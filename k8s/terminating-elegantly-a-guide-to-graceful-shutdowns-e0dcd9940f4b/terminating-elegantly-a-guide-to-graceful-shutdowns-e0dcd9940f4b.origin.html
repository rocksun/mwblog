<!doctype html><html lang="en"><head><title data-rh="true">Terminating Elegantly: A Guide to Graceful Shutdowns | by Alex Pliutau | Jul, 2024 | ITNEXT</title><meta data-rh="true" charset="utf-8"/><meta data-rh="true" name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1,maximum-scale=1"/><meta data-rh="true" name="theme-color" content="#000000"/><meta data-rh="true" name="twitter:app:name:iphone" content="Medium"/><meta data-rh="true" name="twitter:app:id:iphone" content="828256236"/><meta data-rh="true" property="al:ios:app_name" content="Medium"/><meta data-rh="true" property="al:ios:app_store_id" content="828256236"/><meta data-rh="true" property="al:android:package" content="com.medium.reader"/><meta data-rh="true" property="fb:app_id" content="542599432471018"/><meta data-rh="true" property="og:site_name" content="Medium"/><meta data-rh="true" property="og:type" content="article"/><meta data-rh="true" property="article:published_time" content="2024-07-17T12:49:05.265Z"/><meta data-rh="true" name="title" content="Terminating Elegantly: A Guide to Graceful Shutdowns | by Alex Pliutau | Jul, 2024 | ITNEXT"/><meta data-rh="true" property="og:title" content="Terminating Elegantly: A Guide to Graceful Shutdowns"/><meta data-rh="true" property="al:android:url" content="medium://p/e0dcd9940f4b"/><meta data-rh="true" property="al:ios:url" content="medium://p/e0dcd9940f4b"/><meta data-rh="true" property="al:android:app_name" content="Medium"/><meta data-rh="true" name="description" content="Have you ever yanked the power cord out of your computer in frustration? While this might seem like a quick solution, it can lead to data loss and system instability. In the world of software, a…"/><meta data-rh="true" property="og:description" content="Read the original article on packagemain.tech"/><meta data-rh="true" property="og:url" content="https://itnext.io/terminating-elegantly-a-guide-to-graceful-shutdowns-e0dcd9940f4b"/><meta data-rh="true" property="al:web:url" content="https://itnext.io/terminating-elegantly-a-guide-to-graceful-shutdowns-e0dcd9940f4b"/><meta data-rh="true" property="og:image" content="https://miro.medium.com/v2/resize:fit:1200/1*vQXMWaYPYMLVWP8Pjw6XNA.png"/><meta data-rh="true" property="article:author" content="https://medium.com/@pliutau"/><meta data-rh="true" name="author" content="Alex Pliutau"/><meta data-rh="true" name="robots" content="index,follow,max-image-preview:large"/><meta data-rh="true" name="referrer" content="unsafe-url"/><meta data-rh="true" property="twitter:title" content="Terminating Elegantly: A Guide to Graceful Shutdowns"/><meta data-rh="true" name="twitter:site" content="@itnext_io"/><meta data-rh="true" name="twitter:app:url:iphone" content="medium://p/e0dcd9940f4b"/><meta data-rh="true" property="twitter:description" content="Read the original article on packagemain.tech"/><meta data-rh="true" name="twitter:image:src" content="https://miro.medium.com/v2/resize:fit:1200/1*vQXMWaYPYMLVWP8Pjw6XNA.png"/><meta data-rh="true" name="twitter:card" content="summary_large_image"/><meta data-rh="true" name="twitter:creator" content="@pliutau"/><meta data-rh="true" name="twitter:label1" content="Reading time"/><meta data-rh="true" name="twitter:data1" content="6 min read"/><link data-rh="true" rel="icon" href="https://miro.medium.com/v2/resize:fill:256:256/1*SiXeRxgOt0pAYlYhwZIu3g.png"/><link data-rh="true" rel="search" type="application/opensearchdescription+xml" title="Medium" href="/osd.xml"/><link data-rh="true" rel="apple-touch-icon" sizes="152x152" href="https://miro.medium.com/v2/resize:fill:152:152/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"/><link data-rh="true" rel="apple-touch-icon" sizes="120x120" href="https://miro.medium.com/v2/resize:fill:120:120/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"/><link data-rh="true" rel="apple-touch-icon" sizes="76x76" href="https://miro.medium.com/v2/resize:fill:76:76/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"/><link data-rh="true" rel="apple-touch-icon" sizes="60x60" href="https://miro.medium.com/v2/resize:fill:60:60/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"/><link data-rh="true" rel="mask-icon" href="https://cdn-static-1.medium.com/_/fp/icons/Medium-Avatar-500x500.svg" color="#171717"/><link data-rh="true" id="glyph_preload_link" rel="preload" as="style" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" id="glyph_link" rel="stylesheet" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" rel="author" href="https://medium.com/@pliutau"/><link data-rh="true" rel="canonical" href="https://itnext.io/terminating-elegantly-a-guide-to-graceful-shutdowns-e0dcd9940f4b"/><link data-rh="true" rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/e0dcd9940f4b"/><script data-rh="true" type="application/ld+json">{"@context":"http:\u002F\u002Fschema.org","@type":"NewsArticle","image":["https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:1200\u002F1*vQXMWaYPYMLVWP8Pjw6XNA.png"],"url":"https:\u002F\u002Fitnext.io\u002Fterminating-elegantly-a-guide-to-graceful-shutdowns-e0dcd9940f4b","dateCreated":"2024-07-17T08:29:33.653Z","datePublished":"2024-07-17T08:29:33.653Z","dateModified":"2024-07-17T12:49:05.342Z","headline":"Terminating Elegantly: A Guide to Graceful Shutdowns","name":"Terminating Elegantly: A Guide to Graceful Shutdowns","description":"Have you ever yanked the power cord out of your computer in frustration? While this might seem like a quick solution, it can lead to data loss and system instability. In the world of software, a…","identifier":"e0dcd9940f4b","author":{"@type":"Person","name":"Alex Pliutau","url":"https:\u002F\u002Fitnext.io\u002F@pliutau"},"creator":["Alex Pliutau"],"publisher":{"@type":"Organization","name":"ITNEXT","url":"itnext.io","logo":{"@type":"ImageObject","width":315,"height":60,"url":"https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:630\u002F1*jWhTrIoYwTUdKuVXycqAaw.png"}},"mainEntityOfPage":"https:\u002F\u002Fitnext.io\u002Fterminating-elegantly-a-guide-to-graceful-shutdowns-e0dcd9940f4b"}</script><style type="text/css" data-fela-rehydration="518" data-fela-type="STATIC">html{box-sizing:border-box;-webkit-text-size-adjust:100%}*, *:before, *:after{box-sizing:inherit}body{margin:0;padding:0;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;color:rgba(0,0,0,0.8);position:relative;min-height:100vh}h1, h2, h3, h4, h5, h6, dl, dd, ol, ul, menu, figure, blockquote, p, pre, form{margin:0}menu, ol, ul{padding:0;list-style:none;list-style-image:none}main{display:block}a{color:inherit;text-decoration:none}a, button, input{-webkit-tap-highlight-color:transparent}img, svg{vertical-align:middle}button{background:transparent;overflow:visible}button, input, optgroup, select, textarea{margin:0}:root{--reach-tabs:1;--reach-menu-button:1}#speechify-root{font-family:Sohne, sans-serif}div[data-popper-reference-hidden="true"]{visibility:hidden;pointer-events:none}.grecaptcha-badge{visibility:hidden}
/*XCode style (c) Angel Garcia <angelgarcia.mail@gmail.com>*/.hljs {background: #fff;color: black;
}/* Gray DOCTYPE selectors like WebKit */
.xml .hljs-meta {color: #c0c0c0;
}.hljs-comment,
.hljs-quote {color: #007400;
}.hljs-tag,
.hljs-attribute,
.hljs-keyword,
.hljs-selector-tag,
.hljs-literal,
.hljs-name {color: #aa0d91;
}.hljs-variable,
.hljs-template-variable {color: #3F6E74;
}.hljs-code,
.hljs-string,
.hljs-meta .hljs-string {color: #c41a16;
}.hljs-regexp,
.hljs-link {color: #0E0EFF;
}.hljs-title,
.hljs-symbol,
.hljs-bullet,
.hljs-number {color: #1c00cf;
}.hljs-section,
.hljs-meta {color: #643820;
}.hljs-title.class_,
.hljs-class .hljs-title,
.hljs-type,
.hljs-built_in,
.hljs-params {color: #5c2699;
}.hljs-attr {color: #836C28;
}.hljs-subst {color: #000;
}.hljs-formula {background-color: #eee;font-style: italic;
}.hljs-addition {background-color: #baeeba;
}.hljs-deletion {background-color: #ffc8bd;
}.hljs-selector-id,
.hljs-selector-class {color: #9b703f;
}.hljs-doctag,
.hljs-strong {font-weight: bold;
}.hljs-emphasis {font-style: italic;
}
</style><style type="text/css" data-fela-rehydration="518" data-fela-type="KEYFRAME">@-webkit-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@-moz-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}</style><style type="text/css" data-fela-rehydration="518" data-fela-type="RULE">.a{font-family:medium-content-sans-serif-font, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif}.b{font-weight:400}.c{background-color:rgba(255, 255, 255, 1)}.l{display:block}.m{position:sticky}.n{top:0}.o{z-index:500}.p{padding:0 24px}.q{align-items:center}.r{border-bottom:solid 1px #F2F2F2}.y{height:41px}.z{line-height:20px}.ab{display:flex}.ac{height:57px}.ae{flex:1 0 auto}.af{color:inherit}.ag{fill:inherit}.ah{font-size:inherit}.ai{border:inherit}.aj{font-family:inherit}.ak{letter-spacing:inherit}.al{font-weight:inherit}.am{padding:0}.an{margin:0}.ao{cursor:pointer}.ap:disabled{cursor:not-allowed}.aq:disabled{color:#6B6B6B}.ar:disabled{fill:#6B6B6B}.au path{fill:#000000}.av{height:27px}.aw{margin-left:16px}.ax{border:none}.ay{border-radius:20px}.az{width:240px}.ba{background:#F9F9F9}.bb path{fill:#6B6B6B}.bd{outline:none}.be{font-family:sohne, "Helvetica Neue", Helvetica, Arial, sans-serif}.bf{font-size:14px}.bg{width:100%}.bh{padding:10px 20px 10px 0}.bi{background-color:transparent}.bj{color:#242424}.bk::placeholder{color:#6B6B6B}.bl{display:inline-block}.bm{margin-left:12px}.bn{margin-right:12px}.bo{border-radius:4px}.bp{margin-left:24px}.bq{height:24px}.bw{background-color:#F9F9F9}.bx{border-radius:50%}.by{height:32px}.bz{width:32px}.ca{justify-content:center}.cg{max-width:680px}.ch{min-width:0}.ci{animation:k1 1.2s ease-in-out infinite}.cj{height:100vh}.ck{margin-bottom:16px}.cl{margin-top:48px}.cm{align-items:flex-start}.cn{flex-direction:column}.co{justify-content:space-between}.cp{margin-bottom:24px}.cv{width:80%}.cw{background-color:#F2F2F2}.dc{height:44px}.dd{width:44px}.de{margin:auto 0}.df{margin-bottom:4px}.dg{height:16px}.dh{width:120px}.di{width:80px}.do{margin-bottom:8px}.dp{width:96%}.dq{width:98%}.dr{width:81%}.ds{margin-left:8px}.dt{color:#6B6B6B}.du{font-size:13px}.dv{height:100%}.eo{color:#FFFFFF}.ep{fill:#FFFFFF}.eq{background:rgba(63, 141, 206, 1)}.er{border-color:rgba(63, 141, 206, 1)}.ev:disabled{cursor:inherit !important}.ew:disabled{opacity:0.3}.ex:disabled:hover{background:rgba(63, 141, 206, 1)}.ey:disabled:hover{border-color:rgba(63, 141, 206, 1)}.ez{border-radius:99em}.fa{border-width:1px}.fb{border-style:solid}.fc{box-sizing:border-box}.fd{text-decoration:none}.fe{text-align:center}.fh{margin-right:32px}.fi{position:relative}.fj{fill:#6B6B6B}.fm{background:transparent}.fn svg{margin-left:4px}.fo svg{fill:#6B6B6B}.fq{box-shadow:inset 0 0 0 1px rgba(0, 0, 0, 0.05)}.fr{position:absolute}.fy{margin:0 24px}.gc{background:rgba(255, 255, 255, 1)}.gd{border:1px solid #F2F2F2}.ge{box-shadow:0 1px 4px #F2F2F2}.gf{max-height:100vh}.gg{overflow-y:auto}.gh{left:0}.gi{top:calc(100vh + 100px)}.gj{bottom:calc(100vh + 100px)}.gk{width:10px}.gl{pointer-events:none}.gm{word-break:break-word}.gn{word-wrap:break-word}.go:after{display:block}.gp:after{content:""}.gq:after{clear:both}.gr{line-height:1.23}.gs{letter-spacing:0}.gt{font-style:normal}.gu{font-weight:700}.hz{align-items:baseline}.ia{width:48px}.ib{height:48px}.ic{border:2px solid rgba(255, 255, 255, 1)}.id{z-index:0}.ie{box-shadow:none}.if{border:1px solid rgba(0, 0, 0, 0.05)}.ig{margin-left:-12px}.ih{width:28px}.ii{height:28px}.ij{z-index:1}.ik{width:24px}.il{margin-bottom:2px}.im{flex-wrap:nowrap}.in{font-size:16px}.io{line-height:24px}.iq{margin:0 8px}.ir{display:inline}.is{color:rgba(63, 141, 206, 1)}.it{fill:rgba(63, 141, 206, 1)}.iw{flex:0 0 auto}.iz{flex-wrap:wrap}.jc{white-space:pre-wrap}.jd{margin-right:4px}.je{overflow:hidden}.jf{max-height:20px}.jg{text-overflow:ellipsis}.jh{display:-webkit-box}.ji{-webkit-line-clamp:1}.jj{-webkit-box-orient:vertical}.jk{word-break:break-all}.jm{padding-left:8px}.jn{padding-right:8px}.ko> *{flex-shrink:0}.kp{overflow-x:scroll}.kq::-webkit-scrollbar{display:none}.kr{scrollbar-width:none}.ks{-ms-overflow-style:none}.kt{width:74px}.ku{flex-direction:row}.kv{z-index:2}.ky{-webkit-user-select:none}.kz{border:0}.la{fill:rgba(117, 117, 117, 1)}.ld{outline:0}.le{user-select:none}.lf> svg{pointer-events:none}.lo{cursor:progress}.lp{opacity:1}.lq{padding:4px 0}.lt{margin-top:0px}.lu{width:16px}.lw{display:inline-flex}.mc{max-width:100%}.md{padding:8px 2px}.me svg{color:#6B6B6B}.mv{margin-left:auto}.mw{margin-right:auto}.mx{max-width:2880px}.nd{clear:both}.nf{cursor:zoom-in}.ng{z-index:auto}.ni{height:auto}.nj{line-height:1.58}.nk{letter-spacing:-0.004em}.nl{font-family:source-serif-pro, Georgia, Cambria, "Times New Roman", Times, serif}.og{margin-bottom:-0.46em}.oh{text-decoration:underline}.oi{line-height:1.12}.oj{letter-spacing:-0.022em}.ok{font-weight:600}.pf{margin-bottom:-0.28em}.pl{list-style-type:disc}.pm{margin-left:30px}.pn{padding-left:0px}.pt{list-style-type:decimal}.pu{box-shadow:inset 3px 0 0 0 #242424}.pv{padding-left:23px}.pw{margin-left:-20px}.px{font-style:italic}.qd{overflow-x:auto}.qe{font-family:source-code-pro, Menlo, Monaco, "Courier New", Courier, monospace}.qf{padding:32px}.qg{border:1px solid #E5E5E5}.qh{line-height:1.4}.qi{margin-top:-0.2em}.qj{margin-bottom:-0.2em}.qk{white-space:pre}.ql{min-width:fit-content}.qm{max-width:1172px}.qn{max-width:1456px}.qo{margin-bottom:26px}.qp{margin-top:6px}.qq{margin-top:8px}.qr{margin-right:8px}.qs{padding:8px 16px}.qt{border-radius:100px}.qu{transition:background 300ms ease}.qw{white-space:nowrap}.qx{border-top:none}.rd{height:52px}.re{max-height:52px}.rf{box-sizing:content-box}.rg{position:static}.ri{max-width:155px}.ro{margin-right:20px}.ru{align-items:flex-end}.rv{width:76px}.rw{height:76px}.rx{border:2px solid #F9F9F9}.ry{height:72px}.rz{width:72px}.sa{margin-left:-16px}.sb{width:36px}.sc{height:36px}.sd{width:auto}.se{stroke:#F2F2F2}.sf{color:#F2F2F2}.sg{fill:#F2F2F2}.sh{background:#F2F2F2}.si{border-color:#F2F2F2}.so{font-weight:500}.sp{font-size:24px}.sq{line-height:30px}.sr{letter-spacing:-0.016em}.ss{margin-top:16px}.st{height:0px}.su{border-bottom:solid 1px #E5E5E5}.sv{margin-top:72px}.sw{padding:24px 0}.sx{margin-bottom:0px}.sy{margin-right:16px}.as:hover:not(:disabled){color:rgba(25, 25, 25, 1)}.at:hover:not(:disabled){fill:rgba(25, 25, 25, 1)}.es:hover{background:rgba(61, 121, 173, 1)}.et:hover{border-color:rgba(61, 121, 173, 1)}.eu:hover{cursor:pointer}.fk:hover{color:#242424}.fl:hover{fill:#242424}.fp:hover svg{fill:#242424}.fs:hover{background-color:rgba(0, 0, 0, 0.1)}.ip:hover{text-decoration:underline}.iu:hover:not(:disabled){color:rgba(61, 121, 173, 1)}.iv:hover:not(:disabled){fill:rgba(61, 121, 173, 1)}.lc:hover{fill:rgba(8, 8, 8, 1)}.lr:hover{fill:#000000}.ls:hover p{color:#000000}.lv:hover{color:#000000}.mf:hover svg{color:#000000}.qv:hover{background-color:#F2F2F2}.sj:hover{background:#F2F2F2}.sk:hover{border-color:#F2F2F2}.sl:hover{cursor:wait}.sm:hover{color:#F2F2F2}.sn:hover{fill:#F2F2F2}.bc:focus-within path{fill:#242424}.lb:focus{fill:rgba(8, 8, 8, 1)}.mg:focus svg{color:#000000}.nh:focus{transform:scale(1.01)}.lg:active{border-style:none}</style><style type="text/css" data-fela-rehydration="518" data-fela-type="RULE" media="all and (min-width: 1080px)">.d{display:none}.bv{width:64px}.cf{margin:0 64px}.cu{height:48px}.db{margin-bottom:52px}.dn{margin-bottom:48px}.ee{font-size:14px}.ef{line-height:20px}.el{font-size:13px}.em{padding:5px 12px}.fg{display:flex}.fx{margin-bottom:68px}.gb{max-width:680px}.hp{font-size:42px}.hq{margin-top:1.19em}.hr{margin-bottom:32px}.hs{line-height:52px}.ht{letter-spacing:-0.011em}.hy{align-items:center}.ka{border-top:solid 1px #F2F2F2}.kb{border-bottom:solid 1px #F2F2F2}.kc{margin:32px 0 0}.kd{padding:3px 8px}.km> *{margin-right:24px}.kn> :last-child{margin-right:0}.ln{margin-top:0px}.mb{margin:0}.nc{margin-top:40px}.oc{font-size:20px}.od{margin-top:2.14em}.oe{line-height:32px}.of{letter-spacing:-0.003em}.pb{font-size:24px}.pc{margin-top:1.95em}.pd{line-height:30px}.pe{letter-spacing:-0.016em}.pk{margin-top:0.94em}.ps{margin-top:1.14em}.qc{margin-top:56px}.rc{margin-bottom:88px}.rn{display:inline-block}.rt{padding-top:72px}</style><style type="text/css" data-fela-rehydration="518" data-fela-type="RULE" media="all and (max-width: 1079.98px)">.e{display:none}.lm{margin-top:0px}.rm{display:inline-block}</style><style type="text/css" data-fela-rehydration="518" data-fela-type="RULE" media="all and (max-width: 903.98px)">.f{display:none}.ll{margin-top:0px}.rl{display:inline-block}</style><style type="text/css" data-fela-rehydration="518" data-fela-type="RULE" media="all and (max-width: 727.98px)">.g{display:none}.lj{margin-top:0px}.lk{margin-right:0px}.rk{display:inline-block}</style><style type="text/css" data-fela-rehydration="518" data-fela-type="RULE" media="all and (max-width: 551.98px)">.h{display:none}.s{display:flex}.t{justify-content:space-between}.br{width:24px}.cb{margin:0 24px}.cq{height:40px}.cx{margin-bottom:44px}.dj{margin-bottom:32px}.dw{font-size:13px}.dx{line-height:20px}.eg{padding:0px 8px 1px}.ft{margin-bottom:4px}.gv{font-size:32px}.gw{margin-top:1.01em}.gx{margin-bottom:24px}.gy{line-height:38px}.gz{letter-spacing:-0.014em}.hu{align-items:flex-start}.ix{flex-direction:column}.ja{margin-bottom:2px}.jo{margin:24px -24px 0}.jp{padding:0}.ke> *{margin-right:8px}.kf> :last-child{margin-right:24px}.kw{margin-left:0px}.lh{margin-top:0px}.li{margin-right:0px}.lx{margin:0}.mh{border:1px solid #F2F2F2}.mi{border-radius:99em}.mj{padding:0px 16px 0px 12px}.mk{height:38px}.ml{align-items:center}.mn svg{margin-right:8px}.my{margin-top:32px}.nm{font-size:18px}.nn{margin-top:1.56em}.no{line-height:28px}.np{letter-spacing:-0.003em}.ol{font-size:20px}.om{margin-top:1.2em}.on{line-height:24px}.oo{letter-spacing:0}.pg{margin-top:0.67em}.po{margin-top:1.34em}.py{margin-top:40px}.qy{margin-bottom:80px}.rj{display:inline-block}.rp{padding-top:48px}.mm:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="518" data-fela-type="RULE" media="all and (min-width: 904px) and (max-width: 1079.98px)">.i{display:none}.bu{width:64px}.ce{margin:0 64px}.ct{height:48px}.da{margin-bottom:52px}.dm{margin-bottom:48px}.ec{font-size:14px}.ed{line-height:20px}.ej{font-size:13px}.ek{padding:5px 12px}.ff{display:flex}.fw{margin-bottom:68px}.ga{max-width:680px}.hk{font-size:42px}.hl{margin-top:1.19em}.hm{margin-bottom:32px}.hn{line-height:52px}.ho{letter-spacing:-0.011em}.hx{align-items:center}.jw{border-top:solid 1px #F2F2F2}.jx{border-bottom:solid 1px #F2F2F2}.jy{margin:32px 0 0}.jz{padding:3px 8px}.kk> *{margin-right:24px}.kl> :last-child{margin-right:0}.ma{margin:0}.nb{margin-top:40px}.ny{font-size:20px}.nz{margin-top:2.14em}.oa{line-height:32px}.ob{letter-spacing:-0.003em}.ox{font-size:24px}.oy{margin-top:1.95em}.oz{line-height:30px}.pa{letter-spacing:-0.016em}.pj{margin-top:0.94em}.pr{margin-top:1.14em}.qb{margin-top:56px}.rb{margin-bottom:88px}.rs{padding-top:72px}</style><style type="text/css" data-fela-rehydration="518" data-fela-type="RULE" media="all and (min-width: 728px) and (max-width: 903.98px)">.j{display:none}.w{display:flex}.x{justify-content:space-between}.bt{width:64px}.cd{margin:0 48px}.cs{height:48px}.cz{margin-bottom:52px}.dl{margin-bottom:48px}.ea{font-size:13px}.eb{line-height:20px}.ei{padding:0px 8px 1px}.fv{margin-bottom:68px}.fz{max-width:680px}.hf{font-size:42px}.hg{margin-top:1.19em}.hh{margin-bottom:32px}.hi{line-height:52px}.hj{letter-spacing:-0.011em}.hw{align-items:center}.js{border-top:solid 1px #F2F2F2}.jt{border-bottom:solid 1px #F2F2F2}.ju{margin:32px 0 0}.jv{padding:3px 8px}.ki> *{margin-right:24px}.kj> :last-child{margin-right:0}.lz{margin:0}.na{margin-top:40px}.nu{font-size:20px}.nv{margin-top:2.14em}.nw{line-height:32px}.nx{letter-spacing:-0.003em}.ot{font-size:24px}.ou{margin-top:1.95em}.ov{line-height:30px}.ow{letter-spacing:-0.016em}.pi{margin-top:0.94em}.pq{margin-top:1.14em}.qa{margin-top:56px}.ra{margin-bottom:88px}.rr{padding-top:72px}</style><style type="text/css" data-fela-rehydration="518" data-fela-type="RULE" media="all and (min-width: 552px) and (max-width: 727.98px)">.k{display:none}.u{display:flex}.v{justify-content:space-between}.bs{width:24px}.cc{margin:0 24px}.cr{height:40px}.cy{margin-bottom:44px}.dk{margin-bottom:32px}.dy{font-size:13px}.dz{line-height:20px}.eh{padding:0px 8px 1px}.fu{margin-bottom:4px}.ha{font-size:32px}.hb{margin-top:1.01em}.hc{margin-bottom:24px}.hd{line-height:38px}.he{letter-spacing:-0.014em}.hv{align-items:flex-start}.iy{flex-direction:column}.jb{margin-bottom:2px}.jq{margin:24px 0 0}.jr{padding:0}.kg> *{margin-right:8px}.kh> :last-child{margin-right:8px}.kx{margin-left:0px}.ly{margin:0}.mo{border:1px solid #F2F2F2}.mp{border-radius:99em}.mq{padding:0px 16px 0px 12px}.mr{height:38px}.ms{align-items:center}.mu svg{margin-right:8px}.mz{margin-top:32px}.nq{font-size:18px}.nr{margin-top:1.56em}.ns{line-height:28px}.nt{letter-spacing:-0.003em}.op{font-size:20px}.oq{margin-top:1.2em}.or{line-height:24px}.os{letter-spacing:0}.ph{margin-top:0.67em}.pp{margin-top:1.34em}.pz{margin-top:40px}.qz{margin-bottom:80px}.rq{padding-top:48px}.mt:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="518" data-fela-type="RULE" media="print">.rh{display:none}</style><style type="text/css" data-fela-rehydration="518" data-fela-type="RULE" media="(orientation: landscape) and (max-width: 903.98px)">.jl{max-height:none}</style><style type="text/css" data-fela-rehydration="518" data-fela-type="RULE" media="(prefers-reduced-motion: no-preference)">.ne{transition:transform 300ms cubic-bezier(0.2, 0, 0.2, 1)}</style></head><body><div id="root"><div class="a b c"><div class="d e f g h i j k"></div><script>document.domain = document.domain;</script><div class="l c"><div class="l m n o c"><div class="p q r s t u v w x i d y z"><a class="dt ag du be ak b am an ao ap aq ar as at s u w i d q dv z" href="https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fe0dcd9940f4b&amp;%7Efeature=LoOpenInAppButton&amp;%7Echannel=ShowPostUnderCollection&amp;source=---two_column_layout_nav----------------------------------" rel="noopener follow">Open in app<svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" fill="none" viewBox="0 0 10 10" class="ds"><path fill="currentColor" d="M.985 8.485a.375.375 0 1 0 .53.53zM8.75 1.25h.375A.375.375 0 0 0 8.75.875zM8.375 6.5a.375.375 0 1 0 .75 0zM3.5.875a.375.375 0 1 0 0 .75zm-1.985 8.14 7.5-7.5-.53-.53-7.5 7.5zm6.86-7.765V6.5h.75V1.25zM3.5 1.625h5.25v-.75H3.5z"></path></svg></a><div class="ab q"><p class="be b dw dx dy dz ea eb ec ed ee ef dt"><span><a class="be b dw dx eg dy dz eh ea eb ei ej ed ek el ef em eo ep eq er es et eu ev ew ex ey ez fa fb fc bl fd fe" data-testid="headerSignUpButton" href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fitnext.io%2Fterminating-elegantly-a-guide-to-graceful-shutdowns-e0dcd9940f4b&amp;source=post_page---two_column_layout_nav-----------------------global_nav-----------" rel="noopener follow">Sign up</a></span></p><div class="aw l"><p class="be b dw dx dy dz ea eb ec ed ee ef dt"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" href="https://medium.com/m/signin?operation=login&amp;redirect=https%3A%2F%2Fitnext.io%2Fterminating-elegantly-a-guide-to-graceful-shutdowns-e0dcd9940f4b&amp;source=post_page---two_column_layout_nav-----------------------global_nav-----------" rel="noopener follow">Sign in</a></span></p></div></div></div><div class="p q r ab ac"><div class="ab q ae"><a class="af ag ah ai aj ak al am an ao ap aq ar as at ab" aria-label="Homepage" data-testid="headerMediumLogo" href="https://medium.com/?source=---two_column_layout_nav----------------------------------" rel="noopener follow"><svg xmlns="http://www.w3.org/2000/svg" width="120" height="26" fill="none" viewBox="0 0 120 26" class="au av"><path fill="#000" d="m29.57 1.404.036-.008V1.12h-7.27l-6.75 15.979-6.75-15.98H1.003v.278l.035.008c1.327.302 2 .752 2 2.374v18.993c0 1.623-.676 2.073-2.003 2.374L1 25.153v.279h5.315v-.278l-.035-.008c-1.327-.302-2-.751-2-2.374V4.88l8.67 20.552h.492l8.924-21.125V23.24c-.114 1.282-.782 1.677-1.983 1.95l-.036.009v.275h9.259V25.2l-.036-.008c-1.203-.274-1.886-.67-2-1.95l-.006-19.464h.006c0-1.622.674-2.072 2-2.374m4.23 12.582c.15-3.412 1.367-5.875 3.41-5.918.629.01 1.157.219 1.568.62.872.852 1.282 2.634 1.219 5.298zm-.092.962h10.85v-.046c-.03-2.61-.78-4.64-2.228-6.033-1.25-1.204-3.103-1.867-5.048-1.867h-.043c-1.01 0-2.248.246-3.13.693a7.3 7.3 0 0 0-2.623 2.086c-1.185 1.479-1.903 3.477-2.078 5.724a14 14 0 0 0-.04.755q-.007.292-.001.587C29.484 21.934 32.213 26 37.059 26c4.254 0 6.73-3.132 7.348-7.336l-.312-.11c-1.085 2.259-3.034 3.628-5.252 3.461-3.028-.228-5.347-3.32-5.137-7.066m23.122 6.893c-.356.85-1.099 1.319-2.094 1.319s-1.905-.689-2.552-1.939c-.694-1.342-1.06-3.24-1.06-5.487 0-4.678 1.445-7.704 3.68-7.704.937 0 1.674.468 2.026 1.284zm7.198 3.335c-1.327-.316-2-.787-2-2.492V0l-8.062 2.392v.293l.05-.004c1.111-.09 1.866.064 2.304.472.343.32.51.809.51 1.498v3.11C56.033 7.25 55.088 7 53.94 7c-2.326 0-4.453.987-5.986 2.779-1.599 1.867-2.444 4.42-2.444 7.38 0 5.287 2.584 8.84 6.43 8.84 2.25 0 4.06-1.242 4.888-3.336v2.811h7.233v-.29zM70.94 3.085c0-1.65-1.236-2.896-2.875-2.896-1.632 0-2.908 1.272-2.908 2.896s1.278 2.896 2.908 2.896c1.64 0 2.875-1.245 2.875-2.896m1.903 22.092c-1.327-.316-2-.787-2-2.492h-.006V7.055l-7.234 2.092v.284l.043.004c1.566.14 1.994.683 1.994 2.525v13.515h7.24v-.29zm18.536 0c-1.327-.316-2-.787-2-2.492V7.055L82.49 9.078v.285l.04.004c1.28.136 1.65.71 1.65 2.56v9.88c-.426.85-1.227 1.356-2.196 1.39-1.573 0-2.439-1.07-2.439-3.012V7.055l-7.234 2.092v.284l.044.004c1.565.14 1.994.683 1.994 2.525v8.362a9.4 9.4 0 0 0 .15 1.741l.13.57C75.243 24.845 76.848 26 79.362 26c2.129 0 3.996-1.328 4.818-3.405v2.885h7.233v-.291zm28.102.298v-.291l-.035-.009c-1.44-.334-2.001-.964-2.001-2.248V12.295C117.445 8.98 115.597 7 112.5 7c-2.257 0-4.16 1.314-4.893 3.36-.582-2.168-2.257-3.36-4.734-3.36-2.175 0-3.88 1.156-4.612 3.11V7.056l-7.233 2.006v.286l.043.004c1.547.138 1.994.697 1.994 2.492v13.631h6.75v-.29l-.037-.01c-1.148-.271-1.519-.767-1.519-2.04V10.95c.304-.715.917-1.562 2.127-1.562 1.504 0 2.266 1.05 2.266 3.116v12.972h6.751v-.29l-.035-.01c-1.149-.271-1.52-.767-1.52-2.04V12.294a7 7 0 0 0-.095-1.21c.322-.777.97-1.696 2.23-1.696 1.524 0 2.265 1.02 2.265 3.116v12.972z"></path></svg></a><div class="aw h"><div class="ab ax ay az ba q bb bc"><div class="bl" aria-hidden="false" aria-describedby="searchResults" aria-labelledby="searchResults"></div><div class="bm bn ab"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div><input role="combobox" aria-controls="searchResults" aria-expanded="false" aria-label="search" data-testid="headerSearchInput" tabindex="0" class="ax bd be bf z bg bh bi bj bk" placeholder="Search" value=""/></div></div></div><div class="h k w ff fg"><div class="fh ab"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerWriteButton" href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fnew-story&amp;source=---two_column_layout_nav-----------------------new_post_topnav-----------" rel="noopener follow"><div class="be b bf z dt fi fj ab q fk fl"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Write"><path fill="currentColor" d="M14 4a.5.5 0 0 0 0-1zm7 6a.5.5 0 0 0-1 0zm-7-7H4v1h10zM3 4v16h1V4zm1 17h16v-1H4zm17-1V10h-1v10zm-1 1a1 1 0 0 0 1-1h-1zM3 20a1 1 0 0 0 1 1v-1zM4 3a1 1 0 0 0-1 1h1z"></path><path stroke="currentColor" d="m17.5 4.5-8.458 8.458a.25.25 0 0 0-.06.098l-.824 2.47a.25.25 0 0 0 .316.316l2.47-.823a.25.25 0 0 0 .098-.06L19.5 6.5m-2-2 2.323-2.323a.25.25 0 0 1 .354 0l1.646 1.646a.25.25 0 0 1 0 .354L19.5 6.5m-2-2 2 2"></path></svg><div class="ds l">Write</div></div></a></span></div></div><div class="k j i d"><div class="fh ab"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSearchButton" href="https://medium.com/search?source=---two_column_layout_nav----------------------------------" rel="noopener follow"><div class="be b bf z dt fi fj ab q fk fl"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Search"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div></a></div></div><div class="fh h k j"><div class="ab q"><p class="be b dw dx dy dz ea eb ec ed ee ef dt"><span><a class="be b dw dx eg dy dz eh ea eb ei ej ed ek el ef em eo ep eq er es et eu ev ew ex ey ez fa fb fc bl fd fe" data-testid="headerSignUpButton" href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fitnext.io%2Fterminating-elegantly-a-guide-to-graceful-shutdowns-e0dcd9940f4b&amp;source=post_page---two_column_layout_nav-----------------------global_nav-----------" rel="noopener follow">Sign up</a></span></p><div class="aw l"><p class="be b dw dx dy dz ea eb ec ed ee ef dt"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" href="https://medium.com/m/signin?operation=login&amp;redirect=https%3A%2F%2Fitnext.io%2Fterminating-elegantly-a-guide-to-graceful-shutdowns-e0dcd9940f4b&amp;source=post_page---two_column_layout_nav-----------------------global_nav-----------" rel="noopener follow">Sign in</a></span></p></div></div></div><div class="l" aria-hidden="false"><button class="ax fm am ab q ao fn fo fp" aria-label="user options menu" data-testid="headerUserIcon"><div class="l fi"><img alt="" class="l fc bx by bz cw" src="https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png" width="32" height="32" loading="lazy" role="presentation"/><div class="fq bx l by bz fr n ax fs"></div></div></button></div></div></div><div class="l"><div class="ft fu fv fw fx l"><div class="ab ca"><div class="ch bg fy fz ga gb"></div></div><article><div class="l"><div class="l"><span class="l"></span><section><div><div class="fr gh gi gj gk gl"></div><div class="gm gn go gp gq"><div class="ab ca"><div class="ch bg fy fz ga gb"><div><h1 id="d772" class="pw-post-title gr gs gt be gu gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho hp hq hr hs ht bj" data-testid="storyTitle">Terminating Elegantly: A Guide to Graceful Shutdowns</h1><div><div class="speechify-ignore ab co"><div class="speechify-ignore bg l"><div class="hu hv hw hx hy ab"><div><div class="ab hz"><a href="https://medium.com/@pliutau?source=post_page-----e0dcd9940f4b--------------------------------" rel="noopener follow"><div><div class="bl" aria-hidden="false"><div class="l ia ib bx ic id"><div class="l fi"><img alt="Alex Pliutau" class="l fc bx dc dd cw" src="https://miro.medium.com/v2/resize:fill:88:88/1*0GZGQK6ulOCFFdWNdu_sPQ.png" width="44" height="44" loading="lazy" data-testid="authorPhoto"/><div class="ie bx l dc dd fr n if fs"></div></div></div></div></div></a><a href="https://itnext.io/?source=post_page-----e0dcd9940f4b--------------------------------" rel="noopener  ugc nofollow"><div class="ig ab fi"><div><div class="bl" aria-hidden="false"><div class="l ih ii bx ic ij"><div class="l fi"><img alt="ITNEXT" class="l fc bx bq ik cw" src="https://miro.medium.com/v2/resize:fill:48:48/1*yAqDFIFA5F_NXalOJKz4TA.png" width="24" height="24" loading="lazy" data-testid="publicationPhoto"/><div class="ie bx l bq ik fr n if fs"></div></div></div></div></div></div></a></div></div><div class="bm bg l"><div class="ab"><div style="flex:1"><span class="be b bf z bj"><div class="il ab q"><div class="ab q im"><div class="ab q"><div><div class="bl" aria-hidden="false"><p class="be b in io bj"><a class="af ag ah ai aj ak al am an ao ap aq ar ip" data-testid="authorName" href="https://medium.com/@pliutau?source=post_page-----e0dcd9940f4b--------------------------------" rel="noopener follow">Alex Pliutau</a></p></div></div></div><span class="iq ir" aria-hidden="true"><span class="be b bf z dt">·</span></span><p class="be b in io dt"><span><a class="is it ah ai aj ak al am an ao ap aq ar ew iu iv" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F83ef5b231666&amp;operation=register&amp;redirect=https%3A%2F%2Fitnext.io%2Fterminating-elegantly-a-guide-to-graceful-shutdowns-e0dcd9940f4b&amp;user=Alex+Pliutau&amp;userId=83ef5b231666&amp;source=post_page-83ef5b231666----e0dcd9940f4b---------------------post_header-----------" rel="noopener follow">Follow</a></span></p></div></div></span></div></div><div class="l iw"><span class="be b bf z dt"><div class="ab cm ix iy iz"><div class="ja jb ab"><div class="be b bf z dt ab jc"><span class="jd l iw">Published in</span><div><div class="l" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar ip ab q" data-testid="publicationName" href="https://itnext.io/?source=post_page-----e0dcd9940f4b--------------------------------" rel="noopener  ugc nofollow"><p class="be b bf z je jf jg jh ji jj jk jl bj">ITNEXT</p></a></div></div></div><div class="h k"><span class="iq ir" aria-hidden="true"><span class="be b bf z dt">·</span></span></div></div><span class="be b bf z dt"><div class="ab ae"><span data-testid="storyReadTime">6 min read</span><div class="jm jn l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="be b bf z dt">·</span></span></div>5 hours ago</div></span></div></span></div></div></div><div class="ab co jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd"><div class="h k w ff fg q"><div class="kt l"><div class="ab q ku kv"><div class="pw-multi-vote-icon fi jd kw kx ky"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fitnext%2Fe0dcd9940f4b&amp;operation=register&amp;redirect=https%3A%2F%2Fitnext.io%2Fterminating-elegantly-a-guide-to-graceful-shutdowns-e0dcd9940f4b&amp;user=Alex+Pliutau&amp;userId=83ef5b231666&amp;source=-----e0dcd9940f4b---------------------clap_footer-----------" rel="noopener follow"><div><div class="bl" aria-hidden="false"><div class="kz ao la lb lc ld am le lf lg ky"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l lh li lj lk ll lm ln"><p class="be b du z dt"><span class="lo">--</span></p></div></div></div><div><div class="bl" aria-hidden="false"><button class="ao kz lp lq ab q fj lr ls" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="lt"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg></button></div></div></div><div class="ab q ke kf kg kh ki kj kk kl km kn ko kp kq kr ks"><div class="lu k j i d"></div><div class="h k"><div><div class="bl" aria-hidden="false"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerBookmarkButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe0dcd9940f4b&amp;operation=register&amp;redirect=https%3A%2F%2Fitnext.io%2Fterminating-elegantly-a-guide-to-graceful-shutdowns-e0dcd9940f4b&amp;source=-----e0dcd9940f4b---------------------bookmark_footer-----------" rel="noopener follow"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="dt lv" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div><div class="fc lw cm"><div class="l ae"><div class="ab ca"><div class="lx ly lz ma mb mc ch bg"><div class="ab"><div class="bl bg" aria-hidden="false"><div><div class="bl" aria-hidden="false"><button aria-label="Listen" data-testid="audioPlayButton" class="af fj ah ai aj ak al md an ao ap ew me mf ls mg mh mi mj mk s ml mm mn mo mp mq mr u ms mt mu"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"></path></svg><div class="j i d"><p class="be b bf z dt">Listen</p></div></button></div></div></div></div></div></div></div></div><div class="bl" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bl" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af fj ah ai aj ak al md an ao ap ew me mf ls mg mh mi mj mk s ml mm mn mo mp mq mr u ms mt mu"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg><div class="j i d"><p class="be b bf z dt">Share</p></div></button></div></div></div></div></div></div></div></div></div><figure class="my mz na nb nc nd mv mw paragraph-image"><div role="button" tabindex="0" class="ne nf fi ng bg nh"><div class="mv mw mx"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*vQXMWaYPYMLVWP8Pjw6XNA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*vQXMWaYPYMLVWP8Pjw6XNA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*vQXMWaYPYMLVWP8Pjw6XNA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*vQXMWaYPYMLVWP8Pjw6XNA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*vQXMWaYPYMLVWP8Pjw6XNA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*vQXMWaYPYMLVWP8Pjw6XNA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vQXMWaYPYMLVWP8Pjw6XNA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*vQXMWaYPYMLVWP8Pjw6XNA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*vQXMWaYPYMLVWP8Pjw6XNA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*vQXMWaYPYMLVWP8Pjw6XNA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*vQXMWaYPYMLVWP8Pjw6XNA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*vQXMWaYPYMLVWP8Pjw6XNA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*vQXMWaYPYMLVWP8Pjw6XNA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*vQXMWaYPYMLVWP8Pjw6XNA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bg mc ni c" width="700" height="467" loading="eager" role="presentation"/></picture></div></div></figure><p id="b87a" class="pw-post-body-paragraph nj nk gt nl b nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og gm bj"><a class="af oh" href="https://packagemain.tech/p/graceful-shutdowns-k8s-go" rel="noopener ugc nofollow" target="_blank"><strong class="nl gu">Read the original article on packagemain.tech</strong></a></p><p id="22f0" class="pw-post-body-paragraph nj nk gt nl b nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og gm bj">Have you ever yanked the power cord out of your computer in frustration? While this might seem like a quick solution, it can lead to data loss and system instability. In the world of software, a similar concept exists: the hard shutdown. This abrupt termination can cause problems just like its physical counterpart. Thankfully, there’s a better way: the graceful shutdown.</p><p id="0592" class="pw-post-body-paragraph nj nk gt nl b nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og gm bj">By integrating graceful shutdown, we provide advance notification to the service. This enables it to complete ongoing requests, potentially save state information to disk, and ultimately avoid data corruption during shutdown.</p><p id="fc8e" class="pw-post-body-paragraph nj nk gt nl b nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og gm bj">This guide will delve into the world of graceful shutdowns, specifically focusing on their implementation in Go applications running on Kubernetes.</p><h1 id="2f3c" class="oi oj gt be ok ol om on oo op oq or os ot ou ov ow ox oy oz pa pb pc pd pe pf bj">Signals in Unix Systems</h1><p id="73ef" class="pw-post-body-paragraph nj nk gt nl b nm pg no np nq ph ns nt nu pi nw nx ny pj oa ob oc pk oe of og gm bj">One of the key tools for achieving graceful shutdowns in Unix-based systems is the concept of signals, which are, in simple terms, a simple way to communicate one specific thing to a process, from another process. By understanding how signals work, we can leverage them to implement controlled termination procedures within our applications, ensuring a smooth and data-safe shutdown process.</p><p id="6ce1" class="pw-post-body-paragraph nj nk gt nl b nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og gm bj">There are many signals, and you can find them <a class="af oh" href="https://en.wikipedia.org/wiki/Signal_(IPC)" rel="noopener ugc nofollow" target="_blank"><strong class="nl gu">here</strong></a>, but our concern is only shutdown signals:</p><ul class=""><li id="dc3e" class="nj nk gt nl b nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og pl pm pn bj"><strong class="nl gu">SIGTERM</strong> — sent to a process to request its termination. Most commonly used, and we’ll be focusing on it later.</li><li id="9e58" class="nj nk gt nl b nm po no np nq pp ns nt nu pq nw nx ny pr oa ob oc ps oe of og pl pm pn bj"><strong class="nl gu">SIGKILL</strong> — “quit immediately”, can not be interfered with.</li><li id="c9c2" class="nj nk gt nl b nm po no np nq pp ns nt nu pq nw nx ny pr oa ob oc ps oe of og pl pm pn bj"><strong class="nl gu">SIGINT</strong> — interrupt signal (such as Ctrl+C)</li><li id="3c01" class="nj nk gt nl b nm po no np nq pp ns nt nu pq nw nx ny pr oa ob oc ps oe of og pl pm pn bj"><strong class="nl gu">SIGQUIT</strong> — quit signal (such as Ctrl+D)</li></ul><p id="0727" class="pw-post-body-paragraph nj nk gt nl b nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og gm bj">These signals can be sent from the user (Ctrl+C / Ctrl+D), from another program/process or from the system itself (kernel / OS), for example a <strong class="nl gu">SIGSEGV</strong> aka segmentation fault is sent by the OS.</p><h1 id="6750" class="oi oj gt be ok ol om on oo op oq or os ot ou ov ow ox oy oz pa pb pc pd pe pf bj">Our Guinea Pig Service</h1><p id="00f1" class="pw-post-body-paragraph nj nk gt nl b nm pg no np nq ph ns nt nu pi nw nx ny pj oa ob oc pk oe of og gm bj">To explore the world of graceful shutdowns in a practical setting, let’s create a simple service we can experiment with. This “guinea pig” service will have a single endpoint that simulates some real-world work (we’ll add a slight delay) by calling Redis’s <a class="af oh" href="https://redis.io/docs/latest/commands/incr/" rel="noopener ugc nofollow" target="_blank">INCR</a> command. We’ll also provide a basic Kubernetes configuration to test how the platform handles termination signals.</p><p id="cddf" class="pw-post-body-paragraph nj nk gt nl b nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og gm bj">The ultimate goal: ensure our service gracefully handles shutdowns without losing any requests/data. By comparing the number of requests sent in parallel with the final counter value in Redis, we’ll be able to verify if our graceful shutdown implementation is successful.</p><p id="d2af" class="pw-post-body-paragraph nj nk gt nl b nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og gm bj">We won’t go into details of setting up the Kubernetes cluster and Redis, but you can find the <a class="af oh" href="https://github.com/plutov/packagemain/tree/master/graceful-shutdown" rel="noopener ugc nofollow" target="_blank"><strong class="nl gu">full setup in our Github repository</strong></a>.</p><p id="941a" class="pw-post-body-paragraph nj nk gt nl b nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og gm bj">The verification process is the following:</p><ol class=""><li id="cf4a" class="nj nk gt nl b nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og pt pm pn bj">Deploy Redis and Go application to Kubernetes.</li><li id="bcaa" class="nj nk gt nl b nm po no np nq pp ns nt nu pq nw nx ny pr oa ob oc ps oe of og pt pm pn bj">Use <a class="af oh" href="https://github.com/tsenart/vegeta" rel="noopener ugc nofollow" target="_blank"><strong class="nl gu">vegeta</strong></a> to send 1000 requests (25/s over 40 seconds).</li><li id="67c5" class="nj nk gt nl b nm po no np nq pp ns nt nu pq nw nx ny pr oa ob oc ps oe of og pt pm pn bj">While vegeta is running, initialize a Kubernetes <a class="af oh" href="https://kubernetes.io/docs/tutorials/kubernetes-basics/update/update-intro/" rel="noopener ugc nofollow" target="_blank"><strong class="nl gu">Rolling Update</strong></a> by updating image tag.</li><li id="bdd3" class="nj nk gt nl b nm po no np nq pp ns nt nu pq nw nx ny pr oa ob oc ps oe of og pt pm pn bj">Connect to Redis to verify the “counter“, it should be 1000.</li></ol><p id="3bf5" class="pw-post-body-paragraph nj nk gt nl b nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og gm bj">Let’s start with our base Go HTTP Server.</p><blockquote class="pu pv pw"><p id="8ff1" class="nj nk px nl b nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og gm bj"><strong class="nl gu">hard-shutdown/main.go</strong></p></blockquote><pre class="py pz qa qb qc qd qe qf bo qg ba bj"><span id="0d3c" class="qh oj gt qe b bf qi qj l qk ql">package main<br/><br/>import (<br/>  &quot;net/http&quot;<br/>  &quot;os&quot;<br/>  &quot;time&quot;<br/><br/>  &quot;github.com/go-redis/redis&quot;<br/>)<br/><br/>func main() {<br/>  redisdb := redis.NewClient(&amp;redis.Options{<br/>    Addr: os.Getenv(&quot;REDIS_ADDR&quot;),<br/>  })<br/><br/>  server := http.Server{<br/>    Addr: &quot;:8080&quot;,<br/>  }<br/><br/>  http.HandleFunc(&quot;/incr&quot;, func(w http.ResponseWriter, r *http.Request) {<br/>    go processRequest(redisdb)<br/>    w.WriteHeader(http.StatusOK)<br/>  })<br/><br/>  server.ListenAndServe()<br/>}<br/><br/>func processRequest(redisdb *redis.Client) {<br/>  // simulate some business logic here<br/>  time.Sleep(time.Second * 5)<br/>  redisdb.Incr(&quot;counter&quot;)<br/>}</span></pre><p id="ae37" class="pw-post-body-paragraph nj nk gt nl b nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og gm bj">When we run our verification procedure using this code we’ll see that some requests fail and the <strong class="nl gu">counter is less than 1000 </strong>(the number may vary each run).</p><figure class="py pz qa qb qc nd mv mw paragraph-image"><div role="button" tabindex="0" class="ne nf fi ng bg nh"><div class="mv mw qm"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*AUoAI6tNPg39i6Mm.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*AUoAI6tNPg39i6Mm.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*AUoAI6tNPg39i6Mm.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*AUoAI6tNPg39i6Mm.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*AUoAI6tNPg39i6Mm.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*AUoAI6tNPg39i6Mm.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*AUoAI6tNPg39i6Mm.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*AUoAI6tNPg39i6Mm.png 640w, https://miro.medium.com/v2/resize:fit:720/0*AUoAI6tNPg39i6Mm.png 720w, https://miro.medium.com/v2/resize:fit:750/0*AUoAI6tNPg39i6Mm.png 750w, https://miro.medium.com/v2/resize:fit:786/0*AUoAI6tNPg39i6Mm.png 786w, https://miro.medium.com/v2/resize:fit:828/0*AUoAI6tNPg39i6Mm.png 828w, https://miro.medium.com/v2/resize:fit:1100/0*AUoAI6tNPg39i6Mm.png 1100w, https://miro.medium.com/v2/resize:fit:1400/0*AUoAI6tNPg39i6Mm.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bg mc ni c" width="700" height="133" loading="lazy" role="presentation"/></picture></div></div></figure><p id="1a77" class="pw-post-body-paragraph nj nk gt nl b nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og gm bj">Which clearly means that we lost some data during the rolling update. 😢</p><h1 id="03c9" class="oi oj gt be ok ol om on oo op oq or os ot ou ov ow ox oy oz pa pb pc pd pe pf bj">Handling Signals in Go</h1><p id="f1e7" class="pw-post-body-paragraph nj nk gt nl b nm pg no np nq ph ns nt nu pi nw nx ny pj oa ob oc pk oe of og gm bj">Go provides a <a class="af oh" href="https://pkg.go.dev/os/signal" rel="noopener ugc nofollow" target="_blank">signal</a> package that allows you to handle Unix Signals. It’s important to note that by default, SIGINT and SIGTERM signals cause the Go program to exit. And in order for our Go application not to exit so abruptly, we need to handle incoming signals.</p><p id="d8a9" class="pw-post-body-paragraph nj nk gt nl b nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og gm bj">There are two options to do so.</p><blockquote class="pu pv pw"><p id="6bcf" class="nj nk px nl b nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og gm bj"><em class="gt">Using channel:</em></p></blockquote><pre class="py pz qa qb qc qd qe qf bo qg ba bj"><span id="8b27" class="qh oj gt qe b bf qi qj l qk ql">c := make(chan os.Signal, 1)<br/>signal.Notify(c, syscall.SIGTERM)</span></pre><blockquote class="pu pv pw"><p id="8816" class="nj nk px nl b nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og gm bj"><em class="gt">Using context (preferred approach nowadays):</em></p></blockquote><pre class="py pz qa qb qc qd qe qf bo qg ba bj"><span id="0a74" class="qh oj gt qe b bf qi qj l qk ql">ctx, stop := signal.NotifyContext(context.Background(), syscall.SIGTERM)<br/>defer stop()</span></pre><p id="d34d" class="pw-post-body-paragraph nj nk gt nl b nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og gm bj"><strong class="nl gu">NotifyContext</strong> returns a copy of the parent context that is marked done (its Done channel is closed) when one of the listed signals arrives, when the returned <strong class="nl gu">stop()</strong> function is called, or when the parent context’s Done channel is closed, whichever happens first.</p><p id="5368" class="pw-post-body-paragraph nj nk gt nl b nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og gm bj">There are few problems with our current implementation of HTTP Server:</p><ol class=""><li id="d8f1" class="nj nk gt nl b nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og pt pm pn bj">We have a slow processRequest goroutine, and since we don’t handle the termination signal, the program exits automatically, meaning all running goroutines are terminated as well.</li><li id="861f" class="nj nk gt nl b nm po no np nq pp ns nt nu pq nw nx ny pr oa ob oc ps oe of og pt pm pn bj">The program doesn’t close any connections.</li></ol><p id="c7de" class="pw-post-body-paragraph nj nk gt nl b nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og gm bj">Let’s rewrite it.</p><blockquote class="pu pv pw"><p id="001f" class="nj nk px nl b nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og gm bj"><strong class="nl gu">graceful-shutdown/main.go</strong></p></blockquote><pre class="py pz qa qb qc qd qe qf bo qg ba bj"><span id="b98c" class="qh oj gt qe b bf qi qj l qk ql">package main<br/><br/>// imports<br/><br/>var wg sync.WaitGroup<br/><br/>func main() {<br/>  ctx, stop := signal.NotifyContext(context.Background(), syscall.SIGTERM)<br/>  defer stop()<br/><br/>  // redisdb, server<br/><br/>  http.HandleFunc(&quot;/incr&quot;, func(w http.ResponseWriter, r *http.Request) {<br/>    wg.Add(1)<br/>    go processRequest(redisdb)<br/>    w.WriteHeader(http.StatusOK)<br/>  })<br/><br/>  // make it a goroutine<br/>  go server.ListenAndServe()<br/><br/>  // listen for the interrupt signal<br/>  &lt;-ctx.Done()<br/><br/>  // stop the server<br/>  if err := server.Shutdown(context.Background()); err != nil {<br/>    log.Fatalf(&quot;could not shutdown: %v\n&quot;, err)<br/>  }<br/><br/>  // wait for all goroutines to finish<br/>  wg.Wait()<br/><br/>  // close redis connection<br/>  redisdb.Close()<br/><br/>  os.Exit(0)<br/>}<br/><br/>func processRequest(redisdb *redis.Client) {<br/>  defer wg.Done()<br/><br/>  // simulate some business logic here<br/>  time.Sleep(time.Second * 5)<br/>  redisdb.Incr(&quot;counter&quot;)<br/>}</span></pre><p id="bddb" class="pw-post-body-paragraph nj nk gt nl b nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og gm bj">Here’s the summary of updates:</p><ul class=""><li id="90da" class="nj nk gt nl b nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og pl pm pn bj">Added <strong class="nl gu">signal.NotifyContext</strong> to listen for the SIGTERM termination signal.</li><li id="f164" class="nj nk gt nl b nm po no np nq pp ns nt nu pq nw nx ny pr oa ob oc ps oe of og pl pm pn bj">Introduced a <strong class="nl gu">sync.WaitGroup</strong> to track in-flight requests (processRequest goroutines).</li><li id="1f1c" class="nj nk gt nl b nm po no np nq pp ns nt nu pq nw nx ny pr oa ob oc ps oe of og pl pm pn bj">Wrapped the server in a goroutine and used <strong class="nl gu">server.Shutdown</strong> with context to gracefully stop accepting new connections.</li><li id="6fea" class="nj nk gt nl b nm po no np nq pp ns nt nu pq nw nx ny pr oa ob oc ps oe of og pl pm pn bj">Used <strong class="nl gu">wg.Wait()</strong> to ensure all in-flight requests (processRequest goroutines) finish before proceeding.</li><li id="c0bc" class="nj nk gt nl b nm po no np nq pp ns nt nu pq nw nx ny pr oa ob oc ps oe of og pl pm pn bj">Resource Cleanup: Added <strong class="nl gu">redisdb.Close()</strong> to properly close the Redis connection before exiting.</li><li id="ae07" class="nj nk gt nl b nm po no np nq pp ns nt nu pq nw nx ny pr oa ob oc ps oe of og pl pm pn bj">Clean Exit: Used <strong class="nl gu">os.Exit(0)</strong> to indicate a successful termination.</li></ul><p id="bfca" class="pw-post-body-paragraph nj nk gt nl b nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og gm bj">Now, if we repeat our verification process we will see that all 1000 requests are processed correctly. 🎉</p><figure class="py pz qa qb qc nd mv mw paragraph-image"><div role="button" tabindex="0" class="ne nf fi ng bg nh"><div class="mv mw qm"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*zI2edjPToJnSDXTQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*zI2edjPToJnSDXTQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*zI2edjPToJnSDXTQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*zI2edjPToJnSDXTQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*zI2edjPToJnSDXTQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*zI2edjPToJnSDXTQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*zI2edjPToJnSDXTQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*zI2edjPToJnSDXTQ.png 640w, https://miro.medium.com/v2/resize:fit:720/0*zI2edjPToJnSDXTQ.png 720w, https://miro.medium.com/v2/resize:fit:750/0*zI2edjPToJnSDXTQ.png 750w, https://miro.medium.com/v2/resize:fit:786/0*zI2edjPToJnSDXTQ.png 786w, https://miro.medium.com/v2/resize:fit:828/0*zI2edjPToJnSDXTQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/0*zI2edjPToJnSDXTQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/0*zI2edjPToJnSDXTQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bg mc ni c" width="700" height="133" loading="lazy" role="presentation"/></picture></div></div></figure><h1 id="3b89" class="oi oj gt be ok ol om on oo op oq or os ot ou ov ow ox oy oz pa pb pc pd pe pf bj">Web frameworks / HTTP library</h1><p id="adde" class="pw-post-body-paragraph nj nk gt nl b nm pg no np nq ph ns nt nu pi nw nx ny pj oa ob oc pk oe of og gm bj">Frameworks like Echo, Gin, Fiber and others will spawn a goroutine for each incoming requests, giving it a context and then call your function / handler depending on the routing you decided. In our case it would be the anonymous function given to HandleFunc for the “/incr” path.</p><p id="f765" class="pw-post-body-paragraph nj nk gt nl b nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og gm bj">When you intercept a <strong class="nl gu">SIGTERM</strong> signals and ask your framework to gracefully shutdown, 2 important things happen (to oversimplify):</p><ul class=""><li id="d917" class="nj nk gt nl b nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og pl pm pn bj">Your framework stop accepting incoming requests</li><li id="a4f7" class="nj nk gt nl b nm po no np nq pp ns nt nu pq nw nx ny pr oa ob oc ps oe of og pl pm pn bj">It waits for any existing incoming requests to finish (implicitly waiting for the goroutines to end).</li></ul><p id="9a80" class="pw-post-body-paragraph nj nk gt nl b nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og gm bj"><em class="px">Note: Kubernetes also stop directing incoming traffic from the loadbalancer to your pod once it has labelled it as Terminating.</em></p><h1 id="3399" class="oi oj gt be ok ol om on oo op oq or os ot ou ov ow ox oy oz pa pb pc pd pe pf bj">Optional: Shutdown Timeout</h1><p id="90b6" class="pw-post-body-paragraph nj nk gt nl b nm pg no np nq ph ns nt nu pi nw nx ny pj oa ob oc pk oe of og gm bj">Terminating a process can be complex, especially if there are many steps involved like closing connections. To ensure things run smoothly, you can set a timeout. This timeout acts as a safety net, gracefully exiting the process if it takes longer than expected.</p><pre class="py pz qa qb qc qd qe qf bo qg ba bj"><span id="1e3a" class="qh oj gt qe b bf qi qj l qk ql">shutdownCtx, cancel := context.WithTimeout(context.Background(), 10*time.Second)<br/>defer cancel()<br/><br/>go func() {<br/>  if err := server.Shutdown(shutdownCtx); err != nil {<br/>    log.Fatalf(&quot;could not shutdown: %v\n&quot;, err)<br/>  }<br/>}()<br/><br/>select {<br/>case &lt;-shutdownCtx.Done():<br/>  if shutdownCtx.Err() == context.DeadlineExceeded {<br/>    log.Fatalln(&quot;timeout exceeded, forcing shutdown&quot;)<br/>  }<br/><br/>  os.Exit(0)<br/>}</span></pre><h1 id="37e1" class="oi oj gt be ok ol om on oo op oq or os ot ou ov ow ox oy oz pa pb pc pd pe pf bj">Kubernetes Termination Lifecycle</h1><figure class="py pz qa qb qc nd mv mw paragraph-image"><div role="button" tabindex="0" class="ne nf fi ng bg nh"><div class="mv mw qn"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*gQykMIGcZcw-AkAV.jpeg 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*gQykMIGcZcw-AkAV.jpeg 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*gQykMIGcZcw-AkAV.jpeg 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*gQykMIGcZcw-AkAV.jpeg 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*gQykMIGcZcw-AkAV.jpeg 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*gQykMIGcZcw-AkAV.jpeg 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*gQykMIGcZcw-AkAV.jpeg 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*gQykMIGcZcw-AkAV.jpeg 640w, https://miro.medium.com/v2/resize:fit:720/0*gQykMIGcZcw-AkAV.jpeg 720w, https://miro.medium.com/v2/resize:fit:750/0*gQykMIGcZcw-AkAV.jpeg 750w, https://miro.medium.com/v2/resize:fit:786/0*gQykMIGcZcw-AkAV.jpeg 786w, https://miro.medium.com/v2/resize:fit:828/0*gQykMIGcZcw-AkAV.jpeg 828w, https://miro.medium.com/v2/resize:fit:1100/0*gQykMIGcZcw-AkAV.jpeg 1100w, https://miro.medium.com/v2/resize:fit:1400/0*gQykMIGcZcw-AkAV.jpeg 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bg mc ni c" width="700" height="155" loading="lazy" role="presentation"/></picture></div></div></figure><p id="225f" class="pw-post-body-paragraph nj nk gt nl b nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og gm bj">Since we used Kubernetes to deploy our service, let’s dive deeper into how it terminates the pods. Once Kubernetes decides to terminate the pod, the following events will take place:</p><ol class=""><li id="8656" class="nj nk gt nl b nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og pt pm pn bj">Pod is set to the “Terminating” State and removed from the endpoints list of all Services.</li><li id="4675" class="nj nk gt nl b nm po no np nq pp ns nt nu pq nw nx ny pr oa ob oc ps oe of og pt pm pn bj"><strong class="nl gu">preStop</strong> Hook is executed if defined.</li><li id="fa90" class="nj nk gt nl b nm po no np nq pp ns nt nu pq nw nx ny pr oa ob oc ps oe of og pt pm pn bj"><strong class="nl gu">SIGTERM</strong> signal is sent to the pod. But hey, now our application knows what to do!</li><li id="8aaf" class="nj nk gt nl b nm po no np nq pp ns nt nu pq nw nx ny pr oa ob oc ps oe of og pt pm pn bj">Kubernetes waits for a grace period (<strong class="nl gu">terminationGracePeriodSeconds</strong>), which is 30s by default.</li><li id="2c52" class="nj nk gt nl b nm po no np nq pp ns nt nu pq nw nx ny pr oa ob oc ps oe of og pt pm pn bj"><strong class="nl gu">SIGKILL</strong> signal is sent to pod, and the pod is removed.</li></ol><p id="2e09" class="pw-post-body-paragraph nj nk gt nl b nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og gm bj">As you can see, if you have a long-running termination process, it may be necessary to increase the <strong class="nl gu">terminationGracePeriodSeconds </strong>setting<strong class="nl gu">,</strong> allowing your application enough time to shut down gracefully.</p><h1 id="224a" class="oi oj gt be ok ol om on oo op oq or os ot ou ov ow ox oy oz pa pb pc pd pe pf bj">Conclusion</h1><p id="2399" class="pw-post-body-paragraph nj nk gt nl b nm pg no np nq ph ns nt nu pi nw nx ny pj oa ob oc pk oe of og gm bj">Graceful shutdowns safeguard data integrity, maintain a seamless user experience, and optimize resource management. With its rich standard library and emphasis on concurrency, Go empowers developers to effortlessly integrate graceful shutdown practices — a necessity for applications deployed in containerized or orchestrated environments like Kubernetes.</p><p id="4c8a" class="pw-post-body-paragraph nj nk gt nl b nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og gm bj">You can find the Go code and Kubernetes manifests in <a class="af oh" href="https://github.com/plutov/packagemain/tree/master/graceful-shutdown" rel="noopener ugc nofollow" target="_blank">our Github repository</a>.</p><h1 id="5840" class="oi oj gt be ok ol om on oo op oq or os ot ou ov ow ox oy oz pa pb pc pd pe pf bj">Resources</h1><ul class=""><li id="4b7a" class="nj nk gt nl b nm pg no np nq ph ns nt nu pi nw nx ny pj oa ob oc pk oe of og pl pm pn bj"><a class="af oh" href="https://pkg.go.dev/os/signal" rel="noopener ugc nofollow" target="_blank">os/signal packag</a></li><li id="a81e" class="nj nk gt nl b nm po no np nq pp ns nt nu pq nw nx ny pr oa ob oc ps oe of og pl pm pn bj"><a class="af oh" href="https://kubernetes.io/docs/concepts/workloads/pods/pod-lifecycle/" rel="noopener ugc nofollow" target="_blank">Kubernetes Pod Lifecycle</a></li></ul></div></div></div></div></section></div></div></article></div><div class="ab ca"><div class="ch bg fy fz ga gb"><div class="qo qp ab iz"><div class="qq ab"><a class="qr ax am ao" href="https://medium.com/tag/go?source=post_page-----e0dcd9940f4b---------------go-----------------" rel="noopener follow"><div class="qs fi cw qt gd qu qv be b bf z bj qw">Go</div></a></div><div class="qq ab"><a class="qr ax am ao" href="https://medium.com/tag/golang?source=post_page-----e0dcd9940f4b---------------golang-----------------" rel="noopener follow"><div class="qs fi cw qt gd qu qv be b bf z bj qw">Golang</div></a></div><div class="qq ab"><a class="qr ax am ao" href="https://medium.com/tag/kubernetes?source=post_page-----e0dcd9940f4b---------------kubernetes-----------------" rel="noopener follow"><div class="qs fi cw qt gd qu qv be b bf z bj qw">Kubernetes</div></a></div><div class="qq ab"><a class="qr ax am ao" href="https://medium.com/tag/linux?source=post_page-----e0dcd9940f4b---------------linux-----------------" rel="noopener follow"><div class="qs fi cw qt gd qu qv be b bf z bj qw">Linux</div></a></div><div class="qq ab"><a class="qr ax am ao" href="https://medium.com/tag/software-development?source=post_page-----e0dcd9940f4b---------------software_development-----------------" rel="noopener follow"><div class="qs fi cw qt gd qu qv be b bf z bj qw">Software Development</div></a></div></div></div></div><div class="l"></div><footer class="qx qy qz ra rb rc rd re rf ab q rg ij c"><div class="l ae"><div class="ab ca"><div class="ch bg fy fz ga gb"><div class="ab co rh"><div class="ab q ku"><div class="ri l"><span class="l rj rk rl e d"><div class="ab q ku kv"><div class="pw-multi-vote-icon fi jd kw kx ky"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fitnext%2Fe0dcd9940f4b&amp;operation=register&amp;redirect=https%3A%2F%2Fitnext.io%2Fterminating-elegantly-a-guide-to-graceful-shutdowns-e0dcd9940f4b&amp;user=Alex+Pliutau&amp;userId=83ef5b231666&amp;source=-----e0dcd9940f4b---------------------clap_footer-----------" rel="noopener follow"><div><div class="bl" aria-hidden="false"><div class="kz ao la lb lc ld am le lf lg ky"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l lh li lj lk ll lm ln"><p class="be b du z dt"><span class="lo">--</span></p></div></div></span><span class="l h g f rm rn"><div class="ab q ku kv"><div class="pw-multi-vote-icon fi jd kw kx ky"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fitnext%2Fe0dcd9940f4b&amp;operation=register&amp;redirect=https%3A%2F%2Fitnext.io%2Fterminating-elegantly-a-guide-to-graceful-shutdowns-e0dcd9940f4b&amp;user=Alex+Pliutau&amp;userId=83ef5b231666&amp;source=-----e0dcd9940f4b---------------------clap_footer-----------" rel="noopener follow"><div><div class="bl" aria-hidden="false"><div class="kz ao la lb lc ld am le lf lg ky"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l lh li lj lk ll lm ln"><p class="be b du z dt"><span class="lo">--</span></p></div></div></span></div><div class="bp ab"><div><div class="bl" aria-hidden="false"><button class="ao kz lp lq ab q fj lr ls" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="lt"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg></button></div></div></div></div><div class="ab q"><div class="ro l iw"><div><div class="bl" aria-hidden="false"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerBookmarkButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe0dcd9940f4b&amp;operation=register&amp;redirect=https%3A%2F%2Fitnext.io%2Fterminating-elegantly-a-guide-to-graceful-shutdowns-e0dcd9940f4b&amp;source=--------------------------bookmark_footer-----------" rel="noopener follow"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="dt lv" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div><div class="ro l iw"><div class="bl" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bl" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="footerSocialShareButton" class="af fj ah ai aj ak al md an ao ap ew me mf ls mg"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg></button></div></div></div></div></div></div></div></div></div></footer><div class="rp rq rr rs rt l bw"><div class="ab ca"><div class="ch bg fy fz ga gb"><div class="ck ab ru co"><div class="ab hz"><a href="https://medium.com/@pliutau?source=post_page-----e0dcd9940f4b--------------------------------" rel="noopener follow"><div class="l rv rw bx rx id"><div class="l fi"><img alt="Alex Pliutau" class="l fc bx ry rz cw" src="https://miro.medium.com/v2/resize:fill:144:144/1*0GZGQK6ulOCFFdWNdu_sPQ.png" width="72" height="72" loading="lazy"/><div class="ie bx l ry rz fr n if fs"></div></div></div></a><a href="https://itnext.io/?source=post_page-----e0dcd9940f4b--------------------------------" rel="noopener follow"><div class="sa ab fi"><div><div class="bl" aria-hidden="false"><div class="l sb sc bx rx ij"><div class="l fi"><img alt="ITNEXT" class="l fc bx by bz cw" src="https://miro.medium.com/v2/resize:fill:64:64/1*yAqDFIFA5F_NXalOJKz4TA.png" width="32" height="32" loading="lazy"/><div class="ie bx l by bz fr n if fs"></div></div></div></div></div></div></a></div><div class="j i d"><div class="ab"><span><a class="be b bf z eo qs ep eq er es et eu ev ew ex ey ez sd fa fb fc bl fd fe" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F83ef5b231666&amp;operation=register&amp;redirect=https%3A%2F%2Fitnext.io%2Fterminating-elegantly-a-guide-to-graceful-shutdowns-e0dcd9940f4b&amp;user=Alex+Pliutau&amp;userId=83ef5b231666&amp;source=post_page-83ef5b231666----e0dcd9940f4b---------------------follow_profile-----------" rel="noopener follow">Follow</a></span><div class="ds l"><div><div><div class="bl" aria-hidden="false"><div class="l"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F631786b3a66e&amp;operation=register&amp;redirect=https%3A%2F%2Fitnext.io%2Fterminating-elegantly-a-guide-to-graceful-shutdowns-e0dcd9940f4b&amp;newsletterV3=83ef5b231666&amp;newsletterV3Id=631786b3a66e&amp;user=Alex+Pliutau&amp;userId=83ef5b231666&amp;source=-----e0dcd9940f4b---------------------subscribe_user-----------" rel="noopener follow"><button class="be b bf z sf am sg sh si sj sk sl sm sn ev ew ex ey ez fa fb fc bl fd fe" aria-label="Subscribe"><svg xmlns="http://www.w3.org/2000/svg" width="38" height="38" fill="none" viewBox="0 0 38 38" class="se sc sb"><rect width="0.5" height="6.5" x="26.25" y="9.25" rx="0.25"></rect><rect width="0.5" height="6.5" x="29.75" y="12.25" rx="0.25" transform="rotate(90 29.75 12.25)"></rect><path d="M19.5 12.5h-7a1 1 0 0 0-1 1v11a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1v-5"></path><path d="M11.5 14.5 19 20l4-3"></path></svg></button></a></span></div></div></div></div></div></div></div></div><div class="ab cm co"><div class="l"><div class="ab q"><a class="af ag ah ai aj ak al am an ao ap aq ar as at ab q" href="https://medium.com/@pliutau?source=post_page-----e0dcd9940f4b--------------------------------" rel="noopener follow"><h2 class="pw-author-name be so sp sq sr bj"><span class="gm jn">Written by <!-- -->Alex Pliutau</span></h2></a></div><div class="qq ab"><div class="l iw"><span class="pw-follower-count be b bf z bj"><a class="af ag ah ai aj ak al am an ao ap aq ar ip" href="https://medium.com/@pliutau/followers?source=post_page-----e0dcd9940f4b--------------------------------" rel="noopener follow">174 Followers</a></span></div><div class="be b bf z je jf jg ab ji jj jk jl dt jc"><span class="iq l" aria-hidden="true"><span class="be b bf z dt">·</span></span><span class="l iw">Writer for </span><div><div class="l" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar ip ab q" href="https://itnext.io/?source=post_page-----e0dcd9940f4b--------------------------------" rel="noopener follow"><p class="be b bf z je jf jg jh ji jj jk jl bj">ITNEXT</p></a></div></div></div></div><div class="ss l"><p class="be b bf z bj"><a class="af ag ah ai aj ak al am an ao ap aq ar oh gn" href="https://packagemain.tech/" rel="noopener  ugc nofollow">https://packagemain.tech/</a></p></div></div><div class="h k"><div class="ab"><span><a class="be b bf z eo qs ep eq er es et eu ev ew ex ey ez sd fa fb fc bl fd fe" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F83ef5b231666&amp;operation=register&amp;redirect=https%3A%2F%2Fitnext.io%2Fterminating-elegantly-a-guide-to-graceful-shutdowns-e0dcd9940f4b&amp;user=Alex+Pliutau&amp;userId=83ef5b231666&amp;source=post_page-83ef5b231666----e0dcd9940f4b---------------------follow_profile-----------" rel="noopener follow">Follow</a></span><div class="ds l"><div><div><div class="bl" aria-hidden="false"><div class="l"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F631786b3a66e&amp;operation=register&amp;redirect=https%3A%2F%2Fitnext.io%2Fterminating-elegantly-a-guide-to-graceful-shutdowns-e0dcd9940f4b&amp;newsletterV3=83ef5b231666&amp;newsletterV3Id=631786b3a66e&amp;user=Alex+Pliutau&amp;userId=83ef5b231666&amp;source=-----e0dcd9940f4b---------------------subscribe_user-----------" rel="noopener follow"><button class="be b bf z sf am sg sh si sj sk sl sm sn ev ew ex ey ez fa fb fc bl fd fe" aria-label="Subscribe"><svg xmlns="http://www.w3.org/2000/svg" width="38" height="38" fill="none" viewBox="0 0 38 38" class="se sc sb"><rect width="0.5" height="6.5" x="26.25" y="9.25" rx="0.25"></rect><rect width="0.5" height="6.5" x="29.75" y="12.25" rx="0.25" transform="rotate(90 29.75 12.25)"></rect><path d="M19.5 12.5h-7a1 1 0 0 0-1 1v11a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1v-5"></path><path d="M11.5 14.5 19 20l4-3"></path></svg></button></a></span></div></div></div></div></div></div></div></div><div class="st bg su my mz na nb nc"></div></div></div><div class="h k j"><div class="st bg su sv"></div><div class="ab ca"><div class="ch bg fy fz ga gb"><div class="sw ab ku iz"><div class="sx sy l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://help.medium.com/hc/en-us?source=post_page-----e0dcd9940f4b--------------------------------" rel="noopener follow"><p class="be b du z dt">Help</p></a></div><div class="sx sy l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.statuspage.io/?source=post_page-----e0dcd9940f4b--------------------------------" rel="noopener follow"><p class="be b du z dt">Status</p></a></div><div class="sx sy l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/about?autoplay=1&amp;source=post_page-----e0dcd9940f4b--------------------------------" rel="noopener follow"><p class="be b du z dt">About</p></a></div><div class="sx sy l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----e0dcd9940f4b--------------------------------" rel="noopener follow"><p class="be b du z dt">Careers</p></a></div><div class="sx sy l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="mailto:pressinquiries@medium.com?source=post_page-----e0dcd9940f4b--------------------------------" rel="noopener follow"><p class="be b du z dt">Press</p></a></div><div class="sx sy l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://blog.medium.com/?source=post_page-----e0dcd9940f4b--------------------------------" rel="noopener follow"><p class="be b du z dt">Blog</p></a></div><div class="sx sy l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----e0dcd9940f4b--------------------------------" rel="noopener follow"><p class="be b du z dt">Privacy</p></a></div><div class="sx sy l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----e0dcd9940f4b--------------------------------" rel="noopener follow"><p class="be b du z dt">Terms</p></a></div><div class="sx sy l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://speechify.com/medium?source=post_page-----e0dcd9940f4b--------------------------------" rel="noopener follow"><p class="be b du z dt">Text to speech</p></a></div><div class="sx l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/business?source=post_page-----e0dcd9940f4b--------------------------------" rel="noopener follow"><p class="be b du z dt">Teams</p></a></div></div></div></div></div></div></div></div></div></div><script>window.__BUILD_ID__="main-20240716-193550-02a107cf7e"</script><script>window.__GRAPHQL_URI__ = "https://itnext.io/_/graphql"</script><script>window.__PRELOADED_STATE__ = {"algolia":{"queries":{}},"cache":{"experimentGroupSet":true,"reason":"This request is not using the cache middleware worker","group":"disabled","tags":["group-edgeCachePosts","post-e0dcd9940f4b","user-83ef5b231666","collection-5b301f10ddcd"],"serverVariantState":"","middlewareEnabled":false,"cacheStatus":"DYNAMIC","shouldUseCache":false,"vary":[],"lohpSummerUpsellEnabled":false},"client":{"hydrated":false,"isUs":true,"isNativeMedium":false,"isSafariMobile":false,"isSafari":false,"isFirefox":false,"routingEntity":{"type":"COLLECTION","id":"5b301f10ddcd","explicit":true},"viewerIsBot":false},"debug":{"requestId":"70787b19-fe0f-451d-987f-6cda9314b6d2","hybridDevServices":[],"originalSpanCarrier":{"ot-tracer-spanid":"56458d7673027182","ot-tracer-traceid":"09747c541af55ff1","ot-tracer-sampled":"true"}},"multiVote":{"clapsPerPost":{}},"navigation":{"branch":{"show":null,"hasRendered":null,"blockedByCTA":false},"hideGoogleOneTap":false,"hasRenderedAlternateUserBanner":null,"currentLocation":"https:\u002F\u002Fitnext.io\u002Fterminating-elegantly-a-guide-to-graceful-shutdowns-e0dcd9940f4b","host":"itnext.io","hostname":"itnext.io","referrer":"https:\u002F\u002Fwww.google.com","hasSetReferrer":false,"susiModal":{"step":null,"operation":"register"},"postRead":false,"partnerProgram":{"selectedCountryCode":null}},"config":{"nodeEnv":"production","version":"main-20240716-193550-02a107cf7e","target":"production","productName":"Medium","publicUrl":"https:\u002F\u002Fcdn-client.medium.com\u002Flite","authDomain":"medium.com","authGoogleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","favicon":"production","glyphUrl":"https:\u002F\u002Fglyph.medium.com","branchKey":"key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm","algolia":{"appId":"MQ57UUUQZ2","apiKeySearch":"394474ced050e3911ae2249ecc774921","indexPrefix":"medium_","host":"-dsn.algolia.net"},"recaptchaKey":"6Lfc37IUAAAAAKGGtC6rLS13R1Hrw_BqADfS1LRk","recaptcha3Key":"6Lf8R9wUAAAAABMI_85Wb8melS7Zj6ziuf99Yot5","recaptchaEnterpriseKeyId":"6Le-uGgpAAAAAPprRaokM8AKthQ9KNGdoxaGUvVp","datadog":{"applicationId":"6702d87d-a7e0-42fe-bbcb-95b469547ea0","clientToken":"pub853ea8d17ad6821d9f8f11861d23dfed","rumToken":"pubf9cc52896502b9413b68ba36fc0c7162","context":{"deployment":{"target":"production","tag":"main-20240716-193550-02a107cf7e","commit":"02a107cf7e668836d0ea4300e5c6789f61b9fa98"}},"datacenter":"us"},"googleAnalyticsCode":"G-7JY7T788PK","googlePay":{"apiVersion":"2","apiVersionMinor":"0","merchantId":"BCR2DN6TV7EMTGBM","merchantName":"Medium","instanceMerchantId":"13685562959212738550"},"applePay":{"version":3},"signInWallCustomDomainCollectionIds":["3a8144eabfe3","336d898217ee","61061eb0c96b","138adf9c44c","819cc2aaeee0"],"mediumMastodonDomainName":"me.dm","mediumOwnedAndOperatedCollectionIds":["8a9336e5bb4","b7e45b22fec3","193b68bd4fba","8d6b8a439e32","54c98c43354d","3f6ecf56618","d944778ce714","92d2092dc598","ae2a65f35510","1285ba81cada","544c7006046e","fc8964313712","40187e704f1c","88d9857e584e","7b6769f2748b","bcc38c8f6edf","cef6983b292","cb8577c9149e","444d13b52878","713d7dbc99b0","ef8e90590e66","191186aaafa0","55760f21cdc5","9dc80918cc93","bdc4052bbdba","8ccfed20cbb2"],"tierOneDomains":["medium.com","thebolditalic.com","arcdigital.media","towardsdatascience.com","uxdesign.cc","codeburst.io","psiloveyou.xyz","writingcooperative.com","entrepreneurshandbook.co","prototypr.io","betterhumans.coach.me","theascent.pub"],"topicsToFollow":["d61cf867d93f","8a146bc21b28","1eca0103fff3","4d562ee63426","aef1078a3ef5","e15e46793f8d","6158eb913466","55f1c20aba7a","3d18b94f6858","4861fee224fd","63c6f1f93ee","1d98b3a9a871","decb52b64abf","ae5d4995e225","830cded25262"],"topicToTagMappings":{"accessibility":"accessibility","addiction":"addiction","android-development":"android-development","art":"art","artificial-intelligence":"artificial-intelligence","astrology":"astrology","basic-income":"basic-income","beauty":"beauty","biotech":"biotech","blockchain":"blockchain","books":"books","business":"business","cannabis":"cannabis","cities":"cities","climate-change":"climate-change","comics":"comics","coronavirus":"coronavirus","creativity":"creativity","cryptocurrency":"cryptocurrency","culture":"culture","cybersecurity":"cybersecurity","data-science":"data-science","design":"design","digital-life":"digital-life","disability":"disability","economy":"economy","education":"education","equality":"equality","family":"family","feminism":"feminism","fiction":"fiction","film":"film","fitness":"fitness","food":"food","freelancing":"freelancing","future":"future","gadgets":"gadgets","gaming":"gaming","gun-control":"gun-control","health":"health","history":"history","humor":"humor","immigration":"immigration","ios-development":"ios-development","javascript":"javascript","justice":"justice","language":"language","leadership":"leadership","lgbtqia":"lgbtqia","lifestyle":"lifestyle","machine-learning":"machine-learning","makers":"makers","marketing":"marketing","math":"math","media":"media","mental-health":"mental-health","mindfulness":"mindfulness","money":"money","music":"music","neuroscience":"neuroscience","nonfiction":"nonfiction","outdoors":"outdoors","parenting":"parenting","pets":"pets","philosophy":"philosophy","photography":"photography","podcasts":"podcast","poetry":"poetry","politics":"politics","privacy":"privacy","product-management":"product-management","productivity":"productivity","programming":"programming","psychedelics":"psychedelics","psychology":"psychology","race":"race","relationships":"relationships","religion":"religion","remote-work":"remote-work","san-francisco":"san-francisco","science":"science","self":"self","self-driving-cars":"self-driving-cars","sexuality":"sexuality","social-media":"social-media","society":"society","software-engineering":"software-engineering","space":"space","spirituality":"spirituality","sports":"sports","startups":"startup","style":"style","technology":"technology","transportation":"transportation","travel":"travel","true-crime":"true-crime","tv":"tv","ux":"ux","venture-capital":"venture-capital","visual-design":"visual-design","work":"work","world":"world","writing":"writing"},"defaultImages":{"avatar":{"imageId":"1*dmbNkD5D-u45r44go_cf0g.png","height":150,"width":150},"orgLogo":{"imageId":"1*OMF3fSqH8t4xBJ9-6oZDZw.png","height":106,"width":545},"postLogo":{"imageId":"1*kFrc4tBFM_tCis-2Ic87WA.png","height":810,"width":1440},"postPreviewImage":{"imageId":"1*hn4v1tCaJy7cWMyb0bpNpQ.png","height":386,"width":579}},"collectionStructuredData":{"8d6b8a439e32":{"name":"Elemental","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F980\u002F1*9ygdqoKprhwuTVKUM0DLPA@2x.png","width":980,"height":159}}},"3f6ecf56618":{"name":"Forge","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F596\u002F1*uULpIlImcO5TDuBZ6lm7Lg@2x.png","width":596,"height":183}}},"ae2a65f35510":{"name":"GEN","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F264\u002F1*RdVZMdvfV3YiZTw6mX7yWA.png","width":264,"height":140}}},"88d9857e584e":{"name":"LEVEL","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*JqYMhNX6KNNb2UlqGqO2WQ.png","width":540,"height":108}}},"7b6769f2748b":{"name":"Marker","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F383\u002F1*haCUs0wF6TgOOvfoY-jEoQ@2x.png","width":383,"height":92}}},"444d13b52878":{"name":"OneZero","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*cw32fIqCbRWzwJaoQw6BUg.png","width":540,"height":123}}},"8ccfed20cbb2":{"name":"Zora","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*tZUQqRcCCZDXjjiZ4bDvgQ.png","width":540,"height":106}}}},"embeddedPostIds":{"coronavirus":"cd3010f9d81f"},"sharedCdcMessaging":{"COVID_APPLICABLE_TAG_SLUGS":[],"COVID_APPLICABLE_TOPIC_NAMES":[],"COVID_APPLICABLE_TOPIC_NAMES_FOR_TOPIC_PAGE":[],"COVID_MESSAGES":{"tierA":{"text":"For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":66,"end":73,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"tierB":{"text":"Anyone can publish on Medium per our Policies, but we don’t fact-check every story. For more info about the coronavirus, see cdc.gov.","markups":[{"start":37,"end":45,"href":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Fcategories\u002F201931128-Policies-Safety"},{"start":125,"end":132,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"paywall":{"text":"This article has been made free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":56,"end":70,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":138,"end":145,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"unbound":{"text":"This article is free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":45,"end":59,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":127,"end":134,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]}},"COVID_BANNER_POST_ID_OVERRIDE_WHITELIST":["3b31a67bff4a"]},"sharedVoteMessaging":{"TAGS":["politics","election-2020","government","us-politics","election","2020-presidential-race","trump","donald-trump","democrats","republicans","congress","republican-party","democratic-party","biden","joe-biden","maga"],"TOPICS":["politics","election"],"MESSAGE":{"text":"Find out more about the U.S. election results here.","markups":[{"start":46,"end":50,"href":"https:\u002F\u002Fcookpolitical.com\u002F2020-national-popular-vote-tracker"}]},"EXCLUDE_POSTS":["397ef29e3ca5"]},"embedPostRules":[],"recircOptions":{"v1":{"limit":3},"v2":{"limit":8}},"braintreeClientKey":"production_zjkj96jm_m56f8fqpf7ngnrd4","braintree":{"enabled":true,"merchantId":"m56f8fqpf7ngnrd4","merchantAccountId":{"usd":"AMediumCorporation_instant","eur":"amediumcorporation_EUR","cad":"amediumcorporation_CAD"},"publicKey":"ds2nn34bg2z7j5gd","braintreeEnvironment":"production","dashboardUrl":"https:\u002F\u002Fwww.braintreegateway.com\u002Fmerchants","gracePeriodDurationInDays":14,"mediumMembershipPlanId":{"monthly":"ce105f8c57a3","monthlyV2":"e8a5e126-792b-4ee6-8fba-d574c1b02fc5","monthlyWithTrial":"d5ee3dbe3db8","monthlyPremium":"fa741a9b47a2","yearly":"a40ad4a43185","yearlyV2":"3815d7d6-b8ca-4224-9b8c-182f9047866e","yearlyStaff":"d74fb811198a","yearlyWithTrial":"b3bc7350e5c7","yearlyPremium":"e21bd2c12166","monthlyOneYearFree":"e6c0637a-2bad-4171-ab4f-3c268633d83c","monthly25PercentOffFirstYear":"235ecc62-0cdb-49ae-9378-726cd21c504b","monthly20PercentOffFirstYear":"ba518864-9c13-4a99-91ca-411bf0cac756","monthly15PercentOffFirstYear":"594c029b-9f89-43d5-88f8-8173af4e070e","monthly10PercentOffFirstYear":"c6c7bc9a-40f2-4b51-8126-e28511d5bdb0","monthlyForStudents":"629ebe51-da7d-41fd-8293-34cd2f2030a8","yearlyOneYearFree":"78ba7be9-0d9f-4ece-aa3e-b54b826f2bf1","yearly25PercentOffFirstYear":"2dbb010d-bb8f-4eeb-ad5c-a08509f42d34","yearly20PercentOffFirstYear":"47565488-435b-47f8-bf93-40d5fbe0ebc8","yearly15PercentOffFirstYear":"8259809b-0881-47d9-acf7-6c001c7f720f","yearly10PercentOffFirstYear":"9dd694fb-96e1-472c-8d9e-3c868d5c1506","yearlyForStudents":"e29345ef-ab1c-4234-95c5-70e50fe6bc23","monthlyCad":"p52orjkaceei","yearlyCad":"h4q9g2up9ktt"},"braintreeDiscountId":{"oneMonthFree":"MONTHS_FREE_01","threeMonthsFree":"MONTHS_FREE_03","sixMonthsFree":"MONTHS_FREE_06","fiftyPercentOffOneYear":"FIFTY_PERCENT_OFF_ONE_YEAR"},"3DSecureVersion":"2","defaultCurrency":"usd","providerPlanIdCurrency":{"4ycw":"usd","rz3b":"usd","3kqm":"usd","jzw6":"usd","c2q2":"usd","nnsw":"usd","q8qw":"usd","d9y6":"usd","fx7w":"cad","nwf2":"cad"}},"paypalClientId":"AXj1G4fotC2GE8KzWX9mSxCH1wmPE3nJglf4Z2ig_amnhvlMVX87otaq58niAg9iuLktVNF_1WCMnN7v","paypal":{"host":"https:\u002F\u002Fapi.paypal.com:443","clientMode":"production","serverMode":"live","webhookId":"4G466076A0294510S","monthlyPlan":{"planId":"P-9WR0658853113943TMU5FDQA","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlan":{"planId":"P-7N8963881P8875835MU5JOPQ","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oneYearGift":{"name":"Medium Membership (1 Year, Digital Gift Code)","description":"Unlimited access to the best and brightest stories on Medium. Gift codes can be redeemed at medium.com\u002Fredeem.","price":"50.00","currency":"USD","sku":"membership-gift-1-yr"},"oldMonthlyPlan":{"planId":"P-96U02458LM656772MJZUVH2Y","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlan":{"planId":"P-59P80963JF186412JJZU3SMI","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"monthlyPlanWithTrial":{"planId":"P-66C21969LR178604GJPVKUKY","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlanWithTrial":{"planId":"P-6XW32684EX226940VKCT2MFA","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oldMonthlyPlanNoSetupFee":{"planId":"P-4N046520HR188054PCJC7LJI","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlanNoSetupFee":{"planId":"P-7A4913502Y5181304CJEJMXQ","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"sdkUrl":"https:\u002F\u002Fwww.paypal.com\u002Fsdk\u002Fjs"},"stripePublishableKey":"pk_live_7FReX44VnNIInZwrIIx6ghjl","log":{"json":true,"level":"info"},"imageUploadMaxSizeMb":25,"staffPicks":{"title":"Staff Picks","catalogId":"c7bc6e1ee00f"}},"session":{"xsrf":""}}</script><script>window.__APOLLO_STATE__ = {"ROOT_QUERY":{"__typename":"Query","viewer":null,"variantFlags":[{"__typename":"VariantFlag","name":"limit_post_referrers","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_mastodon_for_members","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_see_pronouns","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_speechify_ios","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"glyph_font_set","valueType":{"__typename":"VariantFlagString","value":"m2-unbound-source-serif-pro"}},{"__typename":"VariantFlag","name":"enable_cache_less_following_feed","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_enable_friend_links_postpage_banners","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_iceland_nux","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_google_webhook","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_author_cards","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_enable_lock_responses","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_social_share_sheet","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_response_markup","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_server_upstream_deadlines","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_streamline_pub_newsletters","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_display_paywall_after_onboarding","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"allow_test_auth","valueType":{"__typename":"VariantFlagString","value":"disallow"}},{"__typename":"VariantFlag","name":"enable_switch_plan_premium_tier","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"price_smoke_test_monthly","valueType":{"__typename":"VariantFlagString","value":""}},{"__typename":"VariantFlag","name":"available_annual_premium_plan","valueType":{"__typename":"VariantFlagString","value":"4a442ace1476"}},{"__typename":"VariantFlag","name":"can_send_tips_v0","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_verifications_service","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_client","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_conversion_model_v2","valueType":{"__typename":"VariantFlagString","value":"control"}},{"__typename":"VariantFlag","name":"enable_ios_autorefresh","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_android_dynamic_programming_paywall","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_moc_load_processor_all_recs_surfaces","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"skip_fs_cache_user_vals","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"available_monthly_premium_plan","valueType":{"__typename":"VariantFlagString","value":"12a660186432"}},{"__typename":"VariantFlag","name":"enable_explicit_signals","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_recirc_model","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ios_dynamic_paywall_programming","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_pub_stats","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"price_smoke_test_yearly","valueType":{"__typename":"VariantFlagString","value":""}},{"__typename":"VariantFlag","name":"enable_bg_post_post","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_sharer_validate_post_share_key","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_entities_to_follow_v2","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_moc_load_processor_c","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_enable_home_post_menu","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_webhook","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_configure_pronouns","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lo_homepage","valueType":{"__typename":"VariantFlagString","value":"control"}},{"__typename":"VariantFlag","name":"enable_braintree_paypal","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_rito_upstream_deadlines","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"available_annual_plan","valueType":{"__typename":"VariantFlagString","value":"2c754bcc2995"}},{"__typename":"VariantFlag","name":"crm_send_contact_to_sendgrid","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_enable_topic_portals","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_google_pay","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_apple_pay","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_tipping_v0_android","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_android_verified_author","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_homepage","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_deprecate_legacy_providers_v3","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_eventstats_event_processing","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_legacy_feed_in_iceland","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_maim_the_meter","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_newsletter_lo_flow_custom_domains","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"onboarding_tags_from_top_views","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_enable_syntax_highlight","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_rex_aggregator_v2","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"browsable_stream_config_bucket","valueType":{"__typename":"VariantFlagString","value":"curated-topics"}},{"__typename":"VariantFlag","name":"enable_author_cards_byline","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_enable_editor_new_publishing_flow","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ios_dynamic_paywall_aspiriational","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ios_offline_reading","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"coronavirus_topic_recirc","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_app_flirty_thirty","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_tipping_v0_ios","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_recaptcha_enterprise","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_tag_recs","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_enable_lists_v2","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_rating_prompt_stories_read_threshold","valueType":{"__typename":"VariantFlagNumber"}},{"__typename":"VariantFlag","name":"signin_services","valueType":{"__typename":"VariantFlagString","value":"twitter,facebook,google,email,google-fastidv,google-one-tap,apple"}},{"__typename":"VariantFlag","name":"enable_android_dynamic_aspirational_paywall","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_trial_membership","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"reader_fair_distribution_non_qp","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"allow_signup","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_sharer_create_post_share_key","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_enable_friend_links_creation","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_mobile_lohp_short_hero","valueType":{"__typename":"VariantFlagString","value":"control"}},{"__typename":"VariantFlag","name":"ios_enable_friend_links_creation","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"reengagement_notification_duration","valueType":{"__typename":"VariantFlagNumber"}},{"__typename":"VariantFlag","name":"enable_ios_easy_resubscribe","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_footer_app_buttons","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_pill_based_home_feed","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_pre_pp_v4","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_premium_tier","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_premium_tier_badge","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_seamless_social_sharing","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_android_offline_reading","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_auto_follow_on_subscribe","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_members_only_audio","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_moc_load_processor_first_story","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"allow_access","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_tribute_landing_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"available_monthly_plan","valueType":{"__typename":"VariantFlagString","value":"60e220181034"}},{"__typename":"VariantFlag","name":"enable_aurora_pub_follower_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_medium_forever_introductory_discount","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_mps_pp_writer_stats","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"disable_partner_program_enrollment","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ml_rank_rex_anno","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"redefined_top_posts","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"rex_generator_max_candidates","valueType":{"__typename":"VariantFlagNumber"}},{"__typename":"VariantFlag","name":"enable_automod","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_branch_io","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_susi_redesign_ios","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_continue_this_thread","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_rex_reading_history","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"signup_services","valueType":{"__typename":"VariantFlagString","value":"twitter,facebook,google,email,google-fastidv,google-one-tap,apple"}},{"__typename":"VariantFlag","name":"ios_enable_verified_book_author","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"mobile_custom_app_icon","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_medium2_kbfd","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_speechify_widget","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_apple_sign_in","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_diversification_rex","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_archive_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_mastodon_for_members_username_selection","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_remove_twitter_onboarding_step","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_rex_new_push_notification_endpoint","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"textshots_userid","valueType":{"__typename":"VariantFlagString","value":""}},{"__typename":"VariantFlag","name":"android_enable_friend_links_postpage_banners","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_susi_redesign_android","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_in_app_free_trial","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_enable_image_sharer","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_updated_pub_recs_ui","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_two_hour_refresh","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_pp_v4","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_new_stripe_customers","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_explicit_signals_updated_post_previews","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_integration","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_import","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"limit_user_follows","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_apple_webhook","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_mastodon_avatar_upload","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_starspace","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_marketing_emails","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_tick_landing_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_creator_welcome_email","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_sprig","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_android_miro_v2","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_recommended_publishers_query","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_simplified_digest_v2_b","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_google_one_tap","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_iceland_forced_android","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_group_gifting","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"can_receive_tips_v0","valueType":{"__typename":"VariantFlagBoolean","value":true}}],"collectionByDomainOrSlug({\"domainOrSlug\":\"itnext.io\"})":{"__ref":"Collection:5b301f10ddcd"},"postResult({\"id\":\"e0dcd9940f4b\"})":{"__ref":"Post:e0dcd9940f4b"}},"ImageMetadata:1*SiXeRxgOt0pAYlYhwZIu3g.png":{"__typename":"ImageMetadata","id":"1*SiXeRxgOt0pAYlYhwZIu3g.png"},"Collection:5b301f10ddcd":{"__typename":"Collection","id":"5b301f10ddcd","favicon":{"__ref":"ImageMetadata:1*SiXeRxgOt0pAYlYhwZIu3g.png"},"customStyleSheet":null,"colorPalette":{"__typename":"ColorPalette","highlightSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FFFFFFFF","colorPoints":[{"__typename":"ColorPoint","color":"#FFE6F5FF","point":0},{"__typename":"ColorPoint","color":"#FFE2F4FF","point":0.1},{"__typename":"ColorPoint","color":"#FFDDF2FF","point":0.2},{"__typename":"ColorPoint","color":"#FFD8F1FF","point":0.3},{"__typename":"ColorPoint","color":"#FFD3F0FF","point":0.4},{"__typename":"ColorPoint","color":"#FFCDEFFF","point":0.5},{"__typename":"ColorPoint","color":"#FFC8EDFF","point":0.6},{"__typename":"ColorPoint","color":"#FFC3ECFF","point":0.7},{"__typename":"ColorPoint","color":"#FFBDEBFF","point":0.8},{"__typename":"ColorPoint","color":"#FFB7E9FF","point":0.9},{"__typename":"ColorPoint","color":"#FFB1E8FF","point":1}]},"defaultBackgroundSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FFFFFFFF","colorPoints":[{"__typename":"ColorPoint","color":"#FF3F8DCE","point":0},{"__typename":"ColorPoint","color":"#FF3F83BD","point":0.1},{"__typename":"ColorPoint","color":"#FF3D79AD","point":0.2},{"__typename":"ColorPoint","color":"#FF3B6E9C","point":0.3},{"__typename":"ColorPoint","color":"#FF38648B","point":0.4},{"__typename":"ColorPoint","color":"#FF34597A","point":0.5},{"__typename":"ColorPoint","color":"#FF2F4E6A","point":0.6},{"__typename":"ColorPoint","color":"#FF2A4259","point":0.7},{"__typename":"ColorPoint","color":"#FF233648","point":0.8},{"__typename":"ColorPoint","color":"#FF1B2937","point":0.9},{"__typename":"ColorPoint","color":"#FF121B25","point":1}]},"tintBackgroundSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FF1A71B1","colorPoints":[{"__typename":"ColorPoint","color":"#FF1A71B1","point":0},{"__typename":"ColorPoint","color":"#FF3E82BC","point":0.1},{"__typename":"ColorPoint","color":"#FF5892C7","point":0.2},{"__typename":"ColorPoint","color":"#FF6EA1D1","point":0.3},{"__typename":"ColorPoint","color":"#FF84B0DB","point":0.4},{"__typename":"ColorPoint","color":"#FF98BEE4","point":0.5},{"__typename":"ColorPoint","color":"#FFACCCED","point":0.6},{"__typename":"ColorPoint","color":"#FFBFDAF6","point":0.7},{"__typename":"ColorPoint","color":"#FFD1E7FE","point":0.8},{"__typename":"ColorPoint","color":"#FFE4F4FF","point":0.9},{"__typename":"ColorPoint","color":"#FFF6FFFF","point":1}]}},"googleAnalyticsId":"UA-29035124-5","editors":[{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:bd28806f72a6"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:a00cb31d6074"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:5db23d2304f9"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:cb3f1b710e82"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:56eec51fd7a0"}}],"name":"ITNEXT","avatar":{"__ref":"ImageMetadata:1*yAqDFIFA5F_NXalOJKz4TA.png"},"domain":"itnext.io","slug":"itnext","description":"ITNEXT is a platform for IT developers & software engineers to share knowledge, connect, collaborate, learn and experience next-gen technologies.","subscriberCount":56301,"viewerEdge":{"__ref":"CollectionViewerEdge:collectionId:5b301f10ddcd-viewerId:lo_33aea83cfb05"},"twitterUsername":"itnext_io","facebookPageId":null,"logo":{"__ref":"ImageMetadata:1*jWhTrIoYwTUdKuVXycqAaw.png"}},"User:bd28806f72a6":{"__typename":"User","id":"bd28806f72a6"},"User:a00cb31d6074":{"__typename":"User","id":"a00cb31d6074"},"User:5db23d2304f9":{"__typename":"User","id":"5db23d2304f9"},"User:cb3f1b710e82":{"__typename":"User","id":"cb3f1b710e82"},"User:56eec51fd7a0":{"__typename":"User","id":"56eec51fd7a0"},"ImageMetadata:1*yAqDFIFA5F_NXalOJKz4TA.png":{"__typename":"ImageMetadata","id":"1*yAqDFIFA5F_NXalOJKz4TA.png"},"LinkedAccounts:83ef5b231666":{"__typename":"LinkedAccounts","mastodon":null,"id":"83ef5b231666"},"UserViewerEdge:userId:83ef5b231666-viewerId:lo_33aea83cfb05":{"__typename":"UserViewerEdge","id":"userId:83ef5b231666-viewerId:lo_33aea83cfb05","isFollowing":false,"isUser":false,"isMuting":false},"NewsletterV3:631786b3a66e":{"__typename":"NewsletterV3","id":"631786b3a66e","type":"NEWSLETTER_TYPE_AUTHOR","slug":"83ef5b231666","name":"83ef5b231666","collection":null,"user":{"__ref":"User:83ef5b231666"}},"User:83ef5b231666":{"__typename":"User","id":"83ef5b231666","name":"Alex Pliutau","username":"pliutau","newsletterV3":{"__ref":"NewsletterV3:631786b3a66e"},"linkedAccounts":{"__ref":"LinkedAccounts:83ef5b231666"},"isSuspended":false,"imageId":"1*0GZGQK6ulOCFFdWNdu_sPQ.png","mediumMemberAt":0,"verifications":{"__typename":"VerifiedInfo","isBookAuthor":false},"socialStats":{"__typename":"SocialStats","followerCount":174},"customDomainState":null,"hasSubdomain":false,"bio":"https:\u002F\u002Fpackagemain.tech\u002F","isPartnerProgramEnrolled":false,"viewerEdge":{"__ref":"UserViewerEdge:userId:83ef5b231666-viewerId:lo_33aea83cfb05"},"viewerIsUser":false,"postSubscribeMembershipUpsellShownAt":0,"allowNotes":true,"twitterScreenName":"pliutau","membership":null},"Paragraph:d86f71a1cbe7_0":{"__typename":"Paragraph","id":"d86f71a1cbe7_0","name":"d772","type":"H3","href":null,"layout":null,"metadata":null,"text":"Terminating Elegantly: A Guide to Graceful Shutdowns","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*vQXMWaYPYMLVWP8Pjw6XNA.png":{"__typename":"ImageMetadata","id":"1*vQXMWaYPYMLVWP8Pjw6XNA.png","originalHeight":1920,"originalWidth":2880,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:d86f71a1cbe7_1":{"__typename":"Paragraph","id":"d86f71a1cbe7_1","name":"8604","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*vQXMWaYPYMLVWP8Pjw6XNA.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:d86f71a1cbe7_2":{"__typename":"Paragraph","id":"d86f71a1cbe7_2","name":"b87a","type":"P","href":null,"layout":null,"metadata":null,"text":"Read the original article on packagemain.tech","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":45,"href":"https:\u002F\u002Fpackagemain.tech\u002Fp\u002Fgraceful-shutdowns-k8s-go","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":45,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:d86f71a1cbe7_3":{"__typename":"Paragraph","id":"d86f71a1cbe7_3","name":"22f0","type":"P","href":null,"layout":null,"metadata":null,"text":"Have you ever yanked the power cord out of your computer in frustration? While this might seem like a quick solution, it can lead to data loss and system instability. In the world of software, a similar concept exists: the hard shutdown. This abrupt termination can cause problems just like its physical counterpart. Thankfully, there’s a better way: the graceful shutdown.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:d86f71a1cbe7_4":{"__typename":"Paragraph","id":"d86f71a1cbe7_4","name":"0592","type":"P","href":null,"layout":null,"metadata":null,"text":"By integrating graceful shutdown, we provide advance notification to the service. This enables it to complete ongoing requests, potentially save state information to disk, and ultimately avoid data corruption during shutdown.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:d86f71a1cbe7_5":{"__typename":"Paragraph","id":"d86f71a1cbe7_5","name":"fc8e","type":"P","href":null,"layout":null,"metadata":null,"text":"This guide will delve into the world of graceful shutdowns, specifically focusing on their implementation in Go applications running on Kubernetes.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:d86f71a1cbe7_6":{"__typename":"Paragraph","id":"d86f71a1cbe7_6","name":"2f3c","type":"H3","href":null,"layout":null,"metadata":null,"text":"Signals in Unix Systems","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:d86f71a1cbe7_7":{"__typename":"Paragraph","id":"d86f71a1cbe7_7","name":"73ef","type":"P","href":null,"layout":null,"metadata":null,"text":"One of the key tools for achieving graceful shutdowns in Unix-based systems is the concept of signals, which are, in simple terms, a simple way to communicate one specific thing to a process, from another process. By understanding how signals work, we can leverage them to implement controlled termination procedures within our applications, ensuring a smooth and data-safe shutdown process.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:d86f71a1cbe7_8":{"__typename":"Paragraph","id":"d86f71a1cbe7_8","name":"6ce1","type":"P","href":null,"layout":null,"metadata":null,"text":"There are many signals, and you can find them here, but our concern is only shutdown signals:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":46,"end":50,"href":"https:\u002F\u002Fen.wikipedia.org\u002Fwiki\u002FSignal_(IPC)","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":46,"end":50,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:d86f71a1cbe7_9":{"__typename":"Paragraph","id":"d86f71a1cbe7_9","name":"dc3e","type":"ULI","href":null,"layout":null,"metadata":null,"text":"SIGTERM — sent to a process to request its termination. Most commonly used, and we’ll be focusing on it later.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":7,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:d86f71a1cbe7_10":{"__typename":"Paragraph","id":"d86f71a1cbe7_10","name":"9e58","type":"ULI","href":null,"layout":null,"metadata":null,"text":"SIGKILL — “quit immediately”, can not be interfered with.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":7,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:d86f71a1cbe7_11":{"__typename":"Paragraph","id":"d86f71a1cbe7_11","name":"c9c2","type":"ULI","href":null,"layout":null,"metadata":null,"text":"SIGINT — interrupt signal (such as Ctrl+C)","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":6,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:d86f71a1cbe7_12":{"__typename":"Paragraph","id":"d86f71a1cbe7_12","name":"3c01","type":"ULI","href":null,"layout":null,"metadata":null,"text":"SIGQUIT — quit signal (such as Ctrl+D)","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":7,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:d86f71a1cbe7_13":{"__typename":"Paragraph","id":"d86f71a1cbe7_13","name":"0727","type":"P","href":null,"layout":null,"metadata":null,"text":"These signals can be sent from the user (Ctrl+C \u002F Ctrl+D), from another program\u002Fprocess or from the system itself (kernel \u002F OS), for example a SIGSEGV aka segmentation fault is sent by the OS.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":143,"end":150,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:d86f71a1cbe7_14":{"__typename":"Paragraph","id":"d86f71a1cbe7_14","name":"6750","type":"H3","href":null,"layout":null,"metadata":null,"text":"Our Guinea Pig Service","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:d86f71a1cbe7_15":{"__typename":"Paragraph","id":"d86f71a1cbe7_15","name":"00f1","type":"P","href":null,"layout":null,"metadata":null,"text":"To explore the world of graceful shutdowns in a practical setting, let’s create a simple service we can experiment with. This “guinea pig” service will have a single endpoint that simulates some real-world work (we’ll add a slight delay) by calling Redis’s INCR command. We’ll also provide a basic Kubernetes configuration to test how the platform handles termination signals.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":257,"end":261,"href":"https:\u002F\u002Fredis.io\u002Fdocs\u002Flatest\u002Fcommands\u002Fincr\u002F","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:d86f71a1cbe7_16":{"__typename":"Paragraph","id":"d86f71a1cbe7_16","name":"cddf","type":"P","href":null,"layout":null,"metadata":null,"text":"The ultimate goal: ensure our service gracefully handles shutdowns without losing any requests\u002Fdata. By comparing the number of requests sent in parallel with the final counter value in Redis, we’ll be able to verify if our graceful shutdown implementation is successful.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:d86f71a1cbe7_17":{"__typename":"Paragraph","id":"d86f71a1cbe7_17","name":"d2af","type":"P","href":null,"layout":null,"metadata":null,"text":"We won’t go into details of setting up the Kubernetes cluster and Redis, but you can find the full setup in our Github repository.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":94,"end":129,"href":"https:\u002F\u002Fgithub.com\u002Fplutov\u002Fpackagemain\u002Ftree\u002Fmaster\u002Fgraceful-shutdown","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":94,"end":129,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:d86f71a1cbe7_18":{"__typename":"Paragraph","id":"d86f71a1cbe7_18","name":"941a","type":"P","href":null,"layout":null,"metadata":null,"text":"The verification process is the following:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:d86f71a1cbe7_19":{"__typename":"Paragraph","id":"d86f71a1cbe7_19","name":"cf4a","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Deploy Redis and Go application to Kubernetes.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:d86f71a1cbe7_20":{"__typename":"Paragraph","id":"d86f71a1cbe7_20","name":"bcaa","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Use vegeta to send 1000 requests (25\u002Fs over 40 seconds).","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":4,"end":10,"href":"https:\u002F\u002Fgithub.com\u002Ftsenart\u002Fvegeta","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":4,"end":10,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:d86f71a1cbe7_21":{"__typename":"Paragraph","id":"d86f71a1cbe7_21","name":"67c5","type":"OLI","href":null,"layout":null,"metadata":null,"text":"While vegeta is running, initialize a Kubernetes Rolling Update by updating image tag.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":49,"end":63,"href":"https:\u002F\u002Fkubernetes.io\u002Fdocs\u002Ftutorials\u002Fkubernetes-basics\u002Fupdate\u002Fupdate-intro\u002F","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":49,"end":63,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:d86f71a1cbe7_22":{"__typename":"Paragraph","id":"d86f71a1cbe7_22","name":"bdd3","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Connect to Redis to verify the “counter“, it should be 1000.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:d86f71a1cbe7_23":{"__typename":"Paragraph","id":"d86f71a1cbe7_23","name":"3bf5","type":"P","href":null,"layout":null,"metadata":null,"text":"Let’s start with our base Go HTTP Server.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:d86f71a1cbe7_24":{"__typename":"Paragraph","id":"d86f71a1cbe7_24","name":"8ff1","type":"BQ","href":null,"layout":null,"metadata":null,"text":"hard-shutdown\u002Fmain.go","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":21,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:d86f71a1cbe7_25":{"__typename":"Paragraph","id":"d86f71a1cbe7_25","name":"0d3c","type":"PRE","href":null,"layout":null,"metadata":null,"text":"package main\n\nimport (\n  \"net\u002Fhttp\"\n  \"os\"\n  \"time\"\n\n  \"github.com\u002Fgo-redis\u002Fredis\"\n)\n\nfunc main() {\n  redisdb := redis.NewClient(&redis.Options{\n    Addr: os.Getenv(\"REDIS_ADDR\"),\n  })\n\n  server := http.Server{\n    Addr: \":8080\",\n  }\n\n  http.HandleFunc(\"\u002Fincr\", func(w http.ResponseWriter, r *http.Request) {\n    go processRequest(redisdb)\n    w.WriteHeader(http.StatusOK)\n  })\n\n  server.ListenAndServe()\n}\n\nfunc processRequest(redisdb *redis.Client) {\n  \u002F\u002F simulate some business logic here\n  time.Sleep(time.Second * 5)\n  redisdb.Incr(\"counter\")\n}","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"go"},"iframe":null,"mixtapeMetadata":null},"Paragraph:d86f71a1cbe7_26":{"__typename":"Paragraph","id":"d86f71a1cbe7_26","name":"ae37","type":"P","href":null,"layout":null,"metadata":null,"text":"When we run our verification procedure using this code we’ll see that some requests fail and the counter is less than 1000 (the number may vary each run).","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":97,"end":123,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*AUoAI6tNPg39i6Mm.png":{"__typename":"ImageMetadata","id":"0*AUoAI6tNPg39i6Mm.png","originalHeight":222,"originalWidth":1172,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:d86f71a1cbe7_27":{"__typename":"Paragraph","id":"d86f71a1cbe7_27","name":"21bd","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*AUoAI6tNPg39i6Mm.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:d86f71a1cbe7_28":{"__typename":"Paragraph","id":"d86f71a1cbe7_28","name":"1a77","type":"P","href":null,"layout":null,"metadata":null,"text":"Which clearly means that we lost some data during the rolling update. 😢","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:d86f71a1cbe7_29":{"__typename":"Paragraph","id":"d86f71a1cbe7_29","name":"03c9","type":"H3","href":null,"layout":null,"metadata":null,"text":"Handling Signals in Go","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:d86f71a1cbe7_30":{"__typename":"Paragraph","id":"d86f71a1cbe7_30","name":"f1e7","type":"P","href":null,"layout":null,"metadata":null,"text":"Go provides a signal package that allows you to handle Unix Signals. It’s important to note that by default, SIGINT and SIGTERM signals cause the Go program to exit. And in order for our Go application not to exit so abruptly, we need to handle incoming signals.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":14,"end":20,"href":"https:\u002F\u002Fpkg.go.dev\u002Fos\u002Fsignal","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:d86f71a1cbe7_31":{"__typename":"Paragraph","id":"d86f71a1cbe7_31","name":"d8a9","type":"P","href":null,"layout":null,"metadata":null,"text":"There are two options to do so.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:d86f71a1cbe7_32":{"__typename":"Paragraph","id":"d86f71a1cbe7_32","name":"6bcf","type":"BQ","href":null,"layout":null,"metadata":null,"text":"Using channel:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":14,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:d86f71a1cbe7_33":{"__typename":"Paragraph","id":"d86f71a1cbe7_33","name":"8b27","type":"PRE","href":null,"layout":null,"metadata":null,"text":"c := make(chan os.Signal, 1)\nsignal.Notify(c, syscall.SIGTERM)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"go"},"iframe":null,"mixtapeMetadata":null},"Paragraph:d86f71a1cbe7_34":{"__typename":"Paragraph","id":"d86f71a1cbe7_34","name":"8816","type":"BQ","href":null,"layout":null,"metadata":null,"text":"Using context (preferred approach nowadays):","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":44,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:d86f71a1cbe7_35":{"__typename":"Paragraph","id":"d86f71a1cbe7_35","name":"0a74","type":"PRE","href":null,"layout":null,"metadata":null,"text":"ctx, stop := signal.NotifyContext(context.Background(), syscall.SIGTERM)\ndefer stop()","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"EXPLICIT","lang":"go"},"iframe":null,"mixtapeMetadata":null},"Paragraph:d86f71a1cbe7_36":{"__typename":"Paragraph","id":"d86f71a1cbe7_36","name":"d34d","type":"P","href":null,"layout":null,"metadata":null,"text":"NotifyContext returns a copy of the parent context that is marked done (its Done channel is closed) when one of the listed signals arrives, when the returned stop() function is called, or when the parent context’s Done channel is closed, whichever happens first.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":13,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":158,"end":164,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:d86f71a1cbe7_37":{"__typename":"Paragraph","id":"d86f71a1cbe7_37","name":"5368","type":"P","href":null,"layout":null,"metadata":null,"text":"There are few problems with our current implementation of HTTP Server:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:d86f71a1cbe7_38":{"__typename":"Paragraph","id":"d86f71a1cbe7_38","name":"d8f1","type":"OLI","href":null,"layout":null,"metadata":null,"text":"We have a slow processRequest goroutine, and since we don’t handle the termination signal, the program exits automatically, meaning all running goroutines are terminated as well.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:d86f71a1cbe7_39":{"__typename":"Paragraph","id":"d86f71a1cbe7_39","name":"861f","type":"OLI","href":null,"layout":null,"metadata":null,"text":"The program doesn’t close any connections.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:d86f71a1cbe7_40":{"__typename":"Paragraph","id":"d86f71a1cbe7_40","name":"c7de","type":"P","href":null,"layout":null,"metadata":null,"text":"Let’s rewrite it.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:d86f71a1cbe7_41":{"__typename":"Paragraph","id":"d86f71a1cbe7_41","name":"001f","type":"BQ","href":null,"layout":null,"metadata":null,"text":"graceful-shutdown\u002Fmain.go","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":25,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:d86f71a1cbe7_42":{"__typename":"Paragraph","id":"d86f71a1cbe7_42","name":"b98c","type":"PRE","href":null,"layout":null,"metadata":null,"text":"package main\n\n\u002F\u002F imports\n\nvar wg sync.WaitGroup\n\nfunc main() {\n  ctx, stop := signal.NotifyContext(context.Background(), syscall.SIGTERM)\n  defer stop()\n\n  \u002F\u002F redisdb, server\n\n  http.HandleFunc(\"\u002Fincr\", func(w http.ResponseWriter, r *http.Request) {\n    wg.Add(1)\n    go processRequest(redisdb)\n    w.WriteHeader(http.StatusOK)\n  })\n\n  \u002F\u002F make it a goroutine\n  go server.ListenAndServe()\n\n  \u002F\u002F listen for the interrupt signal\n  \u003C-ctx.Done()\n\n  \u002F\u002F stop the server\n  if err := server.Shutdown(context.Background()); err != nil {\n    log.Fatalf(\"could not shutdown: %v\\n\", err)\n  }\n\n  \u002F\u002F wait for all goroutines to finish\n  wg.Wait()\n\n  \u002F\u002F close redis connection\n  redisdb.Close()\n\n  os.Exit(0)\n}\n\nfunc processRequest(redisdb *redis.Client) {\n  defer wg.Done()\n\n  \u002F\u002F simulate some business logic here\n  time.Sleep(time.Second * 5)\n  redisdb.Incr(\"counter\")\n}","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"go"},"iframe":null,"mixtapeMetadata":null},"Paragraph:d86f71a1cbe7_43":{"__typename":"Paragraph","id":"d86f71a1cbe7_43","name":"bddb","type":"P","href":null,"layout":null,"metadata":null,"text":"Here’s the summary of updates:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:d86f71a1cbe7_44":{"__typename":"Paragraph","id":"d86f71a1cbe7_44","name":"90da","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Added signal.NotifyContext to listen for the SIGTERM termination signal.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":6,"end":26,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:d86f71a1cbe7_45":{"__typename":"Paragraph","id":"d86f71a1cbe7_45","name":"f164","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Introduced a sync.WaitGroup to track in-flight requests (processRequest goroutines).","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":13,"end":27,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:d86f71a1cbe7_46":{"__typename":"Paragraph","id":"d86f71a1cbe7_46","name":"1f1c","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Wrapped the server in a goroutine and used server.Shutdown with context to gracefully stop accepting new connections.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":43,"end":58,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:d86f71a1cbe7_47":{"__typename":"Paragraph","id":"d86f71a1cbe7_47","name":"6fea","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Used wg.Wait() to ensure all in-flight requests (processRequest goroutines) finish before proceeding.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":5,"end":14,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:d86f71a1cbe7_48":{"__typename":"Paragraph","id":"d86f71a1cbe7_48","name":"c0bc","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Resource Cleanup: Added redisdb.Close() to properly close the Redis connection before exiting.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":24,"end":39,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:d86f71a1cbe7_49":{"__typename":"Paragraph","id":"d86f71a1cbe7_49","name":"ae07","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Clean Exit: Used os.Exit(0) to indicate a successful termination.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":17,"end":27,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:d86f71a1cbe7_50":{"__typename":"Paragraph","id":"d86f71a1cbe7_50","name":"bfca","type":"P","href":null,"layout":null,"metadata":null,"text":"Now, if we repeat our verification process we will see that all 1000 requests are processed correctly. 🎉","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*zI2edjPToJnSDXTQ.png":{"__typename":"ImageMetadata","id":"0*zI2edjPToJnSDXTQ.png","originalHeight":222,"originalWidth":1172,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:d86f71a1cbe7_51":{"__typename":"Paragraph","id":"d86f71a1cbe7_51","name":"a0f1","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*zI2edjPToJnSDXTQ.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:d86f71a1cbe7_52":{"__typename":"Paragraph","id":"d86f71a1cbe7_52","name":"3b89","type":"H3","href":null,"layout":null,"metadata":null,"text":"Web frameworks \u002F HTTP library","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:d86f71a1cbe7_53":{"__typename":"Paragraph","id":"d86f71a1cbe7_53","name":"adde","type":"P","href":null,"layout":null,"metadata":null,"text":"Frameworks like Echo, Gin, Fiber and others will spawn a goroutine for each incoming requests, giving it a context and then call your function \u002F handler depending on the routing you decided. In our case it would be the anonymous function given to HandleFunc for the “\u002Fincr” path.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:d86f71a1cbe7_54":{"__typename":"Paragraph","id":"d86f71a1cbe7_54","name":"f765","type":"P","href":null,"layout":null,"metadata":null,"text":"When you intercept a SIGTERM signals and ask your framework to gracefully shutdown, 2 important things happen (to oversimplify):","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":21,"end":28,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:d86f71a1cbe7_55":{"__typename":"Paragraph","id":"d86f71a1cbe7_55","name":"d917","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Your framework stop accepting incoming requests","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:d86f71a1cbe7_56":{"__typename":"Paragraph","id":"d86f71a1cbe7_56","name":"a4f7","type":"ULI","href":null,"layout":null,"metadata":null,"text":"It waits for any existing incoming requests to finish (implicitly waiting for the goroutines to end).","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:d86f71a1cbe7_57":{"__typename":"Paragraph","id":"d86f71a1cbe7_57","name":"9a80","type":"P","href":null,"layout":null,"metadata":null,"text":"Note: Kubernetes also stop directing incoming traffic from the loadbalancer to your pod once it has labelled it as Terminating.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":127,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:d86f71a1cbe7_58":{"__typename":"Paragraph","id":"d86f71a1cbe7_58","name":"3399","type":"H3","href":null,"layout":null,"metadata":null,"text":"Optional: Shutdown Timeout","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:d86f71a1cbe7_59":{"__typename":"Paragraph","id":"d86f71a1cbe7_59","name":"90b6","type":"P","href":null,"layout":null,"metadata":null,"text":"Terminating a process can be complex, especially if there are many steps involved like closing connections. To ensure things run smoothly, you can set a timeout. This timeout acts as a safety net, gracefully exiting the process if it takes longer than expected.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:d86f71a1cbe7_60":{"__typename":"Paragraph","id":"d86f71a1cbe7_60","name":"1e3a","type":"PRE","href":null,"layout":null,"metadata":null,"text":"shutdownCtx, cancel := context.WithTimeout(context.Background(), 10*time.Second)\ndefer cancel()\n\ngo func() {\n  if err := server.Shutdown(shutdownCtx); err != nil {\n    log.Fatalf(\"could not shutdown: %v\\n\", err)\n  }\n}()\n\nselect {\ncase \u003C-shutdownCtx.Done():\n  if shutdownCtx.Err() == context.DeadlineExceeded {\n    log.Fatalln(\"timeout exceeded, forcing shutdown\")\n  }\n\n  os.Exit(0)\n}","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"go"},"iframe":null,"mixtapeMetadata":null},"Paragraph:d86f71a1cbe7_61":{"__typename":"Paragraph","id":"d86f71a1cbe7_61","name":"37e1","type":"H3","href":null,"layout":null,"metadata":null,"text":"Kubernetes Termination Lifecycle","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*gQykMIGcZcw-AkAV.jpeg":{"__typename":"ImageMetadata","id":"0*gQykMIGcZcw-AkAV.jpeg","originalHeight":322,"originalWidth":1456,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:d86f71a1cbe7_62":{"__typename":"Paragraph","id":"d86f71a1cbe7_62","name":"6360","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*gQykMIGcZcw-AkAV.jpeg"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:d86f71a1cbe7_63":{"__typename":"Paragraph","id":"d86f71a1cbe7_63","name":"225f","type":"P","href":null,"layout":null,"metadata":null,"text":"Since we used Kubernetes to deploy our service, let’s dive deeper into how it terminates the pods. Once Kubernetes decides to terminate the pod, the following events will take place:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:d86f71a1cbe7_64":{"__typename":"Paragraph","id":"d86f71a1cbe7_64","name":"8656","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Pod is set to the “Terminating” State and removed from the endpoints list of all Services.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:d86f71a1cbe7_65":{"__typename":"Paragraph","id":"d86f71a1cbe7_65","name":"4675","type":"OLI","href":null,"layout":null,"metadata":null,"text":"preStop Hook is executed if defined.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":7,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:d86f71a1cbe7_66":{"__typename":"Paragraph","id":"d86f71a1cbe7_66","name":"fa90","type":"OLI","href":null,"layout":null,"metadata":null,"text":"SIGTERM signal is sent to the pod. But hey, now our application knows what to do!","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":7,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:d86f71a1cbe7_67":{"__typename":"Paragraph","id":"d86f71a1cbe7_67","name":"8aaf","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Kubernetes waits for a grace period (terminationGracePeriodSeconds), which is 30s by default.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":37,"end":66,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:d86f71a1cbe7_68":{"__typename":"Paragraph","id":"d86f71a1cbe7_68","name":"2c52","type":"OLI","href":null,"layout":null,"metadata":null,"text":"SIGKILL signal is sent to pod, and the pod is removed.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":7,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:d86f71a1cbe7_69":{"__typename":"Paragraph","id":"d86f71a1cbe7_69","name":"2e09","type":"P","href":null,"layout":null,"metadata":null,"text":"As you can see, if you have a long-running termination process, it may be necessary to increase the terminationGracePeriodSeconds setting, allowing your application enough time to shut down gracefully.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":100,"end":130,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":137,"end":138,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:d86f71a1cbe7_70":{"__typename":"Paragraph","id":"d86f71a1cbe7_70","name":"224a","type":"H3","href":null,"layout":null,"metadata":null,"text":"Conclusion","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:d86f71a1cbe7_71":{"__typename":"Paragraph","id":"d86f71a1cbe7_71","name":"2399","type":"P","href":null,"layout":null,"metadata":null,"text":"Graceful shutdowns safeguard data integrity, maintain a seamless user experience, and optimize resource management. With its rich standard library and emphasis on concurrency, Go empowers developers to effortlessly integrate graceful shutdown practices — a necessity for applications deployed in containerized or orchestrated environments like Kubernetes.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:d86f71a1cbe7_72":{"__typename":"Paragraph","id":"d86f71a1cbe7_72","name":"4c8a","type":"P","href":null,"layout":null,"metadata":null,"text":"You can find the Go code and Kubernetes manifests in our Github repository.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":53,"end":74,"href":"https:\u002F\u002Fgithub.com\u002Fplutov\u002Fpackagemain\u002Ftree\u002Fmaster\u002Fgraceful-shutdown","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:d86f71a1cbe7_73":{"__typename":"Paragraph","id":"d86f71a1cbe7_73","name":"5840","type":"H3","href":null,"layout":null,"metadata":null,"text":"Resources","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:d86f71a1cbe7_74":{"__typename":"Paragraph","id":"d86f71a1cbe7_74","name":"4b7a","type":"ULI","href":null,"layout":null,"metadata":null,"text":"os\u002Fsignal packag","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":16,"href":"https:\u002F\u002Fpkg.go.dev\u002Fos\u002Fsignal","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:d86f71a1cbe7_75":{"__typename":"Paragraph","id":"d86f71a1cbe7_75","name":"a81e","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Kubernetes Pod Lifecycle","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":24,"href":"https:\u002F\u002Fkubernetes.io\u002Fdocs\u002Fconcepts\u002Fworkloads\u002Fpods\u002Fpod-lifecycle\u002F","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"CollectionViewerEdge:collectionId:5b301f10ddcd-viewerId:lo_33aea83cfb05":{"__typename":"CollectionViewerEdge","id":"collectionId:5b301f10ddcd-viewerId:lo_33aea83cfb05","isEditor":false,"isMuting":false},"ImageMetadata:1*jWhTrIoYwTUdKuVXycqAaw.png":{"__typename":"ImageMetadata","id":"1*jWhTrIoYwTUdKuVXycqAaw.png","originalWidth":800,"originalHeight":152},"Tag:go":{"__typename":"Tag","id":"go","displayTitle":"Go","normalizedTagSlug":"go"},"Tag:golang":{"__typename":"Tag","id":"golang","displayTitle":"Golang","normalizedTagSlug":"golang"},"Tag:kubernetes":{"__typename":"Tag","id":"kubernetes","displayTitle":"Kubernetes","normalizedTagSlug":"kubernetes"},"Tag:linux":{"__typename":"Tag","id":"linux","displayTitle":"Linux","normalizedTagSlug":"linux"},"Tag:software-development":{"__typename":"Tag","id":"software-development","displayTitle":"Software Development","normalizedTagSlug":"software-development"},"Post:e0dcd9940f4b":{"__typename":"Post","id":"e0dcd9940f4b","collection":{"__ref":"Collection:5b301f10ddcd"},"content({\"postMeteringOptions\":{}})":{"__typename":"PostContent","isLockedPreviewOnly":false,"bodyModel":{"__typename":"RichText","sections":[{"__typename":"Section","name":"2358","startIndex":0,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null}],"paragraphs":[{"__ref":"Paragraph:d86f71a1cbe7_0"},{"__ref":"Paragraph:d86f71a1cbe7_1"},{"__ref":"Paragraph:d86f71a1cbe7_2"},{"__ref":"Paragraph:d86f71a1cbe7_3"},{"__ref":"Paragraph:d86f71a1cbe7_4"},{"__ref":"Paragraph:d86f71a1cbe7_5"},{"__ref":"Paragraph:d86f71a1cbe7_6"},{"__ref":"Paragraph:d86f71a1cbe7_7"},{"__ref":"Paragraph:d86f71a1cbe7_8"},{"__ref":"Paragraph:d86f71a1cbe7_9"},{"__ref":"Paragraph:d86f71a1cbe7_10"},{"__ref":"Paragraph:d86f71a1cbe7_11"},{"__ref":"Paragraph:d86f71a1cbe7_12"},{"__ref":"Paragraph:d86f71a1cbe7_13"},{"__ref":"Paragraph:d86f71a1cbe7_14"},{"__ref":"Paragraph:d86f71a1cbe7_15"},{"__ref":"Paragraph:d86f71a1cbe7_16"},{"__ref":"Paragraph:d86f71a1cbe7_17"},{"__ref":"Paragraph:d86f71a1cbe7_18"},{"__ref":"Paragraph:d86f71a1cbe7_19"},{"__ref":"Paragraph:d86f71a1cbe7_20"},{"__ref":"Paragraph:d86f71a1cbe7_21"},{"__ref":"Paragraph:d86f71a1cbe7_22"},{"__ref":"Paragraph:d86f71a1cbe7_23"},{"__ref":"Paragraph:d86f71a1cbe7_24"},{"__ref":"Paragraph:d86f71a1cbe7_25"},{"__ref":"Paragraph:d86f71a1cbe7_26"},{"__ref":"Paragraph:d86f71a1cbe7_27"},{"__ref":"Paragraph:d86f71a1cbe7_28"},{"__ref":"Paragraph:d86f71a1cbe7_29"},{"__ref":"Paragraph:d86f71a1cbe7_30"},{"__ref":"Paragraph:d86f71a1cbe7_31"},{"__ref":"Paragraph:d86f71a1cbe7_32"},{"__ref":"Paragraph:d86f71a1cbe7_33"},{"__ref":"Paragraph:d86f71a1cbe7_34"},{"__ref":"Paragraph:d86f71a1cbe7_35"},{"__ref":"Paragraph:d86f71a1cbe7_36"},{"__ref":"Paragraph:d86f71a1cbe7_37"},{"__ref":"Paragraph:d86f71a1cbe7_38"},{"__ref":"Paragraph:d86f71a1cbe7_39"},{"__ref":"Paragraph:d86f71a1cbe7_40"},{"__ref":"Paragraph:d86f71a1cbe7_41"},{"__ref":"Paragraph:d86f71a1cbe7_42"},{"__ref":"Paragraph:d86f71a1cbe7_43"},{"__ref":"Paragraph:d86f71a1cbe7_44"},{"__ref":"Paragraph:d86f71a1cbe7_45"},{"__ref":"Paragraph:d86f71a1cbe7_46"},{"__ref":"Paragraph:d86f71a1cbe7_47"},{"__ref":"Paragraph:d86f71a1cbe7_48"},{"__ref":"Paragraph:d86f71a1cbe7_49"},{"__ref":"Paragraph:d86f71a1cbe7_50"},{"__ref":"Paragraph:d86f71a1cbe7_51"},{"__ref":"Paragraph:d86f71a1cbe7_52"},{"__ref":"Paragraph:d86f71a1cbe7_53"},{"__ref":"Paragraph:d86f71a1cbe7_54"},{"__ref":"Paragraph:d86f71a1cbe7_55"},{"__ref":"Paragraph:d86f71a1cbe7_56"},{"__ref":"Paragraph:d86f71a1cbe7_57"},{"__ref":"Paragraph:d86f71a1cbe7_58"},{"__ref":"Paragraph:d86f71a1cbe7_59"},{"__ref":"Paragraph:d86f71a1cbe7_60"},{"__ref":"Paragraph:d86f71a1cbe7_61"},{"__ref":"Paragraph:d86f71a1cbe7_62"},{"__ref":"Paragraph:d86f71a1cbe7_63"},{"__ref":"Paragraph:d86f71a1cbe7_64"},{"__ref":"Paragraph:d86f71a1cbe7_65"},{"__ref":"Paragraph:d86f71a1cbe7_66"},{"__ref":"Paragraph:d86f71a1cbe7_67"},{"__ref":"Paragraph:d86f71a1cbe7_68"},{"__ref":"Paragraph:d86f71a1cbe7_69"},{"__ref":"Paragraph:d86f71a1cbe7_70"},{"__ref":"Paragraph:d86f71a1cbe7_71"},{"__ref":"Paragraph:d86f71a1cbe7_72"},{"__ref":"Paragraph:d86f71a1cbe7_73"},{"__ref":"Paragraph:d86f71a1cbe7_74"},{"__ref":"Paragraph:d86f71a1cbe7_75"}]},"validatedShareKey":"","shareKeyCreator":null},"creator":{"__ref":"User:83ef5b231666"},"inResponseToEntityType":null,"isLocked":false,"isMarkedPaywallOnly":false,"lockedSource":"LOCKED_POST_SOURCE_NONE","mediumUrl":"https:\u002F\u002Fitnext.io\u002Fterminating-elegantly-a-guide-to-graceful-shutdowns-e0dcd9940f4b","primaryTopic":null,"topics":[{"__typename":"Topic","slug":"programming"}],"isPublished":true,"latestPublishedVersion":"d86f71a1cbe7","visibility":"PUBLIC","postResponses":{"__typename":"PostResponses","count":0},"clapCount":9,"allowResponses":true,"isLimitedState":false,"title":"Terminating Elegantly: A Guide to Graceful Shutdowns","isSeries":false,"sequence":null,"uniqueSlug":"terminating-elegantly-a-guide-to-graceful-shutdowns-e0dcd9940f4b","socialTitle":"","socialDek":"","noIndex":null,"canonicalUrl":"","metaDescription":"","latestPublishedAt":1721220545265,"readingTime":5.662264150943396,"previewContent":{"__typename":"PreviewContent","subtitle":"Read the original article on packagemain.tech"},"previewImage":{"__ref":"ImageMetadata:1*vQXMWaYPYMLVWP8Pjw6XNA.png"},"isShortform":false,"seoTitle":"","firstPublishedAt":1721204973653,"updatedAt":1721220545342,"shortformType":"SHORTFORM_TYPE_LINK","seoDescription":"","isSuspended":false,"license":"ALL_RIGHTS_RESERVED","tags":[{"__ref":"Tag:go"},{"__ref":"Tag:golang"},{"__ref":"Tag:kubernetes"},{"__ref":"Tag:linux"},{"__ref":"Tag:software-development"}],"isNewsletter":false,"statusForCollection":"APPROVED","pendingCollection":null,"detectedLanguage":"en","wordCount":1315,"layerCake":0}}</script><script src="https://cdn-client.medium.com/lite/static/js/manifest.1158fd93.js"></script><script src="https://cdn-client.medium.com/lite/static/js/54.bea2e5cf.js"></script><script src="https://cdn-client.medium.com/lite/static/js/main.fbe03b98.js"></script><script src="https://cdn-client.medium.com/lite/static/js/instrumentation.d9108df7.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/reporting.ff22a7a5.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9120.5df29668.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5049.d1ead72d.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4810.988332a1.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7407.1ade2c73.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/382.a98f5384.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9148.3242ff58.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9977.b539ef71.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5025.acd0fad9.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5250.a2539c10.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6349.02c5ee3e.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3801.7d014b43.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2648.746e1532.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8594.9eac1902.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6003.d14e9f7d.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6636.e588ac65.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3735.3535ed24.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4300.dc9e14c6.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6546.be06c6f7.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6834.f2d3924e.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6858.454b4e14.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2420.0330d157.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5832.97239afc.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8980.6c8ff2c1.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2859.a9a624d0.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6040.6ceb7f43.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4391.3e417aeb.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/PostPage.MainContent.1ad05aca.chunk.js"></script><script>window.main();</script></body></html>