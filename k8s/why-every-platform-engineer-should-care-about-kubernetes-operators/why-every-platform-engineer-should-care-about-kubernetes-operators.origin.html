<!doctype html><html lang="en-US" prefix="og: http://ogp.me/ns#"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><script>var segmentWriteKey="UK90Ofwacetj5VCPJ7cUgkbNcKLSHO3u",snippetName="C8Y429BDEy/06ujkUhzfL.min.js";window.growthbook_sdk_key="sdk-psPofGr6jFV2ja9O",window.growthbook_decrypt_key="9NsAVMNWaDS+Oky3rhLQ+A==",window.growthbook_dev_mode=!1</script><script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous" referrerpolicy="no-referrer"></script><script src="/js/bundle.6a32ca8cb06dfc8e7446b106fda01b2f8492b76fb800420cc184e200ee060639.js" defer></script><link rel="stylesheet" href="/css/bundle.c42a03b8e7e171cab5358df4bbc981f3d28a8684bedac89d90a5361768620092.css"><meta name="google-site-verification" content="N-ezSTIu4P3bSc4TqidV4wWCkMzFiMN269ZgDYArGkk"><meta property="og:image" content="https://www.pulumi.com/blog/why-every-platform-engineer-should-care-about-kubernetes-operators/meta.png"><meta property="og:type" content="article"><meta property="og:url" content="https://www.pulumi.com/blog/why-every-platform-engineer-should-care-about-kubernetes-operators/"><meta property="og:site_name" content="pulumi"><meta name="twitter:image" content="https://www.pulumi.com/blog/why-every-platform-engineer-should-care-about-kubernetes-operators/meta.png"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content="@PulumiCorp"><meta name="twitter:creator" content="@_ediri"><meta property="og:title" content="Why Every Platform Engineer Should Care About Kubernetes Operators"><meta name="description" content="Highlighting how Kubernetes Operators empower platform engineers to automate and streamline application deployment, management, and scaling on Kubernetes."><meta property="og:description" content="Highlighting how Kubernetes Operators empower platform engineers to automate and streamline application deployment, management, and scaling on Kubernetes."><title>Why Every Platform Engineer Should Care About Kubernetes Operators | Pulumi Blog</title>
<link rel="icon" type="image/x-icon" href="/images/favicon.ico"><link rel="canonical" href="https://www.pulumi.com/blog/why-every-platform-engineer-should-care-about-kubernetes-operators/"><link rel="alternate" type="application/rss+xml" href="https://www.pulumi.com/blog/rss.xml" title="Pulumi Blog"><script src="https://js.sentry-cdn.com/02614bf2f18e4615a73218b810563ced.min.js" crossorigin="anonymous"></script><script>Sentry.onLoad(function(){Sentry.init({environment:"production",release:"push-2e724a45",beforeSend(e){const t=e.request.headers["User-Agent"];return t&&t.match(/Linespider|Yeti/)?null:e}})})</script><script async defer src="https://buttons.github.io/buttons.js"></script><script async defer id="6senseWebTag" src="https://j.6sc.co/j/a4dca4b3-351c-4764-bda9-03c5caf5fedf.js"></script><script>userAgentBlacklist=["Mozilla/5.0 (compatible; SiteAuditBot/0.97; +http://www.semrush.com/bot.html)","Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/115.0.0.0 Safari/537.36"],!function(){var n,s,t="analytics",e=window[t]=window[t]||[];if(!e.initialize)if(e.invoked)window.console&&console.error&&console.error("Segment snippet included twice.");else if(userAgentBlacklist.includes(navigator.userAgent))console.log("Segment snippet not loaded for user agent: "+navigator.userAgent);else{e.invoked=!0,e.methods=["trackSubmit","trackClick","trackLink","trackForm","pageview","identify","reset","group","track","ready","alias","debug","page","screen","once","off","on","addSourceMiddleware","addIntegrationMiddleware","setAnonymousId","addDestinationMiddleware","register"],e.factory=function(n){return function(){if(window[t].initialized)return window[t][n].apply(window[t],arguments);var o,s=Array.prototype.slice.call(arguments);return["track","screen","alias","group","page","identify"].indexOf(n)>-1&&(o=document.querySelector("link[rel='canonical']"),s.push({__t:"bpc",c:o&&o.getAttribute("href")||void 0,p:location.pathname,u:location.href,s:location.search,t:document.title,r:document.referrer})),s.unshift(n),e.push(s),e}};for(n=0;n<e.methods.length;n++)s=e.methods[n],e[s]=e.factory(s);e.load=function(n,s){var i,o=document.createElement("script");o.type="text/javascript",o.async=!0,o.setAttribute("data-global-segment-analytics-key",t),o.src="https://evs.analytics.pulumi.com/"+snippetName,i=document.getElementsByTagName("script")[0],i.parentNode.insertBefore(o,i),e._loadOptions=s},e._writeKey=segmentWriteKey,e._cdn="https://evs.analytics.pulumi.com",e.SNIPPET_VERSION="5.2.0",e.load(segmentWriteKey),e.page()}}()</script><script>window.consentManagerConfig=function(e){var t=e.React,c=e.inEU,n=t.createElement("span",null,"We use cookies (and other similar technologies) to collect data to improve your experience on our site. By using our website, youÕre agreeing to the collection of data as described in our"," ",t.createElement("a",{href:"/privacy/",target:"_blank"},"Privacy Policy"),"."),s=t.createElement("div",{class:"manage-cookies-btn"},"Manage cookies"),o="Website Data Collection Preferences",i="We use data collected by cookies and JavaScript libraries to improve your browsing experience, analyze site traffic, deliver personalized advertisements, and increase the overall performance of our site.",a="Are you sure you want to cancel?",r="Your preferences have not been saved. By continuing to use our website, you are agreeing to our Website Data Collection Policy.";return{container:"#segment-consent-manager",writeKey:segmentWriteKey,bannerContent:n,bannerSubContent:s,preferencesDialogTitle:o,preferencesDialogContent:i,cancelDialogTitle:a,cancelDialogContent:r,shouldRequireConsent:e.inEU,closeBehavior:e.inEU()?"dismiss":"accept",bannerTextColor:"black",cdnHost:"evs.analytics.pulumi.com",shouldReload:!1}}</script><script src="/js/consent-manager.js" defer></script><script src="https://tag.clearbitscripts.com/v1/pk_54e7d7c428c6d5e79098374d93a7b333/tags.js" referrerpolicy="strict-origin-when-cross-origin"></script><meta name="facebook-domain-verification" content="phlf6qes2bxa9ufzk8zt2es0qivg8j"><script>(function(){if(typeof window=="undefined")return;if(typeof window.signals!="undefined")return;var e=document.createElement("script");e.src="https://cdn.cr-relay.com/v1/site/a725b5ba-75f1-44dc-b250-11023fc10b9d/signals.js",e.async=!0,window.signals=Object.assign([],["page","identify","form"].reduce(function(e,t){return e[t]=function(){return signals.push([t,arguments]),signals},e},{})),document.head.appendChild(e)})()</script><script>!function(){var t,n,e=window.reb2b=window.reb2b||[];if(e.invoked)return;e.invoked=!0,e.methods=["identify","collect"],e.factory=function(t){return function(){var n=Array.prototype.slice.call(arguments);return n.unshift(t),e.push(n),e}};for(t=0;t<e.methods.length;t++)n=e.methods[t],e[n]=e.factory(n);e.load=function(e){var n,t=document.createElement("script");t.type="text/javascript",t.async=!0,t.src="https://s3-us-west-2.amazonaws.com/b2bjsstore/b/"+e+"/reb2b.js.gz",n=document.getElementsByTagName("script")[0],n.parentNode.insertBefore(t,n)},e.SNIPPET_VERSION="1.0.1",e.load("Y4O7Z0HKLKNX")}()</script><script async defer src="//cdnjs.cloudflare.com/ajax/libs/anchor-js/4.1.0/anchor.min.js"></script><script>window.addEventListener("load",function(){anchors&&anchors.add("h1:not(.no-anchor), h2:not(.no-anchor), h3:not(.no-anchor), h4:not(.no-anchor), h5:not(.no-anchor), h6:not(.no-anchor)")})</script></head><body class="section-blog"><pulumi-root></pulumi-root><nav class="top-nav-bar transition-all"><div class="top-nav-container lg:container lg:px-4 flex-wrap justify-end"><div class="top-nav-banner-cta-container w-full flex flex-col justify-center items-center rounded p-0.5"><div class="w-full top-nav-banner-cta gradient"><a href="/blog/pulumi-up-2024/" class="top-nav-banner-cta-text w-full block text-center">ð New Product Launches: Pulumi Insights 2.0 and ESC GA.
<span class="underline">Learn More â«</span> ð</a></div></div><div class="w-full p-4"><ul class="hidden w-full lg:flex justify-end items-center order-first lg:order-last"><li class="github-widget mr-8"><a data-track="header-github-pulumi" class="github-button" href="https://github.com/pulumi/pulumi" data-size="small" data-show-count="true" aria-label="Star pulumi/pulumi on GitHub">Star</a></li><li class="mr-8"><a data-track="header-slack" href="https://slack.pulumi.com/" target="_blank"><i class="fab fa-slack"></i>
Slack</a></li><li class="mr-8"><a data-track="header-docs" href="/docs/"><i class="fas fa-book mr-0.5"></i>
Docs</a></li><li class="mr-8"><a data-track="header-registry" href="/registry/"><i class="fas fa-archive mr-0.5"></i>
Registry</a></li><li class="mr-8"><a data-track="header-ai" href="/ai"><i class="fas fa-robot mr-0.5"></i>
Pulumi AI</a></li><li><a data-track="header-console" href="https://app.pulumi.com/" target="_blank"><i class="fas fa-user-circle"></i>
<pulumi-user-toggle><span slot="signed-in">Pulumi Cloud</span>
<span slot="signed-out">Sign In</span></pulumi-user-toggle></a></li></ul></div></div></nav><div class="header-container"><nav class="lg:container lg:mx-auto lg:px-4 py-3"><header><div class="flex flex-col lg:flex-row"><div class="logo-container"><a data-track="header-pulumi-logo" class="block" href="/"><img class="normal-logo h-8" src="/images/logo/logo-on-white.svg" alt="Pulumi logo">
<img class="dark-logo hidden h-8" src="/images/logo/logo-on-black.svg" alt="Pulumi logo"></a></div><ul class="desktop-menu"><li class="header-nav-item-drop-down"><span class="dropdown-title">Products</span>
<span class="dropdown-menu-caret"></span><div class="header-nav-drop-down-menu product"><ul><div><div class="header-nav-drop-down-heading"></div><div class="header-nav-drop-down-heading-text w-min">Products</div></div><div class="header-nav-two-col-drop-down mb-4"><li><div class="list-title"><a href="/product/infrastructure-as-code/"><i class="fas fa-code fa-fw"></i>
Pulumi IaC<div class="list-sub-title">Infrastructure as code for engineers in Node.js, Python, Go, .NET, Java, and YAML</div></a></div></li><li><div class="list-title"><a href="/product/secrets-management/"><i class="fas fa-key fa-fw"></i>
Pulumi ESC<div class="list-sub-title">Environments, Secrets and Configuration Management</div></a></div></li><li><div class="list-title"><a href="/product/pulumi-insights/"><span class="mr-2"><img src="/icons/magnifying-glass.svg" class="inline opacity-90">
</span>Pulumi Insights<div class="list-sub-title">Asset management, compliance remediation, and AI insights over the cloud</div></a></div></li><li><div class="list-title"><a href="/product/pulumi-cloud/"><i class="fas fa-cloud fa-fw"></i>
Pulumi Cloud<div class="list-sub-title">Managed service for infrastructure as code and secrets management. Use SaaS or self-host.</div></a></div></li></div><div><div class="header-nav-drop-down-heading"></div><div class="header-nav-drop-down-heading-text w-min">Key Capabilities</div></div><div class="header-nav-two-col-drop-down mb-4"><li><div class="list-title"><a href="/product/copilot/"><i class="fas fa-robot fa-fw"></i>
Pulumi Copilot<div class="list-sub-title">Generative AI-powered intelligent cloud management</div></a></div></li><li><div class="list-title"><a href="/crossguard/"><i class="fas fa-shield-alt fa-fw"></i>
Pulumi CrossGuard<div class="list-sub-title">Enforce guardrails for security and compliance using policies in standard languages</div></a></div></li><li><div class="list-title"><a href="/product/pulumi-deployments/"><i class="fas fa-rocket fa-fw"></i>
Pulumi Deployments<div class="list-sub-title">Automate deployment and operational workflows for cloud infrastructure</div></a></div></li><li></li></div><div><div class="header-nav-drop-down-heading"></div></div><div class="header-nav-two-col-drop-down"><li><div class="list-title"><a href="/request-a-demo/"><i class="fas fa-laptop-code fa-fw"></i>
Request a demo<div class="list-sub-title">See how Pulumi can help you ship infrastructure faster</div></a></div></li><li></li></div></ul></div></li><li class="header-nav-item-drop-down"><span class="dropdown-title whitespace-nowrap">Solutions</span>
<span class="dropdown-menu-caret"></span><div class="header-nav-drop-down-menu"><ul><div class="header-nav-one-col-drop-down"><li><div class="list-title"><a href="/testimonials/"><i class="fas fa-quote-left fa-fw"></i>
Engineers love Pulumi<div class="list-sub-title pr-2">Hear from engineers why they love Pulumi</div></a></div></li><li><div class="list-title"><a href="/case-studies/"><i class="fas fa-file fa-fw"></i>
Case Studies<div class="list-sub-title">Read how teams increased productivity</div></a></div></li><li><div class="list-title"><a href="/product/internal-developer-platforms/"><i class="fas fa-users fa-fw"></i>
<span class="list-title-width-hold" title="Pulumi for Platform Engineering">Pulumi for Platform Engineering</span><div class="list-sub-title">Build and scale internal developer platforms</div></a></div></li><li><div class="list-title"><a href="/solutions/ai/"><i class="fas fa-robot fa-fw"></i>
Pulumi for AI<div class="list-sub-title pr-2">Discover, learn, and build infrastructure as code faster with AI</div></a></div></li><li><div class="list-title"><a href="/solutions/"><i class="fas fa-lightbulb fa-fw"></i>
Solutions<div class="list-sub-title">Explore ways to use Pulumi</div></a></div></li><li><div class="list-title"><a href="/enterprise/"><i class="fas fa-building fa-fw"></i>
Enterprises<div class="list-sub-title pr-2">Learn how Pulumi serves enterprise needs</div></a></div></li><li><div class="list-title"><a href="/proserv/"><i class="fas fa-briefcase fa-fw"></i>
Professional Services<div class="list-sub-title pr-2">Explore our professional services offerings</div></a></div></li></div></ul></div></li><li><a href="/pricing/">Pricing</a></li><li><a href="/docs/">Docs</a></li><li class="header-nav-item-drop-down"><span class="dropdown-title">Learn</span>
<span class="dropdown-menu-caret"></span><div class="header-nav-drop-down-menu learn"><ul><div class="header-nav-two-col-drop-down"><li><div class="list-title"><a href="https://info.pulumi.com/platform-engineering-workshop-series"><i class="fas fa-calendar fa-fw"></i>
Platform Engineering Workshop Series<div class="list-sub-title">Learn to automate, secure, and manage at scale. Register and attend the entire series for a certificate of completion</div></a></div></li><li><div class="list-title"><a href="/blog/"><i class="fas fa-blog fa-fw"></i>
Blog<div class="list-sub-title">Read product news, best practices, and more</div></a></div></li><li><div class="list-title"><a href="/templates/"><span><img src="/icons/square-foot.svg" class="inline opacity-90">
</span>Templates<div class="list-sub-title ml-0.5">Deploy common architectures on any cloud</div></a></div></li><li><div class="list-title"><a href="/learn/"><span class="mr-0.5"><img src="/icons/graduation-cap.svg" class="inline opacity-90">
</span>Tutorials<div class="list-sub-title -ml-0.5">Get hands-on with Pulumi concepts</div></a></div></li><li><div class="list-title"><a href="/case-studies/"><i class="fas fa-file fa-fw"></i>
Case Studies<div class="list-sub-title">Read how customers are innovating faster</div></a></div></li><li><div class="list-title"><a href="/events#upcoming"><i class="fas fa-calendar fa-fw"></i>
Events and Workshops<div class="list-sub-title">Register for upcoming sessions, or watch past sessions on-demand</div></a></div></li><li><div class="list-title"><a href="/answers/"><i class="fas fa-robot mr-0.5"></i>
Pulumi Answers<div class="list-sub-title">Collection of Q&A about how to set up different cloud infrastructures</div></a></div></li><li><div class="list-title"><a href="/community/"><i class="fas fa-comments fa-fw"></i>
Community<div class="list-sub-title">Where to find us</div></a></div></li><li><div class="list-title"><a href="/what-is/"><i class="fas fa-book-reader fa-fw"></i>
What is ...?<div class="list-sub-title">Dive into topics in and around the IaC universe</div></a></div></li></div></ul></div></li><li class="header-nav-item-drop-down"><span class="dropdown-title whitespace-nowrap">Company</span>
<span class="dropdown-menu-caret"></span><div class="header-nav-drop-down-menu company"><ul><div class="header-nav-one-col-drop-down min-w-40"><li><div class="list-title"><a href="/about/"><i class="fas fa-quote-left fa-fw"></i>
About us<div class="list-sub-title">Our purpose and values</div></a></div></li><li><div class="list-title"><a href="/careers/"><i class="fas fa-briefcase fa-fw"></i>
Careers<div class="list-sub-title">Come work for Pulumi</div></a></div></li><li><div class="list-title"><a href="/about/newsroom/"><i class="fas fa-book-open fa-fw"></i>
Newsroom<div class="list-sub-title">Pulumi in the news</div></a></div></li><li><div class="list-title"><a href="/awards/"><i class="fas fa-trophy fa-fw"></i>
Awards<div class="list-sub-title">Recognition from press and analysts</div></a></div></li></div></ul></div></li></ul><input class="mobile-menu-toggle" type="checkbox" id="mobile-menu" name="mobile-menu">
<span class="mobile-menu-icon"><label class="mobile-menu-closed" for="mobile-menu"><span><svg width="36" height="36" viewBox="0 0 36 36" fill="none"><rect x="6" y="9" width="24" height="2" rx="1" fill="#2f3032"/><rect x="6" y="17" width="24" height="2" rx="1" fill="#2f3032"/><rect x="6" y="25" width="24" height="2" rx="1" fill="#2f3032"/></svg>
</span></label><label class="mobile-menu-open hidden" for="mobile-menu"><span><svg width="36" height="36" viewBox="0 0 36 36" fill="none"><rect x="10.2219" y="8.80762" width="24" height="2" rx="1" transform="rotate(45 10.2219 8.80762)" fill="#2f3032"/><rect x="8.80762" y="25.7781" width="24" height="2" rx="1" transform="rotate(-45 8.80762 25.7781)" fill="#2f3032"/></svg></span></label></span><ul class="mobile-menu"><ul id="mobile-dropdown"><div><input id="product-mobile-menu" name="nav-menu-checkbox" class="invisible-checkbox" type="checkbox">
<label id="product-menu-label" for="product-mobile-menu" class="mobile-menu-heading">Product<span class="dropdown-menu-caret"></span></label><hr><div class="mobile-menu-subitems-product"><div class="mobile-menu-sub-heading mx-5"><div>Products</div></div><li><a href="/product/infrastructure-as-code/"><i class="fas fa-code fa-fw"></i> Pulumi IaC</a></li><li><a href="/product/secrets-management/"><i class="fas fa-key fa-fw"></i> Pulumi ESC</a></li><li><a href="/product/pulumi-cloud/"><i class="fas fa-cloud fa-fw"></i> Pulumi Cloud</a></li><div class="mobile-menu-sub-heading mx-5 mt-2"><div>Key Capabilities</div></div><li><a href="/product/copilot/"><i class="fas fa-robot fa-fw"></i> Pulumi Copilot</a></li><li><a href="/crossguard/"><i class="fas fa-shield-alt fa-fw"></i> Pulumi CrossGuard</a></li><li><a href="/product/pulumi-deployments/"><i class="fas fa-rocket fa-fw"></i> Pulumi Deployments</a></li><li><a href="/product/pulumi-insights/"><span class="ml-1.5 mr-1.5"><img src="/icons/magnifying-glass.svg" class="inline opacity-90 h-5">
</span>Pulumi Insights</a></li><div class="mobile-menu-sub-heading mx-5 mt-2"></div><li><a href="/request-a-demo/"><i class="fas fa-laptop-code fa-fw"></i> Request a demo</a></li><hr></div></div><div><input id="why-pulumi-mobile-menu" name="nav-menu-checkbox" class="invisible-checkbox" type="checkbox">
<label id="why-pulumi-menu-label" for="why-pulumi-mobile-menu" class="mobile-menu-heading">Solutions<span class="dropdown-menu-caret"></span></label><hr><div class="mobile-menu-subitems-why-pulumi"><li><a href="/testimonials/"><i class="fas fa-quote-left fa-fw"></i> Engineers love Pulumi</a></li><li><a href="/case-studies/"><i class="fas fa-file fa-fw"></i> Case Studies</a></li><li><a href="/product/internal-developer-platforms/"><i class="fas fa-users fa-fw"></i> Pulumi for Platform Engineering</a></li><li><a href="/solutions/ai/"><i class="fas fa-robot fa-fw"></i> Pulumi for AI</a></li><li><a href="/solutions/"><i class="fas fa-lightbulb fa-fw"></i> Solutions</a></li><li><a href="/enterprise/"><i class="fas fa-building fa-fw"></i> Enterprises</a></li><li><a href="/proserv/"><i class="fas fa-briefcase fa-fw"></i> Professional Services</a></li><hr></div></div><li class="mobile-menu-item"><a href="/pricing/">Pricing</a></li><hr><li class="mobile-menu-item"><a href="/docs/">Docs</a></li><hr><div><input id="learn-mobile-menu" name="nav-menu-checkbox" class="invisible-checkbox" type="checkbox">
<label id="learn-menu-label" for="learn-mobile-menu" class="mobile-menu-heading">Learn<span class="dropdown-menu-caret"></span></label><hr><div class="mobile-menu-subitems-learn"><li><a href="https://info.pulumi.com/platform-engineering-workshop-series"><i class="fas fa-calendar fa-fw"></i> Platform Engineering Workshop Series</a></li><li><a href="/blog/"><i class="fas fa-blog fa-fw"></i> Blog</a></li><li><a href="/templates/"><span><img src="/icons/square-foot.svg" class="inline h-8 opacity-90"> </span>Templates</a></li><li><a href="/learn/"><span class="ml-1 mr-1"><img src="/icons/graduation-cap.svg" class="inline opacity-90 h-5">
</span>Tutorials</a></li><li><a href="/case-studies/"><i class="fas fa-file fa-fw"></i> Case Studies</a></li><li><a href="/events#upcoming"><i class="fas fa-calendar fa-fw"></i> Events and Workshops</a></li><li><a href="/answers/"><i class="fas fa-robot mr-0.5"></i> Pulumi Answers</a></li><li><a href="/community/"><i class="fas fa-comments fa-fw"></i> Community</a></li><li><a href="/what-is/"><i class="fas fa-book-reader fa-fw"></i> What is ...?</a></li></div></div><div><input id="company-mobile-menu" name="nav-menu-checkbox" class="invisible-checkbox" type="checkbox">
<label id="company-menu-label" for="company-mobile-menu" class="mobile-menu-heading">Company<span class="dropdown-menu-caret"></span></label><hr><div class="mobile-menu-subitems-company"><li><a href="/about/"><i class="fas fa-quote-left fa-fw"></i> About us</a></li><li><a href="/careers/"><i class="fas fa-briefcase fa-fw"></i> Careers</a></li><li><a href="/about/newsroom/"><i class="fas fa-book-open fa-fw"></i> Newsroom</a></li><li><a href="/awards/"><i class="fas fa-trophy fa-fw"></i> Awards</a></li><hr></div></div></ul><div class="mobile-menu-footer"><div class="flex items-center justify-between py-4 px-2 border-t my-4 mx-2 border-gray-200"><a href="https://github.com/pulumi/pulumi">GitHub</a>
<a href="https://slack.pulumi.com/">Slack</a>
<a href="/docs/">Docs</a>
<a href="/registry/">Registry</a>
<a href="/ai">Pulumi AI</a>
<a href="https://app.pulumi.com/"><pulumi-user-toggle><span slot="signed-in">Pulumi Cloud</span>
<span slot="signed-out">Sign In</span></pulumi-user-toggle></a></div><div class="text-center bg-violet-600 text-white get-started"><a class="block" data-track="header-signup-mobile" href="https://app.pulumi.com/signup" title="Sign up for Pulumi Cloud">Sign Up</a></div></div></ul><div class="cta-container my-2"><header-cta button-class="header-btn-primary"></header-cta></div></div></header></nav></div><main><div class="container mx-auto px-4 py-8"><div class="xxl:flex"><div class="flex flex-col lg:flex-row xxl:w-9/12"><div class="lg:w-1/4 xxl:w-4/12 pr-8"><aside class="lg:pr-8 sticky-sidebar"><div class="lg:hidden"><button class="blog-sidebar-toggle items-center px-3 py-2 border rounded text-purple border-purple">Toggle Blog Navigation</button></div><h2 class="no-anchor hidden lg:flex mt-2 mb-6"><a data-track="sidebar" class="text-2xl" href="/blog/">Pulumi Blog</a></h2><div class="blog-sidebar-content hidden lg:block"><div><div id="search" data-app-id="P6KICOKU8E" data-search-key="9ac9f1177f81bc8cb5f6cf30485e62db" data-facets="Blog" data-index="production"></div></div><hr class="my-8"><div class="my-8"><h5 class="no-anchor text-gray-800 pb-2">Program the Cloud</h5><div class="text-sm"><p class="my-0 text-gray-700">Create, deploy, and manage cloud infrastructure using your favorite language.</p><p class="mb-0"><a class="whitespace-nowrap" data-track="sidebar" href="/docs/iac/get-started/">Get started &rarr;</a></p></div></div><hr class="my-8"><div class="my-4"><h5 class="no-anchor">Recent Posts</h5><ul class="list-none p-0"><li class="my-4 leading-snug"><a data-track="recent-post" class="text-sm" href="/blog/pulumi-year-in-review/">2024 Year in Review: Growth, Innovation and Appreciation</a></li><li class="my-4 leading-snug"><a data-track="recent-post" class="text-sm" href="/blog/master-kubernetes-secrets-with-pulumi-esc-secrets-store-csi-driver/">Master Kubernetes Secrets with Pulumi ESC + Secrets Store CSI Driver</a></li><li class="my-4 leading-snug"><a data-track="recent-post" class="text-sm" href="/blog/aws-eks-auto-mode/">Getting Started with Amazon EKS Auto Mode in Pulumi</a></li><li class="my-4 leading-snug"><a data-track="recent-post" class="text-sm" href="/blog/pulumi-esc-aws-parameter-store-support/">Announcing AWS Systems Manager - Parameter Store Support for Pulumi ESC</a></li><li class="my-4 leading-snug"><a data-track="recent-post" class="text-sm" href="/blog/your-perfect-infrastructure/">Your Perfect Infrastructure May Not Be So Perfect</a></li><li class="my-4 leading-snug"><a data-track="recent-post" class="text-sm" href="/blog/esc-imports-discoverability/">Pulumi ESC: Discovering Environment Imports</a></li><li class="my-4 leading-snug"><a data-track="recent-post" class="text-sm" href="/blog/pulumi-copilot-rest/">Announcing the Pulumi Copilot REST API Preview</a></li><li class="my-4 leading-snug"><a data-track="recent-post" class="text-sm" href="/blog/copilot-lessons/">AI Engineering Lessons from Building Pulumi Copilot</a></li><li class="my-4 leading-snug"><a data-track="recent-post" class="text-sm" href="/blog/integrating-devops-and-security-for-scalable-platform-engineering/">Integrating DevOps and Security in Platform Engineering</a></li><li class="my-4 leading-snug"><a data-track="recent-post" class="text-sm" href="/blog/esc-secret-rotation-with-iac/">Secret Rotation with Pulumi ESC</a></li></ul></div><hr class="my-8"><ul class="tags list-none p-0 mb-2 inline-flex flex-wrap text-xs"><li><a data-track="blog-tag-pulumi-releases" class="tag tag-blog text-xs m-1" href="/blog/tag/pulumi-releases/">pulumi-releases</a></li><li><a data-track="blog-tag-features" class="tag tag-blog text-xs m-1" href="/blog/tag/features/">features</a></li><li><a data-track="blog-tag-aws" class="tag tag-blog text-xs m-1" href="/blog/tag/aws/">aws</a></li><li><a data-track="blog-tag-kubernetes" class="tag tag-blog text-xs m-1" href="/blog/tag/kubernetes/">kubernetes</a></li><li><a data-track="blog-tag-serverless" class="tag tag-blog text-xs m-1" href="/blog/tag/serverless/">serverless</a></li><li><a data-track="blog-tag-azure" class="tag tag-blog text-xs m-1" href="/blog/tag/azure/">azure</a></li><li><a data-track="blog-tag-pulumi-news" class="tag tag-blog text-xs m-1" href="/blog/tag/pulumi-news/">pulumi-news</a></li><li><a data-track="blog-tag-cloud-engineering" class="tag tag-blog text-xs m-1" href="/blog/tag/cloud-engineering/">cloud-engineering</a></li><li><a data-track="blog-tag-containers" class="tag tag-blog text-xs m-1" href="/blog/tag/containers/">containers</a></li><li><a data-track="blog-tag-continuous-delivery" class="tag tag-blog text-xs m-1" href="/blog/tag/continuous-delivery/">continuous-delivery</a></li><li><a data-track="blog-tag-platform-engineering" class="tag tag-blog text-xs m-1" href="/blog/tag/platform-engineering/">platform-engineering</a></li><li><a data-track="blog-tag-ai" class="tag tag-blog text-xs m-1" href="/blog/tag/ai/">ai</a></li><li><a data-track="blog-tag-secrets" class="tag tag-blog text-xs m-1" href="/blog/tag/secrets/">secrets</a></li><li><a data-track="blog-tag-infrastructure-as-code" class="tag tag-blog text-xs m-1" href="/blog/tag/infrastructure-as-code/">infrastructure-as-code</a></li><li><a data-track="blog-tag-typescript" class="tag tag-blog text-xs m-1" href="/blog/tag/typescript/">typescript</a></li><li><a data-track="blog-tag-automation-api" class="tag tag-blog text-xs m-1" href="/blog/tag/automation-api/">automation-api</a></li><li><a data-track="blog-tag-python" class="tag tag-blog text-xs m-1" href="/blog/tag/python/">python</a></li><li><a data-track="blog-tag-eks" class="tag tag-blog text-xs m-1" href="/blog/tag/eks/">eks</a></li><li><a data-track="blog-tag-esc" class="tag tag-blog text-xs m-1" href="/blog/tag/esc/">esc</a></li><li><a data-track="blog-tag-security" class="tag tag-blog text-xs m-1" href="/blog/tag/security/">security</a></li><li><a data-track="blog-tag-community" class="tag tag-blog text-xs m-1" href="/blog/tag/community/">community</a></li><li><a data-track="blog-tag-policy-as-code" class="tag tag-blog text-xs m-1" href="/blog/tag/policy-as-code/">policy-as-code</a></li><li><a data-track="blog-tag-pulumi-events" class="tag tag-blog text-xs m-1" href="/blog/tag/pulumi-events/">pulumi-events</a></li><li><a data-track="blog-tag-docker" class="tag tag-blog text-xs m-1" href="/blog/tag/docker/">docker</a></li><li><a data-track="blog-tag-devops" class="tag tag-blog text-xs m-1" href="/blog/tag/devops/">devops</a></li><li><a data-track="blog-tag-google-cloud" class="tag tag-blog text-xs m-1" href="/blog/tag/google-cloud/">google-cloud</a></li><li><a data-track="blog-tag-guest-post" class="tag tag-blog text-xs m-1" href="/blog/tag/guest-post/">guest-post</a></li><li><a data-track="blog-tag-javascript" class="tag tag-blog text-xs m-1" href="/blog/tag/javascript/">javascript</a></li><li><a data-track="blog-tag-lambda" class="tag tag-blog text-xs m-1" href="/blog/tag/lambda/">lambda</a></li><li><a data-track="blog-tag-yaml" class="tag tag-blog text-xs m-1" href="/blog/tag/yaml/">yaml</a></li><li><a data-track="blog-tag-cloud-native" class="tag tag-blog text-xs m-1" href="/blog/tag/cloud-native/">cloud-native</a></li><li><a data-track="blog-tag-migration" class="tag tag-blog text-xs m-1" href="/blog/tag/migration/">migration</a></li><li><a data-track="blog-tag-go" class="tag tag-blog text-xs m-1" href="/blog/tag/go/">go</a></li><li><a data-track="blog-tag-packages" class="tag tag-blog text-xs m-1" href="/blog/tag/packages/">packages</a></li><li><a data-track="blog-tag-.net" class="tag tag-blog text-xs m-1" href="/blog/tag/.net/">.net</a></li><li><a data-track="blog-tag-best-practices" class="tag tag-blog text-xs m-1" href="/blog/tag/best-practices/">best-practices</a></li><li><a data-track="blog-tag-developer-experience-devex" class="tag tag-blog text-xs m-1" href="/blog/tag/developer-experience-devex/">developer-experience-devex</a></li><li><a data-track="blog-tag-pulumi-enterprise" class="tag tag-blog text-xs m-1" href="/blog/tag/pulumi-enterprise/">pulumi-enterprise</a></li><li><a data-track="blog-tag-testing" class="tag tag-blog text-xs m-1" href="/blog/tag/testing/">testing</a></li><li><a data-track="blog-tag-zephyr" class="tag tag-blog text-xs m-1" href="/blog/tag/zephyr/">zephyr</a></li><li><a data-track="blog-tag-developer-portals" class="tag tag-blog text-xs m-1" href="/blog/tag/developer-portals/">developer-portals</a></li><li><a data-track="blog-tag-infrastructure-lifecycle-management" class="tag tag-blog text-xs m-1" href="/blog/tag/infrastructure-lifecycle-management/">infrastructure-lifecycle-management</a></li></ul><a class="text-blue-600 text-sm block m-1 mb-4" href="/blog/tag/">All blog tags &rarr;</a></div><div class="lg:hidden pb-4"></div></aside></div><div class="lg:w-3/4 xxl:w-9/12"><article class="mb-8 pb-8 border-b border-gray-200"><h1 class="no-anchor">Why Every Platform Engineer Should Care About Kubernetes Operators</h1><p>Posted on <time>Tuesday, Dec 10, 2024</time></p><div class="flex items-center"><span class="text-sm text-gray-700"><span class="flex items-center"><span class="flex items-center"><a data-track="engin-diri-img" class="rounded-full p-1 bg-blue-200 mr-2" href="/blog/author/engin-diri/"><img class="w-8 rounded-full" src="/images/team/engin-diri.jpg" alt="Engin Diri" title="Engin Diri">
</a><a data-track="engin-diri-name" class="mr-2 hover:text-gray-800" href="/blog/author/engin-diri/">Engin Diri</a></span></span></span></div><section><p>In one of my recent talks, I mentioned that the foundation of a successful <a href="/kubernetes">Kubernetes</a>-powered platform is the use of <a href="https://kubernetes.io/docs/concepts/extend-kubernetes/operator/">Kubernetes Operators</a>, as they are a great way to automate operational tasks and the lifecycle of complex applications and services on Kubernetes.</p><p>In case you missed the talk, here is the link to the recording:</p><div style="position:relative;padding-bottom:56.25%;height:0;overflow:hidden"><iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen loading="eager" referrerpolicy="strict-origin-when-cross-origin" src="https://www.youtube.com/embed/vKNsVQjonqM?rel=0?autoplay=0&controls=1&end=0&loop=0&mute=0&start=0" style="position:absolute;top:0;left:0;width:100%;height:100%;border:0" title="YouTube video"></iframe></div><p>After the talk, I received feedback from the audience that they would like to have more information about Kubernetes operators and some of the advanced operators I would recommend to use in their Kubernetes-powered platforms. And who am I to reject such a great opportunity to share my knowledge with the community?</p><p>As you guess, the base for a Kubernetes Operator is, well, Kubernetes. So, if you are not familiar with Kubernetes, let me give you a brief introduction. Kubernetes, or K8s in short, is by far the most powerful open-source container orchestration platform out there - especially for its capability to maintain a desired state. This means you, as the platform admin, can define how you want your cluster and the workload on top of it to look, and Kubernetes (aka the control plane) executes the necessary steps to ensure the desired state is achieved using a feedback loop.</p><p>And how does Kubernetes achieve this complex operational task management? Kubernetes leverages the concept of controllers and operators. Both ensure that the cluster resources are in the desired state. But why is there a distinction between controllers and operators inside the Kubernetes ecosystem? There is also great confusion when folks talk about controllers and operators, as the differences are in the details and operators are a subcategory of controllers.</p><h2 id="kubernetes-controllers-vs-operators">Kubernetes Controllers vs. Operators</h2><p><img src="loop.png" alt="loop.png"></p><p>K8s controllers are control loops that watch your resources and reconcile the current state with the desired state in a continuous loop. Think about how a thermostat works in your house. The thermostat watches the current temperature and, if it is below the desired temperature, it turns on the heating. If it is above the desired temperature, it turns off the heating. This is how a controller works in Kubernetes - it watches the resources and conditions defined in the desired state and executes the necessary steps to make sure the current state matches the desired state.</p><p>Here are some typical Kubernetes controller key functions as part of the maintain, observe, and enforce loop of the control loop:</p><table><thead><tr><th style="text-align:left">Function</th><th style="text-align:left">Description</th></tr></thead><tbody><tr><td style="text-align:left">Rollouts and Rollbacks</td><td style="text-align:left">Deployment controller takes care of rolling out new versions of your application and rolling back to the previous version in case of failure.</td></tr><tr><td style="text-align:left">Cluster maintenance</td><td style="text-align:left">Node controller watches the nodes in the cluster and makes sure that the nodes are in the desired state.</td></tr><tr><td style="text-align:left">Event handling</td><td style="text-align:left">Event controller watches for events and takes action based on the events.</td></tr><tr><td style="text-align:left">Schedule</td><td style="text-align:left">Controller to run jobs and cron jobs at a specific time.</td></tr><tr><td style="text-align:left">Resource enforcement</td><td style="text-align:left">Resource controller watches the resource usage and enforces resource limits in a namespace.</td></tr><tr><td style="text-align:left">State enforcement</td><td style="text-align:left">Different controllers watch the state of the resources and enforce the desired state.</td></tr></tbody></table><p>As you can see, controllers automate the routine operational tasks, enforce policies, handle failures and take actions to continuously maintain the desired state of the cluster.</p><p>Some of the typical use cases for controllers are:</p><ul><li><strong>Limit resource usage</strong> - Prevent the overload of the cluster by enforcing resource limits with controllers like ResourceQuota.</li><li><strong>Auto-scaling</strong> - Automatically scales the number of pods based on the different metrics with HorizontalPodAutoscaler.</li><li><strong>Task scheduling</strong> - Run jobs and cron jobs at a specific time with Job and CronJob controllers.</li><li><strong>Run stateful workloads</strong> - Deploy and manage stateful workloads like databases with StatefulSet controller, by ensuring that the pods are created in a specific order and have a stable network identity.</li><li><strong>Scaling deployments</strong> - Deploy and manage stateless workloads like web applications with the Deployment controller, by ensuring that the desired number of pods is running and handling the rolling updates and rollbacks.</li></ul><p>Controllers, as you see, reduce the manual effort for the platform engineering teams and gives the cluster self-managing
capabilities.</p><p>With all the above points, the benefits of controllers are clear - Let me list some of the main ones:</p><ul><li><strong>Automation</strong> - Controllers automate the routine operational tasks and enforce policies.</li><li><strong>Availability</strong> - Controllers ensure that the resources are always available, addressing failures and taking actions to maintain the desired state.</li><li><strong>Efficiency</strong> - Controllers provide an efficient way to manage the resources and workloads in the cluster with quota management and auto-scaling.</li><li><strong>Reliablity</strong> - Controllers help to make workload management more reliable with features like replica management, <a href="/registry/packages/kubernetes/api-docs/core/v1/pod/">pod</a> creation and deletion, and scheduling.</li><li><strong>Flexibility</strong> - Controllers provide a flexible way to handle a variety of workloads and resources in the cluster, such as <a href="/registry/packages/kubernetes/api-docs/apps/v1/daemonset/">DaemonSet</a>, <a href="/registry/packages/kubernetes/api-docs/apps/v1/statefulset/">StatefulSet</a>, <a href="/registry/packages/kubernetes/api-docs/batch/v1/job/">jobs</a>, <a href="/registry/packages/kubernetes/api-docs/batch/v1/cronjob/">cron jobs</a>, <a href="/registry/packages/kubernetes/api-docs/apps/v1/deployment/">deployments</a>, and <a href="/registry/packages/kubernetes/api-docs/core/v1/service/">services</a>.</li><li><strong>Observability</strong> - Controllers provide a view into the cluster resources and the state of the resources via the <a href="/blog/yaml-terraform-pulumi-whats-the-smart-choice-for-deployment-automation-with-kubernetes/#kubernetes-components-and-the-kubernetes-api">Kubernetes API</a>.</li></ul><p>With Controllers explained, let&rsquo;s move on to the next level of automation in Kubernetes and talk about Kubernetes Operators.</p><h2 id="kubernetes-operators">Kubernetes Operators</h2><p>As mentioned before, Kubernetes Operators are a subcategory of controllers that use API extensions (Custom Resource) to complete the automation task. Operators are a set of independent controllers, with each controller responsible for its own task. And while controllers can share similar functions with a controller, it is only focused on one domain and only uses Custom Resources to manage the domain.</p><blockquote><p>Keep in mind that controllers work without the need for custom resources or a link to a specific domain.</p></blockquote><p>Operators are custom-built controllers that focus on the deployment, management, and operation of a specific application or service. Some key functions of operators include:</p><table><thead><tr><th style="text-align:left">Function</th><th style="text-align:left">Description</th></tr></thead><tbody><tr><td style="text-align:left">Security</td><td style="text-align:left">Operators integrate security best practices and policies, such as encryption, access control, and <a href="/what-is/what-is-secrets-management/">secret management</a>, to protect the application. You can customise these measures and adjust them to the specific needs of the application.</td></tr><tr><td style="text-align:left">Workload Lifecycle management</td><td style="text-align:left">Operators manages the full lifecycle of complex stateful applications through deployment, upgrades, and scaling. It even applies logic to automate operations like backup and restore.</td></tr><tr><td style="text-align:left">Error Handling</td><td style="text-align:left">Operators detects and handles errors, such as application crashes, network failures, and resource constraints.</td></tr><tr><td style="text-align:left">Migration</td><td style="text-align:left">Operators help to migrate the application to a new version, a new cluster, or a new cloud provider.</td></tr><tr><td style="text-align:left">Disaster Recovery</td><td style="text-align:left">Operators help to recover the application from a disaster, such as data loss, network failure, or hardware failure.</td></tr></tbody></table><p>Operators are a great way to encode the operational knowledge of the platform engineering team into automated controllers. This way, the platform engineering team can focus on the strategic tasks and let the operators handle the boring routine operational tasks. This reduces the manual effort and increases the reliability of the platform.</p><p>Some of the typical use cases for operators are:</p><ul><li><strong>Database management</strong> - Deploy and manage databases such as MySQL, PostgreSQL, and MongoDB.</li><li><strong>Storage management</strong> - Deploy and manage storage such as Ceph, GlusterFS, or NFS.</li><li><strong>Logging and monitoring</strong> - Simplify the deployment and management of logging and monitoring solutions like Prometheus, Grafana, or ELK stack.</li><li><strong>CI/CD</strong> - Automate the deployment and management of CI/CD pipelines like Jenkins, GitLab, or Tekton. - Backup and restore - Automate the backup and restore of applications and data.</li><li><strong>Messaging and event streaming</strong> - Simplify the deployment and management of messaging and event streaming solutions like Kafka, RabbitMQ, or NATS.</li><li><strong>Machine learning</strong> - Automate the deployment and management of machine learning workloads such as TensorFlow, PyTorch, or Kubeflow.</li></ul><p>With the applications-centric approach provided by operators, the platform engineering team can now enable fully automated operations while enhancing the reliability, efficiency, and observability of the platform and ensuring adherence to best practices and compliance requirements.</p><p>And similar to controllers, operators also have distinct benefits:</p><ul><li><strong>Simplification</strong> - Operators simplify the deployment and management of complex applications and services by providing a declarative way (via Custom Resources).</li><li><strong>Higher Productivity</strong> - Operators increase the productivity of the platform engineering team by automating the routine operational tasks and allowing users to focus on delivering business value.</li><li><strong>Extensibility</strong> - Extending the K8s API with Custom Resource Definitions (CRDs) allows administrators to support new applications and services without changing the core Kubernetes code.</li><li><strong>Consistency</strong> - Operators ensure that they deploy and run the applications and services consistently across different environments, such as on-premises, cloud, or hybrid.</li><li><strong>Modularity</strong> - Operators are modular and focused on a specific domain.</li><li><strong>Legacy</strong> Transformation - Operators help to transform legacy applications into cloud-native applications by automating the deployment and management of complex applications.</li></ul><p>Here is a visual representation of a Kubernetes Operator in action, which I found very nice and helpful:</p><figure><img src="/blog/why-every-platform-engineer-should-care-about-kubernetes-operators/operator.png" alt="Kubernetes Operators: what are they? Some examples Credit: SparkFabrik" width="100%"><figcaption><p>Kubernetes Operators: what are they? Some examples Credit: SparkFabrik</p></figcaption></figure><h2 id="comparison-of-kubernetes-controllers-and-operators">Comparison of Kubernetes Controllers and Operators</h2><p>Here is a quick summary of the differences between Kubernetes controllers and operators:</p><table><thead><tr><th style="text-align:left"><strong>Feature</strong></th><th style="text-align:left"><strong>Kubernetes Controllers</strong></th><th style="text-align:left"><strong>Kubernetes Operators</strong></th></tr></thead><tbody><tr><td style="text-align:left"><strong>Definition</strong></td><td style="text-align:left">Core control loops within Kubernetes that reconcile the current state with the desired state of resources.</td><td style="text-align:left">Custom-built controllers with domain-specific logic, typically extending Kubernetes API with Custom Resource Definitions (CRDs).</td></tr><tr><td style="text-align:left"><strong>Scope</strong></td><td style="text-align:left">General-purpose automation for cluster-wide resource management and workload operations.</td><td style="text-align:left">Focused on application or service-specific lifecycle management and operations.</td></tr><tr><td style="text-align:left"><strong>Custom Resources (CRDs)</strong></td><td style="text-align:left">Not mandatory. Most controllers work with built-in Kubernetes resources like Pods, Deployments, and StatefulSets.</td><td style="text-align:left">Mandatory. Operators depend on CRDs to define and manage application-specific resources.</td></tr><tr><td style="text-align:left"><strong>Domain-Specific Logic</strong></td><td style="text-align:left">Limited. Primarily focuses on generic Kubernetes operations like scheduling, scaling, and resource enforcement.</td><td style="text-align:left">Extensive. Includes application-specific tasks such as backups, upgrades, migrations, and disaster recovery.</td></tr><tr><td style="text-align:left"><strong>Automation</strong></td><td style="text-align:left">Automates operational tasks like resource scheduling, scaling, and maintaining cluster states.</td><td style="text-align:left">Automates both operational and domain-specific tasks, often encoding deep operational knowledge of specific applications.</td></tr><tr><td style="text-align:left"><strong>Complexity</strong></td><td style="text-align:left">Relatively low complexity as they focus on Kubernetes-native workflows.</td><td style="text-align:left">Higher complexity due to domain-specific implementations and integrations with external systems.</td></tr><tr><td style="text-align:left"><strong>Observability</strong></td><td style="text-align:left">Provides insight into cluster resource states via Kubernetes API and built-in events.</td><td style="text-align:left">Enhances observability with application-specific metrics, logs, and health checks tailored to the managed application.</td></tr><tr><td style="text-align:left"><strong>Use Cases</strong></td><td style="text-align:left">- Pod scaling (e.g., HPA)<br>- Resource enforcement (e.g., ResourceQuota)<br>- Rolling updates and rollbacks<br>- Scheduling jobs (e.g., CronJob).</td><td style="text-align:left">- Database management (e.g., MySQL Operator)<br>- CI/CD pipelines (e.g., Tekton)<br>- Backup and restore<br>- Monitoring solutions (e.g., Prometheus Operator)<br>- Stateful applications (e.g., Kafka Operator).</td></tr><tr><td style="text-align:left"><strong>Deployment</strong></td><td style="text-align:left">Part of Kubernetes core components or extensions like kube-controller-manager.</td><td style="text-align:left">External tools developed by vendors, community, or in-house, deployed using Custom Resources.</td></tr><tr><td style="text-align:left"><strong>Key Benefits</strong></td><td style="text-align:left">- Cluster-wide automation<br>- Ensures resource availability<br>- Efficient and reliable workload management.</td><td style="text-align:left">- Simplifies application lifecycle management<br>- Increases productivity with domain-specific automation<br>- Consistent deployments across environments.</td></tr><tr><td style="text-align:left"><strong>Flexibility</strong></td><td style="text-align:left">Flexible for general Kubernetes operations but limited to built-in resources.</td><td style="text-align:left">Highly flexible and extensible for custom applications and domain-specific requirements.</td></tr><tr><td style="text-align:left"><strong>Target Audience</strong></td><td style="text-align:left">Platform administrators and Kubernetes users looking to automate Kubernetes-native workflows.</td><td style="text-align:left">Developers and platform engineers needing advanced automation and lifecycle management for specific applications or services.</td></tr><tr><td style="text-align:left"><strong>Maintenance</strong></td><td style="text-align:left">Managed and updated by Kubernetes core or community projects.</td><td style="text-align:left">Requires domain-specific knowledge and regular updates to accommodate application changes and best practices.</td></tr></tbody></table><p>With this detailed explanation of Kubernetes controllers and operators, I would like to share some advanced Kubernetes operators that I recommend for use in your Kubernetes-powered platform.</p><h2 id="advanced-kubernetes-operators">Advanced Kubernetes Operators</h2><p>As we have seen, Kubernetes Operators are the go-to way to automate operational tasks and lifecycle management. I should mention that not all operators are created equal. Some operators are more advanced and provide more features than others. That is why, for example, <a href="https://operatorhub.io/">OperatorHub.io</a> categorises operators into <a href="https://sdk.operatorframework.io/docs/overview/operator-capabilities/">five capability levels</a>:</p><ul><li><strong>Basic Install</strong> - Installs the application on the cluster.</li><li><strong>Seamless Upgrades</strong> - Manages Application upgrades.</li><li><strong>Full Lifecycle Management</strong> - Manages the full lifecycle of the application.</li><li><strong>Deep Insights</strong> - Provides monitoring and metrics.</li><li><strong>Auto Pilot</strong> - Automatically optimizes and tunes the application.</li></ul><p>The more advanced the operator, the more features it provides and the more automation it offers. At its most advanced level, the Auto Pilot, the operator automatically optimizes and tunes the application based on the workload and environment.</p><p>Here is a list of advanced Kubernetes operators that I recommend using in your Kubernetes-powered platform:</p><h3 id="cloudnativepg-operator">CloudNativePG Operator</h3><figure><img src="/blog/why-every-platform-engineer-should-care-about-kubernetes-operators/cloudnativepg.png" alt="CloudNativePG Operator Credit: cloudnative-pg.io" width="100%"><figcaption><p>CloudNativePG Operator Credit: cloudnative-pg.io</p></figcaption></figure><p><a href="https://cloudnative-pg.io/">CloudNativePG Operator</a> is a PostgreSQL operator that covers the full lifecycle of PostgreSQL databases on Kubernetes. It simplifies the deployment, management, and scaling of PostgreSQL databases by providing a declarative way to define and manage PostgreSQL clusters using custom resources.</p><p>Some of the key features of CloudNativePG Operator are:</p><ul><li><strong>Automated Backups</strong> - Schedule and manage backups of PostgreSQL databases.</li><li><strong>High Availability</strong> - Deploy and manage high-availability PostgreSQL clusters.</li><li><strong>Scaling</strong> - Scale the number of PostgreSQL instances based on the workload.</li></ul><h4 id="installation">Installation</h4><p>Either use the Helm chart or the Kubernetes manifests to deploy the CloudNativePG Operator:</p><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">helm repo add cloudnative-pg https://cloudnative-pg.io/charts/
</span></span><span class="line"><span class="cl">helm repo update
</span></span><span class="line"><span class="cl">helm upgrade --install cloudnativepg cloudnative-pg/cloudnative-pg --namespace cnpg-system --create-namespace
</span></span></code></pre></div><p>Or use Pulumi to deploy the CloudNativePG Operator:</p><div><pulumi-chooser type="language" options="typescript,javascript,python,go,csharp" mode></pulumi-chooser></div><div><pulumi-choosable type="language" values="typescript" mode><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-typescript" data-lang="typescript"><span class="line"><span class="cl"><span class="kr">import</span> <span class="o">*</span> <span class="kr">as</span> <span class="nx">k8s</span> <span class="kr">from</span> <span class="s2">&#34;@pulumi/kubernetes&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="o">*</span> <span class="kr">as</span> <span class="nx">k8shelm</span> <span class="kr">from</span> <span class="s2">&#34;@pulumi/kubernetes/helm/v3&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">ns</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">k8s</span><span class="p">.</span><span class="nx">core</span><span class="p">.</span><span class="nx">v1</span><span class="p">.</span><span class="nx">Namespace</span><span class="p">(</span><span class="s2">&#34;cnpg-system&#34;</span><span class="p">,</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">metadata</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">name</span><span class="o">:</span> <span class="s2">&#34;cnpg-system&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl"><span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">new</span> <span class="nx">k8shelm</span><span class="p">.</span><span class="nx">Release</span><span class="p">(</span><span class="s2">&#34;cloudnativepg&#34;</span><span class="p">,</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">chart</span><span class="o">:</span> <span class="s2">&#34;cloudnative-pg/cloudnative-pg&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="kr">namespace</span><span class="o">:</span> <span class="nx">ns</span><span class="p">.</span><span class="nx">metadata</span><span class="p">.</span><span class="nx">name</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">createNamespace</span>: <span class="kt">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="p">});</span>
</span></span></code></pre></div></pulumi-choosable></div><div><pulumi-choosable type="language" values="javascript" mode><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="s2">&#34;use strict&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">k8s</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&#34;@pulumi/kubernetes&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">k8shelm</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&#34;@pulumi/kubernetes/helm/v3&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">ns</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">k8s</span><span class="p">.</span><span class="nx">core</span><span class="p">.</span><span class="nx">v1</span><span class="p">.</span><span class="nx">Namespace</span><span class="p">(</span><span class="s2">&#34;cnpg-system&#34;</span><span class="p">,</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">metadata</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">name</span><span class="o">:</span> <span class="s2">&#34;cnpg-system&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl"><span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">new</span> <span class="nx">k8shelm</span><span class="p">.</span><span class="nx">Release</span><span class="p">(</span><span class="s2">&#34;cloudnativepg&#34;</span><span class="p">,</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">chart</span><span class="o">:</span> <span class="s2">&#34;cloudnative-pg/cloudnative-pg&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">namespace</span><span class="o">:</span> <span class="nx">ns</span><span class="p">.</span><span class="nx">metadata</span><span class="p">.</span><span class="nx">name</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">createNamespace</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="p">});</span>
</span></span></code></pre></div></pulumi-choosable></div><div><pulumi-choosable type="language" values="python" mode><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">pulumi_kubernetes</span> <span class="k">as</span> <span class="nn">k8s</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">pulumi_kubernetes.helm.v3</span> <span class="k">as</span> <span class="nn">k8shelm</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">pulumi_kubernetes.meta.v1</span> <span class="k">as</span> <span class="nn">meta</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ns</span> <span class="o">=</span> <span class="n">k8s</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">v1</span><span class="o">.</span><span class="n">Namespace</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;cnpg-system&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">meta</span><span class="o">.</span><span class="n">ObjectMetaArgs</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">name</span><span class="o">=</span><span class="s2">&#34;cnpg-system&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">),</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">release</span> <span class="o">=</span> <span class="n">k8shelm</span><span class="o">.</span><span class="n">Release</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;cloudnativepg&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">chart</span><span class="o">=</span><span class="s2">&#34;cloudnative-pg/cloudnative-pg&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">namespace</span><span class="o">=</span><span class="n">ns</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&#34;name&#34;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="n">create_namespace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span></code></pre></div></pulumi-choosable></div><div><pulumi-choosable type="language" values="go" mode><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="kn">package</span> <span class="nx">main</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">	<span class="nx">k8s</span> <span class="s">&#34;github.com/pulumi/pulumi-kubernetes/sdk/v4/go/kubernetes&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="nx">apiv1</span> <span class="s">&#34;github.com/pulumi/pulumi-kubernetes/sdk/v4/go/kubernetes/apiextensions&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="nx">corev1</span> <span class="s">&#34;github.com/pulumi/pulumi-kubernetes/sdk/v4/go/kubernetes/core/v1&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="nx">helmv3</span> <span class="s">&#34;github.com/pulumi/pulumi-kubernetes/sdk/v4/go/kubernetes/helm/v3&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="nx">metav1</span> <span class="s">&#34;github.com/pulumi/pulumi-kubernetes/sdk/v4/go/kubernetes/meta/v1&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="s">&#34;github.com/pulumi/pulumi/sdk/v3/go/pulumi&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">pulumi</span><span class="p">.</span><span class="nf">Run</span><span class="p">(</span><span class="kd">func</span><span class="p">(</span><span class="nx">ctx</span> <span class="o">*</span><span class="nx">pulumi</span><span class="p">.</span><span class="nx">Context</span><span class="p">)</span> <span class="kt">error</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="nx">ns</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">corev1</span><span class="p">.</span><span class="nf">NewNamespace</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span> <span class="s">&#34;cnpg-system&#34;</span><span class="p">,</span> <span class="o">&amp;</span><span class="nx">corev1</span><span class="p">.</span><span class="nx">NamespaceArgs</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="nx">Metadata</span><span class="p">:</span> <span class="o">&amp;</span><span class="nx">metav1</span><span class="p">.</span><span class="nx">ObjectMetaArgs</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="nx">Name</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;cnpg-system&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">			<span class="p">},</span>
</span></span><span class="line"><span class="cl">		<span class="p">})</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="k">return</span> <span class="nx">err</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="nx">_</span><span class="p">,</span> <span class="nx">err</span> <span class="p">=</span> <span class="nx">helmv3</span><span class="p">.</span><span class="nf">NewRelease</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span> <span class="s">&#34;cloudnativepg&#34;</span><span class="p">,</span> <span class="o">&amp;</span><span class="nx">helmv3</span><span class="p">.</span><span class="nx">ReleaseArgs</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="nx">Chart</span><span class="p">:</span>           <span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;cloudnative-pg/cloudnative-pg&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">			<span class="nx">Namespace</span><span class="p">:</span>       <span class="nx">ns</span><span class="p">.</span><span class="nx">Metadata</span><span class="p">.</span><span class="nf">Name</span><span class="p">().</span><span class="nf">Elem</span><span class="p">(),</span>
</span></span><span class="line"><span class="cl">			<span class="nx">CreateNamespace</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nf">Bool</span><span class="p">(</span><span class="kc">true</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">		<span class="p">})</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="k">return</span> <span class="nx">err</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="k">return</span> <span class="kc">nil</span>
</span></span><span class="line"><span class="cl">	<span class="p">})</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div></pulumi-choosable></div><div><pulumi-choosable type="language" values="csharp" mode><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-csharp" data-lang="csharp"><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">System.Threading.Tasks</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Pulumi</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Pulumi.Kubernetes.Core.V1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Pulumi.Kubernetes.Helm.V3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Pulumi.Kubernetes.Types.Inputs.Core.V1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Pulumi.Kubernetes.Types.Inputs.Helm.V3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Pulumi.Kubernetes.Types.Inputs.Meta.V1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">System.Collections.Generic</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Pulumi.Kubernetes.ApiExtensions</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">MyStack</span> <span class="p">:</span> <span class="n">Stack</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">MyStack</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kt">var</span> <span class="n">ns</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Namespace</span><span class="p">(</span><span class="s">&#34;cnpg-system&#34;</span><span class="p">,</span> <span class="k">new</span> <span class="n">NamespaceArgs</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">Metadata</span> <span class="p">=</span> <span class="k">new</span> <span class="n">ObjectMetaArgs</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">Name</span> <span class="p">=</span> <span class="s">&#34;cnpg-system&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="kt">var</span> <span class="n">release</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Release</span><span class="p">(</span><span class="s">&#34;cloudnativepg&#34;</span><span class="p">,</span> <span class="k">new</span> <span class="n">ReleaseArgs</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">Chart</span> <span class="p">=</span> <span class="s">&#34;cloudnative-pg/cloudnative-pg&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">Namespace</span> <span class="p">=</span> <span class="n">ns</span><span class="p">.</span><span class="n">Metadata</span><span class="p">.</span><span class="n">Apply</span><span class="p">(</span><span class="n">m</span> <span class="p">=&gt;</span> <span class="n">m</span><span class="p">.</span><span class="n">Name</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="n">CreateNamespace</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">        <span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Program</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">static</span> <span class="n">Task</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;</span> <span class="n">Main</span><span class="p">()</span> <span class="p">=&gt;</span> <span class="n">Deployment</span><span class="p">.</span><span class="n">RunAsync</span><span class="p">&lt;</span><span class="n">MyStack</span><span class="p">&gt;();</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div></pulumi-choosable></div><h4 id="usage">Usage</h4><p>Here is a simple example of a PostgreSQL cluster with backup configured on S3 API-compatible storage:</p><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">postgresql.cnpg.io/v1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">Cluster</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">cluster-example-with-backup</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">instances</span><span class="p">:</span><span class="w"> </span><span class="m">3</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">primaryUpdateStrategy</span><span class="p">:</span><span class="w"> </span><span class="l">unsupervised</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c"># Persistent storage configuration</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">storage</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">storageClass</span><span class="p">:</span><span class="w"> </span><span class="l">standard</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">size</span><span class="p">:</span><span class="w"> </span><span class="l">1Gi</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c"># Backup properties</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c"># This assumes a local minio setup</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">backup</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">barmanObjectStore</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">destinationPath</span><span class="p">:</span><span class="w"> </span><span class="l">s3://backups/</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">endpointURL</span><span class="p">:</span><span class="w"> </span><span class="l">http://minio:9000</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">s3Credentials</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">accessKeyId</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">minio</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l">ACCESS_KEY_ID</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">secretAccessKey</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">minio</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l">ACCESS_SECRET_KEY</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">wal</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">compression</span><span class="p">:</span><span class="w"> </span><span class="l">gzip</span><span class="w">
</span></span></span></code></pre></div><p>Or use Pulumi:</p><div><pulumi-chooser type="language" options="typescript,javascript,python,go,csharp" mode></pulumi-chooser></div><div><pulumi-choosable type="language" values="typescript" mode><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-typescript" data-lang="typescript"><span class="line"><span class="cl"><span class="k">new</span> <span class="nx">k8s</span><span class="p">.</span><span class="nx">apiextensions</span><span class="p">.</span><span class="nx">CustomResource</span><span class="p">(</span><span class="s2">&#34;cluster-example-with-backup&#34;</span><span class="p">,</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">apiVersion</span><span class="o">:</span> <span class="s2">&#34;postgresql.cnpg.io/v1&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">kind</span><span class="o">:</span> <span class="s2">&#34;Cluster&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">metadata</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">name</span><span class="o">:</span> <span class="s2">&#34;cluster-example-with-backup&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="nx">spec</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">instances</span>: <span class="kt">3</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nx">primaryUpdateStrategy</span><span class="o">:</span> <span class="s2">&#34;unsupervised&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// Persistent storage configuration
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nx">storage</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nx">storageClass</span><span class="o">:</span> <span class="s2">&#34;standard&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nx">size</span><span class="o">:</span> <span class="s2">&#34;1Gi&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// Backup properties
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nx">backup</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nx">barmanObjectStore</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nx">destinationPath</span><span class="o">:</span> <span class="s2">&#34;s3://backups/&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nx">endpointURL</span><span class="o">:</span> <span class="s2">&#34;http://minio:9000&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nx">s3Credentials</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nx">accessKeyId</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nx">name</span><span class="o">:</span> <span class="s2">&#34;minio&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nx">key</span><span class="o">:</span> <span class="s2">&#34;ACCESS_KEY_ID&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="p">},</span>
</span></span><span class="line"><span class="cl">                    <span class="nx">secretAccessKey</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nx">name</span><span class="o">:</span> <span class="s2">&#34;minio&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nx">key</span><span class="o">:</span> <span class="s2">&#34;ACCESS_SECRET_KEY&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="nx">wal</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nx">compression</span><span class="o">:</span> <span class="s2">&#34;gzip&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl"><span class="p">});</span>
</span></span></code></pre></div></pulumi-choosable></div><div><pulumi-choosable type="language" values="javascript" mode><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="k">new</span> <span class="nx">k8s</span><span class="p">.</span><span class="nx">apiextensions</span><span class="p">.</span><span class="nx">CustomResource</span><span class="p">(</span><span class="s2">&#34;cluster-example-with-backup&#34;</span><span class="p">,</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">apiVersion</span><span class="o">:</span> <span class="s2">&#34;postgresql.cnpg.io/v1&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">kind</span><span class="o">:</span> <span class="s2">&#34;Cluster&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">metadata</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">name</span><span class="o">:</span> <span class="s2">&#34;cluster-example-with-backup&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="nx">spec</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">instances</span><span class="o">:</span> <span class="mi">3</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nx">primaryUpdateStrategy</span><span class="o">:</span> <span class="s2">&#34;unsupervised&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// Persistent storage configuration
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nx">storage</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nx">storageClass</span><span class="o">:</span> <span class="s2">&#34;standard&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nx">size</span><span class="o">:</span> <span class="s2">&#34;1Gi&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// Backup properties
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nx">backup</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nx">barmanObjectStore</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nx">destinationPath</span><span class="o">:</span> <span class="s2">&#34;s3://backups/&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nx">endpointURL</span><span class="o">:</span> <span class="s2">&#34;http://minio:9000&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nx">s3Credentials</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nx">accessKeyId</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nx">name</span><span class="o">:</span> <span class="s2">&#34;minio&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nx">key</span><span class="o">:</span> <span class="s2">&#34;ACCESS_KEY_ID&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="p">},</span>
</span></span><span class="line"><span class="cl">                    <span class="nx">secretAccessKey</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nx">name</span><span class="o">:</span> <span class="s2">&#34;minio&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nx">key</span><span class="o">:</span> <span class="s2">&#34;ACCESS_SECRET_KEY&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="nx">wal</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nx">compression</span><span class="o">:</span> <span class="s2">&#34;gzip&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl"><span class="p">});</span>
</span></span></code></pre></div></pulumi-choosable></div><div><pulumi-choosable type="language" values="python" mode><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pulumi_kubernetes</span> <span class="kn">import</span> <span class="n">apiextensions</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">postgresql_cluster</span> <span class="o">=</span> <span class="n">apiextensions</span><span class="o">.</span><span class="n">CustomResource</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;cluster-example-with-backup&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">api_version</span><span class="o">=</span><span class="s2">&#34;postgresql.cnpg.io/v1&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">kind</span><span class="o">=</span><span class="s2">&#34;Cluster&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">metadata</span><span class="o">=</span><span class="n">meta</span><span class="o">.</span><span class="n">ObjectMetaArgs</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">name</span><span class="o">=</span><span class="s2">&#34;cluster-example-with-backup&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="n">spec</span><span class="o">=</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;instances&#34;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;primaryUpdateStrategy&#34;</span><span class="p">:</span> <span class="s2">&#34;unsupervised&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># Persistent storage configuration</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;storage&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;storageClass&#34;</span><span class="p">:</span> <span class="s2">&#34;standard&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;size&#34;</span><span class="p">:</span> <span class="s2">&#34;1Gi&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># Backup properties</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;backup&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;barmanObjectStore&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;destinationPath&#34;</span><span class="p">:</span> <span class="s2">&#34;s3://backups/&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;endpointURL&#34;</span><span class="p">:</span> <span class="s2">&#34;http://minio:9000&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;s3Credentials&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;accessKeyId&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="s2">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;minio&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="s2">&#34;key&#34;</span><span class="p">:</span> <span class="s2">&#34;ACCESS_KEY_ID&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="p">},</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;secretAccessKey&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="s2">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;minio&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="s2">&#34;key&#34;</span><span class="p">:</span> <span class="s2">&#34;ACCESS_SECRET_KEY&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;wal&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;compression&#34;</span><span class="p">:</span> <span class="s2">&#34;gzip&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span></code></pre></div></pulumi-choosable></div><div><pulumi-choosable type="language" values="go" mode><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="kn">package</span> <span class="nx">main</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">	<span class="nx">k8s</span> <span class="s">&#34;github.com/pulumi/pulumi-kubernetes/sdk/v4/go/kubernetes&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="nx">apiv1</span> <span class="s">&#34;github.com/pulumi/pulumi-kubernetes/sdk/v4/go/kubernetes/apiextensions&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="nx">corev1</span> <span class="s">&#34;github.com/pulumi/pulumi-kubernetes/sdk/v4/go/kubernetes/core/v1&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="nx">helmv3</span> <span class="s">&#34;github.com/pulumi/pulumi-kubernetes/sdk/v4/go/kubernetes/helm/v3&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="nx">metav1</span> <span class="s">&#34;github.com/pulumi/pulumi-kubernetes/sdk/v4/go/kubernetes/meta/v1&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="s">&#34;github.com/pulumi/pulumi/sdk/v3/go/pulumi&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">pulumi</span><span class="p">.</span><span class="nf">Run</span><span class="p">(</span><span class="kd">func</span><span class="p">(</span><span class="nx">ctx</span> <span class="o">*</span><span class="nx">pulumi</span><span class="p">.</span><span class="nx">Context</span><span class="p">)</span> <span class="kt">error</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="nx">_</span><span class="p">,</span> <span class="nx">err</span> <span class="p">=</span> <span class="nx">apiv1</span><span class="p">.</span><span class="nf">NewCustomResource</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span> <span class="s">&#34;cluster-example-with-backup&#34;</span><span class="p">,</span> <span class="o">&amp;</span><span class="nx">apiv1</span><span class="p">.</span><span class="nx">CustomResourceArgs</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="nx">ApiVersion</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;postgresql.cnpg.io/v1&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">			<span class="nx">Kind</span><span class="p">:</span>       <span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;Cluster&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">			<span class="nx">Metadata</span><span class="p">:</span> <span class="o">&amp;</span><span class="nx">metav1</span><span class="p">.</span><span class="nx">ObjectMetaArgs</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="nx">Name</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;cluster-example-with-backup&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">			<span class="p">},</span>
</span></span><span class="line"><span class="cl">			<span class="nx">OtherFields</span><span class="p">:</span> <span class="nx">k8s</span><span class="p">.</span><span class="nx">UntypedArgs</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="s">&#34;instances&#34;</span><span class="p">:</span>             <span class="nx">pulumi</span><span class="p">.</span><span class="nf">Int</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">				<span class="s">&#34;primaryUpdateStrategy&#34;</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;unsupervised&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">				<span class="s">&#34;storage&#34;</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nx">Map</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">					<span class="s">&#34;storageClass&#34;</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;standard&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">					<span class="s">&#34;size&#34;</span><span class="p">:</span>         <span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;1Gi&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">				<span class="p">},</span>
</span></span><span class="line"><span class="cl">				<span class="s">&#34;backup&#34;</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nx">Map</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">					<span class="s">&#34;barmanObjectStore&#34;</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nx">Map</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">						<span class="s">&#34;destinationPath&#34;</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;s3://backups/&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">						<span class="s">&#34;endpointURL&#34;</span><span class="p">:</span>     <span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;http://minio:9000&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">						<span class="s">&#34;s3Credentials&#34;</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nx">Map</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">							<span class="s">&#34;accessKeyId&#34;</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nx">Map</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">								<span class="s">&#34;name&#34;</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;minio&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">								<span class="s">&#34;key&#34;</span><span class="p">:</span>  <span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;ACCESS_KEY_ID&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">							<span class="p">},</span>
</span></span><span class="line"><span class="cl">							<span class="s">&#34;secretAccessKey&#34;</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nx">Map</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">								<span class="s">&#34;name&#34;</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;minio&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">								<span class="s">&#34;key&#34;</span><span class="p">:</span>  <span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;ACCESS_SECRET_KEY&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">							<span class="p">},</span>
</span></span><span class="line"><span class="cl">						<span class="p">},</span>
</span></span><span class="line"><span class="cl">						<span class="s">&#34;wal&#34;</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nx">Map</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">							<span class="s">&#34;compression&#34;</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;gzip&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">						<span class="p">},</span>
</span></span><span class="line"><span class="cl">					<span class="p">},</span>
</span></span><span class="line"><span class="cl">				<span class="p">},</span>
</span></span><span class="line"><span class="cl">			<span class="p">},</span>
</span></span><span class="line"><span class="cl">		<span class="p">})</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="k">return</span> <span class="nx">err</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="k">return</span> <span class="kc">nil</span>
</span></span><span class="line"><span class="cl">	<span class="p">})</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div></pulumi-choosable></div><div><pulumi-choosable type="language" values="csharp" mode><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-csharp" data-lang="csharp"><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">System.Threading.Tasks</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Pulumi</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Pulumi.Kubernetes.Core.V1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Pulumi.Kubernetes.Helm.V3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Pulumi.Kubernetes.Types.Inputs.Core.V1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Pulumi.Kubernetes.Types.Inputs.Helm.V3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Pulumi.Kubernetes.Types.Inputs.Meta.V1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">System.Collections.Generic</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Pulumi.Kubernetes.ApiExtensions</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">PostGreSQLClusterArgs</span> <span class="p">:</span> <span class="n">CustomResourceArgs</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="na">    [Input(&#34;postgresql.cnpg.io/v1&#34;)]</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">Input</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span> <span class="n">ApiVersion</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="na">    [Input(&#34;Cluster&#34;)]</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">Input</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span> <span class="n">Kind</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">ObjectMetaArgs</span> <span class="n">Metadata</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">object</span><span class="p">&gt;</span> <span class="n">Others</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="na">    [Input(&#34;spec&#34;)]</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">InputMap</span><span class="p">&lt;</span><span class="kt">object</span><span class="p">&gt;</span> <span class="n">Spec</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">PostGreSQLClusterArgs</span><span class="p">(</span><span class="kt">string</span> <span class="n">apiVersion</span><span class="p">,</span> <span class="kt">string</span> <span class="n">kind</span><span class="p">)</span> <span class="p">:</span> <span class="k">base</span><span class="p">(</span><span class="n">apiVersion</span><span class="p">,</span> <span class="n">kind</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">MyStack</span> <span class="p">:</span> <span class="n">Stack</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">MyStack</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kt">var</span> <span class="n">postgresqlCluster</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Pulumi</span><span class="p">.</span><span class="n">Kubernetes</span><span class="p">.</span><span class="n">ApiExtensions</span><span class="p">.</span><span class="n">CustomResource</span><span class="p">(</span><span class="s">&#34;cluster-example-with-backup&#34;</span><span class="p">,</span> <span class="k">new</span> <span class="n">PostGreSQLClusterArgs</span><span class="p">(</span><span class="s">&#34;postgresql.cnpg.io/v1&#34;</span><span class="p">,</span> <span class="s">&#34;Cluster&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">ApiVersion</span> <span class="p">=</span> <span class="s">&#34;postgresql.cnpg.io/v1&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">Kind</span> <span class="p">=</span> <span class="s">&#34;Cluster&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">Metadata</span> <span class="p">=</span> <span class="k">new</span> <span class="n">ObjectMetaArgs</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">Name</span> <span class="p">=</span> <span class="s">&#34;cluster-example-with-backup&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="n">Spec</span> <span class="p">=</span> <span class="k">new</span> <span class="n">InputMap</span><span class="p">&lt;</span><span class="kt">object</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span> <span class="s">&#34;instances&#34;</span><span class="p">,</span> <span class="m">3</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span> <span class="s">&#34;primaryUpdateStrategy&#34;</span><span class="p">,</span> <span class="s">&#34;unsupervised&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span> <span class="s">&#34;storage&#34;</span><span class="p">,</span> <span class="k">new</span> <span class="n">InputMap</span><span class="p">&lt;</span><span class="kt">object</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="p">{</span> <span class="s">&#34;storageClass&#34;</span><span class="p">,</span> <span class="s">&#34;standard&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">                        <span class="p">{</span> <span class="s">&#34;size&#34;</span><span class="p">,</span> <span class="s">&#34;1Gi&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span> <span class="s">&#34;backup&#34;</span><span class="p">,</span> <span class="k">new</span> <span class="n">InputMap</span><span class="p">&lt;</span><span class="kt">object</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="p">{</span> <span class="s">&#34;barmanObjectStore&#34;</span><span class="p">,</span> <span class="k">new</span> <span class="n">InputMap</span><span class="p">&lt;</span><span class="kt">object</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">                            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                                <span class="p">{</span> <span class="s">&#34;destinationPath&#34;</span><span class="p">,</span> <span class="s">&#34;s3://backups/&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">                                <span class="p">{</span> <span class="s">&#34;endpointURL&#34;</span><span class="p">,</span> <span class="s">&#34;http://minio:9000&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">                                <span class="p">{</span> <span class="s">&#34;s3Credentials&#34;</span><span class="p">,</span> <span class="k">new</span> <span class="n">InputMap</span><span class="p">&lt;</span><span class="kt">object</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">                                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                                        <span class="p">{</span> <span class="s">&#34;accessKeyId&#34;</span><span class="p">,</span> <span class="k">new</span> <span class="n">InputMap</span><span class="p">&lt;</span><span class="kt">object</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">                                            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                                                <span class="p">{</span> <span class="s">&#34;name&#34;</span><span class="p">,</span> <span class="s">&#34;minio&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">                                                <span class="p">{</span> <span class="s">&#34;key&#34;</span><span class="p">,</span> <span class="s">&#34;ACCESS_KEY_ID&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">                                            <span class="p">}</span>
</span></span><span class="line"><span class="cl">                                        <span class="p">},</span>
</span></span><span class="line"><span class="cl">                                        <span class="p">{</span> <span class="s">&#34;secretAccessKey&#34;</span><span class="p">,</span> <span class="k">new</span> <span class="n">InputMap</span><span class="p">&lt;</span><span class="kt">object</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">                                            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                                                <span class="p">{</span> <span class="s">&#34;name&#34;</span><span class="p">,</span> <span class="s">&#34;minio&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">                                                <span class="p">{</span> <span class="s">&#34;key&#34;</span><span class="p">,</span> <span class="s">&#34;ACCESS_SECRET_KEY&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">                                            <span class="p">}</span>
</span></span><span class="line"><span class="cl">                                        <span class="p">},</span>
</span></span><span class="line"><span class="cl">                                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                                <span class="p">{</span> <span class="s">&#34;wal&#34;</span><span class="p">,</span> <span class="k">new</span> <span class="n">InputMap</span><span class="p">&lt;</span><span class="kt">object</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">                                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                                        <span class="p">{</span> <span class="s">&#34;compression&#34;</span><span class="p">,</span> <span class="s">&#34;gzip&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">                                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                            <span class="p">}</span>
</span></span><span class="line"><span class="cl">                        <span class="p">},</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">});</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Program</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">static</span> <span class="n">Task</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;</span> <span class="n">Main</span><span class="p">()</span> <span class="p">=&gt;</span> <span class="n">Deployment</span><span class="p">.</span><span class="n">RunAsync</span><span class="p">&lt;</span><span class="n">MyStack</span><span class="p">&gt;();</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div></pulumi-choosable></div><h4 id="summary">Summary</h4><p>CloudNativePG Operator is a great way to deploy and manage PostgreSQL databases on Kubernetes. It simplifies a wide range of tasks, including backups, high availability, and scaling, making it a must-have for PostgreSQL users.</p><h3 id="flux-operator">Flux Operator</h3><figure><img src="/blog/why-every-platform-engineer-should-care-about-kubernetes-operators/flux-operator.png" alt="Flux Operator Credit: fluxcd.control-plane.io/operator" width="100%"><figcaption><p>Flux Operator Credit: fluxcd.control-plane.io/operator</p></figcaption></figure><p>The <a href="https://fluxcd.control-plane.io/operator/">Flux Operator</a> is a full autopilot solution that provides an alternative to the traditional Flux Bootstrap procedure, removing the operational burden of managing Flux across multiple clusters by automating the installation, configuration, and upgrade of Flux fully.</p><p>Some of the key features of Flux Operator are:</p><ul><li><strong>GitOps Deployment</strong> - Automate the deployment of applications and services using GitOps.</li><li><strong>Lifecycle Management</strong> - Manage the full lifecycle of Flux, including upgrades and rollbacks.</li><li><strong>Deep Insights</strong> - Provide deep insights into the state of Flux and the applications deployed with Flux.</li></ul><h4 id="installation-1">Installation</h4><p>Use the Helm chart to deploy the Flux Operator:</p><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">helm upgrade -i flux-operator oci://ghcr.io/controlplaneio-fluxcd/charts/flux-operator --namespace flux-system --create-namespace
</span></span></code></pre></div><p>Or use Pulumi to deploy the Flux Operator:</p><div><pulumi-chooser type="language" options="typescript,javascript,python,go,csharp" mode></pulumi-chooser></div><div><pulumi-choosable type="language" values="typescript" mode><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-typescript" data-lang="typescript"><span class="line"><span class="cl"><span class="kr">import</span> <span class="o">*</span> <span class="kr">as</span> <span class="nx">k8s</span> <span class="kr">from</span> <span class="s2">&#34;@pulumi/kubernetes&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="o">*</span> <span class="kr">as</span> <span class="nx">k8shelm</span> <span class="kr">from</span> <span class="s2">&#34;@pulumi/kubernetes/helm/v3&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="kr">namespace</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">k8s</span><span class="p">.</span><span class="nx">core</span><span class="p">.</span><span class="nx">v1</span><span class="p">.</span><span class="nx">Namespace</span><span class="p">(</span><span class="s2">&#34;flux-system&#34;</span><span class="p">,</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">metadata</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">name</span><span class="o">:</span> <span class="s2">&#34;flux-system&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl"><span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">new</span> <span class="nx">k8s</span><span class="p">.</span><span class="nx">helm</span><span class="p">.</span><span class="nx">v3</span><span class="p">.</span><span class="nx">Release</span><span class="p">(</span><span class="s2">&#34;flux-operator&#34;</span><span class="p">,</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">chart</span><span class="o">:</span> <span class="s2">&#34;flux-operator&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">version</span><span class="o">:</span> <span class="s2">&#34;latest&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="kr">namespace</span><span class="o">:</span> <span class="kr">namespace</span><span class="p">.</span><span class="nx">metadata</span><span class="p">.</span><span class="nx">name</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">repositoryOpts</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">repo</span><span class="o">:</span> <span class="s2">&#34;oci://ghcr.io/controlplaneio-fluxcd/charts&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="nx">createNamespace</span>: <span class="kt">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="p">});</span>
</span></span></code></pre></div></pulumi-choosable></div><div><pulumi-choosable type="language" values="javascript" mode><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="s2">&#34;use strict&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">k8s</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&#34;@pulumi/kubernetes&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">k8shelm</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&#34;@pulumi/kubernetes/helm/v3&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">namespace</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">k8s</span><span class="p">.</span><span class="nx">core</span><span class="p">.</span><span class="nx">v1</span><span class="p">.</span><span class="nx">Namespace</span><span class="p">(</span><span class="s2">&#34;flux-system&#34;</span><span class="p">,</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">metadata</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">name</span><span class="o">:</span> <span class="s2">&#34;flux-system&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl"><span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">new</span> <span class="nx">k8s</span><span class="p">.</span><span class="nx">helm</span><span class="p">.</span><span class="nx">v3</span><span class="p">.</span><span class="nx">Release</span><span class="p">(</span><span class="s2">&#34;flux-operator&#34;</span><span class="p">,</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">chart</span><span class="o">:</span> <span class="s2">&#34;flux-operator&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">version</span><span class="o">:</span> <span class="s2">&#34;latest&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">namespace</span><span class="o">:</span> <span class="nx">namespace</span><span class="p">.</span><span class="nx">metadata</span><span class="p">.</span><span class="nx">name</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">repositoryOpts</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">repo</span><span class="o">:</span> <span class="s2">&#34;oci://ghcr.io/controlplaneio-fluxcd/charts&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="nx">createNamespace</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="p">});</span>
</span></span></code></pre></div></pulumi-choosable></div><div><pulumi-choosable type="language" values="python" mode><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">pulumi_kubernetes</span> <span class="k">as</span> <span class="nn">k8s</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">pulumi_kubernetes.helm.v3</span> <span class="k">as</span> <span class="nn">k8shelm</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">pulumi_kubernetes.meta.v1</span> <span class="k">as</span> <span class="nn">meta</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">namespace</span> <span class="o">=</span> <span class="n">k8s</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">v1</span><span class="o">.</span><span class="n">Namespace</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;flux-system&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">meta</span><span class="o">.</span><span class="n">ObjectMetaArgs</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">name</span><span class="o">=</span><span class="s2">&#34;flux-system&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">),</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">flux_operator</span> <span class="o">=</span> <span class="n">k8shelm</span><span class="o">.</span><span class="n">Release</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;flux-operator&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">chart</span><span class="o">=</span><span class="s2">&#34;flux-operator&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">version</span><span class="o">=</span><span class="s2">&#34;latest&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">namespace</span><span class="o">=</span><span class="n">namespace</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&#34;name&#34;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="n">repository_opts</span><span class="o">=</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;repo&#34;</span><span class="p">:</span> <span class="s2">&#34;oci://ghcr.io/controlplaneio-fluxcd/charts&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="n">create_namespace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span></code></pre></div></pulumi-choosable></div><div><pulumi-choosable type="language" values="go" mode><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="kn">package</span> <span class="nx">main</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">	<span class="nx">k8s</span> <span class="s">&#34;github.com/pulumi/pulumi-kubernetes/sdk/v4/go/kubernetes&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="nx">apiv1</span> <span class="s">&#34;github.com/pulumi/pulumi-kubernetes/sdk/v4/go/kubernetes/apiextensions&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="nx">corev1</span> <span class="s">&#34;github.com/pulumi/pulumi-kubernetes/sdk/v4/go/kubernetes/core/v1&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="nx">helmv3</span> <span class="s">&#34;github.com/pulumi/pulumi-kubernetes/sdk/v4/go/kubernetes/helm/v3&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="nx">metav1</span> <span class="s">&#34;github.com/pulumi/pulumi-kubernetes/sdk/v4/go/kubernetes/meta/v1&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="s">&#34;github.com/pulumi/pulumi/sdk/v3/go/pulumi&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">pulumi</span><span class="p">.</span><span class="nf">Run</span><span class="p">(</span><span class="kd">func</span><span class="p">(</span><span class="nx">ctx</span> <span class="o">*</span><span class="nx">pulumi</span><span class="p">.</span><span class="nx">Context</span><span class="p">)</span> <span class="kt">error</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="nx">namespace</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">corev1</span><span class="p">.</span><span class="nf">NewNamespace</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span> <span class="s">&#34;flux-system&#34;</span><span class="p">,</span> <span class="o">&amp;</span><span class="nx">corev1</span><span class="p">.</span><span class="nx">NamespaceArgs</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="nx">Metadata</span><span class="p">:</span> <span class="o">&amp;</span><span class="nx">metav1</span><span class="p">.</span><span class="nx">ObjectMetaArgs</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="nx">Name</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;flux-system&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">			<span class="p">},</span>
</span></span><span class="line"><span class="cl">		<span class="p">})</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="k">return</span> <span class="nx">err</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="nx">_</span><span class="p">,</span> <span class="nx">err</span> <span class="p">=</span> <span class="nx">helmv3</span><span class="p">.</span><span class="nf">NewRelease</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span> <span class="s">&#34;flux-operator&#34;</span><span class="p">,</span> <span class="o">&amp;</span><span class="nx">helmv3</span><span class="p">.</span><span class="nx">ReleaseArgs</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="nx">Chart</span><span class="p">:</span>     <span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;flux-operator&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">			<span class="nx">Version</span><span class="p">:</span>   <span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;latest&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">			<span class="nx">Namespace</span><span class="p">:</span> <span class="nx">namespace</span><span class="p">.</span><span class="nx">Metadata</span><span class="p">.</span><span class="nf">Name</span><span class="p">().</span><span class="nf">Elem</span><span class="p">(),</span>
</span></span><span class="line"><span class="cl">			<span class="nx">RepositoryOpts</span><span class="p">:</span> <span class="o">&amp;</span><span class="nx">helmv3</span><span class="p">.</span><span class="nx">RepositoryOptsArgs</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="nx">Repo</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;oci://ghcr.io/controlplaneio-fluxcd/charts&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">			<span class="p">},</span>
</span></span><span class="line"><span class="cl">			<span class="nx">CreateNamespace</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nf">Bool</span><span class="p">(</span><span class="kc">true</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">		<span class="p">})</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="k">return</span> <span class="nx">err</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="k">return</span> <span class="kc">nil</span>
</span></span><span class="line"><span class="cl">	<span class="p">})</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div></pulumi-choosable></div><div><pulumi-choosable type="language" values="csharp" mode><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-csharp" data-lang="csharp"><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">System.Threading.Tasks</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Pulumi</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Pulumi.Kubernetes.Core.V1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Pulumi.Kubernetes.Helm.V3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Pulumi.Kubernetes.Types.Inputs.Core.V1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Pulumi.Kubernetes.Types.Inputs.Helm.V3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Pulumi.Kubernetes.Types.Inputs.Meta.V1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">System.Collections.Generic</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Pulumi.Kubernetes.ApiExtensions</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="kt">var</span> <span class="n">namespaceFluxSystem</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Namespace</span><span class="p">(</span><span class="s">&#34;flux-system&#34;</span><span class="p">,</span> <span class="k">new</span> <span class="n">NamespaceArgs</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">Metadata</span> <span class="p">=</span> <span class="k">new</span> <span class="n">ObjectMetaArgs</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">Name</span> <span class="p">=</span> <span class="s">&#34;flux-system&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="kt">var</span> <span class="n">fluxOperator</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Release</span><span class="p">(</span><span class="s">&#34;flux-operator&#34;</span><span class="p">,</span> <span class="k">new</span> <span class="n">ReleaseArgs</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">Chart</span> <span class="p">=</span> <span class="s">&#34;flux-operator&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">Version</span> <span class="p">=</span> <span class="s">&#34;latest&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">Namespace</span> <span class="p">=</span> <span class="n">namespaceFluxSystem</span><span class="p">.</span><span class="n">Metadata</span><span class="p">.</span><span class="n">Apply</span><span class="p">(</span><span class="n">metadata</span> <span class="p">=&gt;</span> <span class="n">metadata</span><span class="p">.</span><span class="n">Name</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="n">RepositoryOpts</span> <span class="p">=</span> <span class="k">new</span> <span class="n">RepositoryOptsArgs</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">Repo</span> <span class="p">=</span> <span class="s">&#34;oci://ghcr.io/controlplaneio-fluxcd/charts&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="n">CreateNamespace</span> <span class="p">=</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="p">});</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Program</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">static</span> <span class="n">Task</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;</span> <span class="n">Main</span><span class="p">()</span> <span class="p">=&gt;</span> <span class="n">Deployment</span><span class="p">.</span><span class="n">RunAsync</span><span class="p">&lt;</span><span class="n">MyStack</span><span class="p">&gt;();</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div></pulumi-choosable></div><h4 id="usage-1">Usage</h4><p>Here is an example of a FluxInstance Custom Resource that defines a Flux instance:</p><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">fluxcd.controlplane.io/v1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">FluxInstance</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">flux</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l">flux-system</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">annotations</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">fluxcd.controlplane.io/reconcileEvery</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;1h&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">fluxcd.controlplane.io/reconcileTimeout</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;5m&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">distribution</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;2.x&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">registry</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;ghcr.io/fluxcd&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">artifact</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;oci://ghcr.io/controlplaneio-fluxcd/flux-operator-manifests&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">components</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="l">source-controller</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="l">kustomize-controller</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="l">helm-controller</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="l">notification-controller</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="l">image-reflector-controller</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="l">image-automation-controller</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">cluster</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">kubernetes</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">multitenant</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">networkPolicy</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">domain</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;cluster.local&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">kustomize</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">patches</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="nt">target</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">Deployment</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;(kustomize-controller|helm-controller)&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">patch</span><span class="p">:</span><span class="w"> </span><span class="p">|</span><span class="sd">
</span></span></span><span class="line"><span class="cl"><span class="sd">        - op: add
</span></span></span><span class="line"><span class="cl"><span class="sd">          path: /spec/template/spec/containers/0/args/-
</span></span></span><span class="line"><span class="cl"><span class="sd">          value: --concurrent=10
</span></span></span><span class="line"><span class="cl"><span class="sd">        - op: add
</span></span></span><span class="line"><span class="cl"><span class="sd">          path: /spec/template/spec/containers/0/args/-
</span></span></span><span class="line"><span class="cl"><span class="sd">          value: --requeue-dependency=5s</span><span class="w">        
</span></span></span></code></pre></div><p>Or use Pulumi:</p><div><pulumi-chooser type="language" options="typescript,javascript,python,go,csharp" mode></pulumi-chooser></div><div><pulumi-choosable type="language" values="typescript" mode><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-typescript" data-lang="typescript"><span class="line"><span class="cl"><span class="k">new</span> <span class="nx">k8s</span><span class="p">.</span><span class="nx">apiextensions</span><span class="p">.</span><span class="nx">CustomResource</span><span class="p">(</span><span class="s2">&#34;flux&#34;</span><span class="p">,</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">apiVersion</span><span class="o">:</span> <span class="s2">&#34;fluxcd.controlplane.io/v1&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">kind</span><span class="o">:</span> <span class="s2">&#34;FluxInstance&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">metadata</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">name</span><span class="o">:</span> <span class="s2">&#34;flux&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="kr">namespace</span><span class="o">:</span> <span class="s2">&#34;flux-system&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nx">annotations</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;fluxcd.controlplane.io/reconcileEvery&#34;</span><span class="o">:</span> <span class="s2">&#34;1h&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;fluxcd.controlplane.io/reconcileTimeout&#34;</span><span class="o">:</span> <span class="s2">&#34;5m&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="nx">spec</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">distribution</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nx">version</span><span class="o">:</span> <span class="s2">&#34;2.x&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nx">registry</span><span class="o">:</span> <span class="s2">&#34;ghcr.io/fluxcd&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nx">artifact</span><span class="o">:</span> <span class="s2">&#34;oci://ghcr.io/controlplaneio-fluxcd/flux-operator-manifests&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nx">components</span><span class="o">:</span> <span class="p">[</span><span class="s2">&#34;source-controller&#34;</span><span class="p">,</span> <span class="s2">&#34;kustomize-controller&#34;</span><span class="p">,</span> <span class="s2">&#34;helm-controller&#34;</span><span class="p">,</span> <span class="s2">&#34;notification-controller&#34;</span><span class="p">,</span> <span class="s2">&#34;image-reflector-controller&#34;</span><span class="p">,</span> <span class="s2">&#34;image-automation-controller&#34;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="nx">cluster</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="kr">type</span><span class="o">:</span> <span class="s2">&#34;kubernetes&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nx">multitenant</span>: <span class="kt">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nx">networkPolicy</span>: <span class="kt">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nx">domain</span><span class="o">:</span> <span class="s2">&#34;cluster.local&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nx">kustomize</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nx">patches</span><span class="o">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nx">target</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nx">kind</span><span class="o">:</span> <span class="s2">&#34;Deployment&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nx">name</span><span class="o">:</span> <span class="s2">&#34;(kustomize-controller|helm-controller)&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="p">},</span>
</span></span><span class="line"><span class="cl">                    <span class="nx">patch</span><span class="o">:</span> <span class="sb">`
</span></span></span><span class="line"><span class="cl"><span class="sb">                    - op: add
</span></span></span><span class="line"><span class="cl"><span class="sb">                      path: /spec/template/spec/containers/0/args/-
</span></span></span><span class="line"><span class="cl"><span class="sb">                      value: --concurrent=10
</span></span></span><span class="line"><span class="cl"><span class="sb">                    - op: add
</span></span></span><span class="line"><span class="cl"><span class="sb">                      path: /spec/template/spec/containers/0/args/-
</span></span></span><span class="line"><span class="cl"><span class="sb">                      value: --requeue-dependency=5s
</span></span></span><span class="line"><span class="cl"><span class="sb">                    `</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl"><span class="p">});</span>
</span></span></code></pre></div></pulumi-choosable></div><div><pulumi-choosable type="language" values="javascript" mode><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="k">new</span> <span class="nx">k8s</span><span class="p">.</span><span class="nx">apiextensions</span><span class="p">.</span><span class="nx">CustomResource</span><span class="p">(</span><span class="s2">&#34;flux&#34;</span><span class="p">,</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">apiVersion</span><span class="o">:</span> <span class="s2">&#34;fluxcd.controlplane.io/v1&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">kind</span><span class="o">:</span> <span class="s2">&#34;FluxInstance&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">metadata</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">name</span><span class="o">:</span> <span class="s2">&#34;flux&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nx">namespace</span><span class="o">:</span> <span class="s2">&#34;flux-system&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nx">annotations</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;fluxcd.controlplane.io/reconcileEvery&#34;</span><span class="o">:</span> <span class="s2">&#34;1h&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;fluxcd.controlplane.io/reconcileTimeout&#34;</span><span class="o">:</span> <span class="s2">&#34;5m&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="nx">spec</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">distribution</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nx">version</span><span class="o">:</span> <span class="s2">&#34;2.x&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nx">registry</span><span class="o">:</span> <span class="s2">&#34;ghcr.io/fluxcd&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nx">artifact</span><span class="o">:</span> <span class="s2">&#34;oci://ghcr.io/controlplaneio-fluxcd/flux-operator-manifests&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nx">components</span><span class="o">:</span> <span class="p">[</span><span class="s2">&#34;source-controller&#34;</span><span class="p">,</span> <span class="s2">&#34;kustomize-controller&#34;</span><span class="p">,</span> <span class="s2">&#34;helm-controller&#34;</span><span class="p">,</span> <span class="s2">&#34;notification-controller&#34;</span><span class="p">,</span> <span class="s2">&#34;image-reflector-controller&#34;</span><span class="p">,</span> <span class="s2">&#34;image-automation-controller&#34;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="nx">cluster</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nx">type</span><span class="o">:</span> <span class="s2">&#34;kubernetes&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nx">multitenant</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nx">networkPolicy</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nx">domain</span><span class="o">:</span> <span class="s2">&#34;cluster.local&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nx">kustomize</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nx">patches</span><span class="o">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nx">target</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nx">kind</span><span class="o">:</span> <span class="s2">&#34;Deployment&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nx">name</span><span class="o">:</span> <span class="s2">&#34;(kustomize-controller|helm-controller)&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="p">},</span>
</span></span><span class="line"><span class="cl">                    <span class="nx">patch</span><span class="o">:</span> <span class="sb">`
</span></span></span><span class="line"><span class="cl"><span class="sb">                            - op: add
</span></span></span><span class="line"><span class="cl"><span class="sb">                              path: /spec/template/spec/containers/0/args/-
</span></span></span><span class="line"><span class="cl"><span class="sb">                              value: --concurrent=10
</span></span></span><span class="line"><span class="cl"><span class="sb">                            - op: add
</span></span></span><span class="line"><span class="cl"><span class="sb">                              path: /spec/template/spec/containers/0/args/-
</span></span></span><span class="line"><span class="cl"><span class="sb">                              value: --requeue-dependency=5s
</span></span></span><span class="line"><span class="cl"><span class="sb">                            `</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl"><span class="p">});</span>
</span></span></code></pre></div></pulumi-choosable></div><div><pulumi-choosable type="language" values="python" mode><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pulumi_kubernetes</span> <span class="kn">import</span> <span class="n">apiextensions</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">flux_instance</span> <span class="o">=</span> <span class="n">k8s</span><span class="o">.</span><span class="n">apiextensions</span><span class="o">.</span><span class="n">CustomResource</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;flux&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">api_version</span><span class="o">=</span><span class="s2">&#34;fluxcd.controlplane.io/v1&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">kind</span><span class="o">=</span><span class="s2">&#34;FluxInstance&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">metadata</span><span class="o">=</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;flux&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;namespace&#34;</span><span class="p">:</span> <span class="n">flux_namespace</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&#34;name&#34;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;annotations&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;fluxcd.controlplane.io/reconcileEvery&#34;</span><span class="p">:</span> <span class="s2">&#34;1h&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;fluxcd.controlplane.io/reconcileTimeout&#34;</span><span class="p">:</span> <span class="s2">&#34;5m&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="n">spec</span><span class="o">=</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;distribution&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;version&#34;</span><span class="p">:</span> <span class="s2">&#34;2.x&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;registry&#34;</span><span class="p">:</span> <span class="s2">&#34;ghcr.io/fluxcd&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;artifact&#34;</span><span class="p">:</span> <span class="s2">&#34;oci://ghcr.io/controlplaneio-fluxcd/flux-operator-manifests&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;components&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;source-controller&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;kustomize-controller&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;helm-controller&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;notification-controller&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;image-reflector-controller&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;image-automation-controller&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;cluster&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;kubernetes&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;multitenant&#34;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;networkPolicy&#34;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;domain&#34;</span><span class="p">:</span> <span class="s2">&#34;cluster.local&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;kustomize&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;patches&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;target&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="s2">&#34;kind&#34;</span><span class="p">:</span> <span class="s2">&#34;Deployment&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="s2">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;(kustomize-controller|helm-controller)&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="p">},</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;patch&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                        <span class="p">{</span>
</span></span><span class="line"><span class="cl">                            <span class="s2">&#34;op&#34;</span><span class="p">:</span> <span class="s2">&#34;add&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                            <span class="s2">&#34;path&#34;</span><span class="p">:</span> <span class="s2">&#34;/spec/template/spec/containers/0/args/-&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                            <span class="s2">&#34;value&#34;</span><span class="p">:</span> <span class="s2">&#34;--concurrent=10&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="p">},</span>
</span></span><span class="line"><span class="cl">                        <span class="p">{</span>
</span></span><span class="line"><span class="cl">                            <span class="s2">&#34;op&#34;</span><span class="p">:</span> <span class="s2">&#34;add&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                            <span class="s2">&#34;path&#34;</span><span class="p">:</span> <span class="s2">&#34;/spec/template/spec/containers/0/args/-&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                            <span class="s2">&#34;value&#34;</span><span class="p">:</span> <span class="s2">&#34;--requeue-dependency=5s&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="p">},</span>
</span></span><span class="line"><span class="cl">                    <span class="p">],</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span></code></pre></div></pulumi-choosable></div><div><pulumi-choosable type="language" values="go" mode><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="kn">package</span> <span class="nx">main</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">	<span class="nx">k8s</span> <span class="s">&#34;github.com/pulumi/pulumi-kubernetes/sdk/v4/go/kubernetes&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="nx">apiv1</span> <span class="s">&#34;github.com/pulumi/pulumi-kubernetes/sdk/v4/go/kubernetes/apiextensions&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="nx">corev1</span> <span class="s">&#34;github.com/pulumi/pulumi-kubernetes/sdk/v4/go/kubernetes/core/v1&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="nx">helmv3</span> <span class="s">&#34;github.com/pulumi/pulumi-kubernetes/sdk/v4/go/kubernetes/helm/v3&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="nx">metav1</span> <span class="s">&#34;github.com/pulumi/pulumi-kubernetes/sdk/v4/go/kubernetes/meta/v1&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="s">&#34;github.com/pulumi/pulumi/sdk/v3/go/pulumi&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">pulumi</span><span class="p">.</span><span class="nf">Run</span><span class="p">(</span><span class="kd">func</span><span class="p">(</span><span class="nx">ctx</span> <span class="o">*</span><span class="nx">pulumi</span><span class="p">.</span><span class="nx">Context</span><span class="p">)</span> <span class="kt">error</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="nx">_</span><span class="p">,</span> <span class="nx">err</span> <span class="p">=</span> <span class="nx">apiv1</span><span class="p">.</span><span class="nf">NewCustomResource</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span> <span class="s">&#34;flux&#34;</span><span class="p">,</span> <span class="o">&amp;</span><span class="nx">apiv1</span><span class="p">.</span><span class="nx">CustomResourceArgs</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="nx">ApiVersion</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;fluxcd.controlplane.io/v1&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">			<span class="nx">Kind</span><span class="p">:</span>       <span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;FluxInstance&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">			<span class="nx">Metadata</span><span class="p">:</span> <span class="o">&amp;</span><span class="nx">metav1</span><span class="p">.</span><span class="nx">ObjectMetaArgs</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="nx">Name</span><span class="p">:</span>      <span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;flux&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">				<span class="nx">Namespace</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;flux-system&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">				<span class="nx">Annotations</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nx">StringMap</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">					<span class="s">&#34;fluxcd.controlplane.io/reconcileEvery&#34;</span><span class="p">:</span>   <span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;1h&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">					<span class="s">&#34;fluxcd.controlplane.io/reconcileTimeout&#34;</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;5m&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">				<span class="p">},</span>
</span></span><span class="line"><span class="cl">			<span class="p">},</span>
</span></span><span class="line"><span class="cl">			<span class="nx">OtherFields</span><span class="p">:</span> <span class="nx">k8s</span><span class="p">.</span><span class="nx">UntypedArgs</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="s">&#34;distribution&#34;</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nx">Map</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">					<span class="s">&#34;version&#34;</span><span class="p">:</span>  <span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;2.x&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">					<span class="s">&#34;registry&#34;</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;ghcr.io/fluxcd&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">					<span class="s">&#34;artifact&#34;</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;oci://ghcr.io/controlplaneio-fluxcd/flux-operator-manifests&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">				<span class="p">},</span>
</span></span><span class="line"><span class="cl">				<span class="s">&#34;components&#34;</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nx">StringArray</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">					<span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;source-controller&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">					<span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;kustomize-controller&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">					<span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;helm-controller&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">					<span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;notification-controller&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">					<span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;image-reflector-controller&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">					<span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;image-automation-controller&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">				<span class="p">},</span>
</span></span><span class="line"><span class="cl">				<span class="s">&#34;cluster&#34;</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nx">Map</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">					<span class="s">&#34;type&#34;</span><span class="p">:</span>          <span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;kubernetes&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">					<span class="s">&#34;multitenant&#34;</span><span class="p">:</span>   <span class="nx">pulumi</span><span class="p">.</span><span class="nf">Bool</span><span class="p">(</span><span class="kc">false</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">					<span class="s">&#34;networkPolicy&#34;</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nf">Bool</span><span class="p">(</span><span class="kc">true</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">					<span class="s">&#34;domain&#34;</span><span class="p">:</span>        <span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;cluster.local&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">				<span class="p">},</span>
</span></span><span class="line"><span class="cl">				<span class="s">&#34;kustomize&#34;</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nx">Map</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">					<span class="s">&#34;patches&#34;</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nx">Array</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">						<span class="nx">pulumi</span><span class="p">.</span><span class="nx">Map</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">							<span class="s">&#34;target&#34;</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nx">Map</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">								<span class="s">&#34;kind&#34;</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;Deployment&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">								<span class="s">&#34;name&#34;</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;(kustomize-controller|helm-controller)&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">							<span class="p">},</span>
</span></span><span class="line"><span class="cl">							<span class="s">&#34;patch&#34;</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nx">Array</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">								<span class="nx">pulumi</span><span class="p">.</span><span class="nx">Map</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">									<span class="s">&#34;op&#34;</span><span class="p">:</span>    <span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;add&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">									<span class="s">&#34;path&#34;</span><span class="p">:</span>  <span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;/spec/template/spec/containers/0/args/-&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">									<span class="s">&#34;value&#34;</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;--concurrent=10&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">								<span class="p">},</span>
</span></span><span class="line"><span class="cl">								<span class="nx">pulumi</span><span class="p">.</span><span class="nx">Map</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">									<span class="s">&#34;op&#34;</span><span class="p">:</span>    <span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;add&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">									<span class="s">&#34;path&#34;</span><span class="p">:</span>  <span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;/spec/template/spec/containers/0/args/-&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">									<span class="s">&#34;value&#34;</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;--requeue-dependency=5s&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">								<span class="p">},</span>
</span></span><span class="line"><span class="cl">							<span class="p">},</span>
</span></span><span class="line"><span class="cl">						<span class="p">},</span>
</span></span><span class="line"><span class="cl">					<span class="p">},</span>
</span></span><span class="line"><span class="cl">				<span class="p">},</span>
</span></span><span class="line"><span class="cl">			<span class="p">},</span>
</span></span><span class="line"><span class="cl">		<span class="p">})</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="k">return</span> <span class="nx">err</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="k">return</span> <span class="kc">nil</span>
</span></span><span class="line"><span class="cl">	<span class="p">})</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div></pulumi-choosable></div><div><pulumi-choosable type="language" values="csharp" mode><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-csharp" data-lang="csharp"><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">System.Threading.Tasks</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Pulumi</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Pulumi.Kubernetes.Core.V1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Pulumi.Kubernetes.Helm.V3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Pulumi.Kubernetes.Types.Inputs.Core.V1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Pulumi.Kubernetes.Types.Inputs.Helm.V3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Pulumi.Kubernetes.Types.Inputs.Meta.V1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">System.Collections.Generic</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Pulumi.Kubernetes.ApiExtensions</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">FluxInstanceArgs</span> <span class="p">:</span> <span class="n">CustomResourceArgs</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">string</span> <span class="n">ApiVersion</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">string</span> <span class="n">Kind</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">ObjectMetaArgs</span> <span class="n">Metadata</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">object</span><span class="p">&gt;</span> <span class="n">Spec</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">FluxInstanceArgs</span><span class="p">(</span><span class="kt">string</span> <span class="n">apiVersion</span><span class="p">,</span> <span class="kt">string</span> <span class="n">kind</span><span class="p">)</span> <span class="p">:</span> <span class="k">base</span><span class="p">(</span><span class="n">apiVersion</span><span class="p">,</span> <span class="n">kind</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="kt">var</span> <span class="n">flux</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Pulumi</span><span class="p">.</span><span class="n">Kubernetes</span><span class="p">.</span><span class="n">ApiExtensions</span><span class="p">.</span><span class="n">CustomResource</span><span class="p">(</span><span class="s">&#34;flux&#34;</span><span class="p">,</span> <span class="k">new</span> <span class="n">FluxInstanceArgs</span><span class="p">(</span><span class="s">&#34;fluxcd.controlplane.io/v1&#34;</span><span class="p">,</span> <span class="s">&#34;FluxInstance&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">ApiVersion</span> <span class="p">=</span> <span class="s">&#34;fluxcd.controlplane.io/v1&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">Kind</span> <span class="p">=</span> <span class="s">&#34;FluxInstance&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">Metadata</span> <span class="p">=</span> <span class="k">new</span> <span class="n">ObjectMetaArgs</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">Name</span> <span class="p">=</span> <span class="s">&#34;flux&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="n">Annotations</span> <span class="p">=</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span> <span class="s">&#34;fluxcd.controlplane.io/reconcileEvery&#34;</span><span class="p">,</span> <span class="s">&#34;1h&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span> <span class="s">&#34;fluxcd.controlplane.io/reconcileTimeout&#34;</span><span class="p">,</span> <span class="s">&#34;5m&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="n">Spec</span> <span class="p">=</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span> <span class="s">&#34;distribution&#34;</span><span class="p">,</span> <span class="k">new</span> <span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">object</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="p">{</span> <span class="s">&#34;version&#34;</span><span class="p">,</span> <span class="s">&#34;2.x&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">                        <span class="p">{</span> <span class="s">&#34;registry&#34;</span><span class="p">,</span> <span class="s">&#34;ghcr.io/fluxcd&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">                        <span class="p">{</span> <span class="s">&#34;artifact&#34;</span><span class="p">,</span> <span class="s">&#34;oci://ghcr.io/controlplaneio-fluxcd/flux-operator-manifests&#34;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span> <span class="s">&#34;components&#34;</span><span class="p">,</span> <span class="k">new</span><span class="p">[]</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="s">&#34;source-controller&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="s">&#34;kustomize-controller&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="s">&#34;helm-controller&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="s">&#34;notification-controller&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="s">&#34;image-reflector-controller&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="s">&#34;image-automation-controller&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span> <span class="s">&#34;cluster&#34;</span><span class="p">,</span> <span class="k">new</span> <span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">object</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="p">{</span> <span class="s">&#34;type&#34;</span><span class="p">,</span> <span class="s">&#34;kubernetes&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">                        <span class="p">{</span> <span class="s">&#34;multitenant&#34;</span><span class="p">,</span> <span class="kc">false</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">                        <span class="p">{</span> <span class="s">&#34;networkPolicy&#34;</span><span class="p">,</span> <span class="kc">true</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">                        <span class="p">{</span> <span class="s">&#34;domain&#34;</span><span class="p">,</span> <span class="s">&#34;cluster.local&#34;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span> <span class="s">&#34;kustomize&#34;</span><span class="p">,</span> <span class="k">new</span> <span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">object</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="p">{</span> <span class="s">&#34;patches&#34;</span><span class="p">,</span> <span class="k">new</span><span class="p">[]</span>
</span></span><span class="line"><span class="cl">                            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                                <span class="k">new</span> <span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">object</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">                                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                                    <span class="p">{</span> <span class="s">&#34;target&#34;</span><span class="p">,</span> <span class="k">new</span> <span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">object</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">                                        <span class="p">{</span>
</span></span><span class="line"><span class="cl">                                            <span class="p">{</span> <span class="s">&#34;kind&#34;</span><span class="p">,</span> <span class="s">&#34;Deployment&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">                                            <span class="p">{</span> <span class="s">&#34;name&#34;</span><span class="p">,</span> <span class="s">&#34;(kustomize-controller|helm-controller)&#34;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">                                        <span class="p">}</span>
</span></span><span class="line"><span class="cl">                                    <span class="p">},</span>
</span></span><span class="line"><span class="cl">                                    <span class="p">{</span> <span class="s">&#34;patch&#34;</span><span class="p">,</span> <span class="k">new</span><span class="p">[]</span>
</span></span><span class="line"><span class="cl">                                        <span class="p">{</span>
</span></span><span class="line"><span class="cl">                                            <span class="k">new</span> <span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">object</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">                                            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                                                <span class="p">{</span> <span class="s">&#34;op&#34;</span><span class="p">,</span> <span class="s">&#34;add&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">                                                <span class="p">{</span> <span class="s">&#34;path&#34;</span><span class="p">,</span> <span class="s">&#34;/spec/template/spec/containers/0/args/-&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">                                                <span class="p">{</span> <span class="s">&#34;value&#34;</span><span class="p">,</span> <span class="s">&#34;--concurrent=10&#34;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">                                            <span class="p">},</span>
</span></span><span class="line"><span class="cl">                                            <span class="k">new</span> <span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">object</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">                                            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                                                <span class="p">{</span> <span class="s">&#34;op&#34;</span><span class="p">,</span> <span class="s">&#34;add&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">                                                <span class="p">{</span> <span class="s">&#34;path&#34;</span><span class="p">,</span> <span class="s">&#34;/spec/template/spec/containers/0/args/-&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">                                                <span class="p">{</span> <span class="s">&#34;value&#34;</span><span class="p">,</span> <span class="s">&#34;--requeue-dependency=5s&#34;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">                                            <span class="p">}</span>
</span></span><span class="line"><span class="cl">                                        <span class="p">}</span>
</span></span><span class="line"><span class="cl">                                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                                <span class="p">}</span>
</span></span><span class="line"><span class="cl">                            <span class="p">}</span>
</span></span><span class="line"><span class="cl">                        <span class="p">}</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Program</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">static</span> <span class="n">Task</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;</span> <span class="n">Main</span><span class="p">()</span> <span class="p">=&gt;</span> <span class="n">Deployment</span><span class="p">.</span><span class="n">RunAsync</span><span class="p">&lt;</span><span class="n">MyStack</span><span class="p">&gt;();</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div></pulumi-choosable></div><h4 id="summary-1">Summary</h4><p>The Flux Operator is another excellent example of an advanced Kubernetes operator, providing full lifecycle management with numerous automation features.</p><h3 id="strimzi-operator">Strimzi Operator</h3><figure><img src="/blog/why-every-platform-engineer-should-care-about-kubernetes-operators/strimzi.png" alt="Strimzi Operator Credit: strimzi.io" width="100%"><figcaption><p>Strimzi Operator Credit: strimzi.io</p></figcaption></figure><p>Last but not least, the <a href="https://strimzi.io/">Strimzi Operator</a> is a full lifecycle management operator for Apache Kafka on Kubernetes. As event-driven architectures are becoming increasingly popular, Apache Kafka has become the de-facto standard for building scalable and reliable event streaming platforms. The Strimzi Operator makes it easier to deploy, manage, and scale Apache Kafka clusters on Kubernetes.</p><p>Some of the key features of Strimzi Operator are:</p><ul><li><strong>Cluster Management</strong> - Deploy and manage Apache Kafka clusters.</li><li><strong>Mirror Clusters</strong> - Deploy and manage mirror clusters for disaster recovery.</li><li><strong>Streaming Capabilities</strong> - With Kafka Connect you can stream data between Kafka and other systems.</li></ul><h4 id="installation-2">Installation</h4><p>Use the Helm chart to deploy the Strimzi Operator:</p><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">helm repo add strimzi https://strimzi.io/charts/
</span></span><span class="line"><span class="cl">helm repo update
</span></span><span class="line"><span class="cl">helm install strimzi strimzi/strimzi-kafka-operator -n kafka --create-namespace
</span></span></code></pre></div><p>Or use Pulumi to deploy the Strimzi Operator:</p><div><pulumi-chooser type="language" options="typescript,javascript,python,go,csharp" mode></pulumi-chooser></div><div><pulumi-choosable type="language" values="typescript" mode><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-typescript" data-lang="typescript"><span class="line"><span class="cl"><span class="kr">import</span> <span class="o">*</span> <span class="kr">as</span> <span class="nx">k8s</span> <span class="kr">from</span> <span class="s2">&#34;@pulumi/kubernetes&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="o">*</span> <span class="kr">as</span> <span class="nx">k8shelm</span> <span class="kr">from</span> <span class="s2">&#34;@pulumi/kubernetes/helm/v3&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">namespaceKafka</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">k8s</span><span class="p">.</span><span class="nx">core</span><span class="p">.</span><span class="nx">v1</span><span class="p">.</span><span class="nx">Namespace</span><span class="p">(</span><span class="s2">&#34;kafka&#34;</span><span class="p">,</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">metadata</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">name</span><span class="o">:</span> <span class="s2">&#34;kafka&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl"><span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">new</span> <span class="nx">k8s</span><span class="p">.</span><span class="nx">helm</span><span class="p">.</span><span class="nx">v3</span><span class="p">.</span><span class="nx">Release</span><span class="p">(</span><span class="s2">&#34;strimzi-kafka-operator&#34;</span><span class="p">,</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">chart</span><span class="o">:</span> <span class="s2">&#34;strimzi-kafka-operator&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">version</span><span class="o">:</span> <span class="s2">&#34;latest&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="kr">namespace</span><span class="o">:</span> <span class="nx">namespaceKafka</span><span class="p">.</span><span class="nx">metadata</span><span class="p">.</span><span class="nx">name</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">repositoryOpts</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">repo</span><span class="o">:</span> <span class="s2">&#34;https://strimzi.io/charts/&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="nx">createNamespace</span>: <span class="kt">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="p">});</span>
</span></span></code></pre></div></pulumi-choosable></div><div><pulumi-choosable type="language" values="javascript" mode><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="s2">&#34;use strict&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">k8s</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&#34;@pulumi/kubernetes&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">k8shelm</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&#34;@pulumi/kubernetes/helm/v3&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">namespaceKafka</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">k8s</span><span class="p">.</span><span class="nx">core</span><span class="p">.</span><span class="nx">v1</span><span class="p">.</span><span class="nx">Namespace</span><span class="p">(</span><span class="s2">&#34;kafka&#34;</span><span class="p">,</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">metadata</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">name</span><span class="o">:</span> <span class="s2">&#34;kafka&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl"><span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">new</span> <span class="nx">k8s</span><span class="p">.</span><span class="nx">helm</span><span class="p">.</span><span class="nx">v3</span><span class="p">.</span><span class="nx">Release</span><span class="p">(</span><span class="s2">&#34;strimzi-kafka-operator&#34;</span><span class="p">,</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">chart</span><span class="o">:</span> <span class="s2">&#34;strimzi-kafka-operator&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">version</span><span class="o">:</span> <span class="s2">&#34;latest&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">namespace</span><span class="o">:</span> <span class="nx">namespaceKafka</span><span class="p">.</span><span class="nx">metadata</span><span class="p">.</span><span class="nx">name</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">repositoryOpts</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">repo</span><span class="o">:</span> <span class="s2">&#34;https://strimzi.io/charts/&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="nx">createNamespace</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="p">});</span>
</span></span></code></pre></div></pulumi-choosable></div><div><pulumi-choosable type="language" values="python" mode><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">pulumi_kubernetes</span> <span class="k">as</span> <span class="nn">k8s</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">pulumi_kubernetes.helm.v3</span> <span class="k">as</span> <span class="nn">k8shelm</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">pulumi_kubernetes.meta.v1</span> <span class="k">as</span> <span class="nn">meta</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">namespace_kafka</span> <span class="o">=</span> <span class="n">k8s</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">v1</span><span class="o">.</span><span class="n">v1</span><span class="o">.</span><span class="n">Namespace</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;kafka&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">meta</span><span class="o">.</span><span class="n">ObjectMetaArgs</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">name</span><span class="o">=</span><span class="s2">&#34;kafka&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">),</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">strimzi_kafka_operator</span> <span class="o">=</span> <span class="n">k8shelm</span><span class="o">.</span><span class="n">Release</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;strimzi-kafka-operator&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">chart</span><span class="o">=</span><span class="s2">&#34;strimzi-kafka-operator&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">version</span><span class="o">=</span><span class="s2">&#34;latest&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">namespace</span><span class="o">=</span><span class="n">namespace_kafka</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&#34;name&#34;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="n">repository_opts</span><span class="o">=</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;repo&#34;</span><span class="p">:</span> <span class="s2">&#34;https://strimzi.io/charts/&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="n">create_namespace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span></code></pre></div></pulumi-choosable></div><div><pulumi-choosable type="language" values="go" mode><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="kn">package</span> <span class="nx">main</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">	<span class="nx">k8s</span> <span class="s">&#34;github.com/pulumi/pulumi-kubernetes/sdk/v4/go/kubernetes&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="nx">apiv1</span> <span class="s">&#34;github.com/pulumi/pulumi-kubernetes/sdk/v4/go/kubernetes/apiextensions&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="nx">corev1</span> <span class="s">&#34;github.com/pulumi/pulumi-kubernetes/sdk/v4/go/kubernetes/core/v1&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="nx">helmv3</span> <span class="s">&#34;github.com/pulumi/pulumi-kubernetes/sdk/v4/go/kubernetes/helm/v3&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="nx">metav1</span> <span class="s">&#34;github.com/pulumi/pulumi-kubernetes/sdk/v4/go/kubernetes/meta/v1&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="s">&#34;github.com/pulumi/pulumi/sdk/v3/go/pulumi&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="nx">namespaceKafka</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">corev1</span><span class="p">.</span><span class="nf">NewNamespace</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span> <span class="s">&#34;kafka&#34;</span><span class="p">,</span> <span class="o">&amp;</span><span class="nx">corev1</span><span class="p">.</span><span class="nx">NamespaceArgs</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="nx">Metadata</span><span class="p">:</span> <span class="o">&amp;</span><span class="nx">metav1</span><span class="p">.</span><span class="nx">ObjectMetaArgs</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="nx">Name</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;kafka&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">			<span class="p">},</span>
</span></span><span class="line"><span class="cl">		<span class="p">})</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="k">return</span> <span class="nx">err</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="nx">_</span><span class="p">,</span> <span class="nx">err</span> <span class="p">=</span> <span class="nx">helmv3</span><span class="p">.</span><span class="nf">NewRelease</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span> <span class="s">&#34;strimzi-kafka-operator&#34;</span><span class="p">,</span> <span class="o">&amp;</span><span class="nx">helmv3</span><span class="p">.</span><span class="nx">ReleaseArgs</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="nx">Chart</span><span class="p">:</span>     <span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;strimzi-kafka-operator&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">			<span class="nx">Version</span><span class="p">:</span>   <span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;latest&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">			<span class="nx">Namespace</span><span class="p">:</span> <span class="nx">namespaceKafka</span><span class="p">.</span><span class="nx">Metadata</span><span class="p">.</span><span class="nf">Name</span><span class="p">(),</span>
</span></span><span class="line"><span class="cl">			<span class="nx">RepositoryOpts</span><span class="p">:</span> <span class="nx">helmv3</span><span class="p">.</span><span class="nx">RepositoryOptsArgs</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="nx">Repo</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;https://strimzi.io/charts/&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">			<span class="p">},</span>
</span></span><span class="line"><span class="cl">			<span class="nx">CreateNamespace</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nf">Bool</span><span class="p">(</span><span class="kc">true</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">		<span class="p">})</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="k">return</span> <span class="nx">err</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="k">return</span> <span class="kc">nil</span>
</span></span><span class="line"><span class="cl">	<span class="p">})</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div></pulumi-choosable></div><div><pulumi-choosable type="language" values="csharp" mode><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-csharp" data-lang="csharp"><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">System.Threading.Tasks</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Pulumi</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Pulumi.Kubernetes.Core.V1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Pulumi.Kubernetes.Helm.V3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Pulumi.Kubernetes.Types.Inputs.Core.V1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Pulumi.Kubernetes.Types.Inputs.Helm.V3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Pulumi.Kubernetes.Types.Inputs.Meta.V1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">System.Collections.Generic</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Pulumi.Kubernetes.ApiExtensions</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">MyStack</span> <span class="p">:</span> <span class="n">Stack</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">MyStack</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kt">var</span> <span class="n">namespaceKafka</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Namespace</span><span class="p">(</span><span class="s">&#34;kafka&#34;</span><span class="p">,</span> <span class="k">new</span> <span class="n">NamespaceArgs</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">Metadata</span> <span class="p">=</span> <span class="k">new</span> <span class="n">ObjectMetaArgs</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">Name</span> <span class="p">=</span> <span class="s">&#34;kafka&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="kt">var</span> <span class="n">strimziKafkaOperator</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Release</span><span class="p">(</span><span class="s">&#34;strimzi-kafka-operator&#34;</span><span class="p">,</span> <span class="k">new</span> <span class="n">ReleaseArgs</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">Chart</span> <span class="p">=</span> <span class="s">&#34;strimzi-kafka-operator&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">Version</span> <span class="p">=</span> <span class="s">&#34;latest&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">Namespace</span> <span class="p">=</span> <span class="n">namespaceKafka</span><span class="p">.</span><span class="n">Metadata</span><span class="p">.</span><span class="n">Apply</span><span class="p">(</span><span class="n">ns</span> <span class="p">=&gt;</span> <span class="n">ns</span><span class="p">.</span><span class="n">Name</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="n">RepositoryOpts</span> <span class="p">=</span> <span class="k">new</span> <span class="n">RepositoryOptsArgs</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">Repo</span> <span class="p">=</span> <span class="s">&#34;https://strimzi.io/charts/&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="n">CreateNamespace</span> <span class="p">=</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Program</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">static</span> <span class="n">Task</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;</span> <span class="n">Main</span><span class="p">()</span> <span class="p">=&gt;</span> <span class="n">Deployment</span><span class="p">.</span><span class="n">RunAsync</span><span class="p">&lt;</span><span class="n">MyStack</span><span class="p">&gt;();</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div></pulumi-choosable></div><h4 id="usage-2">Usage</h4><p>Here is an example of a Kafka Custom Resource that defines a Kafka cluster:</p><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">kafka.strimzi.io/v1beta2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">KafkaNodePool</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">example-kafka-node-pool</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">labels</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">strimzi.io/cluster</span><span class="p">:</span><span class="w"> </span><span class="l">example-kafka-cluster</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">replicas</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">roles</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="l">controller</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="l">broker</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">storage</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">ephemeral</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nn">---</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">kafka.strimzi.io/v1beta2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">Kafka</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">example-kafka-cluster</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">annotations</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">strimzi.io/kraft</span><span class="p">:</span><span class="w"> </span><span class="l">enabled</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">strimzi.io/node-pools</span><span class="p">:</span><span class="w"> </span><span class="l">enabled</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">kafka</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">replicas</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="m">3.8.0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">storage</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">ephemeral</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">metadataVersion</span><span class="p">:</span><span class="w"> </span><span class="m">3.8</span>-<span class="l">IV0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">listeners</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">plain</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="m">9092</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">internal</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">tls</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">tls</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="m">9093</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">internal</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">tls</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">config</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">offsets.topic.replication.factor</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">transaction.state.log.replication.factor</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">transaction.state.log.min.isr</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">default.replication.factor</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">min.insync.replicas</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">entityOperator</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">topicOperator</span><span class="p">:</span><span class="w"> </span>{}<span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">userOperator</span><span class="p">:</span><span class="w"> </span>{}<span class="w">
</span></span></span></code></pre></div><p>This example defines a Kafka cluster with one replica and two listeners, one for plain and one for TLS and uses
ephemeral storage.</p><p>To create a topic, you can use the following KafkaTopic Custom Resource:</p><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">kafka.strimzi.io/v1beta2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">KafkaTopic</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">example-kafka-cluster</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">labels</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">strimzi.io/cluster</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">partitions</span><span class="p">:</span><span class="w"> </span><span class="m">5</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">replicas</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">config</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">retention.ms</span><span class="p">:</span><span class="w"> </span><span class="m">7200000</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">segment.bytes</span><span class="p">:</span><span class="w"> </span><span class="m">1073741824</span><span class="w">
</span></span></span></code></pre></div><p>Or use Pulumi:</p><div><pulumi-chooser type="language" options="typescript,javascript,python,go,csharp" mode></pulumi-chooser></div><div><pulumi-choosable type="language" values="typescript" mode><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-typescript" data-lang="typescript"><span class="line"><span class="cl"><span class="k">new</span> <span class="nx">k8s</span><span class="p">.</span><span class="nx">apiextensions</span><span class="p">.</span><span class="nx">CustomResource</span><span class="p">(</span><span class="s2">&#34;example-kafka-node-pool&#34;</span><span class="p">,</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">apiVersion</span><span class="o">:</span> <span class="s2">&#34;kafka.strimzi.io/v1beta2&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">kind</span><span class="o">:</span> <span class="s2">&#34;KafkaNodePool&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">metadata</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">name</span><span class="o">:</span> <span class="s2">&#34;example-kafka-node-pool&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nx">labels</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;strimzi.io/cluster&#34;</span><span class="o">:</span> <span class="s2">&#34;example-kafka-cluster&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="kr">namespace</span><span class="o">:</span> <span class="s2">&#34;kafka&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="nx">spec</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">replicas</span>: <span class="kt">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nx">roles</span><span class="o">:</span> <span class="p">[</span><span class="s2">&#34;controller&#34;</span><span class="p">,</span> <span class="s2">&#34;broker&#34;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="nx">storage</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="kr">type</span><span class="o">:</span> <span class="s2">&#34;ephemeral&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl"><span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">new</span> <span class="nx">k8s</span><span class="p">.</span><span class="nx">apiextensions</span><span class="p">.</span><span class="nx">CustomResource</span><span class="p">(</span><span class="s2">&#34;example-kafka-cluster&#34;</span><span class="p">,</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">apiVersion</span><span class="o">:</span> <span class="s2">&#34;kafka.strimzi.io/v1beta2&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">kind</span><span class="o">:</span> <span class="s2">&#34;Kafka&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">metadata</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">name</span><span class="o">:</span> <span class="s2">&#34;example-kafka-cluster&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nx">annotations</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;strimzi.io/kraft&#34;</span><span class="o">:</span> <span class="s2">&#34;enabled&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;strimzi.io/node-pools&#34;</span><span class="o">:</span> <span class="s2">&#34;enabled&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="kr">namespace</span><span class="o">:</span> <span class="s2">&#34;kafka&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="nx">spec</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">kafka</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nx">replicas</span>: <span class="kt">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nx">version</span><span class="o">:</span> <span class="s2">&#34;3.8.0&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nx">storage</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="kr">type</span><span class="o">:</span> <span class="s2">&#34;ephemeral&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="nx">metadataVersion</span><span class="o">:</span> <span class="s2">&#34;3.8-IV0&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nx">listeners</span><span class="o">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nx">name</span><span class="o">:</span> <span class="s2">&#34;plain&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nx">port</span>: <span class="kt">9092</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="kr">type</span><span class="o">:</span> <span class="s2">&#34;internal&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nx">tls</span>: <span class="kt">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nx">name</span><span class="o">:</span> <span class="s2">&#34;tls&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nx">port</span>: <span class="kt">9093</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="kr">type</span><span class="o">:</span> <span class="s2">&#34;internal&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nx">tls</span>: <span class="kt">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="p">],</span>
</span></span><span class="line"><span class="cl">            <span class="nx">config</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;offsets.topic.replication.factor&#34;</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;transaction.state.log.replication.factor&#34;</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;transaction.state.log.min.isr&#34;</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;default.replication.factor&#34;</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;min.insync.replicas&#34;</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nx">entityOperator</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nx">topicOperator</span><span class="o">:</span> <span class="p">{},</span>
</span></span><span class="line"><span class="cl">            <span class="nx">userOperator</span><span class="o">:</span> <span class="p">{},</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl"><span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">new</span> <span class="nx">k8s</span><span class="p">.</span><span class="nx">apiextensions</span><span class="p">.</span><span class="nx">CustomResource</span><span class="p">(</span><span class="s2">&#34;example-kafka-topic&#34;</span><span class="p">,</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">apiVersion</span><span class="o">:</span> <span class="s2">&#34;kafka.strimzi.io/v1beta2&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">kind</span><span class="o">:</span> <span class="s2">&#34;KafkaTopic&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">metadata</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">name</span><span class="o">:</span> <span class="s2">&#34;example-kafka-topic&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nx">labels</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;strimzi.io/cluster&#34;</span><span class="o">:</span> <span class="s2">&#34;example-kafka-cluster&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="kr">namespace</span><span class="o">:</span> <span class="s2">&#34;kafka&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="nx">spec</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">partitions</span>: <span class="kt">5</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nx">replicas</span>: <span class="kt">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nx">config</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;retention.ms&#34;</span><span class="o">:</span> <span class="mi">7200000</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;segment.bytes&#34;</span><span class="o">:</span> <span class="mi">1073741824</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl"><span class="p">});</span>
</span></span></code></pre></div></pulumi-choosable></div><div><pulumi-choosable type="language" values="javascript" mode><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="k">new</span> <span class="nx">k8s</span><span class="p">.</span><span class="nx">apiextensions</span><span class="p">.</span><span class="nx">CustomResource</span><span class="p">(</span><span class="s2">&#34;example-kafka-node-pool&#34;</span><span class="p">,</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">apiVersion</span><span class="o">:</span> <span class="s2">&#34;kafka.strimzi.io/v1beta2&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">kind</span><span class="o">:</span> <span class="s2">&#34;KafkaNodePool&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">metadata</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">name</span><span class="o">:</span> <span class="s2">&#34;example-kafka-node-pool&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nx">labels</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;strimzi.io/cluster&#34;</span><span class="o">:</span> <span class="s2">&#34;example-kafka-cluster&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nx">namespace</span><span class="o">:</span> <span class="s2">&#34;kafka&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="nx">spec</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">replicas</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nx">roles</span><span class="o">:</span> <span class="p">[</span><span class="s2">&#34;controller&#34;</span><span class="p">,</span> <span class="s2">&#34;broker&#34;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="nx">storage</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nx">type</span><span class="o">:</span> <span class="s2">&#34;ephemeral&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl"><span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">new</span> <span class="nx">k8s</span><span class="p">.</span><span class="nx">apiextensions</span><span class="p">.</span><span class="nx">CustomResource</span><span class="p">(</span><span class="s2">&#34;example-kafka-cluster&#34;</span><span class="p">,</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">apiVersion</span><span class="o">:</span> <span class="s2">&#34;kafka.strimzi.io/v1beta2&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">kind</span><span class="o">:</span> <span class="s2">&#34;Kafka&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">metadata</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">name</span><span class="o">:</span> <span class="s2">&#34;example-kafka-cluster&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nx">annotations</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;strimzi.io/kraft&#34;</span><span class="o">:</span> <span class="s2">&#34;enabled&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;strimzi.io/node-pools&#34;</span><span class="o">:</span> <span class="s2">&#34;enabled&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nx">namespace</span><span class="o">:</span> <span class="s2">&#34;kafka&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="nx">spec</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">kafka</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nx">replicas</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nx">version</span><span class="o">:</span> <span class="s2">&#34;3.8.0&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nx">storage</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nx">type</span><span class="o">:</span> <span class="s2">&#34;ephemeral&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="nx">metadataVersion</span><span class="o">:</span> <span class="s2">&#34;3.8-IV0&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nx">listeners</span><span class="o">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nx">name</span><span class="o">:</span> <span class="s2">&#34;plain&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nx">port</span><span class="o">:</span> <span class="mi">9092</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nx">type</span><span class="o">:</span> <span class="s2">&#34;internal&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nx">tls</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nx">name</span><span class="o">:</span> <span class="s2">&#34;tls&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nx">port</span><span class="o">:</span> <span class="mi">9093</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nx">type</span><span class="o">:</span> <span class="s2">&#34;internal&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nx">tls</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="p">],</span>
</span></span><span class="line"><span class="cl">            <span class="nx">config</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;offsets.topic.replication.factor&#34;</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;transaction.state.log.replication.factor&#34;</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;transaction.state.log.min.isr&#34;</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;default.replication.factor&#34;</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;min.insync.replicas&#34;</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nx">entityOperator</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nx">topicOperator</span><span class="o">:</span> <span class="p">{},</span>
</span></span><span class="line"><span class="cl">            <span class="nx">userOperator</span><span class="o">:</span> <span class="p">{},</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl"><span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">new</span> <span class="nx">k8s</span><span class="p">.</span><span class="nx">apiextensions</span><span class="p">.</span><span class="nx">CustomResource</span><span class="p">(</span><span class="s2">&#34;example-kafka-topic&#34;</span><span class="p">,</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">apiVersion</span><span class="o">:</span> <span class="s2">&#34;kafka.strimzi.io/v1beta2&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">kind</span><span class="o">:</span> <span class="s2">&#34;KafkaTopic&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">metadata</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">name</span><span class="o">:</span> <span class="s2">&#34;example-kafka-topic&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nx">labels</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;strimzi.io/cluster&#34;</span><span class="o">:</span> <span class="s2">&#34;example-kafka-cluster&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nx">namespace</span><span class="o">:</span> <span class="s2">&#34;kafka&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="nx">spec</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">partitions</span><span class="o">:</span> <span class="mi">5</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nx">replicas</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nx">config</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;retention.ms&#34;</span><span class="o">:</span> <span class="mi">7200000</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;segment.bytes&#34;</span><span class="o">:</span> <span class="mi">1073741824</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl"><span class="p">});</span>
</span></span></code></pre></div></pulumi-choosable></div><div><pulumi-choosable type="language" values="python" mode><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pulumi_kubernetes</span> <span class="kn">import</span> <span class="n">apiextensions</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">kafka_node_pool</span> <span class="o">=</span> <span class="n">k8s</span><span class="o">.</span><span class="n">apiextensions</span><span class="o">.</span><span class="n">CustomResource</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;example-kafka-node-pool&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">api_version</span><span class="o">=</span><span class="s2">&#34;kafka.strimzi.io/v1beta2&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">kind</span><span class="o">=</span><span class="s2">&#34;KafkaNodePool&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">metadata</span><span class="o">=</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;example-kafka-node-pool&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;labels&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;strimzi.io/cluster&#34;</span><span class="p">:</span> <span class="s2">&#34;example-kafka-cluster&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;namespace&#34;</span><span class="p">:</span> <span class="n">kafka_namespace</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&#34;name&#34;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="n">spec</span><span class="o">=</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;replicas&#34;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;roles&#34;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&#34;controller&#34;</span><span class="p">,</span> <span class="s2">&#34;broker&#34;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;storage&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;ephemeral&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">kafka_cluster</span> <span class="o">=</span> <span class="n">k8s</span><span class="o">.</span><span class="n">apiextensions</span><span class="o">.</span><span class="n">CustomResource</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;example-kafka-cluster&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">api_version</span><span class="o">=</span><span class="s2">&#34;kafka.strimzi.io/v1beta2&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">kind</span><span class="o">=</span><span class="s2">&#34;Kafka&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">metadata</span><span class="o">=</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;example-kafka-cluster&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;annotations&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;strimzi.io/kraft&#34;</span><span class="p">:</span> <span class="s2">&#34;enabled&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;strimzi.io/node-pools&#34;</span><span class="p">:</span> <span class="s2">&#34;enabled&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;namespace&#34;</span><span class="p">:</span> <span class="n">kafka_namespace</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&#34;name&#34;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="n">spec</span><span class="o">=</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;kafka&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;replicas&#34;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;version&#34;</span><span class="p">:</span> <span class="s2">&#34;3.8.0&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;storage&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;ephemeral&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;metadataVersion&#34;</span><span class="p">:</span> <span class="s2">&#34;3.8-IV0&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;listeners&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;plain&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;port&#34;</span><span class="p">:</span> <span class="mi">9092</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;internal&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;tls&#34;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;tls&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;port&#34;</span><span class="p">:</span> <span class="mi">9093</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;internal&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;tls&#34;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="p">],</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;config&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;offsets.topic.replication.factor&#34;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;transaction.state.log.replication.factor&#34;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;transaction.state.log.min.isr&#34;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;default.replication.factor&#34;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;min.insync.replicas&#34;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;entityOperator&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;topicOperator&#34;</span><span class="p">:</span> <span class="p">{},</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;userOperator&#34;</span><span class="p">:</span> <span class="p">{},</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">kafka_topic</span> <span class="o">=</span> <span class="n">k8s</span><span class="o">.</span><span class="n">apiextensions</span><span class="o">.</span><span class="n">CustomResource</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;example-kafka-topic&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">api_version</span><span class="o">=</span><span class="s2">&#34;kafka.strimzi.io/v1beta2&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">kind</span><span class="o">=</span><span class="s2">&#34;KafkaTopic&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">metadata</span><span class="o">=</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;example-kafka-topic&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;labels&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;strimzi.io/cluster&#34;</span><span class="p">:</span> <span class="s2">&#34;example-kafka-cluster&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;namespace&#34;</span><span class="p">:</span> <span class="n">kafka_namespace</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&#34;name&#34;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="n">spec</span><span class="o">=</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;partitions&#34;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;replicas&#34;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;config&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;retention.ms&#34;</span><span class="p">:</span> <span class="mi">7200000</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;segment.bytes&#34;</span><span class="p">:</span> <span class="mi">1073741824</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span></code></pre></div></pulumi-choosable></div><div><pulumi-choosable type="language" values="go" mode><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="kn">package</span> <span class="nx">main</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">	<span class="nx">k8s</span> <span class="s">&#34;github.com/pulumi/pulumi-kubernetes/sdk/v4/go/kubernetes&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="nx">apiv1</span> <span class="s">&#34;github.com/pulumi/pulumi-kubernetes/sdk/v4/go/kubernetes/apiextensions&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="nx">corev1</span> <span class="s">&#34;github.com/pulumi/pulumi-kubernetes/sdk/v4/go/kubernetes/core/v1&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="nx">helmv3</span> <span class="s">&#34;github.com/pulumi/pulumi-kubernetes/sdk/v4/go/kubernetes/helm/v3&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="nx">metav1</span> <span class="s">&#34;github.com/pulumi/pulumi-kubernetes/sdk/v4/go/kubernetes/meta/v1&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="s">&#34;github.com/pulumi/pulumi/sdk/v3/go/pulumi&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">pulumi</span><span class="p">.</span><span class="nf">Run</span><span class="p">(</span><span class="kd">func</span><span class="p">(</span><span class="nx">ctx</span> <span class="o">*</span><span class="nx">pulumi</span><span class="p">.</span><span class="nx">Context</span><span class="p">)</span> <span class="kt">error</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="nx">_</span><span class="p">,</span> <span class="nx">err</span> <span class="p">=</span> <span class="nx">apiv1</span><span class="p">.</span><span class="nf">NewCustomResource</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span> <span class="s">&#34;flux&#34;</span><span class="p">,</span> <span class="o">&amp;</span><span class="nx">apiv1</span><span class="p">.</span><span class="nx">CustomResourceArgs</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="nx">ApiVersion</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;fluxcd.controlplane.io/v1&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">			<span class="nx">Kind</span><span class="p">:</span>       <span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;FluxInstance&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">			<span class="nx">Metadata</span><span class="p">:</span> <span class="o">&amp;</span><span class="nx">metav1</span><span class="p">.</span><span class="nx">ObjectMetaArgs</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="nx">Name</span><span class="p">:</span>      <span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;flux&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">				<span class="nx">Namespace</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;flux-system&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">				<span class="nx">Annotations</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nx">StringMap</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">					<span class="s">&#34;fluxcd.controlplane.io/reconcileEvery&#34;</span><span class="p">:</span>   <span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;1h&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">					<span class="s">&#34;fluxcd.controlplane.io/reconcileTimeout&#34;</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;5m&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">				<span class="p">},</span>
</span></span><span class="line"><span class="cl">			<span class="p">},</span>
</span></span><span class="line"><span class="cl">			<span class="nx">OtherFields</span><span class="p">:</span> <span class="nx">k8s</span><span class="p">.</span><span class="nx">UntypedArgs</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="s">&#34;distribution&#34;</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nx">Map</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">					<span class="s">&#34;version&#34;</span><span class="p">:</span>  <span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;2.x&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">					<span class="s">&#34;registry&#34;</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;ghcr.io/fluxcd&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">					<span class="s">&#34;artifact&#34;</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;oci://ghcr.io/controlplaneio-fluxcd/flux-operator-manifests&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">				<span class="p">},</span>
</span></span><span class="line"><span class="cl">				<span class="s">&#34;components&#34;</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nx">StringArray</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">					<span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;source-controller&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">					<span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;kustomize-controller&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">					<span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;helm-controller&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">					<span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;notification-controller&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">					<span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;image-reflector-controller&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">					<span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;image-automation-controller&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">				<span class="p">},</span>
</span></span><span class="line"><span class="cl">				<span class="s">&#34;cluster&#34;</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nx">Map</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">					<span class="s">&#34;type&#34;</span><span class="p">:</span>          <span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;kubernetes&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">					<span class="s">&#34;multitenant&#34;</span><span class="p">:</span>   <span class="nx">pulumi</span><span class="p">.</span><span class="nf">Bool</span><span class="p">(</span><span class="kc">false</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">					<span class="s">&#34;networkPolicy&#34;</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nf">Bool</span><span class="p">(</span><span class="kc">true</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">					<span class="s">&#34;domain&#34;</span><span class="p">:</span>        <span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;cluster.local&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">				<span class="p">},</span>
</span></span><span class="line"><span class="cl">				<span class="s">&#34;kustomize&#34;</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nx">Map</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">					<span class="s">&#34;patches&#34;</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nx">Array</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">						<span class="nx">pulumi</span><span class="p">.</span><span class="nx">Map</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">							<span class="s">&#34;target&#34;</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nx">Map</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">								<span class="s">&#34;kind&#34;</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;Deployment&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">								<span class="s">&#34;name&#34;</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;(kustomize-controller|helm-controller)&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">							<span class="p">},</span>
</span></span><span class="line"><span class="cl">							<span class="s">&#34;patch&#34;</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nx">Array</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">								<span class="nx">pulumi</span><span class="p">.</span><span class="nx">Map</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">									<span class="s">&#34;op&#34;</span><span class="p">:</span>    <span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;add&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">									<span class="s">&#34;path&#34;</span><span class="p">:</span>  <span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;/spec/template/spec/containers/0/args/-&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">									<span class="s">&#34;value&#34;</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;--concurrent=10&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">								<span class="p">},</span>
</span></span><span class="line"><span class="cl">								<span class="nx">pulumi</span><span class="p">.</span><span class="nx">Map</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">									<span class="s">&#34;op&#34;</span><span class="p">:</span>    <span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;add&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">									<span class="s">&#34;path&#34;</span><span class="p">:</span>  <span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;/spec/template/spec/containers/0/args/-&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">									<span class="s">&#34;value&#34;</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;--requeue-dependency=5s&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">								<span class="p">},</span>
</span></span><span class="line"><span class="cl">							<span class="p">},</span>
</span></span><span class="line"><span class="cl">						<span class="p">},</span>
</span></span><span class="line"><span class="cl">					<span class="p">},</span>
</span></span><span class="line"><span class="cl">				<span class="p">},</span>
</span></span><span class="line"><span class="cl">			<span class="p">},</span>
</span></span><span class="line"><span class="cl">		<span class="p">})</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="k">return</span> <span class="nx">err</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="nx">_</span><span class="p">,</span> <span class="nx">err</span> <span class="p">=</span> <span class="nx">apiv1</span><span class="p">.</span><span class="nf">NewCustomResource</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span> <span class="s">&#34;example-kafka-node-pool&#34;</span><span class="p">,</span> <span class="o">&amp;</span><span class="nx">apiv1</span><span class="p">.</span><span class="nx">CustomResourceArgs</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="nx">ApiVersion</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;kafka.strimzi.io/v1beta2&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">			<span class="nx">Kind</span><span class="p">:</span>       <span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;KafkaNodePool&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">			<span class="nx">Metadata</span><span class="p">:</span> <span class="o">&amp;</span><span class="nx">metav1</span><span class="p">.</span><span class="nx">ObjectMetaArgs</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="nx">Name</span><span class="p">:</span>      <span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;example-kafka-node-pool&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">				<span class="nx">Namespace</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;kafka&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">				<span class="nx">Labels</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nx">StringMap</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">					<span class="s">&#34;strimzi.io/cluster&#34;</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;example-kafka-cluster&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">				<span class="p">},</span>
</span></span><span class="line"><span class="cl">			<span class="p">},</span>
</span></span><span class="line"><span class="cl">			<span class="nx">OtherFields</span><span class="p">:</span> <span class="nx">k8s</span><span class="p">.</span><span class="nx">UntypedArgs</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="s">&#34;replicas&#34;</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nf">Int</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">				<span class="s">&#34;roles&#34;</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nx">StringArray</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">					<span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;controller&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">					<span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;broker&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">				<span class="p">},</span>
</span></span><span class="line"><span class="cl">				<span class="s">&#34;storage&#34;</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nx">Map</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">					<span class="s">&#34;type&#34;</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;ephemeral&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">				<span class="p">},</span>
</span></span><span class="line"><span class="cl">			<span class="p">},</span>
</span></span><span class="line"><span class="cl">		<span class="p">})</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="k">return</span> <span class="nx">err</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="nx">_</span><span class="p">,</span> <span class="nx">err</span> <span class="p">=</span> <span class="nx">apiv1</span><span class="p">.</span><span class="nf">NewCustomResource</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span> <span class="s">&#34;example-kafka-cluster&#34;</span><span class="p">,</span> <span class="o">&amp;</span><span class="nx">apiv1</span><span class="p">.</span><span class="nx">CustomResourceArgs</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="nx">ApiVersion</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;kafka.strimzi.io/v1beta2&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">			<span class="nx">Kind</span><span class="p">:</span>       <span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;Kafka&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">			<span class="nx">Metadata</span><span class="p">:</span> <span class="o">&amp;</span><span class="nx">metav1</span><span class="p">.</span><span class="nx">ObjectMetaArgs</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="nx">Name</span><span class="p">:</span>      <span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;example-kafka-cluster&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">				<span class="nx">Namespace</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;kafka&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">				<span class="nx">Annotations</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nx">StringMap</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">					<span class="s">&#34;strimzi.io/kraft&#34;</span><span class="p">:</span>      <span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;enabled&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">					<span class="s">&#34;strimzi.io/node-pools&#34;</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;enabled&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">				<span class="p">},</span>
</span></span><span class="line"><span class="cl">			<span class="p">},</span>
</span></span><span class="line"><span class="cl">			<span class="nx">OtherFields</span><span class="p">:</span> <span class="nx">k8s</span><span class="p">.</span><span class="nx">UntypedArgs</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="s">&#34;kafka&#34;</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nx">Map</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">					<span class="s">&#34;replicas&#34;</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nf">Int</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">					<span class="s">&#34;version&#34;</span><span class="p">:</span>  <span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;3.8.0&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">					<span class="s">&#34;storage&#34;</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nx">Map</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">						<span class="s">&#34;type&#34;</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;ephemeral&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">					<span class="p">},</span>
</span></span><span class="line"><span class="cl">					<span class="s">&#34;metadataVersion&#34;</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;3.8-IV0&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">					<span class="s">&#34;listeners&#34;</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nx">Array</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">						<span class="nx">pulumi</span><span class="p">.</span><span class="nx">Map</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">							<span class="s">&#34;name&#34;</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;plain&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">							<span class="s">&#34;port&#34;</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nf">Int</span><span class="p">(</span><span class="mi">9092</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">							<span class="s">&#34;type&#34;</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;internal&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">							<span class="s">&#34;tls&#34;</span><span class="p">:</span>  <span class="nx">pulumi</span><span class="p">.</span><span class="nf">Bool</span><span class="p">(</span><span class="kc">false</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">						<span class="p">},</span>
</span></span><span class="line"><span class="cl">						<span class="nx">pulumi</span><span class="p">.</span><span class="nx">Map</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">							<span class="s">&#34;name&#34;</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;tls&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">							<span class="s">&#34;port&#34;</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nf">Int</span><span class="p">(</span><span class="mi">9093</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">							<span class="s">&#34;type&#34;</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;internal&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">							<span class="s">&#34;tls&#34;</span><span class="p">:</span>  <span class="nx">pulumi</span><span class="p">.</span><span class="nf">Bool</span><span class="p">(</span><span class="kc">true</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">						<span class="p">},</span>
</span></span><span class="line"><span class="cl">					<span class="p">},</span>
</span></span><span class="line"><span class="cl">					<span class="s">&#34;config&#34;</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nx">Map</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">						<span class="s">&#34;offsets.topic.replication.factor&#34;</span><span class="p">:</span>         <span class="nx">pulumi</span><span class="p">.</span><span class="nf">Int</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">						<span class="s">&#34;transaction.state.log.replication.factor&#34;</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nf">Int</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">						<span class="s">&#34;transaction.state.log.min.isr&#34;</span><span class="p">:</span>            <span class="nx">pulumi</span><span class="p">.</span><span class="nf">Int</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">						<span class="s">&#34;default.replication.factor&#34;</span><span class="p">:</span>               <span class="nx">pulumi</span><span class="p">.</span><span class="nf">Int</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">						<span class="s">&#34;min.insync.replicas&#34;</span><span class="p">:</span>                      <span class="nx">pulumi</span><span class="p">.</span><span class="nf">Int</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">					<span class="p">},</span>
</span></span><span class="line"><span class="cl">				<span class="p">},</span>
</span></span><span class="line"><span class="cl">				<span class="s">&#34;entityOperator&#34;</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nx">Map</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">					<span class="s">&#34;topicOperator&#34;</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nx">Map</span><span class="p">{},</span>
</span></span><span class="line"><span class="cl">					<span class="s">&#34;userOperator&#34;</span><span class="p">:</span>  <span class="nx">pulumi</span><span class="p">.</span><span class="nx">Map</span><span class="p">{},</span>
</span></span><span class="line"><span class="cl">				<span class="p">},</span>
</span></span><span class="line"><span class="cl">			<span class="p">},</span>
</span></span><span class="line"><span class="cl">		<span class="p">})</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="k">return</span> <span class="nx">err</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="nx">_</span><span class="p">,</span> <span class="nx">err</span> <span class="p">=</span> <span class="nx">apiv1</span><span class="p">.</span><span class="nf">NewCustomResource</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span> <span class="s">&#34;example-kafka-topic&#34;</span><span class="p">,</span> <span class="o">&amp;</span><span class="nx">apiv1</span><span class="p">.</span><span class="nx">CustomResourceArgs</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="nx">ApiVersion</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;kafka.strimzi.io/v1beta2&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">			<span class="nx">Kind</span><span class="p">:</span>       <span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;KafkaTopic&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">			<span class="nx">Metadata</span><span class="p">:</span> <span class="o">&amp;</span><span class="nx">metav1</span><span class="p">.</span><span class="nx">ObjectMetaArgs</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="nx">Name</span><span class="p">:</span>      <span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;example-kafka-topic&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">				<span class="nx">Namespace</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;kafka&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">				<span class="nx">Labels</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nx">StringMap</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">					<span class="s">&#34;strimzi.io/cluster&#34;</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">&#34;example-kafka-cluster&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">				<span class="p">},</span>
</span></span><span class="line"><span class="cl">			<span class="p">},</span>
</span></span><span class="line"><span class="cl">			<span class="nx">OtherFields</span><span class="p">:</span> <span class="nx">k8s</span><span class="p">.</span><span class="nx">UntypedArgs</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="s">&#34;partitions&#34;</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nf">Int</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">				<span class="s">&#34;replicas&#34;</span><span class="p">:</span>   <span class="nx">pulumi</span><span class="p">.</span><span class="nf">Int</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">				<span class="s">&#34;config&#34;</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nx">Map</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">					<span class="s">&#34;retention.ms&#34;</span><span class="p">:</span>  <span class="nx">pulumi</span><span class="p">.</span><span class="nf">Int</span><span class="p">(</span><span class="mi">7200000</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">					<span class="s">&#34;segment.bytes&#34;</span><span class="p">:</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nf">Int</span><span class="p">(</span><span class="mi">1073741824</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">				<span class="p">},</span>
</span></span><span class="line"><span class="cl">			<span class="p">},</span>
</span></span><span class="line"><span class="cl">		<span class="p">})</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="k">return</span> <span class="nx">err</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="k">return</span> <span class="kc">nil</span>
</span></span><span class="line"><span class="cl">	<span class="p">})</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div></pulumi-choosable></div><div><pulumi-choosable type="language" values="csharp" mode><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-csharp" data-lang="csharp"><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">System.Threading.Tasks</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Pulumi</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Pulumi.Kubernetes.Core.V1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Pulumi.Kubernetes.Helm.V3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Pulumi.Kubernetes.Types.Inputs.Core.V1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Pulumi.Kubernetes.Types.Inputs.Helm.V3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Pulumi.Kubernetes.Types.Inputs.Meta.V1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">System.Collections.Generic</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Pulumi.Kubernetes.ApiExtensions</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">KafkaNodePoolArgs</span> <span class="p">:</span> <span class="n">CustomResourceArgs</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">string</span> <span class="n">ApiVersion</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">string</span> <span class="n">Kind</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">ObjectMetaArgs</span> <span class="n">Metadata</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">object</span><span class="p">&gt;</span> <span class="n">Spec</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">KafkaNodePoolArgs</span><span class="p">(</span><span class="kt">string</span> <span class="n">apiVersion</span><span class="p">,</span> <span class="kt">string</span> <span class="n">kind</span><span class="p">)</span> <span class="p">:</span> <span class="k">base</span><span class="p">(</span><span class="n">apiVersion</span><span class="p">,</span> <span class="n">kind</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">KafkaClusterArgs</span> <span class="p">:</span> <span class="n">CustomResourceArgs</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">string</span> <span class="n">ApiVersion</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">string</span> <span class="n">Kind</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">ObjectMetaArgs</span> <span class="n">Metadata</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">object</span><span class="p">&gt;</span> <span class="n">Spec</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">KafkaClusterArgs</span><span class="p">(</span><span class="kt">string</span> <span class="n">apiVersion</span><span class="p">,</span> <span class="kt">string</span> <span class="n">kind</span><span class="p">)</span> <span class="p">:</span> <span class="k">base</span><span class="p">(</span><span class="n">apiVersion</span><span class="p">,</span> <span class="n">kind</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">KafkaTopicArgs</span> <span class="p">:</span> <span class="n">CustomResourceArgs</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">string</span> <span class="n">ApiVersion</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">string</span> <span class="n">Kind</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">ObjectMetaArgs</span> <span class="n">Metadata</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">object</span><span class="p">&gt;</span> <span class="n">Spec</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">KafkaTopicArgs</span><span class="p">(</span><span class="kt">string</span> <span class="n">apiVersion</span><span class="p">,</span> <span class="kt">string</span> <span class="n">kind</span><span class="p">)</span> <span class="p">:</span> <span class="k">base</span><span class="p">(</span><span class="n">apiVersion</span><span class="p">,</span> <span class="n">kind</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">MyStack</span> <span class="p">:</span> <span class="n">Stack</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">MyStack</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kt">var</span> <span class="n">kafkaNodePool</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Pulumi</span><span class="p">.</span><span class="n">Kubernetes</span><span class="p">.</span><span class="n">ApiExtensions</span><span class="p">.</span><span class="n">CustomResource</span><span class="p">(</span><span class="s">&#34;exampleKafkaNodePool&#34;</span><span class="p">,</span> <span class="k">new</span> <span class="n">KafkaNodePoolArgs</span><span class="p">(</span><span class="s">&#34;kafka.strimzi.io/v1beta2&#34;</span><span class="p">,</span> <span class="s">&#34;KafkaNodePool&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="n">ApiVersion</span> <span class="p">=</span> <span class="s">&#34;kafka.strimzi.io/v1beta2&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="n">Kind</span> <span class="p">=</span> <span class="s">&#34;KafkaNodePool&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="n">Metadata</span> <span class="p">=</span> <span class="k">new</span> <span class="n">ObjectMetaArgs</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="n">Name</span> <span class="p">=</span> <span class="s">&#34;example-kafka-node-pool&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="n">Labels</span> <span class="p">=</span>
</span></span><span class="line"><span class="cl">                        <span class="p">{</span>
</span></span><span class="line"><span class="cl">                            <span class="p">{</span> <span class="s">&#34;strimzi.io/cluster&#34;</span><span class="p">,</span> <span class="s">&#34;example-kafka-cluster&#34;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">                        <span class="p">}</span>
</span></span><span class="line"><span class="cl">                    <span class="p">},</span>
</span></span><span class="line"><span class="cl">                    <span class="n">Spec</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">object</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="p">{</span> <span class="s">&#34;replicas&#34;</span><span class="p">,</span> <span class="m">1</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">                        <span class="p">{</span> <span class="s">&#34;roles&#34;</span><span class="p">,</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span> <span class="p">{</span> <span class="s">&#34;controller&#34;</span><span class="p">,</span> <span class="s">&#34;broker&#34;</span> <span class="p">}</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">                        <span class="p">{</span> <span class="s">&#34;storage&#34;</span><span class="p">,</span> <span class="k">new</span> <span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">object</span><span class="p">&gt;</span> <span class="p">{</span> <span class="p">{</span> <span class="s">&#34;type&#34;</span><span class="p">,</span> <span class="s">&#34;ephemeral&#34;</span> <span class="p">}</span> <span class="p">}</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="kt">var</span> <span class="n">kafkaCluster</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Pulumi</span><span class="p">.</span><span class="n">Kubernetes</span><span class="p">.</span><span class="n">ApiExtensions</span><span class="p">.</span><span class="n">CustomResource</span><span class="p">(</span><span class="s">&#34;exampleKafkaCluster&#34;</span><span class="p">,</span> <span class="k">new</span> <span class="n">KafkaClusterArgs</span><span class="p">(</span><span class="s">&#34;kafka.strimzi.io/v1beta2&#34;</span><span class="p">,</span> <span class="s">&#34;Kafka&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">ApiVersion</span> <span class="p">=</span> <span class="s">&#34;kafka.strimzi.io/v1beta2&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">Kind</span> <span class="p">=</span> <span class="s">&#34;Kafka&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">Metadata</span> <span class="p">=</span> <span class="k">new</span> <span class="n">ObjectMetaArgs</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">Name</span> <span class="p">=</span> <span class="s">&#34;example-kafka-cluster&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="n">Annotations</span> <span class="p">=</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span> <span class="s">&#34;strimzi.io/kraft&#34;</span><span class="p">,</span> <span class="s">&#34;enabled&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span> <span class="s">&#34;strimzi.io/node-pools&#34;</span><span class="p">,</span> <span class="s">&#34;enabled&#34;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="n">Spec</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">object</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span> <span class="s">&#34;kafka&#34;</span><span class="p">,</span> <span class="k">new</span> <span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">object</span><span class="p">&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span> <span class="s">&#34;replicas&#34;</span><span class="p">,</span> <span class="m">1</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span> <span class="s">&#34;version&#34;</span><span class="p">,</span> <span class="s">&#34;3.8.0&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span> <span class="s">&#34;storage&#34;</span><span class="p">,</span> <span class="k">new</span> <span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">object</span><span class="p">&gt;</span> <span class="p">{</span> <span class="p">{</span> <span class="s">&#34;type&#34;</span><span class="p">,</span> <span class="s">&#34;ephemeral&#34;</span> <span class="p">}</span> <span class="p">}</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span> <span class="s">&#34;metadataVersion&#34;</span><span class="p">,</span> <span class="s">&#34;3.8-IV0&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span> <span class="s">&#34;listeners&#34;</span><span class="p">,</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">object</span><span class="p">&gt;&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="k">new</span> <span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">object</span><span class="p">&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                            <span class="p">{</span> <span class="s">&#34;name&#34;</span><span class="p">,</span> <span class="s">&#34;plain&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">                            <span class="p">{</span> <span class="s">&#34;port&#34;</span><span class="p">,</span> <span class="m">9092</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">                            <span class="p">{</span> <span class="s">&#34;type&#34;</span><span class="p">,</span> <span class="s">&#34;internal&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">                            <span class="p">{</span> <span class="s">&#34;tls&#34;</span><span class="p">,</span> <span class="kc">false</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">                        <span class="p">},</span>
</span></span><span class="line"><span class="cl">                        <span class="k">new</span> <span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">object</span><span class="p">&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                            <span class="p">{</span> <span class="s">&#34;name&#34;</span><span class="p">,</span> <span class="s">&#34;tls&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">                            <span class="p">{</span> <span class="s">&#34;port&#34;</span><span class="p">,</span> <span class="m">9093</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">                            <span class="p">{</span> <span class="s">&#34;type&#34;</span><span class="p">,</span> <span class="s">&#34;internal&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">                            <span class="p">{</span> <span class="s">&#34;tls&#34;</span><span class="p">,</span> <span class="kc">true</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">                        <span class="p">}</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}},</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span> <span class="s">&#34;config&#34;</span><span class="p">,</span> <span class="k">new</span> <span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">object</span><span class="p">&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="p">{</span> <span class="s">&#34;offsets.topic.replication.factor&#34;</span><span class="p">,</span> <span class="m">1</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">                        <span class="p">{</span> <span class="s">&#34;transaction.state.log.replication.factor&#34;</span><span class="p">,</span> <span class="m">1</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">                        <span class="p">{</span> <span class="s">&#34;transaction.state.log.min.isr&#34;</span><span class="p">,</span> <span class="m">1</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">                        <span class="p">{</span> <span class="s">&#34;default.replication.factor&#34;</span><span class="p">,</span> <span class="m">1</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">                        <span class="p">{</span> <span class="s">&#34;min.insync.replicas&#34;</span><span class="p">,</span> <span class="m">1</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}}</span>
</span></span><span class="line"><span class="cl">                <span class="p">}},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span> <span class="s">&#34;entityOperator&#34;</span><span class="p">,</span> <span class="k">new</span> <span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">object</span><span class="p">&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span> <span class="s">&#34;topicOperator&#34;</span><span class="p">,</span> <span class="k">new</span> <span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">object</span><span class="p">&gt;()</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span> <span class="s">&#34;userOperator&#34;</span><span class="p">,</span> <span class="k">new</span> <span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">object</span><span class="p">&gt;()</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="p">}}</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="kt">var</span> <span class="n">kafkaTopic</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Pulumi</span><span class="p">.</span><span class="n">Kubernetes</span><span class="p">.</span><span class="n">ApiExtensions</span><span class="p">.</span><span class="n">CustomResource</span><span class="p">(</span><span class="s">&#34;exampleKafkaTopic&#34;</span><span class="p">,</span> <span class="k">new</span> <span class="n">KafkaTopicArgs</span><span class="p">(</span><span class="s">&#34;kafka.strimzi.io/v1beta2&#34;</span><span class="p">,</span> <span class="s">&#34;KafkaTopic&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">ApiVersion</span> <span class="p">=</span> <span class="s">&#34;kafka.strimzi.io/v1beta2&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">Kind</span> <span class="p">=</span> <span class="s">&#34;KafkaTopic&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">Metadata</span> <span class="p">=</span> <span class="k">new</span> <span class="n">ObjectMetaArgs</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">Name</span> <span class="p">=</span> <span class="s">&#34;example-kafka-topic&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="n">Labels</span> <span class="p">=</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span> <span class="s">&#34;strimzi.io/cluster&#34;</span><span class="p">,</span> <span class="s">&#34;example-kafka-cluster&#34;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="n">Spec</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">object</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span> <span class="s">&#34;partitions&#34;</span><span class="p">,</span> <span class="m">5</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span> <span class="s">&#34;replicas&#34;</span><span class="p">,</span> <span class="m">1</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span> <span class="s">&#34;config&#34;</span><span class="p">,</span> <span class="k">new</span> <span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">object</span><span class="p">&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span> <span class="s">&#34;retention.ms&#34;</span><span class="p">,</span> <span class="m">7200000</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span> <span class="s">&#34;segment.bytes&#34;</span><span class="p">,</span> <span class="m">1073741824</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="p">}}</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">});</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Program</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">static</span> <span class="n">Task</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;</span> <span class="n">Main</span><span class="p">()</span> <span class="p">=&gt;</span> <span class="n">Deployment</span><span class="p">.</span><span class="n">RunAsync</span><span class="p">&lt;</span><span class="n">MyStack</span><span class="p">&gt;();</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div></pulumi-choosable></div><h4 id="summary-2">Summary</h4><p>The Strimzi Operator demonstrates the power of Kubernetes Operators by providing full lifecycle management for Apache Kafka on Kubernetes. It takes care of the heavy lifting of deploying and managing Kafka clusters, making the Strimzi Operator a valuable tool that should be part of every Kubernetes-powered platform, as it covers a wide range of use cases.</p><h2 id="conclusion">Conclusion</h2><p>In this blog post, I highlighted the importance of Kubernetes Operators for platform engineers and how they can harness the advanced automation capabilities of operators to simplify deploying, managing, and scaling applications and services on Kubernetes.</p><p>I provided some examples of advanced Kubernetes operators that I recommend, but if you want to try using Kubernetes Operators in your Kubernetes-powered platform, here are some great guides to get you started with Pulumi and Kubernetes:</p><section class="my-16"><div class="container mx-auto max-w-5xl md:flex my-8 align-top justify-center text-center"><div class="md:w3-/12 mr-4"><h2 class="no-anchor">Get Started with Pulumi</h2><p class="text-gray-700 text-sm">Use Pulumi's open-source SDK to create, deploy, and manage infrastructure on any cloud.</p></div></div><div class="mx-auto max-w-4xl"><div class="tiles flex-wrap mt-4"><div class="pb-4 md:pr-4 md:w-1/2"><a class="tile p-8" href="/docs/iac/get-started/aws/"><img class="h-10 mx-auto" src="/logos/tech/aws.svg" alt="AWS"></a></div><div class="pb-4 md:w-1/2"><a class="tile p-8" href="/docs/iac/get-started/azure/"><img class="h-10 mx-auto" src="/logos/tech/azure.svg" alt="Azure"></a></div><div class="pb-4 md:pr-4 md:w-1/2"><a class="tile p-8" href="/docs/iac/get-started/gcp/"><img class="h-10 mx-auto" src="/logos/tech/gcp.svg" alt="Google Cloud"></a></div><div class="pb-4 md:w-1/2"><a class="tile p-8" href="/docs/iac/get-started/kubernetes/"><img class="h-10 mx-auto" src="/logos/tech/k8s.svg" alt="Kubernetes"></a></div></div></div></section></section><div><ul class="tags m-0 mt-8 p-0 text-sm"><li class="mt-0 inline-flex"><a class="tag tag-blog" href="/blog/tag/kubernetes/">kubernetes</a></li><li class="mt-0 inline-flex"><a class="tag tag-blog" href="/blog/tag/operators/">operators</a></li><li class="mt-0 inline-flex"><a class="tag tag-blog" href="/blog/tag/devops/">devops</a></li><li class="mt-0 inline-flex"><a class="tag tag-blog" href="/blog/tag/platform-engineering/">platform-engineering</a></li></ul></div><section class="py-8 newsletter-input"><div class="container mx-auto"><div class="text-center"><h4>Subscribe to the Pulumi Monthly Newsletter</h4><div class="inline-block"><pulumi-hubspot-form form-id="6d45d68a-4244-4f23-bbec-941f8ccb2b44" class="newsletter newsletter-dark-border"></pulumi-hubspot-form></div></div></div></section></article></div></div><div class="xxl:w-3/12 lg:pl-8"><div class="sticky-sidebar"><p class="text-gray-500 text-xs">Share this post</p><ul class="p-0 list-none"><li><a data-track="share-twitter" class="mr-2" href="https://twitter.com/intent/tweet?text=Why%20Every%20Platform%20Engineer%20Should%20Care%20About%20Kubernetes%20Operators&tw_p=tweetbutton&url=https%3a%2f%2fwww.pulumi.com%2fblog%2fwhy-every-platform-engineer-should-care-about-kubernetes-operators%2f" target="_blank"><i class="fab fa-twitter text-xl"></i>
</a><a data-track="share-linkedin" href="https://www.linkedin.com/sharing/share-offsite/?url=https%3a%2f%2fwww.pulumi.com%2fblog%2fwhy-every-platform-engineer-should-care-about-kubernetes-operators%2f" target="_blank"><i class="fab fa-linkedin text-xl"></i></a></li></ul><div class="mt-8 docs-marketing-ad w-44"><a href="https://info.pulumi.com/platform-engineering-workshop-series" data-track="docs-platform-engineering-workshop-ad"><img src="/images/docs/ad/workshop-series-ad.gif" alt="Platform Engineering Workshop Series - Register Now"></a></div></div></div></div></div><copilot-sidebar copilot-src="/pulumi-ai/copilot/sidebar?hostApp=docs&apiHost=https%3A%2F%2Fapp.pulumi.com%2Fai"></copilot-sidebar></main><nav class="footer"><div class="container mx-auto"><div class="footer-nav-container"><div class="hidden md:w-1/12"></div><ul><li><a data-track="footer-get-started" href="/docs/get-started/" class="link">Get Started</a></li><li><a data-track="footer-documentation" href="/docs/" class="link">Documentation</a></li><li><a data-track="footer-apis" href="/registry/" class="link">Registry</a></li><li><a data-track="public-roadmap" href="https://github.com/orgs/pulumi/projects/44/" class="link">Public Roadmap</a></li><li><a data-track="footer-security" href="/security/" class="link">Security</a></li><li><a data-track="footer-signup" href="https://app.pulumi.com/signup" class="link">Signup</a></li></ul><ul><li><a data-track="footer-enterprise" href="/enterprise/" class="link">Enterprise</a></li><li><a data-track="footer-platform-engineering" href="/product/internal-developer-platforms/" class="link">Platform Engineering</a></li><li><a data-track="footer-artificial-intelligence" href="/solutions/ai/" class="link">Artificial Intelligence</a></li><li><a data-track="footer-aws" href="/aws/" class="link">AWS</a></li><li><a data-track="footer-azure" href="/azure/" class="link">Azure</a></li><li><a data-track="footer-gcp" href="/gcp/" class="link">Google Cloud</a></li><li><a href="/kubernetes/" class="link">Kubernetes</a></li></ul><ul><li><a data-track="footer-events" href="/case-studies/" class="link">Case Studies</a></li><li><a data-track="footer-contact-us" href="/request-a-demo/" class="link">Request a Demo</a></li><li><a data-track="footer-contact-us" href="/contact/" class="link">Talk to a Human</a></li><li><a data-track="footer-professional-services" href="/proserv/" class="link">Professional Services</a></li><li><a data-track="footer-support" href="https://support.pulumi.com/" class="link">Support</a></li><li><a data-track="footer-events" href="/resources/" class="link">Events</a></li></ul><ul><li><a data-track="footer-about-us" href="/about/" class="link">About Us</a></li><li><a data-track="footer-community" href="/community/" class="link">Community</a></li><li><a data-track="footer-careers" href="/careers/" class="link">Careers</a></li><li><a data-track="footer-events" href="/awards/" class="link">Awards & Recognitions</a></li><li><a data-track="footer-brand" href="/brand/" class="link">Brand Resources</a></li><li><a class="link cursor-pointer" onclick=window.consentManager.openConsentManager()>Your Website Preferences</a></li></ul></div><div class="border mt-16"></div><section class="py-8 px-4"><div class="container mx-auto"><div class="flex justify-center flex-col flex-row text-center"><h4>Sign up for our newsletter</h4><div class="flex justify-center my-3"><pulumi-hubspot-form form-id="027b4c6d-9b73-4ad8-b149-3c8b07fff608" class="newsletter newsletter-dark-border"></pulumi-hubspot-form></div></div></div></section><ul class="py-8 flex flex-col text-center md:text-left md:flex-row md:justify-center"><li class="mr-2 mb-4 lg:mb-0 lg:mr-8 font-semibold"><a class="link" data-track="footer-legal-trademark-usage" href="/trademark/">Trademark Usage</a></li><li class="mr-2 mb-4 lg:mb-0 lg:mr-8 font-semibold"><a class="link" data-track="footer-legal-acceptable-use-policy" href="/acceptable-use/">Acceptable Use Policy</a></li><li class="mr-2 mb-4 lg:mb-0 lg:mr-8 font-semibold"><a class="link" data-track="footer-legal-terms-conditions" href="/terms-and-conditions/">Terms & Conditions</a></li><li class="mr-2 mb-4 lg:mb-0 lg:mr-8 font-semibold"><a class="link" data-track="footer-legal-privacy-policy" href="/privacy/">Privacy Policy</a></li><li class="mr-2 mb-4 lg:mb-0 lg:mr-8 font-semibold"><a class="link" data-track="footer-legal-professional-services-agreement" href="/professional-services-agreement/">Professional Services Agreement</a></li></ul><div class="text-center mb-8"><p class="text-black mb-8">&copy; Pulumi 2024</p><ul class="flex inline-items text-2xl justify-center"><li class="mr-8"><a data-track="footer-twitter" href="https://twitter.com/pulumicorp" target="_blank"><img class="h-6" src="/logos/tech/twitter.svg" alt="Pulumi Twitter"></a></li><li class="mr-8"><a data-track="footer-slack" href="https://slack.pulumi.com/" target="_blank"><img class="h-6" src="/logos/tech/slack.svg" alt="Pulumi Slack"></a></li><li class="mr-8"><a data-track="footer-linkedin" href="https://www.linkedin.com/company/pulumi/" target="_blank"><img class="h-6" src="/logos/tech/linkedin.svg" alt="Pulumi LinkedIn"></a></li><li class="mr-8"><a data-track="footer-youtube" href="https://www.youtube.com/channel/UC2Dhyn4Ev52YSbcpfnfP0Mw" target="_blank"><img class="h-6" src="/logos/tech/youtube.svg" alt="Pulumi YouTube"></a></li><li><a data-track="footer-github" href="https://github.com/pulumi/" target="_blank"><img class="h-6" src="/logos/tech/github.svg" alt="Pulumi Github"></a></li></ul></div></div></nav><div id="segment-consent-manager"></div></body></html>