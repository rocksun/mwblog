<!--
title:  容器安全犹如牙医检查
cover: https://cdn.thenewstack.io/media/2023/11/7d0124a2-container-security-dental-1024x870.jpg
-->

容器维护就像牙科检查，不喜欢做但必须坚持，否则问题只会加剧。

> 译自 [Why Securing Containers Is Like Going to the Dentist](https://thenewstack.io/why-securing-containers-is-like-going-to-the-dentist/)，作者 Neta Krakover 是 Slim.AI 的工程主管，这是一家总部位于波士顿、专注于优化和保护云原生应用程序的初创公司。Krakover 是一名资深软件工程师，拥有超过 15 年的团队管理经验。Krakover 已经建立了优秀的技术领导能力的记录......

完成软件系统安全检查就像进行常规牙科检查一样，许多人都会推迟。无论是对去牙医诊所有点紧张，还是不想承担费用支出，亦或是日程排得太满，无法抽出时间进行这类定期维护，这都是一项易被延期或降低优先级的常规维护项目。

使容器安全化也有类似的情况。它有助于生态系统健康，但工程师推迟对[容器进行重要的安全维护](https://thenewstack.io/building-and-securing-containers-with-slim-ai/)存在许多原因。IT 管理层有必要了解这种抵抗，以及不经常强化或修补容器对应用程序安全性的影响。

## 加固容器暴露出技能差距

漏洞扫描器会产生大量数据，这可能让工程师(包括安全方面经验丰富的工程师)不知所措。与有用信息相比，扫描器报告的噪音较多。

在许多公司中，工程师没有足够的安全知识和培训来理解关键漏洞的严重性，更不用说定位和缓解它们的专业知识了。根据组织结构的不同，缓解可能需要工程师进行代码更改，或者 [DevOps](https://roadmap.sh/devops) 更改他们所拥有的基础容器镜像。

根据 [2022 年 Slim.AI 公共容器报告](https://www.slim.ai/blog/container-report-2022/)，只有 26% 的开发者有信心他们具备将容器用于生产的安全知识。开发人员和 DevOps 可能会认识到需要修补某些软件包，但软件包仍然 rarely 被修复。安全专业人员必须投入大量时间对漏洞进行分类和路由，这取决于公司的风险偏好和组织结构。随着公司的增长，分类和路由过程会变得更加困难，可能会占用服务级协议 (SLA) 中分配的大部分时间。

即使分类流程高效，能过滤出最相关和可操作的漏洞，缓解也可能不是一个简单或快速的任务。例如，即使扫描器指出补丁可用，补丁可能适用于间接使用的漏洞软件包，这会使直接依赖项保持未修补状态。这样就白白浪费了工程师几个小时的时间，没有获得明显的产品或安全价值。如果要替换你直接使用的软件包，可能还需要付出重大努力。真令人沮丧！

如果所有的星星都排列齐全，并且您使用的软件包有可用的补丁，工程师可能需要对代码进行更改以适应新的软件包API，以修复库中引入的破坏性更改。这假设测试覆盖率足够高，可以防止代码的行为发生负面改变。哦，但是等等——然后您可能会在同一容器中的其他地方发现相同的漏洞，有时代码仍间接使用它。更多的时间流逝，代码更少的稳定性，扫描漏洞计数没有变化。更多的沮丧！

的确，处理单个漏洞可能是痛苦的，沮丧情绪可以在广袤的容器景观中迅速升级，每个容器可能存在数千个漏洞。组织可能监督数百个容器，导致令人震惊的时间浪费，沮丧情绪激增，以及产品价值的明显缺失。更糟糕的是，当您建立了持续的修补和软件包维护时，进行次要软件包版本更新可能需要“几个小时”，但这与更新主要版本或更换快要结束生命周期的软件包所需的时间差得远了。

类比牙科检查，如果你不定期去看牙医，当你终于去的时候，检查时间可能会更长(并更加不愉快)。

## 组织层面的容器更新挑战

抛开软件包更新和处理漏洞的技术和知识差距不谈，从组织角度看，也存在严重障碍，尤其是在确定工作优先级方面。

许多工程师认为加固容器是没有产品价值的单调工作。即使安全团队强烈要求解决，工程管理也可能不会优先考虑或激励容器安全，因为安全很少是工程度量标准。没有 CEO 会说：“好样的，工程师们，没有安全漏洞，也交付了更少的产品价值。” 工程师很少将容器安全视为影响底线的活动。因此，除非安全团队特别有效地使其量化，否则它通常不被视为优先事项。

直到客户由于未解决或新发现的漏洞而拒绝部署新版本，情况才会发生变化。此时高管层介入，问题立即成为最优先事项，因为它直接影响收入。

回到牙科检查的类比：如果你忽略了常规检查，你可能需要根管治疗，这时候事情变成全员参与的情况。这并不理想。

即使是那些采取措施在开发过程中避免引入新漏洞的工程组织(例如使用预提交挂钩)，也并不安全。新漏洞总是在出现和被发现，这对工程师在漏洞被发现后解决它们施加了巨大的负担，通常是在代码开发和交付之后。新漏洞可能出现在一段时间未更改的代码中，需要大量努力和时间来解决，这会阻碍工程师的所有其他工作。

## 安全维护最佳实践

一个更好的场景是，当一家公司积极主动地修复漏洞时，它会提前向客户说明发现的漏洞，并解释解决漏洞的时间和方式。采取这种方法的公司不仅可以减少惊喜和故障演练，获得客户信任，还可以为反复扫描其容器的组织节省大量工作量。

定期进行检查可以避免之后更痛苦的经历。同样，尽管每天投入少量时间保持所用软件包的最新状态可能看起来很麻烦，但这比不管常规更新的替代方案要好得多:如果你忽略常规更新，你在时间和破坏性变更方面付出的代价将会更高。

低估定期维护容器更新的负面影响是不明智的。俗话说，“防患于未然胜于救急。” 以下是一些可以帮助您的组织保持良好的容器运行状况的预防和补救策略。

## 左移检测和预防

- 尽快扫描一切。最好的地方是在开发人员开发功能时的集成开发环境 (IDE) 中。这样，一旦在代码中引入漏洞，或者至少在代码推送到 CI/CD 时，可以识别出这些漏洞。
- 使用多种扫描器持续扫描，以实现尽早检测。关键是在客户发现之前找到漏洞(避免紧急事故和管理层介入)。
- 通过使用更小的基础镜像和多步容器构建以及瘦身(从容器中删除未使用的代码)来最小化不必要的代码。
- 自动更新软件包，以始终使用最新稳定版本(当可能时)。
- 在引入新软件包时，将安全评估纳入设计流程的一部分。
- 为团队中的工程师提供充分的安全教育，使他们了解维护代码的重要性，并能够尽早做出更好的决策。

## 补救策略

- 通过捕获所有权和容器维护人员来改善路由，以便根据漏洞类型和包管理器将补救责任分配给负责团队。
- 确保安全和工程领导层进行良好协作，具有适当的合同，并基于系统配置使用适当的分类流程。这包括减少噪音并在适用时添加注释。请注意，注释就是补救。
- 确保您的 CI/CD 管道是现代的，并且您的软件经过彻底测试，以使修补尽可能[快速和自动化](https://thenewstack.io/slim-ai-automating-vulnerability-remediation-for-a-shift-left-world/)，而不降低软件质量。
- 使用维护良好的软件包，具有信誉良好的作者和大量社区。如果还没有，请添加审核流程以考虑这些因素来审核您的供应链依赖项。

就像没有人想被一个本可以通过常规检查预防的牙科急诊事件所打击一样，工程团队也不希望在本可以通过常规容器更新解决的漏洞问题上措手不及。工程领导者需要优先考虑教育和激励开发人员定期扫描、自动化、测试和优化容器，作为常规容器维护的重要工作。这对您的生态系统健康以及最重要的客户关系至关重要。

