<!DOCTYPE html><html lang="en"><head><meta charSet="UTF-8" /><meta name="viewport" content="width=device-width,initial-scale=1" /><link rel="icon" type="image/svg+xml" href="/favicon.svg" /><link rel="mask-icon" type="image/svg+xml" href="/favicon.svg" color="#000000" /><title>End to End encrypted secrets deployment to Kubernetes | Phase Blog</title><meta name="robots" content="index,follow" /><meta name="description" content="Securely deploying secrets to Kubernetes with Phase" /><meta property="og:title" content="End to End encrypted secrets deployment to Kubernetes | Phase Blog" /><meta property="og:description" content="Securely deploying secrets to Kubernetes with Phase" /><meta property="og:url" content="https://phase.dev" /><meta property="og:image" content="https://phase.dev/assets/images/blog/kubernetes/output.webp" /><meta property="og:image:alt" content="phase.dev" /><meta property="og:image:type" content="image/webp" /><meta property="og:image:width" content="1200" /><meta property="og:image:height" content="630" /><meta property="og:locale" content="en" /><meta property="og:site_name" content="phase" /><link rel="canonical" href="https://phase.dev" /><meta name="next-head-count" content="18" /><link rel="preload" href="/_next/static/media/c9a5bc6a7c948fb0.p.woff2" as="font" type="font/woff2" crossorigin="anonymous" data-next-font /><link rel="preload" href="/_next/static/css/33c861132a66ac82.css" as="style" crossorigin /><link rel="stylesheet" href="/_next/static/css/33c861132a66ac82.css" crossorigin data-n-g /><noscript data-n-css></noscript><script defer crossorigin nomodule src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/assets/asciinema/asciinema-player.min.js" defer data-nscript="beforeInteractive" crossorigin></script><script src="/_next/static/chunks/webpack-e0625a99da900f0f.js" defer crossorigin></script><script src="/_next/static/chunks/framework-f707628ec3f247aa.js" defer crossorigin></script><script src="/_next/static/chunks/main-7b54f93fccdc5834.js" defer crossorigin></script><script src="/_next/static/chunks/pages/_app-07bdadd331c5a721.js" defer crossorigin></script><script src="/_next/static/chunks/d9067523-0bef302d6e498823.js" defer crossorigin></script><script src="/_next/static/chunks/e21e5bbe-50f81974f561b696.js" defer crossorigin></script><script src="/_next/static/chunks/cb355538-7defbc376cfa9a84.js" defer crossorigin></script><script src="/_next/static/chunks/902-2bad2e06e109a2f2.js" defer crossorigin></script><script src="/_next/static/chunks/199-85e9fd2bcbf6d146.js" defer crossorigin></script><script src="/_next/static/chunks/pages/blog/%5Bslug%5D-622f2ca5b69710cf.js" defer crossorigin></script><script src="/_next/static/9jZFK-2PGcU00dlET0GvC/_buildManifest.js" defer crossorigin></script><script src="/_next/static/9jZFK-2PGcU00dlET0GvC/_ssgManifest.js" defer crossorigin></script></head><body><div id="__next"><div class="__className_918210"><div class="min-h-screen w-full bg-zinc-950 antialiased"><div><header class="fixed z-50 w-full border-violet-200/10 bg-black/0 transition-all ease-in-out  " data-testid="navbar"><nav class="mx-auto flex w-full max-w-screen-lg items-center justify-between px-4 py-2 md:p-4 2xl:max-w-screen-2xl"><a class="group flex items-center gap-1 border-none text-2xl font-light text-white md:text-4xl" href="/"><div class="hidden md:block"><svg viewBox="0 0 1604 622" fill="none" xmlns="http://www.w3.org/2000/svg" class="ease w-32 fill-white transition group-hover:fill-emerald-500"><g clip-path="url(#clip0_625_16)"><path fill-rule="evenodd" clip-rule="evenodd" d="M187.661 486.576L169 578L194.475 583.2L213.226 491.334C220.135 492.12 227.161 492.523 234.28 492.523C336.055 492.523 418.561 410.018 418.561 308.243C418.561 224.668 362.925 154.087 286.669 131.516L304.695 43.1997L279.221 38L261.274 125.926C252.463 124.633 243.45 123.963 234.28 123.963C132.505 123.963 50 206.468 50 308.243C50 393.912 108.458 465.928 187.661 486.576ZM223.078 443.066C226.772 443.369 230.508 443.523 234.28 443.523C308.993 443.523 369.561 382.956 369.561 308.243C369.561 248.39 330.691 197.616 276.817 179.786L223.078 443.066ZM251.453 174.042L197.482 438.458C140.652 422.431 99 370.201 99 308.243C99 233.53 159.567 172.963 234.28 172.963C240.097 172.963 245.829 173.33 251.453 174.042Z"></path><path d="M498.42 506.818V206.818H548.989V242.898H551.972C554.623 237.595 558.364 231.96 563.193 225.994C568.023 219.934 574.557 214.773 582.795 210.511C591.034 206.155 601.545 203.977 614.33 203.977C631.186 203.977 646.384 208.286 659.926 216.903C673.563 225.426 684.358 238.068 692.312 254.83C700.362 271.496 704.386 291.951 704.386 316.193C704.386 340.152 700.456 360.511 692.597 377.273C684.737 394.034 674.036 406.818 660.494 415.625C646.953 424.432 631.612 428.835 614.472 428.835C601.972 428.835 591.602 426.752 583.364 422.585C575.125 418.419 568.496 413.4 563.477 407.528C558.553 401.562 554.718 395.928 551.972 390.625H549.841V506.818H498.42ZM548.847 315.909C548.847 330.019 550.835 342.377 554.812 352.983C558.884 363.589 564.708 371.875 572.284 377.841C579.955 383.712 589.235 386.648 600.125 386.648C611.489 386.648 621.006 383.617 628.676 377.557C636.347 371.402 642.123 363.021 646.006 352.415C649.983 341.714 651.972 329.545 651.972 315.909C651.972 302.367 650.03 290.341 646.148 279.83C642.265 269.318 636.489 261.08 628.818 255.114C621.148 249.148 611.583 246.165 600.125 246.165C589.14 246.165 579.812 249.053 572.142 254.83C564.472 260.606 558.648 268.703 554.67 279.119C550.788 289.536 548.847 301.799 548.847 315.909ZM775.841 297.159V425H724.42V134.091H774.705V243.892H777.261C782.375 231.581 790.282 221.875 800.983 214.773C811.778 207.576 825.509 203.977 842.176 203.977C857.328 203.977 870.538 207.15 881.807 213.494C893.076 219.839 901.788 229.119 907.943 241.335C914.193 253.551 917.318 268.466 917.318 286.08V425H865.898V294.034C865.898 279.356 862.11 267.945 854.534 259.801C847.053 251.562 836.542 247.443 823 247.443C813.909 247.443 805.765 249.432 798.568 253.409C791.466 257.292 785.879 262.926 781.807 270.312C777.83 277.699 775.841 286.648 775.841 297.159ZM1008.52 429.403C994.691 429.403 982.239 426.941 971.159 422.017C960.174 416.998 951.462 409.612 945.023 399.858C938.678 390.104 935.506 378.078 935.506 363.778C935.506 351.468 937.778 341.288 942.324 333.239C946.869 325.189 953.072 318.75 960.932 313.92C968.792 309.091 977.646 305.445 987.494 302.983C997.438 300.426 1007.71 298.58 1018.32 297.443C1031.1 296.117 1041.47 294.934 1049.43 293.892C1057.38 292.756 1063.16 291.051 1066.76 288.778C1070.45 286.411 1072.3 282.765 1072.3 277.841V276.989C1072.3 266.288 1069.12 258.002 1062.78 252.131C1056.43 246.259 1047.3 243.324 1035.36 243.324C1022.77 243.324 1012.78 246.07 1005.39 251.562C998.1 257.055 993.176 263.542 990.619 271.023L942.608 264.205C946.396 250.947 952.646 239.867 961.358 230.966C970.07 221.97 980.723 215.246 993.318 210.795C1005.91 206.25 1019.83 203.977 1035.08 203.977C1045.59 203.977 1056.05 205.208 1066.47 207.67C1076.89 210.133 1086.41 214.205 1095.02 219.886C1103.64 225.473 1110.55 233.097 1115.76 242.756C1121.06 252.415 1123.72 264.489 1123.72 278.977V425H1074.28V395.028H1072.58C1069.45 401.089 1065.05 406.771 1059.37 412.074C1053.78 417.282 1046.73 421.496 1038.2 424.716C1029.78 427.841 1019.88 429.403 1008.52 429.403ZM1021.87 391.619C1032.19 391.619 1041.14 389.583 1048.72 385.511C1056.29 381.345 1062.12 375.852 1066.19 369.034C1070.35 362.216 1072.44 354.782 1072.44 346.733V321.023C1070.83 322.348 1068.08 323.58 1064.2 324.716C1060.41 325.852 1056.15 326.847 1051.41 327.699C1046.68 328.551 1041.99 329.309 1037.35 329.972C1032.71 330.634 1028.69 331.203 1025.28 331.676C1017.61 332.718 1010.74 334.422 1004.68 336.79C998.621 339.157 993.839 342.472 990.335 346.733C986.831 350.9 985.08 356.297 985.08 362.926C985.08 372.396 988.536 379.545 995.449 384.375C1002.36 389.205 1011.17 391.619 1021.87 391.619ZM1323.86 264.489L1276.99 269.602C1275.66 264.867 1273.34 260.417 1270.03 256.25C1266.81 252.083 1262.45 248.722 1256.96 246.165C1251.47 243.608 1244.74 242.33 1236.79 242.33C1226.09 242.33 1217.09 244.65 1209.8 249.29C1202.6 253.93 1199.05 259.943 1199.15 267.33C1199.05 273.674 1201.37 278.835 1206.11 282.812C1210.94 286.79 1218.89 290.057 1229.97 292.614L1267.19 300.568C1287.83 305.019 1303.17 312.074 1313.21 321.733C1323.34 331.392 1328.46 344.034 1328.55 359.659C1328.46 373.39 1324.43 385.511 1316.48 396.023C1308.62 406.439 1297.68 414.583 1283.66 420.455C1269.65 426.326 1253.55 429.261 1235.37 429.261C1208.66 429.261 1187.17 423.674 1170.88 412.5C1154.59 401.231 1144.89 385.559 1141.76 365.483L1191.9 360.653C1194.18 370.502 1199.01 377.936 1206.39 382.955C1213.78 387.973 1223.39 390.483 1235.23 390.483C1247.44 390.483 1257.24 387.973 1264.63 382.955C1272.11 377.936 1275.85 371.733 1275.85 364.347C1275.85 358.097 1273.44 352.936 1268.61 348.864C1263.87 344.792 1256.49 341.667 1246.45 339.489L1209.23 331.676C1188.3 327.32 1172.82 319.981 1162.78 309.659C1152.75 299.242 1147.77 286.08 1147.87 270.17C1147.77 256.723 1151.42 245.076 1158.81 235.227C1166.29 225.284 1176.66 217.614 1189.91 212.216C1203.27 206.723 1218.66 203.977 1236.08 203.977C1261.65 203.977 1281.77 209.422 1296.45 220.312C1311.22 231.203 1320.36 245.928 1323.86 264.489ZM1443.54 429.261C1421.67 429.261 1402.78 424.716 1386.87 415.625C1371.05 406.439 1358.88 393.466 1350.36 376.705C1341.84 359.848 1337.58 340.009 1337.58 317.188C1337.58 294.744 1341.84 275.047 1350.36 258.097C1358.98 241.051 1371 227.794 1386.44 218.324C1401.88 208.759 1420.01 203.977 1440.84 203.977C1454.29 203.977 1466.98 206.155 1478.91 210.511C1490.94 214.773 1501.54 221.402 1510.73 230.398C1520.01 239.394 1527.3 250.852 1532.61 264.773C1537.91 278.598 1540.56 295.076 1540.56 314.205V329.972H1361.72V295.312H1491.27C1491.18 285.464 1489.04 276.705 1484.88 269.034C1480.71 261.269 1474.89 255.161 1467.41 250.71C1460.02 246.259 1451.4 244.034 1441.55 244.034C1431.04 244.034 1421.81 246.591 1413.86 251.705C1405.9 256.723 1399.7 263.352 1395.25 271.591C1390.89 279.735 1388.67 288.684 1388.57 298.438V328.693C1388.57 341.383 1390.89 352.273 1395.53 361.364C1400.17 370.36 1406.66 377.273 1414.99 382.102C1423.32 386.837 1433.08 389.205 1444.25 389.205C1451.73 389.205 1458.5 388.163 1464.57 386.08C1470.63 383.902 1475.88 380.729 1480.33 376.562C1484.78 372.396 1488.14 367.235 1490.42 361.08L1538.43 366.477C1535.4 379.167 1529.62 390.246 1521.1 399.716C1512.67 409.091 1501.88 416.383 1488.71 421.591C1475.55 426.705 1460.49 429.261 1443.54 429.261Z"></path></g><defs><clipPath id="clip0_625_16"><rect width="1604" height="622" fill="white"></rect></clipPath></defs></svg></div><div class="md:hidden"><svg viewBox="0 0 1604 622" fill="none" xmlns="http://www.w3.org/2000/svg" class="ease w-24 fill-white"><g clip-path="url(#clip0_625_16)"><path fill-rule="evenodd" clip-rule="evenodd" d="M187.661 486.576L169 578L194.475 583.2L213.226 491.334C220.135 492.12 227.161 492.523 234.28 492.523C336.055 492.523 418.561 410.018 418.561 308.243C418.561 224.668 362.925 154.087 286.669 131.516L304.695 43.1997L279.221 38L261.274 125.926C252.463 124.633 243.45 123.963 234.28 123.963C132.505 123.963 50 206.468 50 308.243C50 393.912 108.458 465.928 187.661 486.576ZM223.078 443.066C226.772 443.369 230.508 443.523 234.28 443.523C308.993 443.523 369.561 382.956 369.561 308.243C369.561 248.39 330.691 197.616 276.817 179.786L223.078 443.066ZM251.453 174.042L197.482 438.458C140.652 422.431 99 370.201 99 308.243C99 233.53 159.567 172.963 234.28 172.963C240.097 172.963 245.829 173.33 251.453 174.042Z"></path><path d="M498.42 506.818V206.818H548.989V242.898H551.972C554.623 237.595 558.364 231.96 563.193 225.994C568.023 219.934 574.557 214.773 582.795 210.511C591.034 206.155 601.545 203.977 614.33 203.977C631.186 203.977 646.384 208.286 659.926 216.903C673.563 225.426 684.358 238.068 692.312 254.83C700.362 271.496 704.386 291.951 704.386 316.193C704.386 340.152 700.456 360.511 692.597 377.273C684.737 394.034 674.036 406.818 660.494 415.625C646.953 424.432 631.612 428.835 614.472 428.835C601.972 428.835 591.602 426.752 583.364 422.585C575.125 418.419 568.496 413.4 563.477 407.528C558.553 401.562 554.718 395.928 551.972 390.625H549.841V506.818H498.42ZM548.847 315.909C548.847 330.019 550.835 342.377 554.812 352.983C558.884 363.589 564.708 371.875 572.284 377.841C579.955 383.712 589.235 386.648 600.125 386.648C611.489 386.648 621.006 383.617 628.676 377.557C636.347 371.402 642.123 363.021 646.006 352.415C649.983 341.714 651.972 329.545 651.972 315.909C651.972 302.367 650.03 290.341 646.148 279.83C642.265 269.318 636.489 261.08 628.818 255.114C621.148 249.148 611.583 246.165 600.125 246.165C589.14 246.165 579.812 249.053 572.142 254.83C564.472 260.606 558.648 268.703 554.67 279.119C550.788 289.536 548.847 301.799 548.847 315.909ZM775.841 297.159V425H724.42V134.091H774.705V243.892H777.261C782.375 231.581 790.282 221.875 800.983 214.773C811.778 207.576 825.509 203.977 842.176 203.977C857.328 203.977 870.538 207.15 881.807 213.494C893.076 219.839 901.788 229.119 907.943 241.335C914.193 253.551 917.318 268.466 917.318 286.08V425H865.898V294.034C865.898 279.356 862.11 267.945 854.534 259.801C847.053 251.562 836.542 247.443 823 247.443C813.909 247.443 805.765 249.432 798.568 253.409C791.466 257.292 785.879 262.926 781.807 270.312C777.83 277.699 775.841 286.648 775.841 297.159ZM1008.52 429.403C994.691 429.403 982.239 426.941 971.159 422.017C960.174 416.998 951.462 409.612 945.023 399.858C938.678 390.104 935.506 378.078 935.506 363.778C935.506 351.468 937.778 341.288 942.324 333.239C946.869 325.189 953.072 318.75 960.932 313.92C968.792 309.091 977.646 305.445 987.494 302.983C997.438 300.426 1007.71 298.58 1018.32 297.443C1031.1 296.117 1041.47 294.934 1049.43 293.892C1057.38 292.756 1063.16 291.051 1066.76 288.778C1070.45 286.411 1072.3 282.765 1072.3 277.841V276.989C1072.3 266.288 1069.12 258.002 1062.78 252.131C1056.43 246.259 1047.3 243.324 1035.36 243.324C1022.77 243.324 1012.78 246.07 1005.39 251.562C998.1 257.055 993.176 263.542 990.619 271.023L942.608 264.205C946.396 250.947 952.646 239.867 961.358 230.966C970.07 221.97 980.723 215.246 993.318 210.795C1005.91 206.25 1019.83 203.977 1035.08 203.977C1045.59 203.977 1056.05 205.208 1066.47 207.67C1076.89 210.133 1086.41 214.205 1095.02 219.886C1103.64 225.473 1110.55 233.097 1115.76 242.756C1121.06 252.415 1123.72 264.489 1123.72 278.977V425H1074.28V395.028H1072.58C1069.45 401.089 1065.05 406.771 1059.37 412.074C1053.78 417.282 1046.73 421.496 1038.2 424.716C1029.78 427.841 1019.88 429.403 1008.52 429.403ZM1021.87 391.619C1032.19 391.619 1041.14 389.583 1048.72 385.511C1056.29 381.345 1062.12 375.852 1066.19 369.034C1070.35 362.216 1072.44 354.782 1072.44 346.733V321.023C1070.83 322.348 1068.08 323.58 1064.2 324.716C1060.41 325.852 1056.15 326.847 1051.41 327.699C1046.68 328.551 1041.99 329.309 1037.35 329.972C1032.71 330.634 1028.69 331.203 1025.28 331.676C1017.61 332.718 1010.74 334.422 1004.68 336.79C998.621 339.157 993.839 342.472 990.335 346.733C986.831 350.9 985.08 356.297 985.08 362.926C985.08 372.396 988.536 379.545 995.449 384.375C1002.36 389.205 1011.17 391.619 1021.87 391.619ZM1323.86 264.489L1276.99 269.602C1275.66 264.867 1273.34 260.417 1270.03 256.25C1266.81 252.083 1262.45 248.722 1256.96 246.165C1251.47 243.608 1244.74 242.33 1236.79 242.33C1226.09 242.33 1217.09 244.65 1209.8 249.29C1202.6 253.93 1199.05 259.943 1199.15 267.33C1199.05 273.674 1201.37 278.835 1206.11 282.812C1210.94 286.79 1218.89 290.057 1229.97 292.614L1267.19 300.568C1287.83 305.019 1303.17 312.074 1313.21 321.733C1323.34 331.392 1328.46 344.034 1328.55 359.659C1328.46 373.39 1324.43 385.511 1316.48 396.023C1308.62 406.439 1297.68 414.583 1283.66 420.455C1269.65 426.326 1253.55 429.261 1235.37 429.261C1208.66 429.261 1187.17 423.674 1170.88 412.5C1154.59 401.231 1144.89 385.559 1141.76 365.483L1191.9 360.653C1194.18 370.502 1199.01 377.936 1206.39 382.955C1213.78 387.973 1223.39 390.483 1235.23 390.483C1247.44 390.483 1257.24 387.973 1264.63 382.955C1272.11 377.936 1275.85 371.733 1275.85 364.347C1275.85 358.097 1273.44 352.936 1268.61 348.864C1263.87 344.792 1256.49 341.667 1246.45 339.489L1209.23 331.676C1188.3 327.32 1172.82 319.981 1162.78 309.659C1152.75 299.242 1147.77 286.08 1147.87 270.17C1147.77 256.723 1151.42 245.076 1158.81 235.227C1166.29 225.284 1176.66 217.614 1189.91 212.216C1203.27 206.723 1218.66 203.977 1236.08 203.977C1261.65 203.977 1281.77 209.422 1296.45 220.312C1311.22 231.203 1320.36 245.928 1323.86 264.489ZM1443.54 429.261C1421.67 429.261 1402.78 424.716 1386.87 415.625C1371.05 406.439 1358.88 393.466 1350.36 376.705C1341.84 359.848 1337.58 340.009 1337.58 317.188C1337.58 294.744 1341.84 275.047 1350.36 258.097C1358.98 241.051 1371 227.794 1386.44 218.324C1401.88 208.759 1420.01 203.977 1440.84 203.977C1454.29 203.977 1466.98 206.155 1478.91 210.511C1490.94 214.773 1501.54 221.402 1510.73 230.398C1520.01 239.394 1527.3 250.852 1532.61 264.773C1537.91 278.598 1540.56 295.076 1540.56 314.205V329.972H1361.72V295.312H1491.27C1491.18 285.464 1489.04 276.705 1484.88 269.034C1480.71 261.269 1474.89 255.161 1467.41 250.71C1460.02 246.259 1451.4 244.034 1441.55 244.034C1431.04 244.034 1421.81 246.591 1413.86 251.705C1405.9 256.723 1399.7 263.352 1395.25 271.591C1390.89 279.735 1388.67 288.684 1388.57 298.438V328.693C1388.57 341.383 1390.89 352.273 1395.53 361.364C1400.17 370.36 1406.66 377.273 1414.99 382.102C1423.32 386.837 1433.08 389.205 1444.25 389.205C1451.73 389.205 1458.5 388.163 1464.57 386.08C1470.63 383.902 1475.88 380.729 1480.33 376.562C1484.78 372.396 1488.14 367.235 1490.42 361.08L1538.43 366.477C1535.4 379.167 1529.62 390.246 1521.1 399.716C1512.67 409.091 1501.88 416.383 1488.71 421.591C1475.55 426.705 1460.49 429.261 1443.54 429.261Z"></path></g><defs><clipPath id="clip0_625_16"><rect width="1604" height="622" fill="white"></rect></clipPath></defs></svg></div></a><div class="hidden items-center gap-8 rounded-full px-3 py-2 md:flex"><a class="hover:border-none hover:outline-none" href="/"><button variant="text" class="inline-flex items-center justify-center gap-1 overflow-hidden font-medium transition text-zinc-400 hover:text-emerald-600 text-xs md:text-sm">Home</button></a><a class="hover:border-none hover:outline-none" href="/pricing/"><button variant="text" class="inline-flex items-center justify-center gap-1 overflow-hidden font-medium transition text-zinc-400 hover:text-emerald-600 text-xs md:text-sm">Pricing</button></a><a target="_blank" class="hover:border-none hover:outline-none" href="https://docs.phase.dev/security?ref=navbar"><button variant="text" class="inline-flex items-center justify-center gap-1 overflow-hidden font-medium transition text-zinc-400 hover:text-emerald-600 text-xs md:text-sm">Security</button></a><a target="_blank" class="hover:border-none hover:outline-none" href="https://github.com/phasehq/console"><button variant="secondary" class="inline-flex items-center justify-center gap-1 overflow-hidden font-medium transition rounded-full py-1 px-3 bg-zinc-800/40 text-zinc-400 ring-1 ring-inset ring-zinc-800 hover:bg-zinc-100 hover:text-black text-xs md:text-sm"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 496 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg>Star us on GitHub</button></a><a target="_blank" class="hover:border-none hover:outline-none" href="https://slack.phase.dev"><button variant="secondary" class="inline-flex items-center justify-center gap-1 overflow-hidden font-medium transition rounded-full py-1 px-3 bg-zinc-800/40 text-zinc-400 ring-1 ring-inset ring-zinc-800 hover:bg-zinc-100 hover:text-black text-xs md:text-sm"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 448 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M94.12 315.1c0 25.9-21.16 47.06-47.06 47.06S0 341 0 315.1c0-25.9 21.16-47.06 47.06-47.06h47.06v47.06zm23.72 0c0-25.9 21.16-47.06 47.06-47.06s47.06 21.16 47.06 47.06v117.84c0 25.9-21.16 47.06-47.06 47.06s-47.06-21.16-47.06-47.06V315.1zm47.06-188.98c-25.9 0-47.06-21.16-47.06-47.06S139 32 164.9 32s47.06 21.16 47.06 47.06v47.06H164.9zm0 23.72c25.9 0 47.06 21.16 47.06 47.06s-21.16 47.06-47.06 47.06H47.06C21.16 243.96 0 222.8 0 196.9s21.16-47.06 47.06-47.06H164.9zm188.98 47.06c0-25.9 21.16-47.06 47.06-47.06 25.9 0 47.06 21.16 47.06 47.06s-21.16 47.06-47.06 47.06h-47.06V196.9zm-23.72 0c0 25.9-21.16 47.06-47.06 47.06-25.9 0-47.06-21.16-47.06-47.06V79.06c0-25.9 21.16-47.06 47.06-47.06 25.9 0 47.06 21.16 47.06 47.06V196.9zM283.1 385.88c25.9 0 47.06 21.16 47.06 47.06 0 25.9-21.16 47.06-47.06 47.06-25.9 0-47.06-21.16-47.06-47.06v-47.06h47.06zm0-23.72c-25.9 0-47.06-21.16-47.06-47.06 0-25.9 21.16-47.06 47.06-47.06h117.84c25.9 0 47.06 21.16 47.06 47.06 0 25.9-21.16 47.06-47.06 47.06H283.1z"></path></svg>Join our Slack</button></a></div><div class="hidden items-center gap-4 md:flex md:gap-6"><a target="_blank" class="hover:border-none hover:outline-none" href="https://docs.phase.dev"><button variant="secondary" class="inline-flex items-center justify-center gap-1 overflow-hidden font-medium transition rounded-full py-1 px-3 bg-zinc-800/40 text-zinc-400 ring-1 ring-inset ring-zinc-800 hover:bg-zinc-100 hover:text-black text-xs md:text-sm">Docs</button></a><a target="_blank" class="hover:border-none hover:outline-none" href="https://console.phase.dev?ref=navbar"><button variant="primary" class="inline-flex items-center justify-center gap-1 overflow-hidden font-medium transition rounded-full py-1 px-3 bg-emerald-400/10 text-emerald-400 ring-1 ring-inset ring-emerald-400/20 hover:bg-emerald-400/10 hover:text-emerald-300 hover:ring-emerald-300 text-xs md:text-sm">Sign in</button></a></div><div class="md:hidden"><div class=" w-full max-w-sm"><div class="relative" data-headlessui-state><button class="
                text-opacity-90
                group inline-flex items-center text-base font-medium focus:outline-none" type="button" aria-expanded="false" data-headlessui-state><div class="group flex size-12 flex-col items-center justify-center rounded"><div class="h-[2px] w-6 my-1 rounded-full transition ease transform duration-300 bg-white "></div><div class="h-[2px] w-6 my-1 rounded-full transition ease transform duration-300 bg-white "></div><div class="h-[2px] w-6 my-1 rounded-full transition ease transform duration-300 bg-white "></div></div></button></div><div style="position:fixed;top:1px;left:1px;width:1px;height:0;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border-width:0;display:none"></div></div></div></nav></header><main class="content text-xl"><div class="min-h-screen w-full"><div class="pointer-events-none absolute inset-0 mx-0 max-w-none overflow-hidden"><div class="absolute top-0 ml-0 h-[80rem] w-[120rem] [mask-image:linear-gradient(white,transparent)]"><div class="absolute inset-0 bg-gradient-to-r from-cyan-700/50 to-sky-900/50 opacity-100 [mask-image:radial-gradient(farthest-side_at_top,white,transparent)]"><svg aria-hidden="true" class="fill-white/2.5 absolute inset-x-0 inset-y-[-50%] h-[200%] w-full skew-y-[-18deg] stroke-white/5 mix-blend-overlay"><defs><pattern id=":Rd6:" width="72" height="56" patternUnits="userSpaceOnUse" x="-12" y="4"><path d="M.5 56V.5H72" fill="none"></path></pattern></defs><rect width="100%" height="100%" stroke-width="0" fill="url(#:Rd6:)"></rect><svg x="-12" y="4" class="overflow-visible"><rect stroke-width="0" width="73" height="57" x="288" y="168"></rect><rect stroke-width="0" width="73" height="57" x="144" y="56"></rect><rect stroke-width="0" width="73" height="57" x="504" y="168"></rect><rect stroke-width="0" width="73" height="57" x="720" y="336"></rect></svg></svg></div></div></div><div class="relative z-10 mx-auto flex w-full max-w-screen-lg px-4 py-40 2xl:max-w-screen-2xl"><article class="blog prose mx-auto overflow-x-hidden pt-2"><div class="space-y-6"><div class="space-y-3"><div class="flex"><a class="group relative flex items-center text-2xs" href="/blog/"><span class="absolute left-0 text-emerald-500 opacity-0 transition-all group-hover:-translate-x-4 group-hover:opacity-100"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 448 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M257.5 445.1l-22.2 22.2c-9.4 9.4-24.6 9.4-33.9 0L7 273c-9.4-9.4-9.4-24.6 0-33.9L201.4 44.7c9.4-9.4 24.6-9.4 33.9 0l22.2 22.2c9.5 9.5 9.3 25-.4 34.3L136.6 216H424c13.3 0 24 10.7 24 24v32c0 13.3-10.7 24-24 24H136.6l120.5 114.8c9.8 9.3 10 24.8.4 34.3z"></path></svg></span><span class="font-mono text-xs font-semibold uppercase leading-6 tracking-wide text-emerald-400">blog</span></a></div><h1>End to End encrypted secrets deployment to Kubernetes</h1><p class="text-lg font-medium">Securely deploying secrets to Kubernetes with Phase</p></div><div class="flex w-full items-center gap-4"><a class="ease flex items-center gap-2 border-none font-medium text-zinc-200 transition-colors hover:border-none hover:text-zinc-400 hover:no-underline" target="_blank" href="https://github.com/nimish-ks"><div style="background-image:url(&quot;/assets/images/blog/authors/nimish.webp&quot;)" class="size-7 rounded-full bg-cover"></div><span class>Nimish</span></a><span class="size-1 rounded-full bg-neutral-500"></span><div>Tuesday, March 26, 2024</div></div></div><main><p><img src="/assets/images/blog/kubernetes/output.webp" alt="k8-secrets" /></p>
<h2 id="introduction">Introduction</h2>
<p>Kubernetes is the open-source container orchestration platform of choice for many, specifically for automating deployment, scaling, and management of containerized applications. Supplying secrets securely to these containerized applications with Kubernetes can be tricky, but it&#x27;s essential to the security of your workload. Out of the box, Kubernetes offers several native mechanisms to handle secrets, but they come with limitations in terms of security features, scalability, and complexity.</p>
<p>In this guide, we will explore enabling encryption at rest for secrets stored in Kubernetes and use the <a href="https://docs.phase.dev/integrations/platforms/kubernetes" rel="nofollow">Phase Kubernetes Operator</a> to securely sync secrets stored in the Phase secrets manager to a Kubernetes cluster. If you don&#x27;t know what an operator is, think of it as an agent running inside a Pod in a Kubernetes cluster that interacts with the Kubernetes API to automate the management of a certain service or a set of services.</p>
<p>Here&#x27;s what the high level architecture looks like:</p>
<p><img src="/assets/images/blog/kubernetes/phase-kubernetes-operator.webp" alt="phase-k8-operator" /></p>
<p>The Phase Kubernetes Operator will fetch application secrets from a Phase instance, decrypt them, and write them to a Kubernetes cluster as a managed <a href="https://kubernetes.io/docs/concepts/configuration/secret/" rel="nofollow">Kubernetes Secret</a>. It will then continue to watch for any changes in secrets in Phase and automatically sync them with the Kubernetes cluster, making our secret manager the source of truth for secrets. Furthermore, it can optionally automatically re-deploy Kubernetes deployments once a secret associated with them has been changed.</p>
<p>Phase can also be used to manage secrets in stages preceding application deployment in the cloud, such as <a href="https://docs.phase.dev/integrations" rel="nofollow">local development</a> or a when a container is being built in CI pipelines like <a href="https://docs.phase.dev/integrations/platforms/github-actions" rel="nofollow">GitHub Actions</a>, but that&#x27;s outside the scope of this blog.</p>
<p><img src="/assets/images/blog/kubernetes/keyspace-secrets.png" alt="keyspace-secrets" /></p>
<h2 id="understanding-the-security-of-secrets-stored-in-kubernetes-etcd">Understanding the security of secrets stored in Kubernetes <code>etcd</code></h2>
<p>Before we begin, let&#x27;s make sure our Kubernetes cluster has &#x27;encryption at rest&#x27; enabled. Kubernetes uses <code>etcd</code>, a distributed key-value pair database to store critical data such as the state of the cluster, configuration and secrets. It&#x27;s important that the Kubernetes API encrypts the secrets before they are written to <code>etcd</code> on disk.</p>
<p>There is a saying, &quot;<em>encryption is easy, key management is hard</em>&quot;; here we face the same challenge. If we want to encrypt secrets that are stored inside our Kubernetes cluster, which key would we encrypt that data with? Isn&#x27;t that another secret we need to protect? The complexity of this setup varies depending on how your cluster is managed. If you are managing your Kubernetes cluster by yourself, the process can be complex given that you will have to manually create, deploy, and manage the key that is used to encrypt <code>etcd</code> data on all master / master standby or control plane nodes. Although this may be tedious, this approach has security benefits if your threat model requires you to maintain self-custody of your keys.</p>
<p>On the other hand, if your cluster is managed by a cloud provider like AWS, GCP or Azure, encryption of <code>etcd</code> data is setup by default with the keys owned and managed by the cloud provider.</p>
<p>With managed Kubernetes you also have the option to leverage the respective cloud provider&#x27;s KMS (Key Management Service) to create and use an encryption key that will be managed by you but owned by the provider. This is usually easier to set up but requires you to trust the cloud provider&#x27;s KMS service with your keys and can end up being quite expensive as the keys are often priced by the number of invocations.</p>
<p>So to recap, there are two main options for encrypting secrets at rest in Kubernetes <code>etcd</code>:</p>
<ul>
<li><strong>Local Key Storage:</strong> Offers protection against <code>etcd</code> compromise but not host compromise, as keys are stored on the host. Most suitable for self-managed Kubernetes clusters.</li>
<li><strong>Managed KMS Key Storage:</strong> Leverages envelope encryption and enhances security by not storing the key encryption key in Kubernetes. This will most likely be the default option if you have a managed Kubernetes cluster on larger cloud providers like AWS, GCP, Azure etc.</li>
</ul>
<h3 id="encryption-provider-considerations">Encryption provider considerations</h3>
<p>Kubernetes facilitates encryption through various providers, each with distinct attributes and trade-offs:</p>
<div class="overflow-x-auto"><table><thead><tr><th>Name</th><th>Encryption</th><th>Strength</th><th>Speed</th><th>Key Length</th><th>Note</th></tr></thead><tbody><tr><td><strong>Default</strong> - identity</td><td>None</td><td>N/A</td><td>N/A</td><td>N/A</td><td>Writes resources without encryption. Acts as a decryptor when set as the first provider.</td></tr><tr><td>aescbc</td><td>AES-CBC with PKCS#7 padding</td><td>Weak</td><td>Fast</td><td>32-byte</td><td>Vulnerable to padding oracle attacks. Key material is accessible from control plane host.</td></tr><tr><td>aesgcm</td><td>AES-GCM with random nonce</td><td>Must be rotated every 200,000 writes</td><td>Fastest</td><td>16, 24, or 32-byte</td><td>Advisable only with an automated key rotation scheme. Key material is accessible from control plane host.</td></tr><tr><td>kms v1 (deprecated)</td><td>Envelope encryption with DEK per resource.</td><td>Strongest</td><td>Slow</td><td>32-bytes</td><td>Uses AES-GCM for data encryption and configurable KMS for key encryption. Supports simple key rotation.</td></tr><tr><td>kms v2</td><td>Envelope encryption with DEK per API server.</td><td>Strongest</td><td>Fast</td><td>32-bytes</td><td>Similar to KMS v1 but with improved performance and key management. A solid choice for third-party key management. Stable from Kubernetes v1.29.</td></tr><tr><td>secretbox</td><td>XSalsa20 and Poly1305</td><td>Strong</td><td>Faster</td><td>32-byte</td><td>Utilizes modern encryption technologies but may not comply with specific certifications like FIPS.</td></tr></tbody></table></div>
<h2 id="encryption-for-self-managed-kubernetes-clusters">Encryption for self-managed Kubernetes clusters</h2>
<p>Let&#x27;s take a look at a real example of setting up <code>etcd</code> encryption in a self-managed Kubernetes cluster with our own key:</p>
<h3 id="step-1-generate-a-high-entropy-32-byte-key">Step 1: Generate a high entropy 32-byte key</h3>
<div class="remark-highlight"><pre class="language-bash"><code class="language-bash">openssl rand <span class="token parameter variable">-base64</span> <span class="token number">32</span>
IPue+NtWYF2dnvKqlLTy2UXok2P+aiJ+eKuVuRd7wt0<span class="token operator">=</span>
</code></pre></div>
<h3 id="step-2-deploy-the-key-on-your-kubernetes-clusters-master-node">Step 2: Deploy the key on your Kubernetes cluster&#x27;s master node</h3>
<p><strong>Note</strong>: Please make sure to use something like SSH (Secure Shell) to deploy the key to your Kubernetes node(s).</p>
<p>Create the following <code>EncryptionConfiguration</code> at path <code>/etc/kubernetes/enc/enc.yaml</code> on the control-plane node.</p>
<div class="remark-highlight"><pre class="language-yaml"><code class="language-yaml"><span class="token punctuation">---</span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> apiserver.config.k8s.io/v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> EncryptionConfiguration
<span class="token key atrule">resources</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">resources</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> secrets
      <span class="token punctuation">-</span> configmaps
      <span class="token punctuation">-</span> pandas.awesome.bears.example
    <span class="token key atrule">providers</span><span class="token punctuation">:</span>
      <span class="token comment"># Your encryption provider</span>
      <span class="token punctuation">-</span> <span class="token key atrule">secretbox</span><span class="token punctuation">:</span> 
          <span class="token key atrule">keys</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> key1
              <span class="token comment"># Your 32-byte base64 key</span>
              <span class="token key atrule">secret</span><span class="token punctuation">:</span> IPue+NtWYF2dnvKqlLTy2UXok2P+aiJ+eKuVuRd7wt0=
      <span class="token punctuation">-</span> <span class="token key atrule">identity</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token comment"># This fallback allows reading unencrypted secrets;</span>
                     <span class="token comment"># for example, during initial migration</span>
</code></pre></div>
<h3 id="step-3-use-the-encryption-configuration-file">Step 3: Use the encryption configuration file</h3>
<p>Edit the manifest for the <code>kube-apiserver</code> static pod: <code>/etc/kubernetes/manifests/kube-apiserver.yaml</code> so that it is similar to:</p>
<div class="remark-highlight"><pre class="language-yaml"><code class="language-yaml"><span class="token punctuation">---</span>
<span class="token comment">#</span>
<span class="token comment"># This is a fragment of a manifest for a static Pod.</span>
<span class="token comment"># Check whether this is correct for your cluster and for your API server.</span>
<span class="token comment">#</span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Pod
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">annotations</span><span class="token punctuation">:</span>
    <span class="token key atrule">kubeadm.kubernetes.io/kube-apiserver.advertise-address.endpoint</span><span class="token punctuation">:</span> 10.20.30.40<span class="token punctuation">:</span><span class="token number">443</span>
  <span class="token key atrule">creationTimestamp</span><span class="token punctuation">:</span> <span class="token null important">null</span>
  <span class="token key atrule">labels</span><span class="token punctuation">:</span>
    <span class="token key atrule">app.kubernetes.io/component</span><span class="token punctuation">:</span> kube<span class="token punctuation">-</span>apiserver
    <span class="token key atrule">tier</span><span class="token punctuation">:</span> control<span class="token punctuation">-</span>plane
  <span class="token key atrule">name</span><span class="token punctuation">:</span> kube<span class="token punctuation">-</span>apiserver
  <span class="token key atrule">namespace</span><span class="token punctuation">:</span> kube<span class="token punctuation">-</span>system
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">containers</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">command</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> kube<span class="token punctuation">-</span>apiserver
    <span class="token punctuation">...</span>
    <span class="token punctuation">-</span> <span class="token punctuation">-</span><span class="token punctuation">-</span>encryption<span class="token punctuation">-</span>provider<span class="token punctuation">-</span>config=/etc/kubernetes/enc/enc.yaml  <span class="token comment"># 👈 Path to your EncryptionConfiguration</span>
    <span class="token key atrule">volumeMounts</span><span class="token punctuation">:</span>
    <span class="token punctuation">...</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> enc                           <span class="token comment"># Add this line</span>
      <span class="token key atrule">mountPath</span><span class="token punctuation">:</span> /etc/kubernetes/enc      <span class="token comment"># Add this line</span>
      <span class="token key atrule">readOnly</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>                      <span class="token comment"># Add this line</span>
    <span class="token punctuation">...</span>
  <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
  <span class="token punctuation">...</span>
  <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> enc                             <span class="token comment"># Add this line</span>
    <span class="token key atrule">hostPath</span><span class="token punctuation">:</span>                             <span class="token comment"># Add this line</span>
      <span class="token key atrule">path</span><span class="token punctuation">:</span> /etc/kubernetes/enc           <span class="token comment"># Add this line</span>
      <span class="token key atrule">type</span><span class="token punctuation">:</span> DirectoryOrCreate             <span class="token comment"># Add this line</span>
  <span class="token punctuation">...</span>
</code></pre></div>
<h3 id="step-4-restart-your-kube-api-server">Step 4: Restart your Kube API server</h3>
<p>For more information about <a href="https://kubernetes.io/docs/tasks/administer-cluster/encrypt-data/#verifying-that-data-is-encrypted" rel="nofollow">verifying that secrets</a> are actually encrypted with the new key, <a href="https://kubernetes.io/docs/tasks/administer-cluster/encrypt-data/#rotating-a-decryption-key" rel="nofollow">rotating keys</a>, and <a href="https://kubernetes.io/docs/tasks/administer-cluster/encrypt-data/#cleanup-all-secrets-encrypted" rel="nofollow">preventing plaintext secret retrieval</a>, please explore the official <a href="https://kubernetes.io/docs/tasks/administer-cluster/encrypt-data" rel="nofollow">Kubernetes Docs</a>.</p>
<h2 id="managed-kubernetes-cluster-using-cloud-provider-kms">Managed Kubernetes cluster using cloud-provider KMS</h2>
<p>Here are some examples of how we can encrypt secrets in <code>etcd</code> in a managed Kubernetes cluster by leveraging the KMS from cloud providers.</p>
<h3 id="aws-eks-elastic-kubernetes-service">AWS EKS (Elastic Kubernetes Service)</h3>
<p>AWS offers an integrated key management solution, simplifying the use of encryption providers and ensuring secure key handling. By default, this uses an AWS-managed key to encrypt <code>etcd</code> data but allows using a CMK (Customer Managed Keys) via AWS KMS.</p>
<p><img src="/assets/images/blog/kubernetes/aws-eks-cluster-create-secret-encryption-cmk.webp" alt="AWS EKS Cluster Create Secret Encryption CMK" /></p>
<p><img src="/assets/images/blog/kubernetes/aws-eks-cluster-view-secret-encryption-cmk.webp" alt="AWS EKS Cluster View Secret Encryption CMK" /></p>
<h3 id="gcp-gke-google-kubernetes-engine">GCP GKE (Google Kubernetes Engine)</h3>
<p>GCP similarly provides an integrated environment for secure secret management. Make sure to ✅ check &#x27;Encrypt secrets at the application layer&#x27;.</p>
<p><img src="/assets/images/blog/kubernetes/gcp-gke-encrypt-secrets-app-layer-create.webp" alt="GCP GKE Encrypt Secrets App Layer Create" /></p>
<p><img src="/assets/images/blog/kubernetes/gcp-gke-encrypt-secrets-app-layer-set-key-resource-name.webp" alt="GCP GKE Encrypt Secrets App Layer Set Key Resource Name" /></p>
<h3 id="azure-aks-azure-kubernetes-service">Azure AKS (Azure Kubernetes Service)</h3>
<p>Azure provides instructions on using Azure Key Management service with AKS. Read <a href="https://learn.microsoft.com/en-us/azure/aks/use-kms-etcd-encryption" rel="nofollow">Add Key Management Service etcd encryption to an Azure Kubernetes Service cluster</a></p>
<h2 id="sync-secrets-to-kubernetes">Sync secrets to Kubernetes</h2>
<p>Next, let&#x27;s move on to the fun part — actually deploying secrets!</p>
<h3 id="1-install-the-phase-kubernetes-operator-via-helm">1. Install the Phase Kubernetes Operator via Helm</h3>
<p>Add the Phase helm repo and update it:</p>
<div class="remark-highlight"><pre class="language-bash"><code class="language-bash">helm repo <span class="token function">add</span> phase https://helm.phase.dev <span class="token operator">&amp;&amp;</span> helm repo update
</code></pre></div>
<p>Let&#x27;s install version <code>v1.2.0</code>:</p>
<div class="remark-highlight"><pre class="language-bash"><code class="language-bash">helm <span class="token function">install</span> phase-secrets-operator phase/phase-kubernetes-operator <span class="token parameter variable">--set</span> <span class="token assign-left variable">image.tag</span><span class="token operator">=</span>v1.2.0
</code></pre></div>
<p>You can find the available versions on our <a href="https://github.com/phasehq/kubernetes-secrets-operator/releases" rel="nofollow">GitHub releases page</a>.</p>
<h3 id="2-create-a-service-token-secret-in-kubernetes">2. Create a Service Token Secret in Kubernetes</h3>
<p>We need to create a Phase Service Token so that the operator can authenticate with the Phase Service and fetch secrets. Head on over to the Phase Console &gt; Apps &gt; Your application &gt; Service tokens and create a token.</p>
<p><img src="/assets/images/blog/kubernetes/service-token.png" alt="phase-service-token" /></p>
<p>Check out the <a href="https://docs.phase.dev/console/tokens#service-tokens" rel="nofollow">Phase Docs</a> for information on creating Service Tokens.</p>
<p>Creating a Service Token Secret securely via <code>kubectl</code> is vital. You can do this using the <code>read</code> command, which is recommended as it avoids writing the token to disk or shell history:</p>
<div class="remark-highlight"><pre class="language-bash"><code class="language-bash"><span class="token builtin class-name">read</span> <span class="token parameter variable">-s</span> TOKEN
kubectl create secret generic phase-service-token <span class="token punctuation">\</span>
  --from-literal<span class="token operator">=</span>token<span class="token operator">=</span><span class="token variable">$TOKEN</span> <span class="token punctuation">\</span>
  <span class="token parameter variable">--type</span><span class="token operator">=</span>Opaque <span class="token punctuation">\</span>
  <span class="token parameter variable">--namespace</span><span class="token operator">=</span>default
<span class="token builtin class-name">unset</span> TOKEN
</code></pre></div>
<p>Alternatively, you can simply pass the <code>Token</code> inline:</p>
<div class="remark-highlight"><pre class="language-bash"><code class="language-bash">kubectl create secret generic phase-service-token <span class="token punctuation">\</span>
  --from-literal<span class="token operator">=</span>token<span class="token operator">=</span><span class="token operator">&lt;</span>TOKEN<span class="token operator">&gt;</span> <span class="token punctuation">\</span>
  <span class="token parameter variable">--type</span><span class="token operator">=</span>Opaque <span class="token punctuation">\</span>
  <span class="token parameter variable">--namespace</span><span class="token operator">=</span>default
</code></pre></div>
<h2 id="3-deploy-the-phase-secrets-operator-cr-custom-resource">3. Deploy the Phase Secrets Operator CR (Custom Resource)</h2>
<p>Create a custom resource file named <code>phase-secrets-operator-cr.yaml</code>. This file will define how the Phase Secrets Operator should manage your secrets. Below is a basic example of how to sync all secrets from path <code>/</code> in <code>production</code> environment in an app in the Phase Console to your Kubernetes cluster:</p>
<div class="remark-highlight"><pre class="language-yaml"><code class="language-yaml"><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> secrets.phase.dev/v1alpha1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> PhaseSecret
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> keyspace<span class="token punctuation">-</span>cloud<span class="token punctuation">-</span>phase<span class="token punctuation">-</span>secret
  <span class="token key atrule">namespace</span><span class="token punctuation">:</span> default
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">phaseApp</span><span class="token punctuation">:</span> <span class="token string">&#x27;keyspace.cloud&#x27;</span> <span class="token comment"># The name of your Phase application</span>
  <span class="token key atrule">phaseAppEnv</span><span class="token punctuation">:</span> <span class="token string">&#x27;production&#x27;</span> <span class="token comment"># The Phase App Environment to fetch secrets from</span>
  <span class="token key atrule">phaseAppEnvPath</span><span class="token punctuation">:</span> <span class="token string">&#x27;/&#x27;</span> <span class="token comment"># Path within the Phase application environment to fetch secrets from</span>
  <span class="token key atrule">phaseHost</span><span class="token punctuation">:</span> <span class="token string">&#x27;https://console.phase.dev&#x27;</span> <span class="token comment"># OPTIONAL - URL of a Phase Console instance</span>
  <span class="token key atrule">authentication</span><span class="token punctuation">:</span>
    <span class="token key atrule">serviceToken</span><span class="token punctuation">:</span>
      <span class="token key atrule">serviceTokenSecretReference</span><span class="token punctuation">:</span>
        <span class="token key atrule">secretName</span><span class="token punctuation">:</span> <span class="token string">&#x27;phase-service-token&#x27;</span> <span class="token comment"># Name of the Phase Service Token with access to your application</span>
        <span class="token key atrule">secretNamespace</span><span class="token punctuation">:</span> <span class="token string">&#x27;default&#x27;</span>
  <span class="token key atrule">managedSecretReferences</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">secretName</span><span class="token punctuation">:</span> <span class="token string">&#x27;keyspace-cloud-prod-secret&#x27;</span> <span class="token comment"># Name of the Kubernetes managed secret that Phase will sync</span>
      <span class="token key atrule">secretNamespace</span><span class="token punctuation">:</span> <span class="token string">&#x27;default&#x27;</span>
</code></pre></div>
<p>Apply the custom resource:</p>
<div class="remark-highlight"><pre class="language-bash"><code class="language-bash">kubectl apply <span class="token parameter variable">-f</span> phase-secrets-operator-cr.yaml
</code></pre></div>
<p>Watch for secrets being created:</p>
<div class="remark-highlight"><pre class="language-bash"><code class="language-bash"><span class="token function">watch</span> kubectl get secrets
</code></pre></div>
<h3 id="set-up-rbac-role-based-access-control-and-update-deployment">Set up RBAC (Role Based Access Control) and update deployment</h3>
<p>Now that our secrets are deployed to Kubernetes we need to control access to them via Kubernetes RBAC policy for additional security.</p>
<h3 id="1-setup-a-rbac-policy-for-accessing-secrets">1. Setup a RBAC policy for accessing secrets</h3>
<p>First, let&#x27;s set up an RBAC policy with a custom role (<code>Role</code>) for our deployment:</p>
<div class="remark-highlight"><pre class="language-yaml"><code class="language-yaml"><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> rbac.authorization.k8s.io/v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Role
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">namespace</span><span class="token punctuation">:</span> default
  <span class="token key atrule">name</span><span class="token punctuation">:</span> secret<span class="token punctuation">-</span>reader
<span class="token key atrule">rules</span><span class="token punctuation">:</span>
<span class="token punctuation">-</span> <span class="token key atrule">apiGroups</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;&quot;</span><span class="token punctuation">]</span>
  <span class="token key atrule">resources</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;secrets&quot;</span><span class="token punctuation">]</span>
  <span class="token key atrule">resourceNames</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;keyspace-cloud-prod-secret&quot;</span><span class="token punctuation">]</span>
  <span class="token key atrule">verbs</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;get&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;watch&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;list&quot;</span><span class="token punctuation">]</span>
</code></pre></div>
<p>This <code>Role</code> named <code>secret-reader</code> allows reading the secret named <code>keyspace-cloud-prod-secret</code> in the <code>default</code> namespace and grants the following permissions: <code>get</code>, <code>watch</code>, <code>list</code>.</p>
<h3 id="2-create-a-service-account-for-your-application">2. Create a Service Account for your Application</h3>
<p>Let&#x27;s create a Kubernetes Service Account (<code>ServiceAccount</code>) for our deployment. This will be used by each pod of our application.</p>
<div class="remark-highlight"><pre class="language-yaml"><code class="language-yaml"><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> ServiceAccount
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> keyspace<span class="token punctuation">-</span>app<span class="token punctuation">-</span>service<span class="token punctuation">-</span>account
  <span class="token key atrule">namespace</span><span class="token punctuation">:</span> default
</code></pre></div>
<h3 id="3-bind-the-role-to-the-service-account">3. Bind the Role to the Service Account</h3>
<p>Next, create a <code>RoleBinding</code> to grant the <code>secret-reader</code> role to the <code>keyspace-app-service-account</code>:</p>
<div class="remark-highlight"><pre class="language-yaml"><code class="language-yaml"><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> rbac.authorization.k8s.io/v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> RoleBinding
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> read<span class="token punctuation">-</span>secret<span class="token punctuation">-</span>to<span class="token punctuation">-</span>my<span class="token punctuation">-</span>app
  <span class="token key atrule">namespace</span><span class="token punctuation">:</span> default
<span class="token key atrule">subjects</span><span class="token punctuation">:</span>
<span class="token punctuation">-</span> <span class="token key atrule">kind</span><span class="token punctuation">:</span> ServiceAccount
  <span class="token key atrule">name</span><span class="token punctuation">:</span> keyspace<span class="token punctuation">-</span>app<span class="token punctuation">-</span>service<span class="token punctuation">-</span>account
  <span class="token key atrule">namespace</span><span class="token punctuation">:</span> default
<span class="token key atrule">roleRef</span><span class="token punctuation">:</span>
  <span class="token key atrule">kind</span><span class="token punctuation">:</span> Role
  <span class="token key atrule">name</span><span class="token punctuation">:</span> secret<span class="token punctuation">-</span>reader
  <span class="token key atrule">apiGroup</span><span class="token punctuation">:</span> rbac.authorization.k8s.io
</code></pre></div>
<p>This <code>RoleBinding</code> named <code>read-secret-to-my-app</code> connects the <code>secret-reader</code> role with the <code>keyspace-app-service-account</code>, allowing the associated pods to access the <code>keyspace-cloud-prod-secret</code>.</p>
<h3 id="4-update-your-deployment-to-use-the-service-account">4. Update Your Deployment to Use the Service Account</h3>
<p>Modify your deployment to use the <code>keyspace-app-service-account</code>:</p>
<div class="remark-highlight"><pre class="language-yaml"><code class="language-yaml"><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> apps/v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Deployment
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> keyspace<span class="token punctuation">-</span>cloud<span class="token punctuation">-</span>app<span class="token punctuation">-</span>deployment
  <span class="token key atrule">annotations</span><span class="token punctuation">:</span>
    <span class="token key atrule">secrets.phase.dev/redeploy</span><span class="token punctuation">:</span> <span class="token string">&#x27;true&#x27;</span> <span class="token comment"># 👈 Automatically redeploy my application after secret changed </span>
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">replicas</span><span class="token punctuation">:</span> <span class="token number">3</span>
  <span class="token key atrule">selector</span><span class="token punctuation">:</span>
    <span class="token key atrule">matchLabels</span><span class="token punctuation">:</span>
      <span class="token key atrule">app</span><span class="token punctuation">:</span> my<span class="token punctuation">-</span>app
  <span class="token key atrule">template</span><span class="token punctuation">:</span>
    <span class="token key atrule">metadata</span><span class="token punctuation">:</span>
      <span class="token key atrule">labels</span><span class="token punctuation">:</span>
        <span class="token key atrule">app</span><span class="token punctuation">:</span> my<span class="token punctuation">-</span>app
    <span class="token key atrule">spec</span><span class="token punctuation">:</span>
      <span class="token key atrule">serviceAccountName</span><span class="token punctuation">:</span> keyspace<span class="token punctuation">-</span>app<span class="token punctuation">-</span>service<span class="token punctuation">-</span>account <span class="token comment"># 👈 Service account we just created</span>
      <span class="token key atrule">containers</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> my<span class="token punctuation">-</span>app
          <span class="token key atrule">image</span><span class="token punctuation">:</span> my<span class="token punctuation">-</span>app<span class="token punctuation">-</span>image
          <span class="token key atrule">envFrom</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> <span class="token key atrule">secretRef</span><span class="token punctuation">:</span>
                <span class="token key atrule">name</span><span class="token punctuation">:</span> keyspace<span class="token punctuation">-</span>cloud<span class="token punctuation">-</span>prod<span class="token punctuation">-</span>secret <span class="token comment"># 👈 Application secret</span>
</code></pre></div>
<p>In this deployment, the <code>spec.serviceAccountName</code> field is set to <code>keyspace-app-service-account</code>, ensuring that the pods run with the permissions granted to the service account, and thereby, adhere to the principles defined in the <code>Role</code> and <code>RoleBinding</code>.</p>
<p>By setting up these RBAC policies, you ensure that only your application has the necessary access to the secrets it needs, adhering to best practices for security and access control in Kubernetes.</p></main></article></div><div class="flex w-full border-t border-neutral-500/20 px-4 py-10 md:py-40"><div class="relative mx-auto grid w-full max-w-screen-lg shadow-2xl md:grid-cols-2 2xl:max-w-screen-2xl "><svg aria-hidden="true" class="pointer-events-none absolute inset-x-0 inset-y-[-50%] h-[200%] w-full skew-y-[-12deg] fill-black/10 stroke-white/20 mix-blend-overlay"><defs><pattern id=":R1t6:" width="72" height="56" patternUnits="userSpaceOnUse" x="-12" y="4"><path d="M.5 56V.5H72" fill="none"></path></pattern></defs><rect width="100%" height="100%" stroke-width="0" fill="url(#:R1t6:)"></rect><svg x="-12" y="4" class="overflow-visible"><rect stroke-width="0" width="73" height="57" x="288" y="168"></rect><rect stroke-width="0" width="73" height="57" x="144" y="56"></rect><rect stroke-width="0" width="73" height="57" x="576" y="168"></rect><rect stroke-width="0" width="73" height="57" x="504" y="504"></rect><rect stroke-width="0" width="73" height="57" x="720" y="336"></rect><rect stroke-width="0" width="73" height="57" x="864" y="224"></rect><rect stroke-width="0" width="73" height="57" x="1008" y="392"></rect><rect stroke-width="0" width="73" height="57" x="1152" y="280"></rect><rect stroke-width="0" width="73" height="57" x="936" y="560"></rect><rect stroke-width="0" width="73" height="57" x="648" y="504"></rect><rect stroke-width="0" width="73" height="57" x="1152" y="504"></rect><rect stroke-width="0" width="73" height="57" x="1152" y="672"></rect></svg></svg><div class="flex flex-col justify-between rounded-t-xl bg-gradient-to-tr from-emerald-600 to-emerald-900/70 p-8 md:rounded-l-xl md:rounded-tr-none md:p-10"><div><h2 class="text-3xl font-bold text-white md:text-4xl"><div class="flex items-center gap-1 border-none text-2xl font-light text-white md:text-4xl"><svg viewBox="0 0 1604 622" fill="none" xmlns="http://www.w3.org/2000/svg" class="w-36 fill-white md:w-48"><g clip-path="url(#clip0_625_16)"><path fill-rule="evenodd" clip-rule="evenodd" d="M187.661 486.576L169 578L194.475 583.2L213.226 491.334C220.135 492.12 227.161 492.523 234.28 492.523C336.055 492.523 418.561 410.018 418.561 308.243C418.561 224.668 362.925 154.087 286.669 131.516L304.695 43.1997L279.221 38L261.274 125.926C252.463 124.633 243.45 123.963 234.28 123.963C132.505 123.963 50 206.468 50 308.243C50 393.912 108.458 465.928 187.661 486.576ZM223.078 443.066C226.772 443.369 230.508 443.523 234.28 443.523C308.993 443.523 369.561 382.956 369.561 308.243C369.561 248.39 330.691 197.616 276.817 179.786L223.078 443.066ZM251.453 174.042L197.482 438.458C140.652 422.431 99 370.201 99 308.243C99 233.53 159.567 172.963 234.28 172.963C240.097 172.963 245.829 173.33 251.453 174.042Z"></path><path d="M498.42 506.818V206.818H548.989V242.898H551.972C554.623 237.595 558.364 231.96 563.193 225.994C568.023 219.934 574.557 214.773 582.795 210.511C591.034 206.155 601.545 203.977 614.33 203.977C631.186 203.977 646.384 208.286 659.926 216.903C673.563 225.426 684.358 238.068 692.312 254.83C700.362 271.496 704.386 291.951 704.386 316.193C704.386 340.152 700.456 360.511 692.597 377.273C684.737 394.034 674.036 406.818 660.494 415.625C646.953 424.432 631.612 428.835 614.472 428.835C601.972 428.835 591.602 426.752 583.364 422.585C575.125 418.419 568.496 413.4 563.477 407.528C558.553 401.562 554.718 395.928 551.972 390.625H549.841V506.818H498.42ZM548.847 315.909C548.847 330.019 550.835 342.377 554.812 352.983C558.884 363.589 564.708 371.875 572.284 377.841C579.955 383.712 589.235 386.648 600.125 386.648C611.489 386.648 621.006 383.617 628.676 377.557C636.347 371.402 642.123 363.021 646.006 352.415C649.983 341.714 651.972 329.545 651.972 315.909C651.972 302.367 650.03 290.341 646.148 279.83C642.265 269.318 636.489 261.08 628.818 255.114C621.148 249.148 611.583 246.165 600.125 246.165C589.14 246.165 579.812 249.053 572.142 254.83C564.472 260.606 558.648 268.703 554.67 279.119C550.788 289.536 548.847 301.799 548.847 315.909ZM775.841 297.159V425H724.42V134.091H774.705V243.892H777.261C782.375 231.581 790.282 221.875 800.983 214.773C811.778 207.576 825.509 203.977 842.176 203.977C857.328 203.977 870.538 207.15 881.807 213.494C893.076 219.839 901.788 229.119 907.943 241.335C914.193 253.551 917.318 268.466 917.318 286.08V425H865.898V294.034C865.898 279.356 862.11 267.945 854.534 259.801C847.053 251.562 836.542 247.443 823 247.443C813.909 247.443 805.765 249.432 798.568 253.409C791.466 257.292 785.879 262.926 781.807 270.312C777.83 277.699 775.841 286.648 775.841 297.159ZM1008.52 429.403C994.691 429.403 982.239 426.941 971.159 422.017C960.174 416.998 951.462 409.612 945.023 399.858C938.678 390.104 935.506 378.078 935.506 363.778C935.506 351.468 937.778 341.288 942.324 333.239C946.869 325.189 953.072 318.75 960.932 313.92C968.792 309.091 977.646 305.445 987.494 302.983C997.438 300.426 1007.71 298.58 1018.32 297.443C1031.1 296.117 1041.47 294.934 1049.43 293.892C1057.38 292.756 1063.16 291.051 1066.76 288.778C1070.45 286.411 1072.3 282.765 1072.3 277.841V276.989C1072.3 266.288 1069.12 258.002 1062.78 252.131C1056.43 246.259 1047.3 243.324 1035.36 243.324C1022.77 243.324 1012.78 246.07 1005.39 251.562C998.1 257.055 993.176 263.542 990.619 271.023L942.608 264.205C946.396 250.947 952.646 239.867 961.358 230.966C970.07 221.97 980.723 215.246 993.318 210.795C1005.91 206.25 1019.83 203.977 1035.08 203.977C1045.59 203.977 1056.05 205.208 1066.47 207.67C1076.89 210.133 1086.41 214.205 1095.02 219.886C1103.64 225.473 1110.55 233.097 1115.76 242.756C1121.06 252.415 1123.72 264.489 1123.72 278.977V425H1074.28V395.028H1072.58C1069.45 401.089 1065.05 406.771 1059.37 412.074C1053.78 417.282 1046.73 421.496 1038.2 424.716C1029.78 427.841 1019.88 429.403 1008.52 429.403ZM1021.87 391.619C1032.19 391.619 1041.14 389.583 1048.72 385.511C1056.29 381.345 1062.12 375.852 1066.19 369.034C1070.35 362.216 1072.44 354.782 1072.44 346.733V321.023C1070.83 322.348 1068.08 323.58 1064.2 324.716C1060.41 325.852 1056.15 326.847 1051.41 327.699C1046.68 328.551 1041.99 329.309 1037.35 329.972C1032.71 330.634 1028.69 331.203 1025.28 331.676C1017.61 332.718 1010.74 334.422 1004.68 336.79C998.621 339.157 993.839 342.472 990.335 346.733C986.831 350.9 985.08 356.297 985.08 362.926C985.08 372.396 988.536 379.545 995.449 384.375C1002.36 389.205 1011.17 391.619 1021.87 391.619ZM1323.86 264.489L1276.99 269.602C1275.66 264.867 1273.34 260.417 1270.03 256.25C1266.81 252.083 1262.45 248.722 1256.96 246.165C1251.47 243.608 1244.74 242.33 1236.79 242.33C1226.09 242.33 1217.09 244.65 1209.8 249.29C1202.6 253.93 1199.05 259.943 1199.15 267.33C1199.05 273.674 1201.37 278.835 1206.11 282.812C1210.94 286.79 1218.89 290.057 1229.97 292.614L1267.19 300.568C1287.83 305.019 1303.17 312.074 1313.21 321.733C1323.34 331.392 1328.46 344.034 1328.55 359.659C1328.46 373.39 1324.43 385.511 1316.48 396.023C1308.62 406.439 1297.68 414.583 1283.66 420.455C1269.65 426.326 1253.55 429.261 1235.37 429.261C1208.66 429.261 1187.17 423.674 1170.88 412.5C1154.59 401.231 1144.89 385.559 1141.76 365.483L1191.9 360.653C1194.18 370.502 1199.01 377.936 1206.39 382.955C1213.78 387.973 1223.39 390.483 1235.23 390.483C1247.44 390.483 1257.24 387.973 1264.63 382.955C1272.11 377.936 1275.85 371.733 1275.85 364.347C1275.85 358.097 1273.44 352.936 1268.61 348.864C1263.87 344.792 1256.49 341.667 1246.45 339.489L1209.23 331.676C1188.3 327.32 1172.82 319.981 1162.78 309.659C1152.75 299.242 1147.77 286.08 1147.87 270.17C1147.77 256.723 1151.42 245.076 1158.81 235.227C1166.29 225.284 1176.66 217.614 1189.91 212.216C1203.27 206.723 1218.66 203.977 1236.08 203.977C1261.65 203.977 1281.77 209.422 1296.45 220.312C1311.22 231.203 1320.36 245.928 1323.86 264.489ZM1443.54 429.261C1421.67 429.261 1402.78 424.716 1386.87 415.625C1371.05 406.439 1358.88 393.466 1350.36 376.705C1341.84 359.848 1337.58 340.009 1337.58 317.188C1337.58 294.744 1341.84 275.047 1350.36 258.097C1358.98 241.051 1371 227.794 1386.44 218.324C1401.88 208.759 1420.01 203.977 1440.84 203.977C1454.29 203.977 1466.98 206.155 1478.91 210.511C1490.94 214.773 1501.54 221.402 1510.73 230.398C1520.01 239.394 1527.3 250.852 1532.61 264.773C1537.91 278.598 1540.56 295.076 1540.56 314.205V329.972H1361.72V295.312H1491.27C1491.18 285.464 1489.04 276.705 1484.88 269.034C1480.71 261.269 1474.89 255.161 1467.41 250.71C1460.02 246.259 1451.4 244.034 1441.55 244.034C1431.04 244.034 1421.81 246.591 1413.86 251.705C1405.9 256.723 1399.7 263.352 1395.25 271.591C1390.89 279.735 1388.67 288.684 1388.57 298.438V328.693C1388.57 341.383 1390.89 352.273 1395.53 361.364C1400.17 370.36 1406.66 377.273 1414.99 382.102C1423.32 386.837 1433.08 389.205 1444.25 389.205C1451.73 389.205 1458.5 388.163 1464.57 386.08C1470.63 383.902 1475.88 380.729 1480.33 376.562C1484.78 372.396 1488.14 367.235 1490.42 361.08L1538.43 366.477C1535.4 379.167 1529.62 390.246 1521.1 399.716C1512.67 409.091 1501.88 416.383 1488.71 421.591C1475.55 426.705 1460.49 429.261 1443.54 429.261Z"></path></g><defs><clipPath id="clip0_625_16"><rect width="1604" height="622" fill="white"></rect></clipPath></defs></svg><sup class="-ml-2 bg-gradient-to-r from-zinc-400 via-white to-zinc-300 bg-clip-text font-mono text-sm font-bold text-transparent md:text-base">CLOUD</sup></div></h2><p class="text-base text-white/80 md:text-lg">The fastest and easiest way to get started with Phase. Spin up an app in minutes. Hosted in Frankfurt 🇩🇪</p></div><div class="flex w-full md:justify-end"><a href="https://console.phase.dev?ref=ctabanner" target="_blank" rel="noreferrer" class="hover:border-none hover:outline-none"><button variant="filled" class="inline-flex items-center justify-center gap-1 overflow-hidden font-medium transition rounded-full py-1 px-3 bg-emerald-500 text-white hover:bg-emerald-400 text-lg md:text-xl">Start Free<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 448 512" height="16" width="16" xmlns="http://www.w3.org/2000/svg"><path d="M190.5 66.9l22.2-22.2c9.4-9.4 24.6-9.4 33.9 0L441 239c9.4 9.4 9.4 24.6 0 33.9L246.6 467.3c-9.4 9.4-24.6 9.4-33.9 0l-22.2-22.2c-9.5-9.5-9.3-25 .4-34.3L311.4 296H24c-13.3 0-24-10.7-24-24v-32c0-13.3 10.7-24 24-24h287.4L190.9 101.2c-9.8-9.3-10-24.8-.4-34.3z"></path></svg></button></a></div></div><div class="flex w-full flex-col justify-between rounded-b-xl bg-gradient-to-tl from-zinc-700 to-zinc-900  p-8 md:rounded-r-xl md:rounded-bl-none md:p-10"><div><h2 class="text-3xl font-bold text-white md:text-4xl"><div class="flex items-center gap-1 border-none text-2xl font-light text-white md:text-4xl"><svg viewBox="0 0 1604 622" fill="none" xmlns="http://www.w3.org/2000/svg" class="w-36 fill-white md:w-48"><g clip-path="url(#clip0_625_16)"><path fill-rule="evenodd" clip-rule="evenodd" d="M187.661 486.576L169 578L194.475 583.2L213.226 491.334C220.135 492.12 227.161 492.523 234.28 492.523C336.055 492.523 418.561 410.018 418.561 308.243C418.561 224.668 362.925 154.087 286.669 131.516L304.695 43.1997L279.221 38L261.274 125.926C252.463 124.633 243.45 123.963 234.28 123.963C132.505 123.963 50 206.468 50 308.243C50 393.912 108.458 465.928 187.661 486.576ZM223.078 443.066C226.772 443.369 230.508 443.523 234.28 443.523C308.993 443.523 369.561 382.956 369.561 308.243C369.561 248.39 330.691 197.616 276.817 179.786L223.078 443.066ZM251.453 174.042L197.482 438.458C140.652 422.431 99 370.201 99 308.243C99 233.53 159.567 172.963 234.28 172.963C240.097 172.963 245.829 173.33 251.453 174.042Z"></path><path d="M498.42 506.818V206.818H548.989V242.898H551.972C554.623 237.595 558.364 231.96 563.193 225.994C568.023 219.934 574.557 214.773 582.795 210.511C591.034 206.155 601.545 203.977 614.33 203.977C631.186 203.977 646.384 208.286 659.926 216.903C673.563 225.426 684.358 238.068 692.312 254.83C700.362 271.496 704.386 291.951 704.386 316.193C704.386 340.152 700.456 360.511 692.597 377.273C684.737 394.034 674.036 406.818 660.494 415.625C646.953 424.432 631.612 428.835 614.472 428.835C601.972 428.835 591.602 426.752 583.364 422.585C575.125 418.419 568.496 413.4 563.477 407.528C558.553 401.562 554.718 395.928 551.972 390.625H549.841V506.818H498.42ZM548.847 315.909C548.847 330.019 550.835 342.377 554.812 352.983C558.884 363.589 564.708 371.875 572.284 377.841C579.955 383.712 589.235 386.648 600.125 386.648C611.489 386.648 621.006 383.617 628.676 377.557C636.347 371.402 642.123 363.021 646.006 352.415C649.983 341.714 651.972 329.545 651.972 315.909C651.972 302.367 650.03 290.341 646.148 279.83C642.265 269.318 636.489 261.08 628.818 255.114C621.148 249.148 611.583 246.165 600.125 246.165C589.14 246.165 579.812 249.053 572.142 254.83C564.472 260.606 558.648 268.703 554.67 279.119C550.788 289.536 548.847 301.799 548.847 315.909ZM775.841 297.159V425H724.42V134.091H774.705V243.892H777.261C782.375 231.581 790.282 221.875 800.983 214.773C811.778 207.576 825.509 203.977 842.176 203.977C857.328 203.977 870.538 207.15 881.807 213.494C893.076 219.839 901.788 229.119 907.943 241.335C914.193 253.551 917.318 268.466 917.318 286.08V425H865.898V294.034C865.898 279.356 862.11 267.945 854.534 259.801C847.053 251.562 836.542 247.443 823 247.443C813.909 247.443 805.765 249.432 798.568 253.409C791.466 257.292 785.879 262.926 781.807 270.312C777.83 277.699 775.841 286.648 775.841 297.159ZM1008.52 429.403C994.691 429.403 982.239 426.941 971.159 422.017C960.174 416.998 951.462 409.612 945.023 399.858C938.678 390.104 935.506 378.078 935.506 363.778C935.506 351.468 937.778 341.288 942.324 333.239C946.869 325.189 953.072 318.75 960.932 313.92C968.792 309.091 977.646 305.445 987.494 302.983C997.438 300.426 1007.71 298.58 1018.32 297.443C1031.1 296.117 1041.47 294.934 1049.43 293.892C1057.38 292.756 1063.16 291.051 1066.76 288.778C1070.45 286.411 1072.3 282.765 1072.3 277.841V276.989C1072.3 266.288 1069.12 258.002 1062.78 252.131C1056.43 246.259 1047.3 243.324 1035.36 243.324C1022.77 243.324 1012.78 246.07 1005.39 251.562C998.1 257.055 993.176 263.542 990.619 271.023L942.608 264.205C946.396 250.947 952.646 239.867 961.358 230.966C970.07 221.97 980.723 215.246 993.318 210.795C1005.91 206.25 1019.83 203.977 1035.08 203.977C1045.59 203.977 1056.05 205.208 1066.47 207.67C1076.89 210.133 1086.41 214.205 1095.02 219.886C1103.64 225.473 1110.55 233.097 1115.76 242.756C1121.06 252.415 1123.72 264.489 1123.72 278.977V425H1074.28V395.028H1072.58C1069.45 401.089 1065.05 406.771 1059.37 412.074C1053.78 417.282 1046.73 421.496 1038.2 424.716C1029.78 427.841 1019.88 429.403 1008.52 429.403ZM1021.87 391.619C1032.19 391.619 1041.14 389.583 1048.72 385.511C1056.29 381.345 1062.12 375.852 1066.19 369.034C1070.35 362.216 1072.44 354.782 1072.44 346.733V321.023C1070.83 322.348 1068.08 323.58 1064.2 324.716C1060.41 325.852 1056.15 326.847 1051.41 327.699C1046.68 328.551 1041.99 329.309 1037.35 329.972C1032.71 330.634 1028.69 331.203 1025.28 331.676C1017.61 332.718 1010.74 334.422 1004.68 336.79C998.621 339.157 993.839 342.472 990.335 346.733C986.831 350.9 985.08 356.297 985.08 362.926C985.08 372.396 988.536 379.545 995.449 384.375C1002.36 389.205 1011.17 391.619 1021.87 391.619ZM1323.86 264.489L1276.99 269.602C1275.66 264.867 1273.34 260.417 1270.03 256.25C1266.81 252.083 1262.45 248.722 1256.96 246.165C1251.47 243.608 1244.74 242.33 1236.79 242.33C1226.09 242.33 1217.09 244.65 1209.8 249.29C1202.6 253.93 1199.05 259.943 1199.15 267.33C1199.05 273.674 1201.37 278.835 1206.11 282.812C1210.94 286.79 1218.89 290.057 1229.97 292.614L1267.19 300.568C1287.83 305.019 1303.17 312.074 1313.21 321.733C1323.34 331.392 1328.46 344.034 1328.55 359.659C1328.46 373.39 1324.43 385.511 1316.48 396.023C1308.62 406.439 1297.68 414.583 1283.66 420.455C1269.65 426.326 1253.55 429.261 1235.37 429.261C1208.66 429.261 1187.17 423.674 1170.88 412.5C1154.59 401.231 1144.89 385.559 1141.76 365.483L1191.9 360.653C1194.18 370.502 1199.01 377.936 1206.39 382.955C1213.78 387.973 1223.39 390.483 1235.23 390.483C1247.44 390.483 1257.24 387.973 1264.63 382.955C1272.11 377.936 1275.85 371.733 1275.85 364.347C1275.85 358.097 1273.44 352.936 1268.61 348.864C1263.87 344.792 1256.49 341.667 1246.45 339.489L1209.23 331.676C1188.3 327.32 1172.82 319.981 1162.78 309.659C1152.75 299.242 1147.77 286.08 1147.87 270.17C1147.77 256.723 1151.42 245.076 1158.81 235.227C1166.29 225.284 1176.66 217.614 1189.91 212.216C1203.27 206.723 1218.66 203.977 1236.08 203.977C1261.65 203.977 1281.77 209.422 1296.45 220.312C1311.22 231.203 1320.36 245.928 1323.86 264.489ZM1443.54 429.261C1421.67 429.261 1402.78 424.716 1386.87 415.625C1371.05 406.439 1358.88 393.466 1350.36 376.705C1341.84 359.848 1337.58 340.009 1337.58 317.188C1337.58 294.744 1341.84 275.047 1350.36 258.097C1358.98 241.051 1371 227.794 1386.44 218.324C1401.88 208.759 1420.01 203.977 1440.84 203.977C1454.29 203.977 1466.98 206.155 1478.91 210.511C1490.94 214.773 1501.54 221.402 1510.73 230.398C1520.01 239.394 1527.3 250.852 1532.61 264.773C1537.91 278.598 1540.56 295.076 1540.56 314.205V329.972H1361.72V295.312H1491.27C1491.18 285.464 1489.04 276.705 1484.88 269.034C1480.71 261.269 1474.89 255.161 1467.41 250.71C1460.02 246.259 1451.4 244.034 1441.55 244.034C1431.04 244.034 1421.81 246.591 1413.86 251.705C1405.9 256.723 1399.7 263.352 1395.25 271.591C1390.89 279.735 1388.67 288.684 1388.57 298.438V328.693C1388.57 341.383 1390.89 352.273 1395.53 361.364C1400.17 370.36 1406.66 377.273 1414.99 382.102C1423.32 386.837 1433.08 389.205 1444.25 389.205C1451.73 389.205 1458.5 388.163 1464.57 386.08C1470.63 383.902 1475.88 380.729 1480.33 376.562C1484.78 372.396 1488.14 367.235 1490.42 361.08L1538.43 366.477C1535.4 379.167 1529.62 390.246 1521.1 399.716C1512.67 409.091 1501.88 416.383 1488.71 421.591C1475.55 426.705 1460.49 429.261 1443.54 429.261Z"></path></g><defs><clipPath id="clip0_625_16"><rect width="1604" height="622" fill="white"></rect></clipPath></defs></svg><sup class="-ml-2 bg-gradient-to-r from-zinc-400 via-white to-zinc-300 bg-clip-text font-mono text-sm font-bold text-transparent md:text-base">SELF-HOSTED</sup></div></h2><p class="text-base text-white/80 md:text-lg">Run Phase on your own infrastructure and maintain full control. Perfect for customers with strict compliance requirements.</p></div><div class="flex w-full md:justify-end"><a href="https://docs.phase.dev/self-hosting?ref=ctabanner" target="_blank" rel="noreferrer" class="hover:border-none hover:outline-none"><button variant="secondary" color="black" class="inline-flex items-center justify-center gap-1 overflow-hidden font-medium transition rounded-full py-1 px-3 bg-zinc-800/40 text-zinc-400 ring-1 ring-inset ring-zinc-800 hover:bg-zinc-100 hover:text-black text-lg md:text-xl">Explore Docs<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 448 512" height="16" width="16" xmlns="http://www.w3.org/2000/svg"><path d="M190.5 66.9l22.2-22.2c9.4-9.4 24.6-9.4 33.9 0L441 239c9.4 9.4 9.4 24.6 0 33.9L246.6 467.3c-9.4 9.4-24.6 9.4-33.9 0l-22.2-22.2c-9.5-9.5-9.3-25 .4-34.3L311.4 296H24c-13.3 0-24-10.7-24-24v-32c0-13.3 10.7-24 24-24h287.4L190.9 101.2c-9.8-9.3-10-24.8-.4-34.3z"></path></svg></button></a></div></div></div></div></div></main><div class="relative w-full border-t border-neutral-500/20"><div class="pointer-events-none absolute inset-0 mx-0 max-w-none rotate-180 overflow-hidden"><div class=" absolute left-1/3 top-0 ml-[-30rem] h-[30rem] w-[120rem] [mask-image:linear-gradient(white,transparent)]"><div class="absolute inset-0 bg-gradient-to-r from-[#B945CC]/70 to-[#355BE0]/70 opacity-100 [mask-image:radial-gradient(farthest-side_at_top,white,transparent)]"><svg aria-hidden="true" class="absolute inset-x-0 inset-y-[-50%] h-[200%] w-full skew-y-[-18deg] fill-black/10 stroke-white/5 mix-blend-overlay"><defs><pattern id=":Rf6:" width="72" height="56" patternUnits="userSpaceOnUse" x="-12" y="4"><path d="M.5 56V.5H72" fill="none"></path></pattern></defs><rect width="100%" height="100%" stroke-width="0" fill="url(#:Rf6:)"></rect><svg x="-12" y="4" class="overflow-visible"><rect stroke-width="0" width="73" height="57" x="288" y="168"></rect><rect stroke-width="0" width="73" height="57" x="144" y="56"></rect><rect stroke-width="0" width="73" height="57" x="504" y="168"></rect><rect stroke-width="0" width="73" height="57" x="720" y="336"></rect></svg></svg></div></div></div><footer class="z-10 mx-auto grid w-full max-w-screen-lg grid-cols-1 gap-y-16 px-4 pt-20 text-sm text-gray-500 sm:grid-cols-2 md:pt-40 lg:max-w-screen-lg lg:grid-cols-4 2xl:max-w-screen-2xl" data-testid="footer"><div class="flex flex-col justify-between md:w-1/2"><div class="flex items-center gap-1 border-none text-2xl font-light text-white/40 grayscale"><svg viewBox="0 0 1604 622" fill="none" xmlns="http://www.w3.org/2000/svg" class="ease w-24 fill-neutral-500 md:w-48"><g clip-path="url(#clip0_625_16)"><path fill-rule="evenodd" clip-rule="evenodd" d="M187.661 486.576L169 578L194.475 583.2L213.226 491.334C220.135 492.12 227.161 492.523 234.28 492.523C336.055 492.523 418.561 410.018 418.561 308.243C418.561 224.668 362.925 154.087 286.669 131.516L304.695 43.1997L279.221 38L261.274 125.926C252.463 124.633 243.45 123.963 234.28 123.963C132.505 123.963 50 206.468 50 308.243C50 393.912 108.458 465.928 187.661 486.576ZM223.078 443.066C226.772 443.369 230.508 443.523 234.28 443.523C308.993 443.523 369.561 382.956 369.561 308.243C369.561 248.39 330.691 197.616 276.817 179.786L223.078 443.066ZM251.453 174.042L197.482 438.458C140.652 422.431 99 370.201 99 308.243C99 233.53 159.567 172.963 234.28 172.963C240.097 172.963 245.829 173.33 251.453 174.042Z"></path><path d="M498.42 506.818V206.818H548.989V242.898H551.972C554.623 237.595 558.364 231.96 563.193 225.994C568.023 219.934 574.557 214.773 582.795 210.511C591.034 206.155 601.545 203.977 614.33 203.977C631.186 203.977 646.384 208.286 659.926 216.903C673.563 225.426 684.358 238.068 692.312 254.83C700.362 271.496 704.386 291.951 704.386 316.193C704.386 340.152 700.456 360.511 692.597 377.273C684.737 394.034 674.036 406.818 660.494 415.625C646.953 424.432 631.612 428.835 614.472 428.835C601.972 428.835 591.602 426.752 583.364 422.585C575.125 418.419 568.496 413.4 563.477 407.528C558.553 401.562 554.718 395.928 551.972 390.625H549.841V506.818H498.42ZM548.847 315.909C548.847 330.019 550.835 342.377 554.812 352.983C558.884 363.589 564.708 371.875 572.284 377.841C579.955 383.712 589.235 386.648 600.125 386.648C611.489 386.648 621.006 383.617 628.676 377.557C636.347 371.402 642.123 363.021 646.006 352.415C649.983 341.714 651.972 329.545 651.972 315.909C651.972 302.367 650.03 290.341 646.148 279.83C642.265 269.318 636.489 261.08 628.818 255.114C621.148 249.148 611.583 246.165 600.125 246.165C589.14 246.165 579.812 249.053 572.142 254.83C564.472 260.606 558.648 268.703 554.67 279.119C550.788 289.536 548.847 301.799 548.847 315.909ZM775.841 297.159V425H724.42V134.091H774.705V243.892H777.261C782.375 231.581 790.282 221.875 800.983 214.773C811.778 207.576 825.509 203.977 842.176 203.977C857.328 203.977 870.538 207.15 881.807 213.494C893.076 219.839 901.788 229.119 907.943 241.335C914.193 253.551 917.318 268.466 917.318 286.08V425H865.898V294.034C865.898 279.356 862.11 267.945 854.534 259.801C847.053 251.562 836.542 247.443 823 247.443C813.909 247.443 805.765 249.432 798.568 253.409C791.466 257.292 785.879 262.926 781.807 270.312C777.83 277.699 775.841 286.648 775.841 297.159ZM1008.52 429.403C994.691 429.403 982.239 426.941 971.159 422.017C960.174 416.998 951.462 409.612 945.023 399.858C938.678 390.104 935.506 378.078 935.506 363.778C935.506 351.468 937.778 341.288 942.324 333.239C946.869 325.189 953.072 318.75 960.932 313.92C968.792 309.091 977.646 305.445 987.494 302.983C997.438 300.426 1007.71 298.58 1018.32 297.443C1031.1 296.117 1041.47 294.934 1049.43 293.892C1057.38 292.756 1063.16 291.051 1066.76 288.778C1070.45 286.411 1072.3 282.765 1072.3 277.841V276.989C1072.3 266.288 1069.12 258.002 1062.78 252.131C1056.43 246.259 1047.3 243.324 1035.36 243.324C1022.77 243.324 1012.78 246.07 1005.39 251.562C998.1 257.055 993.176 263.542 990.619 271.023L942.608 264.205C946.396 250.947 952.646 239.867 961.358 230.966C970.07 221.97 980.723 215.246 993.318 210.795C1005.91 206.25 1019.83 203.977 1035.08 203.977C1045.59 203.977 1056.05 205.208 1066.47 207.67C1076.89 210.133 1086.41 214.205 1095.02 219.886C1103.64 225.473 1110.55 233.097 1115.76 242.756C1121.06 252.415 1123.72 264.489 1123.72 278.977V425H1074.28V395.028H1072.58C1069.45 401.089 1065.05 406.771 1059.37 412.074C1053.78 417.282 1046.73 421.496 1038.2 424.716C1029.78 427.841 1019.88 429.403 1008.52 429.403ZM1021.87 391.619C1032.19 391.619 1041.14 389.583 1048.72 385.511C1056.29 381.345 1062.12 375.852 1066.19 369.034C1070.35 362.216 1072.44 354.782 1072.44 346.733V321.023C1070.83 322.348 1068.08 323.58 1064.2 324.716C1060.41 325.852 1056.15 326.847 1051.41 327.699C1046.68 328.551 1041.99 329.309 1037.35 329.972C1032.71 330.634 1028.69 331.203 1025.28 331.676C1017.61 332.718 1010.74 334.422 1004.68 336.79C998.621 339.157 993.839 342.472 990.335 346.733C986.831 350.9 985.08 356.297 985.08 362.926C985.08 372.396 988.536 379.545 995.449 384.375C1002.36 389.205 1011.17 391.619 1021.87 391.619ZM1323.86 264.489L1276.99 269.602C1275.66 264.867 1273.34 260.417 1270.03 256.25C1266.81 252.083 1262.45 248.722 1256.96 246.165C1251.47 243.608 1244.74 242.33 1236.79 242.33C1226.09 242.33 1217.09 244.65 1209.8 249.29C1202.6 253.93 1199.05 259.943 1199.15 267.33C1199.05 273.674 1201.37 278.835 1206.11 282.812C1210.94 286.79 1218.89 290.057 1229.97 292.614L1267.19 300.568C1287.83 305.019 1303.17 312.074 1313.21 321.733C1323.34 331.392 1328.46 344.034 1328.55 359.659C1328.46 373.39 1324.43 385.511 1316.48 396.023C1308.62 406.439 1297.68 414.583 1283.66 420.455C1269.65 426.326 1253.55 429.261 1235.37 429.261C1208.66 429.261 1187.17 423.674 1170.88 412.5C1154.59 401.231 1144.89 385.559 1141.76 365.483L1191.9 360.653C1194.18 370.502 1199.01 377.936 1206.39 382.955C1213.78 387.973 1223.39 390.483 1235.23 390.483C1247.44 390.483 1257.24 387.973 1264.63 382.955C1272.11 377.936 1275.85 371.733 1275.85 364.347C1275.85 358.097 1273.44 352.936 1268.61 348.864C1263.87 344.792 1256.49 341.667 1246.45 339.489L1209.23 331.676C1188.3 327.32 1172.82 319.981 1162.78 309.659C1152.75 299.242 1147.77 286.08 1147.87 270.17C1147.77 256.723 1151.42 245.076 1158.81 235.227C1166.29 225.284 1176.66 217.614 1189.91 212.216C1203.27 206.723 1218.66 203.977 1236.08 203.977C1261.65 203.977 1281.77 209.422 1296.45 220.312C1311.22 231.203 1320.36 245.928 1323.86 264.489ZM1443.54 429.261C1421.67 429.261 1402.78 424.716 1386.87 415.625C1371.05 406.439 1358.88 393.466 1350.36 376.705C1341.84 359.848 1337.58 340.009 1337.58 317.188C1337.58 294.744 1341.84 275.047 1350.36 258.097C1358.98 241.051 1371 227.794 1386.44 218.324C1401.88 208.759 1420.01 203.977 1440.84 203.977C1454.29 203.977 1466.98 206.155 1478.91 210.511C1490.94 214.773 1501.54 221.402 1510.73 230.398C1520.01 239.394 1527.3 250.852 1532.61 264.773C1537.91 278.598 1540.56 295.076 1540.56 314.205V329.972H1361.72V295.312H1491.27C1491.18 285.464 1489.04 276.705 1484.88 269.034C1480.71 261.269 1474.89 255.161 1467.41 250.71C1460.02 246.259 1451.4 244.034 1441.55 244.034C1431.04 244.034 1421.81 246.591 1413.86 251.705C1405.9 256.723 1399.7 263.352 1395.25 271.591C1390.89 279.735 1388.67 288.684 1388.57 298.438V328.693C1388.57 341.383 1390.89 352.273 1395.53 361.364C1400.17 370.36 1406.66 377.273 1414.99 382.102C1423.32 386.837 1433.08 389.205 1444.25 389.205C1451.73 389.205 1458.5 388.163 1464.57 386.08C1470.63 383.902 1475.88 380.729 1480.33 376.562C1484.78 372.396 1488.14 367.235 1490.42 361.08L1538.43 366.477C1535.4 379.167 1529.62 390.246 1521.1 399.716C1512.67 409.091 1501.88 416.383 1488.71 421.591C1475.55 426.705 1460.49 429.261 1443.54 429.261Z"></path></g><defs><clipPath id="clip0_625_16"><rect width="1604" height="622" fill="white"></rect></clipPath></defs></svg></div></div><div class="flex flex-col space-y-2"><div class="mb-2 font-bold text-zinc-600">Product</div><div><a class=" text-neutral-300 outline-none hover:border-none hover:text-emerald-500 hover:outline-none" target="_blank" href="https://docs.phase.dev/security">Security</a></div><div><a class=" text-neutral-300 outline-none hover:border-none hover:text-emerald-500 hover:outline-none" target="_self" href="/pricing/">Pricing</a></div><div><a class=" text-neutral-300 outline-none hover:border-none hover:text-emerald-500 hover:outline-none" target="_blank" href="https://console.phase.dev">Console</a></div><div><a class=" text-neutral-300 outline-none hover:border-none hover:text-emerald-500 hover:outline-none" target="_blank" href="https://docs.phase.dev/#phase-cli">CLI</a></div><div><a class=" text-neutral-300 outline-none hover:border-none hover:text-emerald-500 hover:outline-none" href="/vs-aws-secrets-manager/">vs AWS Secrets Manager</a></div></div><div class="flex flex-col space-y-2"><div class="mb-2 font-bold text-zinc-600">Resources</div><div><a class=" text-neutral-300 outline-none hover:border-none hover:text-emerald-500 hover:outline-none" target="_blank" href="https://docs.phase.dev">Docs</a></div><div><a class=" text-neutral-300 outline-none hover:border-none hover:text-emerald-500 hover:outline-none" target="_blank" href="https://docs.phase.dev/integrations">Integrations</a></div><div><a class=" text-neutral-300 outline-none hover:border-none hover:text-emerald-500 hover:outline-none" target="_self" href="/blog/">Blog</a></div><div><a class=" text-neutral-300 outline-none hover:border-none hover:text-emerald-500 hover:outline-none" target="_self" href="/changelog/">Changelog</a></div></div><div class="flex flex-col space-y-2"><div class="mb-2 font-bold text-zinc-600">Legal</div><div><a class=" text-neutral-300 outline-none hover:border-none hover:text-emerald-500 hover:outline-none" target="_self" href="/legal/privacy/">Privacy policy</a></div><div><a class=" text-neutral-300 outline-none hover:border-none hover:text-emerald-500 hover:outline-none" target="_self" href="/legal/cookies/">Cookie policy</a></div><div><a class=" text-neutral-300 outline-none hover:border-none hover:text-emerald-500 hover:outline-none" target="_self" href="/legal/terms/">Terms of service</a></div></div><div class="flex w-full justify-between border-t border-neutral-500/20 py-6 text-xs text-zinc-400 sm:col-span-2 lg:col-span-4"><span class="w-1/2">© Copyright <!-- -->2024<!-- --> Phase Security Inc. All rights reserved.</span><div class="grid grid-cols-1 gap-4 md:grid-cols-2"><a class=" text-neutral-300 outline-none hover:border-none hover:text-emerald-500 hover:outline-none" target="_blank" href="https://phase.statuspage.io">System status<span class="ml-2 inline-block size-2 animate-pulse rounded-full bg-emerald-500"></span></a><div class="flex gap-4"><a target="_blank" title="Follow us on GitHub" class="group outline-none hover:border-none" href="https://github.com/phasehq/console"><svg stroke="currentColor" fill="currentColor" stroke-width="0" role="img" viewBox="0 0 24 24" class="size-4 fill-zinc-700 transition group-hover:fill-zinc-500 md:size-5" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg><span class="sr-only"></span></a><a target="_blank" title="Join our Slack" class="group outline-none hover:border-none" href="https://slack.phase.dev"><svg stroke="currentColor" fill="currentColor" stroke-width="0" role="img" viewBox="0 0 24 24" class="size-4 fill-zinc-700 transition group-hover:fill-zinc-500 md:size-5" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M5.042 15.165a2.528 2.528 0 0 1-2.52 2.523A2.528 2.528 0 0 1 0 15.165a2.527 2.527 0 0 1 2.522-2.52h2.52v2.52zM6.313 15.165a2.527 2.527 0 0 1 2.521-2.52 2.527 2.527 0 0 1 2.521 2.52v6.313A2.528 2.528 0 0 1 8.834 24a2.528 2.528 0 0 1-2.521-2.522v-6.313zM8.834 5.042a2.528 2.528 0 0 1-2.521-2.52A2.528 2.528 0 0 1 8.834 0a2.528 2.528 0 0 1 2.521 2.522v2.52H8.834zM8.834 6.313a2.528 2.528 0 0 1 2.521 2.521 2.528 2.528 0 0 1-2.521 2.521H2.522A2.528 2.528 0 0 1 0 8.834a2.528 2.528 0 0 1 2.522-2.521h6.312zM18.956 8.834a2.528 2.528 0 0 1 2.522-2.521A2.528 2.528 0 0 1 24 8.834a2.528 2.528 0 0 1-2.522 2.521h-2.522V8.834zM17.688 8.834a2.528 2.528 0 0 1-2.523 2.521 2.527 2.527 0 0 1-2.52-2.521V2.522A2.527 2.527 0 0 1 15.165 0a2.528 2.528 0 0 1 2.523 2.522v6.312zM15.165 18.956a2.528 2.528 0 0 1 2.523 2.522A2.528 2.528 0 0 1 15.165 24a2.527 2.527 0 0 1-2.52-2.522v-2.522h2.52zM15.165 17.688a2.527 2.527 0 0 1-2.52-2.523 2.526 2.526 0 0 1 2.52-2.52h6.313A2.527 2.527 0 0 1 24 15.165a2.528 2.528 0 0 1-2.522 2.523h-6.313z"></path></svg><span class="sr-only"></span></a><a target="_blank" title="Follow us on Twitter" class="group outline-none hover:border-none" href="https://twitter.com/phasedotdev"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" class="size-4 fill-zinc-700 transition group-hover:fill-zinc-500 md:size-5" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M18.2048 2.25H21.5128L14.2858 10.51L22.7878 21.75H16.1308L10.9168 14.933L4.95084 21.75H1.64084L9.37084 12.915L1.21484 2.25H8.04084L12.7538 8.481L18.2048 2.25ZM17.0438 19.77H18.8768L7.04484 4.126H5.07784L17.0438 19.77Z"></path></svg><span class="sr-only"></span></a><a target="_blank" title="Follow us on LinkedIn" class="group outline-none hover:border-none" href="https://www.linkedin.com/company/phasehq/"><svg stroke="currentColor" fill="currentColor" stroke-width="0" role="img" viewBox="0 0 24 24" class="size-4 fill-zinc-700 transition group-hover:fill-zinc-500 md:size-5" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"></path></svg><span class="sr-only"></span></a><a target="_blank" title="Review us on ProductHunt" class="group outline-none hover:border-none" href="https://www.producthunt.com/posts/phase-6"><svg stroke="currentColor" fill="currentColor" stroke-width="0" role="img" viewBox="0 0 24 24" class="size-4 fill-zinc-700 transition group-hover:fill-zinc-500 md:size-5" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M13.604 8.4h-3.405V12h3.405c.995 0 1.801-.806 1.801-1.801 0-.993-.805-1.799-1.801-1.799zM12 0C5.372 0 0 5.372 0 12s5.372 12 12 12 12-5.372 12-12S18.628 0 12 0zm1.604 14.4h-3.405V18H7.801V6h5.804c2.319 0 4.2 1.88 4.2 4.199 0 2.321-1.881 4.201-4.201 4.201z"></path></svg><span class="sr-only"></span></a></div></div></div></footer></div></div></div></div></div><script id="__NEXT_DATA__" type="application/json" crossorigin>{"props":{"pageProps":{"source":{"compiledSource":"/*@jsxRuntime automatic @jsxImportSource react*/\nconst {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];\nconst {useMDXComponents: _provideComponents} = arguments[0];\nfunction _createMdxContent(props) {\n  const _components = Object.assign({\n    p: \"p\",\n    img: \"img\",\n    h2: \"h2\",\n    a: \"a\",\n    code: \"code\",\n    em: \"em\",\n    ul: \"ul\",\n    li: \"li\",\n    strong: \"strong\",\n    h3: \"h3\",\n    table: \"table\",\n    thead: \"thead\",\n    tr: \"tr\",\n    th: \"th\",\n    tbody: \"tbody\",\n    td: \"td\",\n    div: \"div\",\n    pre: \"pre\",\n    span: \"span\"\n  }, _provideComponents(), props.components);\n  return _jsxs(_Fragment, {\n    children: [_jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"/assets/images/blog/kubernetes/output.webp\",\n        alt: \"k8-secrets\"\n      })\n    }), \"\\n\", _jsx(_components.h2, {\n      id: \"introduction\",\n      children: \"Introduction\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Kubernetes is the open-source container orchestration platform of choice for many, specifically for automating deployment, scaling, and management of containerized applications. Supplying secrets securely to these containerized applications with Kubernetes can be tricky, but it's essential to the security of your workload. Out of the box, Kubernetes offers several native mechanisms to handle secrets, but they come with limitations in terms of security features, scalability, and complexity.\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"In this guide, we will explore enabling encryption at rest for secrets stored in Kubernetes and use the \", _jsx(_components.a, {\n        href: \"https://docs.phase.dev/integrations/platforms/kubernetes\",\n        rel: \"nofollow\",\n        children: \"Phase Kubernetes Operator\"\n      }), \" to securely sync secrets stored in the Phase secrets manager to a Kubernetes cluster. If you don't know what an operator is, think of it as an agent running inside a Pod in a Kubernetes cluster that interacts with the Kubernetes API to automate the management of a certain service or a set of services.\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Here's what the high level architecture looks like:\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"/assets/images/blog/kubernetes/phase-kubernetes-operator.webp\",\n        alt: \"phase-k8-operator\"\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"The Phase Kubernetes Operator will fetch application secrets from a Phase instance, decrypt them, and write them to a Kubernetes cluster as a managed \", _jsx(_components.a, {\n        href: \"https://kubernetes.io/docs/concepts/configuration/secret/\",\n        rel: \"nofollow\",\n        children: \"Kubernetes Secret\"\n      }), \". It will then continue to watch for any changes in secrets in Phase and automatically sync them with the Kubernetes cluster, making our secret manager the source of truth for secrets. Furthermore, it can optionally automatically re-deploy Kubernetes deployments once a secret associated with them has been changed.\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Phase can also be used to manage secrets in stages preceding application deployment in the cloud, such as \", _jsx(_components.a, {\n        href: \"https://docs.phase.dev/integrations\",\n        rel: \"nofollow\",\n        children: \"local development\"\n      }), \" or a when a container is being built in CI pipelines like \", _jsx(_components.a, {\n        href: \"https://docs.phase.dev/integrations/platforms/github-actions\",\n        rel: \"nofollow\",\n        children: \"GitHub Actions\"\n      }), \", but that's outside the scope of this blog.\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"/assets/images/blog/kubernetes/keyspace-secrets.png\",\n        alt: \"keyspace-secrets\"\n      })\n    }), \"\\n\", _jsxs(_components.h2, {\n      id: \"understanding-the-security-of-secrets-stored-in-kubernetes-etcd\",\n      children: [\"Understanding the security of secrets stored in Kubernetes \", _jsx(_components.code, {\n        children: \"etcd\"\n      })]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Before we begin, let's make sure our Kubernetes cluster has 'encryption at rest' enabled. Kubernetes uses \", _jsx(_components.code, {\n        children: \"etcd\"\n      }), \", a distributed key-value pair database to store critical data such as the state of the cluster, configuration and secrets. It's important that the Kubernetes API encrypts the secrets before they are written to \", _jsx(_components.code, {\n        children: \"etcd\"\n      }), \" on disk.\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"There is a saying, \\\"\", _jsx(_components.em, {\n        children: \"encryption is easy, key management is hard\"\n      }), \"\\\";  here we face the same challenge. If we want to encrypt secrets that are stored inside our Kubernetes cluster, which key would we encrypt that data with? Isn't that another secret we need to protect? The complexity of this setup varies depending on how your cluster is managed. If you are managing your Kubernetes cluster by yourself, the process can be complex given that you will have to manually create, deploy, and manage the key that is used to encrypt \", _jsx(_components.code, {\n        children: \"etcd\"\n      }), \" data on all master / master standby or control plane nodes. Although this may be tedious, this approach has security benefits if your threat model requires you to maintain self-custody of your keys.\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"On the other hand, if your cluster is managed by a cloud provider like AWS, GCP or Azure, encryption of \", _jsx(_components.code, {\n        children: \"etcd\"\n      }), \" data is setup by default with the keys owned and managed by the cloud provider.\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"With managed Kubernetes you also have the option to leverage the respective cloud provider's KMS (Key Management Service) to create and use an encryption key that will be managed by you but owned by the provider. This is usually easier to set up but requires you to trust the cloud provider's KMS service with your keys and can end up being quite expensive as the keys are often priced by the number of invocations.\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"So to recap, there are two main options for encrypting secrets at rest in Kubernetes \", _jsx(_components.code, {\n        children: \"etcd\"\n      }), \":\"]\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.strong, {\n          children: \"Local Key Storage:\"\n        }), \" Offers protection against \", _jsx(_components.code, {\n          children: \"etcd\"\n        }), \" compromise but not host compromise, as keys are stored on the host. Most suitable for self-managed Kubernetes clusters.\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.strong, {\n          children: \"Managed KMS Key Storage:\"\n        }), \" Leverages envelope encryption and enhances security by not storing the key encryption key in Kubernetes. This will most likely be the default option if you have a managed Kubernetes cluster on larger cloud providers like AWS, GCP, Azure etc.\"]\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.h3, {\n      id: \"encryption-provider-considerations\",\n      children: \"Encryption provider considerations\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Kubernetes facilitates encryption through various providers, each with distinct attributes and trade-offs:\"\n    }), \"\\n\", _jsx(\"div\", {\n      className: \"overflow-x-auto\",\n      children: _jsxs(_components.table, {\n        children: [_jsx(_components.thead, {\n          children: _jsxs(_components.tr, {\n            children: [_jsx(_components.th, {\n              children: \"Name\"\n            }), _jsx(_components.th, {\n              children: \"Encryption\"\n            }), _jsx(_components.th, {\n              children: \"Strength\"\n            }), _jsx(_components.th, {\n              children: \"Speed\"\n            }), _jsx(_components.th, {\n              children: \"Key Length\"\n            }), _jsx(_components.th, {\n              children: \"Note\"\n            })]\n          })\n        }), _jsxs(_components.tbody, {\n          children: [_jsxs(_components.tr, {\n            children: [_jsxs(_components.td, {\n              children: [_jsx(_components.strong, {\n                children: \"Default\"\n              }), \" - identity\"]\n            }), _jsx(_components.td, {\n              children: \"None\"\n            }), _jsx(_components.td, {\n              children: \"N/A\"\n            }), _jsx(_components.td, {\n              children: \"N/A\"\n            }), _jsx(_components.td, {\n              children: \"N/A\"\n            }), _jsx(_components.td, {\n              children: \"Writes resources without encryption. Acts as a decryptor when set as the first provider.\"\n            })]\n          }), _jsxs(_components.tr, {\n            children: [_jsx(_components.td, {\n              children: \"aescbc\"\n            }), _jsx(_components.td, {\n              children: \"AES-CBC with PKCS#7 padding\"\n            }), _jsx(_components.td, {\n              children: \"Weak\"\n            }), _jsx(_components.td, {\n              children: \"Fast\"\n            }), _jsx(_components.td, {\n              children: \"32-byte\"\n            }), _jsx(_components.td, {\n              children: \"Vulnerable to padding oracle attacks. Key material is accessible from control plane host.\"\n            })]\n          }), _jsxs(_components.tr, {\n            children: [_jsx(_components.td, {\n              children: \"aesgcm\"\n            }), _jsx(_components.td, {\n              children: \"AES-GCM with random nonce\"\n            }), _jsx(_components.td, {\n              children: \"Must be rotated every 200,000 writes\"\n            }), _jsx(_components.td, {\n              children: \"Fastest\"\n            }), _jsx(_components.td, {\n              children: \"16, 24, or 32-byte\"\n            }), _jsx(_components.td, {\n              children: \"Advisable only with an automated key rotation scheme. Key material is accessible from control plane host.\"\n            })]\n          }), _jsxs(_components.tr, {\n            children: [_jsx(_components.td, {\n              children: \"kms v1 (deprecated)\"\n            }), _jsx(_components.td, {\n              children: \"Envelope encryption with DEK per resource.\"\n            }), _jsx(_components.td, {\n              children: \"Strongest\"\n            }), _jsx(_components.td, {\n              children: \"Slow\"\n            }), _jsx(_components.td, {\n              children: \"32-bytes\"\n            }), _jsx(_components.td, {\n              children: \"Uses AES-GCM for data encryption and configurable KMS for key encryption. Supports simple key rotation.\"\n            })]\n          }), _jsxs(_components.tr, {\n            children: [_jsx(_components.td, {\n              children: \"kms v2\"\n            }), _jsx(_components.td, {\n              children: \"Envelope encryption with DEK per API server.\"\n            }), _jsx(_components.td, {\n              children: \"Strongest\"\n            }), _jsx(_components.td, {\n              children: \"Fast\"\n            }), _jsx(_components.td, {\n              children: \"32-bytes\"\n            }), _jsx(_components.td, {\n              children: \"Similar to KMS v1 but with improved performance and key management. A solid choice for third-party key management. Stable from Kubernetes v1.29.\"\n            })]\n          }), _jsxs(_components.tr, {\n            children: [_jsx(_components.td, {\n              children: \"secretbox\"\n            }), _jsx(_components.td, {\n              children: \"XSalsa20 and Poly1305\"\n            }), _jsx(_components.td, {\n              children: \"Strong\"\n            }), _jsx(_components.td, {\n              children: \"Faster\"\n            }), _jsx(_components.td, {\n              children: \"32-byte\"\n            }), _jsx(_components.td, {\n              children: \"Utilizes modern encryption technologies but may not comply with specific certifications like FIPS.\"\n            })]\n          })]\n        })]\n      })\n    }), \"\\n\", _jsx(_components.h2, {\n      id: \"encryption-for-self-managed-kubernetes-clusters\",\n      children: \"Encryption for self-managed Kubernetes clusters\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Let's take a look at a real example of setting up \", _jsx(_components.code, {\n        children: \"etcd\"\n      }), \" encryption in a self-managed Kubernetes cluster with our own key:\"]\n    }), \"\\n\", _jsx(_components.h3, {\n      id: \"step-1-generate-a-high-entropy-32-byte-key\",\n      children: \"Step 1: Generate a high entropy 32-byte key\"\n    }), \"\\n\", _jsx(_components.div, {\n      className: \"remark-highlight\",\n      children: _jsx(_components.pre, {\n        className: \"language-bash\",\n        children: _jsxs(_components.code, {\n          className: \"language-bash\",\n          children: [\"openssl rand \", _jsx(_components.span, {\n            className: \"token parameter variable\",\n            children: \"-base64\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"32\"\n          }), \"\\nIPue+NtWYF2dnvKqlLTy2UXok2P+aiJ+eKuVuRd7wt0\", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \"\\n\"]\n        })\n      })\n    }), \"\\n\", _jsx(_components.h3, {\n      id: \"step-2-deploy-the-key-on-your-kubernetes-clusters-master-node\",\n      children: \"Step 2: Deploy the key on your Kubernetes cluster's master node\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [_jsx(_components.strong, {\n        children: \"Note\"\n      }), \": Please make sure to use something like SSH (Secure Shell) to deploy the key to your Kubernetes node(s).\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Create the following \", _jsx(_components.code, {\n        children: \"EncryptionConfiguration\"\n      }), \" at path \", _jsx(_components.code, {\n        children: \"/etc/kubernetes/enc/enc.yaml\"\n      }), \" on the control-plane node.\"]\n    }), \"\\n\", _jsx(_components.div, {\n      className: \"remark-highlight\",\n      children: _jsx(_components.pre, {\n        className: \"language-yaml\",\n        children: _jsxs(_components.code, {\n          className: \"language-yaml\",\n          children: [_jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"---\"\n          }), \"\\n\", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"apiVersion\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" apiserver.config.k8s.io/v1\\n\", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"kind\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" EncryptionConfiguration\\n\", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"resources\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n  \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"-\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"resources\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n      \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"-\"\n          }), \" secrets\\n      \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"-\"\n          }), \" configmaps\\n      \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"-\"\n          }), \" pandas.awesome.bears.example\\n    \", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"providers\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n      \", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# Your encryption provider\"\n          }), \"\\n      \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"-\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"secretbox\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" \\n          \", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"keys\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n            \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"-\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"name\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" key1\\n              \", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# Your 32-byte base64 key\"\n          }), \"\\n              \", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"secret\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" IPue+NtWYF2dnvKqlLTy2UXok2P+aiJ+eKuVuRd7wt0=\\n      \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"-\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"identity\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"{\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"}\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# This fallback allows reading unencrypted secrets;\"\n          }), \"\\n                     \", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# for example, during initial migration\"\n          }), \"\\n\"]\n        })\n      })\n    }), \"\\n\", _jsx(_components.h3, {\n      id: \"step-3-use-the-encryption-configuration-file\",\n      children: \"Step 3: Use the encryption configuration file\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Edit the manifest for the \", _jsx(_components.code, {\n        children: \"kube-apiserver\"\n      }), \" static pod: \", _jsx(_components.code, {\n        children: \"/etc/kubernetes/manifests/kube-apiserver.yaml\"\n      }), \" so that it is similar to:\"]\n    }), \"\\n\", _jsx(_components.div, {\n      className: \"remark-highlight\",\n      children: _jsx(_components.pre, {\n        className: \"language-yaml\",\n        children: _jsxs(_components.code, {\n          className: \"language-yaml\",\n          children: [_jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"---\"\n          }), \"\\n\", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"#\"\n          }), \"\\n\", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# This is a fragment of a manifest for a static Pod.\"\n          }), \"\\n\", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# Check whether this is correct for your cluster and for your API server.\"\n          }), \"\\n\", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"#\"\n          }), \"\\n\", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"apiVersion\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" v1\\n\", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"kind\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" Pod\\n\", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"metadata\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n  \", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"annotations\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n    \", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"kubeadm.kubernetes.io/kube-apiserver.advertise-address.endpoint\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" 10.20.30.40\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"443\"\n          }), \"\\n  \", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"creationTimestamp\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token null important\",\n            children: \"null\"\n          }), \"\\n  \", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"labels\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n    \", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"app.kubernetes.io/component\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" kube\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"-\"\n          }), \"apiserver\\n    \", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"tier\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" control\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"-\"\n          }), \"plane\\n  \", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"name\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" kube\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"-\"\n          }), \"apiserver\\n  \", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"namespace\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" kube\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"-\"\n          }), \"system\\n\", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"spec\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n  \", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"containers\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n  \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"-\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"command\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n    \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"-\"\n          }), \" kube\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"-\"\n          }), \"apiserver\\n    \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"...\"\n          }), \"\\n    \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"-\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"-\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"-\"\n          }), \"encryption\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"-\"\n          }), \"provider\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"-\"\n          }), \"config=/etc/kubernetes/enc/enc.yaml  \", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# 👈 Path to your EncryptionConfiguration\"\n          }), \"\\n    \", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"volumeMounts\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n    \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"...\"\n          }), \"\\n    \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"-\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"name\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" enc                           \", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# Add this line\"\n          }), \"\\n      \", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"mountPath\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" /etc/kubernetes/enc      \", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# Add this line\"\n          }), \"\\n      \", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"readOnly\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token boolean important\",\n            children: \"true\"\n          }), \"                      \", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# Add this line\"\n          }), \"\\n    \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"...\"\n          }), \"\\n  \", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"volumes\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n  \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"...\"\n          }), \"\\n  \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"-\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"name\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" enc                             \", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# Add this line\"\n          }), \"\\n    \", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"hostPath\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"                             \", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# Add this line\"\n          }), \"\\n      \", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"path\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" /etc/kubernetes/enc           \", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# Add this line\"\n          }), \"\\n      \", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"type\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" DirectoryOrCreate             \", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# Add this line\"\n          }), \"\\n  \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"...\"\n          }), \"\\n\"]\n        })\n      })\n    }), \"\\n\", _jsx(_components.h3, {\n      id: \"step-4-restart-your-kube-api-server\",\n      children: \"Step 4: Restart your Kube API server\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"For more information about \", _jsx(_components.a, {\n        href: \"https://kubernetes.io/docs/tasks/administer-cluster/encrypt-data/#verifying-that-data-is-encrypted\",\n        rel: \"nofollow\",\n        children: \"verifying that secrets\"\n      }), \" are actually encrypted with the new key, \", _jsx(_components.a, {\n        href: \"https://kubernetes.io/docs/tasks/administer-cluster/encrypt-data/#rotating-a-decryption-key\",\n        rel: \"nofollow\",\n        children: \"rotating keys\"\n      }), \", and \", _jsx(_components.a, {\n        href: \"https://kubernetes.io/docs/tasks/administer-cluster/encrypt-data/#cleanup-all-secrets-encrypted\",\n        rel: \"nofollow\",\n        children: \"preventing plaintext secret retrieval\"\n      }), \", please explore the official \", _jsx(_components.a, {\n        href: \"https://kubernetes.io/docs/tasks/administer-cluster/encrypt-data\",\n        rel: \"nofollow\",\n        children: \"Kubernetes Docs\"\n      }), \".\"]\n    }), \"\\n\", _jsx(_components.h2, {\n      id: \"managed-kubernetes-cluster-using-cloud-provider-kms\",\n      children: \"Managed Kubernetes cluster using cloud-provider KMS\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Here are some examples of how we can encrypt secrets in \", _jsx(_components.code, {\n        children: \"etcd\"\n      }), \" in a managed Kubernetes cluster by leveraging the KMS from cloud providers.\"]\n    }), \"\\n\", _jsx(_components.h3, {\n      id: \"aws-eks-elastic-kubernetes-service\",\n      children: \"AWS EKS (Elastic Kubernetes Service)\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"AWS offers an integrated key management solution, simplifying the use of encryption providers and ensuring secure key handling. By default, this uses an AWS-managed key to encrypt \", _jsx(_components.code, {\n        children: \"etcd\"\n      }), \" data but allows using a CMK (Customer Managed Keys) via AWS KMS.\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"/assets/images/blog/kubernetes/aws-eks-cluster-create-secret-encryption-cmk.webp\",\n        alt: \"AWS EKS Cluster Create Secret Encryption CMK\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"/assets/images/blog/kubernetes/aws-eks-cluster-view-secret-encryption-cmk.webp\",\n        alt: \"AWS EKS Cluster View Secret Encryption CMK\"\n      })\n    }), \"\\n\", _jsx(_components.h3, {\n      id: \"gcp-gke-google-kubernetes-engine\",\n      children: \"GCP GKE (Google Kubernetes Engine)\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"GCP similarly provides an integrated environment for secure secret management. Make sure to ✅  check 'Encrypt secrets at the application layer'.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"/assets/images/blog/kubernetes/gcp-gke-encrypt-secrets-app-layer-create.webp\",\n        alt: \"GCP GKE Encrypt Secrets App Layer Create\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"/assets/images/blog/kubernetes/gcp-gke-encrypt-secrets-app-layer-set-key-resource-name.webp\",\n        alt: \"GCP GKE Encrypt Secrets App Layer Set Key Resource Name\"\n      })\n    }), \"\\n\", _jsx(_components.h3, {\n      id: \"azure-aks-azure-kubernetes-service\",\n      children: \"Azure AKS (Azure Kubernetes Service)\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Azure provides instructions on using Azure Key Management service with AKS. Read \", _jsx(_components.a, {\n        href: \"https://learn.microsoft.com/en-us/azure/aks/use-kms-etcd-encryption\",\n        rel: \"nofollow\",\n        children: \"Add Key Management Service etcd encryption to an Azure Kubernetes Service cluster\"\n      })]\n    }), \"\\n\", _jsx(_components.h2, {\n      id: \"sync-secrets-to-kubernetes\",\n      children: \"Sync secrets to Kubernetes\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Next, let's move on to the fun part — actually deploying secrets!\"\n    }), \"\\n\", _jsx(_components.h3, {\n      id: \"1-install-the-phase-kubernetes-operator-via-helm\",\n      children: \"1. Install the Phase Kubernetes Operator via Helm\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Add the Phase helm repo and update it:\"\n    }), \"\\n\", _jsx(_components.div, {\n      className: \"remark-highlight\",\n      children: _jsx(_components.pre, {\n        className: \"language-bash\",\n        children: _jsxs(_components.code, {\n          className: \"language-bash\",\n          children: [\"helm repo \", _jsx(_components.span, {\n            className: \"token function\",\n            children: \"add\"\n          }), \" phase https://helm.phase.dev \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"\u0026\u0026\"\n          }), \" helm repo update\\n\"]\n        })\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Let's install version \", _jsx(_components.code, {\n        children: \"v1.2.0\"\n      }), \":\"]\n    }), \"\\n\", _jsx(_components.div, {\n      className: \"remark-highlight\",\n      children: _jsx(_components.pre, {\n        className: \"language-bash\",\n        children: _jsxs(_components.code, {\n          className: \"language-bash\",\n          children: [\"helm \", _jsx(_components.span, {\n            className: \"token function\",\n            children: \"install\"\n          }), \" phase-secrets-operator phase/phase-kubernetes-operator \", _jsx(_components.span, {\n            className: \"token parameter variable\",\n            children: \"--set\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token assign-left variable\",\n            children: \"image.tag\"\n          }), _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \"v1.2.0\\n\"]\n        })\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"You can find the available versions on our \", _jsx(_components.a, {\n        href: \"https://github.com/phasehq/kubernetes-secrets-operator/releases\",\n        rel: \"nofollow\",\n        children: \"GitHub releases page\"\n      }), \".\"]\n    }), \"\\n\", _jsx(_components.h3, {\n      id: \"2-create-a-service-token-secret-in-kubernetes\",\n      children: \"2. Create a Service Token Secret in Kubernetes\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"We need to create a Phase Service Token so that the operator can authenticate with the Phase Service and fetch secrets. Head on over to the Phase Console \u003e Apps \u003e Your application \u003e Service tokens and create a token.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"/assets/images/blog/kubernetes/service-token.png\",\n        alt: \"phase-service-token\"\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Check out the \", _jsx(_components.a, {\n        href: \"https://docs.phase.dev/console/tokens#service-tokens\",\n        rel: \"nofollow\",\n        children: \"Phase Docs\"\n      }), \" for information on creating Service Tokens.\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Creating a Service Token Secret securely via \", _jsx(_components.code, {\n        children: \"kubectl\"\n      }), \" is vital. You can do this using the \", _jsx(_components.code, {\n        children: \"read\"\n      }), \" command, which is recommended as it avoids writing the token to disk or shell history:\"]\n    }), \"\\n\", _jsx(_components.div, {\n      className: \"remark-highlight\",\n      children: _jsx(_components.pre, {\n        className: \"language-bash\",\n        children: _jsxs(_components.code, {\n          className: \"language-bash\",\n          children: [_jsx(_components.span, {\n            className: \"token builtin class-name\",\n            children: \"read\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token parameter variable\",\n            children: \"-s\"\n          }), \" TOKEN\\nkubectl create secret generic phase-service-token \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"\\\\\"\n          }), \"\\n  --from-literal\", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \"token\", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), _jsx(_components.span, {\n            className: \"token variable\",\n            children: \"$TOKEN\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"\\\\\"\n          }), \"\\n  \", _jsx(_components.span, {\n            className: \"token parameter variable\",\n            children: \"--type\"\n          }), _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \"Opaque \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"\\\\\"\n          }), \"\\n  \", _jsx(_components.span, {\n            className: \"token parameter variable\",\n            children: \"--namespace\"\n          }), _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \"default\\n\", _jsx(_components.span, {\n            className: \"token builtin class-name\",\n            children: \"unset\"\n          }), \" TOKEN\\n\"]\n        })\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Alternatively, you can simply pass the \", _jsx(_components.code, {\n        children: \"Token\"\n      }), \" inline:\"]\n    }), \"\\n\", _jsx(_components.div, {\n      className: \"remark-highlight\",\n      children: _jsx(_components.pre, {\n        className: \"language-bash\",\n        children: _jsxs(_components.code, {\n          className: \"language-bash\",\n          children: [\"kubectl create secret generic phase-service-token \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"\\\\\"\n          }), \"\\n  --from-literal\", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \"token\", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"\u003c\"\n          }), \"TOKEN\", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"\u003e\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"\\\\\"\n          }), \"\\n  \", _jsx(_components.span, {\n            className: \"token parameter variable\",\n            children: \"--type\"\n          }), _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \"Opaque \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"\\\\\"\n          }), \"\\n  \", _jsx(_components.span, {\n            className: \"token parameter variable\",\n            children: \"--namespace\"\n          }), _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \"default\\n\"]\n        })\n      })\n    }), \"\\n\", _jsx(_components.h2, {\n      id: \"3-deploy-the-phase-secrets-operator-cr-custom-resource\",\n      children: \"3. Deploy the Phase Secrets Operator CR (Custom Resource)\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Create a custom resource file named \", _jsx(_components.code, {\n        children: \"phase-secrets-operator-cr.yaml\"\n      }), \". This file will define how the Phase Secrets Operator should manage your secrets. Below is a basic example of how to sync all secrets from path \", _jsx(_components.code, {\n        children: \"/\"\n      }), \" in \", _jsx(_components.code, {\n        children: \"production\"\n      }), \" environment in an app in the Phase Console to your Kubernetes cluster:\"]\n    }), \"\\n\", _jsx(_components.div, {\n      className: \"remark-highlight\",\n      children: _jsx(_components.pre, {\n        className: \"language-yaml\",\n        children: _jsxs(_components.code, {\n          className: \"language-yaml\",\n          children: [_jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"apiVersion\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" secrets.phase.dev/v1alpha1\\n\", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"kind\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" PhaseSecret\\n\", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"metadata\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n  \", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"name\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" keyspace\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"-\"\n          }), \"cloud\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"-\"\n          }), \"phase\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"-\"\n          }), \"secret\\n  \", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"namespace\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" default\\n\", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"spec\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n  \", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"phaseApp\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"'keyspace.cloud'\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# The name of your Phase application\"\n          }), \"\\n  \", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"phaseAppEnv\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"'production'\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# The Phase App Environment to fetch secrets from\"\n          }), \"\\n  \", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"phaseAppEnvPath\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"'/'\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# Path within the Phase application environment to fetch secrets from\"\n          }), \"\\n  \", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"phaseHost\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"'https://console.phase.dev'\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# OPTIONAL - URL of a Phase Console instance\"\n          }), \"\\n  \", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"authentication\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n    \", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"serviceToken\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n      \", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"serviceTokenSecretReference\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n        \", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"secretName\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"'phase-service-token'\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# Name of the Phase Service Token with access to your application\"\n          }), \"\\n        \", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"secretNamespace\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"'default'\"\n          }), \"\\n  \", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"managedSecretReferences\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n    \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"-\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"secretName\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"'keyspace-cloud-prod-secret'\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# Name of the Kubernetes managed secret that Phase will sync\"\n          }), \"\\n      \", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"secretNamespace\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"'default'\"\n          }), \"\\n\"]\n        })\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Apply the custom resource:\"\n    }), \"\\n\", _jsx(_components.div, {\n      className: \"remark-highlight\",\n      children: _jsx(_components.pre, {\n        className: \"language-bash\",\n        children: _jsxs(_components.code, {\n          className: \"language-bash\",\n          children: [\"kubectl apply \", _jsx(_components.span, {\n            className: \"token parameter variable\",\n            children: \"-f\"\n          }), \" phase-secrets-operator-cr.yaml\\n\"]\n        })\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Watch for secrets being created:\"\n    }), \"\\n\", _jsx(_components.div, {\n      className: \"remark-highlight\",\n      children: _jsx(_components.pre, {\n        className: \"language-bash\",\n        children: _jsxs(_components.code, {\n          className: \"language-bash\",\n          children: [_jsx(_components.span, {\n            className: \"token function\",\n            children: \"watch\"\n          }), \" kubectl get secrets\\n\"]\n        })\n      })\n    }), \"\\n\", _jsx(_components.h3, {\n      id: \"set-up-rbac-role-based-access-control-and-update-deployment\",\n      children: \"Set up RBAC (Role Based Access Control) and update deployment\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Now that our secrets are deployed to Kubernetes we need to control access to them via Kubernetes RBAC policy for additional security.\"\n    }), \"\\n\", _jsx(_components.h3, {\n      id: \"1-setup-a-rbac-policy-for-accessing-secrets\",\n      children: \"1. Setup a RBAC policy for accessing secrets\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"First, let's set up an RBAC policy with a custom role (\", _jsx(_components.code, {\n        children: \"Role\"\n      }), \") for our deployment:\"]\n    }), \"\\n\", _jsx(_components.div, {\n      className: \"remark-highlight\",\n      children: _jsx(_components.pre, {\n        className: \"language-yaml\",\n        children: _jsxs(_components.code, {\n          className: \"language-yaml\",\n          children: [_jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"apiVersion\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" rbac.authorization.k8s.io/v1\\n\", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"kind\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" Role\\n\", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"metadata\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n  \", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"namespace\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" default\\n  \", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"name\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" secret\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"-\"\n          }), \"reader\\n\", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"rules\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"-\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"apiGroups\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"\\\"\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), \"\\n  \", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"resources\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"secrets\\\"\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), \"\\n  \", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"resourceNames\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"keyspace-cloud-prod-secret\\\"\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), \"\\n  \", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"verbs\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"get\\\"\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"watch\\\"\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"list\\\"\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), \"\\n\"]\n        })\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"This \", _jsx(_components.code, {\n        children: \"Role\"\n      }), \" named \", _jsx(_components.code, {\n        children: \"secret-reader\"\n      }), \" allows reading the secret named \", _jsx(_components.code, {\n        children: \"keyspace-cloud-prod-secret\"\n      }), \" in the \", _jsx(_components.code, {\n        children: \"default\"\n      }), \" namespace and grants the following permissions: \", _jsx(_components.code, {\n        children: \"get\"\n      }), \", \", _jsx(_components.code, {\n        children: \"watch\"\n      }), \", \", _jsx(_components.code, {\n        children: \"list\"\n      }), \".\"]\n    }), \"\\n\", _jsx(_components.h3, {\n      id: \"2-create-a-service-account-for-your-application\",\n      children: \"2. Create a Service Account for your Application\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Let's create a Kubernetes Service Account (\", _jsx(_components.code, {\n        children: \"ServiceAccount\"\n      }), \") for our deployment. This will be used by each pod of our application.\"]\n    }), \"\\n\", _jsx(_components.div, {\n      className: \"remark-highlight\",\n      children: _jsx(_components.pre, {\n        className: \"language-yaml\",\n        children: _jsxs(_components.code, {\n          className: \"language-yaml\",\n          children: [_jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"apiVersion\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" v1\\n\", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"kind\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" ServiceAccount\\n\", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"metadata\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n  \", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"name\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" keyspace\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"-\"\n          }), \"app\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"-\"\n          }), \"service\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"-\"\n          }), \"account\\n  \", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"namespace\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" default\\n\"]\n        })\n      })\n    }), \"\\n\", _jsx(_components.h3, {\n      id: \"3-bind-the-role-to-the-service-account\",\n      children: \"3. Bind the Role to the Service Account\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Next, create a \", _jsx(_components.code, {\n        children: \"RoleBinding\"\n      }), \" to grant the \", _jsx(_components.code, {\n        children: \"secret-reader\"\n      }), \" role to the \", _jsx(_components.code, {\n        children: \"keyspace-app-service-account\"\n      }), \":\"]\n    }), \"\\n\", _jsx(_components.div, {\n      className: \"remark-highlight\",\n      children: _jsx(_components.pre, {\n        className: \"language-yaml\",\n        children: _jsxs(_components.code, {\n          className: \"language-yaml\",\n          children: [_jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"apiVersion\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" rbac.authorization.k8s.io/v1\\n\", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"kind\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" RoleBinding\\n\", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"metadata\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n  \", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"name\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" read\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"-\"\n          }), \"secret\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"-\"\n          }), \"to\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"-\"\n          }), \"my\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"-\"\n          }), \"app\\n  \", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"namespace\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" default\\n\", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"subjects\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"-\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"kind\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" ServiceAccount\\n  \", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"name\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" keyspace\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"-\"\n          }), \"app\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"-\"\n          }), \"service\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"-\"\n          }), \"account\\n  \", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"namespace\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" default\\n\", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"roleRef\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n  \", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"kind\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" Role\\n  \", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"name\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" secret\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"-\"\n          }), \"reader\\n  \", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"apiGroup\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" rbac.authorization.k8s.io\\n\"]\n        })\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"This \", _jsx(_components.code, {\n        children: \"RoleBinding\"\n      }), \" named \", _jsx(_components.code, {\n        children: \"read-secret-to-my-app\"\n      }), \" connects the \", _jsx(_components.code, {\n        children: \"secret-reader\"\n      }), \" role with the \", _jsx(_components.code, {\n        children: \"keyspace-app-service-account\"\n      }), \", allowing the associated pods to access the \", _jsx(_components.code, {\n        children: \"keyspace-cloud-prod-secret\"\n      }), \".\"]\n    }), \"\\n\", _jsx(_components.h3, {\n      id: \"4-update-your-deployment-to-use-the-service-account\",\n      children: \"4. Update Your Deployment to Use the Service Account\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Modify your deployment to use the \", _jsx(_components.code, {\n        children: \"keyspace-app-service-account\"\n      }), \":\"]\n    }), \"\\n\", _jsx(_components.div, {\n      className: \"remark-highlight\",\n      children: _jsx(_components.pre, {\n        className: \"language-yaml\",\n        children: _jsxs(_components.code, {\n          className: \"language-yaml\",\n          children: [_jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"apiVersion\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" apps/v1\\n\", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"kind\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" Deployment\\n\", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"metadata\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n  \", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"name\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" keyspace\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"-\"\n          }), \"cloud\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"-\"\n          }), \"app\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"-\"\n          }), \"deployment\\n  \", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"annotations\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n    \", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"secrets.phase.dev/redeploy\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"'true'\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# 👈 Automatically redeploy my application after secret changed \"\n          }), \"\\n\", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"spec\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n  \", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"replicas\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"3\"\n          }), \"\\n  \", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"selector\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n    \", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"matchLabels\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n      \", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"app\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" my\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"-\"\n          }), \"app\\n  \", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"template\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n    \", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"metadata\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n      \", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"labels\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n        \", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"app\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" my\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"-\"\n          }), \"app\\n    \", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"spec\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n      \", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"serviceAccountName\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" keyspace\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"-\"\n          }), \"app\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"-\"\n          }), \"service\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"-\"\n          }), \"account \", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# 👈 Service account we just created\"\n          }), \"\\n      \", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"containers\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n        \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"-\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"name\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" my\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"-\"\n          }), \"app\\n          \", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"image\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" my\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"-\"\n          }), \"app\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"-\"\n          }), \"image\\n          \", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"envFrom\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n            \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"-\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"secretRef\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n                \", _jsx(_components.span, {\n            className: \"token key atrule\",\n            children: \"name\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" keyspace\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"-\"\n          }), \"cloud\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"-\"\n          }), \"prod\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"-\"\n          }), \"secret \", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# 👈 Application secret\"\n          }), \"\\n\"]\n        })\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"In this deployment, the \", _jsx(_components.code, {\n        children: \"spec.serviceAccountName\"\n      }), \" field is set to \", _jsx(_components.code, {\n        children: \"keyspace-app-service-account\"\n      }), \", ensuring that the pods run with the permissions granted to the service account, and thereby, adhere to the principles defined in the \", _jsx(_components.code, {\n        children: \"Role\"\n      }), \" and \", _jsx(_components.code, {\n        children: \"RoleBinding\"\n      }), \".\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"By setting up these RBAC policies, you ensure that only your application has the necessary access to the secrets it needs, adhering to best practices for security and access control in Kubernetes.\"\n    })]\n  });\n}\nfunction MDXContent(props = {}) {\n  const {wrapper: MDXLayout} = Object.assign({}, _provideComponents(), props.components);\n  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {\n    children: _jsx(_createMdxContent, props)\n  })) : _createMdxContent(props);\n}\nreturn {\n  default: MDXContent\n};\n","frontmatter":{},"scope":{"title":"End to End encrypted secrets deployment to Kubernetes","subtitle":"Securely deploying secrets to Kubernetes with Phase","author":{"name":"Nimish","avatarUrl":"/assets/images/blog/authors/nimish.webp","socialLink":"https://github.com/nimish-ks"},"date":"2024-03-26","coverImage":"/assets/images/blog/kubernetes/output.webp"}},"frontMatter":{"title":"End to End encrypted secrets deployment to Kubernetes","subtitle":"Securely deploying secrets to Kubernetes with Phase","author":{"name":"Nimish","avatarUrl":"/assets/images/blog/authors/nimish.webp","socialLink":"https://github.com/nimish-ks"},"date":"2024-03-26","coverImage":"/assets/images/blog/kubernetes/output.webp"}},"__N_SSG":true},"page":"/blog/[slug]","query":{"slug":"e2ee-secrets-deployment-with-kubernetes"},"buildId":"9jZFK-2PGcU00dlET0GvC","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>