# AI for APIs: AI-Assisted SDK Generation Techniques

![AI for APIs: Techniques for AI-Assisted SDK Generation 的特色图片](https://cdn.thenewstack.io/media/2024/10/7a96f473-alex-shuper-p-9g0uixuuq-unsplashb-1024x576.jpg)

The rise of AI tools like GitHub Copilot and ChatGPT has sparked significant interest in how AI can assist developers in generating and using API SDKs (Software Development Kits). AI holds the potential to streamline repetitive coding tasks, presenting exciting opportunities for enhancing API workflows. However, this new approach also introduces notable challenges, including reliability, security, and non-determinism concerns.

In this article, we delve into the role of AI as a copilot in SDK generation, examining common pitfalls like hallucinations, and exploring how AI can complement traditional code generation methods to deliver a balanced and efficient development experience.

## The Potential of AI in SDK Generation

APIs are the backbone of modern software applications, enabling different systems to communicate with each other. SDKs simplify API usage by providing developers with pre-packaged libraries and tools. Traditionally, SDK generation has been a manual and time-consuming process. However, recent advancements in AI have opened up new possibilities for automating SDK creation.

One of the key advantages of AI in SDK generation is its ability to handle monotonous, repetitive tasks. By parsing OpenAPI specifications or API documentation, AI can automatically create the models, services, and other components needed to build an SDK. This reduces manual labor, allowing developers to focus on more complex and creative tasks.

For example, platforms like [APIMatic](https://www.apimatic.io/) are experimenting with using AI to improve the developer experience by training AI to work in tandem with traditional code generation tools. In this hybrid model, AI can dynamically answer developer queries and explore API documentation, while deterministic code generators are responsible for reliably creating static API access code.

## Example: Spotify API

The following C# code demonstrates how to interact with the [Spotify API](https://apimatic-api-copilot.netlify.app/#/net-standard-library/quick-start/overview) to create a new playlist, get an artist's top tracks, and add those tracks to the created playlist. It was generated by the API Copilot in APIMatic based on the query: "How to create a new playlist and add 10 of Taylor Swift's most popular songs?"

This code handles the following complete workflow:

**Authenticating via OAuth 2.0** to obtain the necessary permissions to modify user playlists. **Creating a new playlist** for the user to use with Spotify's API. **Getting Taylor Swift's top tracks**. **Adding the retrieved tracks** to the newly created playlist.

Here's a breakdown of the code.

### 1. Authorization Setup

The code first sets up the OAuth 2.0 authorization code flow to obtain access to the Spotify API. It defines the OAuth client ID, client secret, and redirect URI, and requests the following scopes needed to manage playlists:

`PlaylistModifyPrivate`
: Modify private playlists. `PlaylistModifyPublic`
: Modify public playlists.

The client obtains an OAuth token by redirecting the user to the Spotify authorization page, where the user grants consent. This token is then used to authenticate API calls.

### 2. Creating a New Playlist

After authorization, a `PlaylistsController`
is instantiated to interact with playlists. The `CreatePlaylistAsync`
method is used to create a playlist named "Taylor Swift Top 10" with privacy and description parameters.

### 3. Getting Taylor Swift's Top Tracks

The `ArtistsController`
is used to get Taylor Swift's top tracks using the `GetAnArtistsTopTracksAsync`
method, specifying the artist's Spotify ID (06HL4z0CvFAxyc27GXpf02) and market (US). The result is a list of top tracks, including their URIs (unique Spotify track identifiers).

### 4. Adding Tracks to the Playlist

The code then uses the `AddTracksToPlaylistAsync`
method to add these top tracks to the newly created playlist. It sends the list of track URIs to the playlist using the `playlistId`
obtained from the playlist creation response.

**How It Works**

**OAuth Flow**: The user is prompted to log in to Spotify, the application retrieves an authorization code, and then exchanges it for an OAuth token. **Playlist Creation**: A private playlist named "Taylor Swift Top 10" is created for the authenticated user. **Getting Artist Top Tracks**: The code retrieves Taylor Swift's top tracks from Spotify, specific to the US market. **Adding Tracks to Playlist**: The tracks are added to the newly created playlist using their Spotify URIs.

**Additional Considerations**

**Exception Handling**: The code includes `try-catch`
blocks to catch exceptions that may occur during API calls (e.g., if authorization fails or the playlist cannot be created). **User Authorization**: `AuthorizationCodeAuth`
模型用于安全访问，允许应用程序在获得明确同意后修改用户播放列表。这种设置允许用户创建动态播放列表，个性化音乐体验并将 Spotify 无缝集成到应用程序中。

通过利用 API 副驾驶，这系列复杂的 API 交互被简化为结构化和可执行的格式。副驾驶确保正确地处理端点、身份验证流程和 API 参数，使开发人员更容易实现复杂的特性，如播放列表创建和歌曲管理，而无需手动编写每个细节。

**AI 生成的 SDK 的挑战**

虽然这听起来很有希望，但基于 AI 的 SDK 生成远非完整的解决方案。尽管它有优势，但仍有一些关键挑战需要解决。

**1. 非确定性和幻觉**

非确定性是指 AI 模型无法对相同的输入始终如一地生成相同的输出。这对 SDK 生成来说尤其成问题，因为一致性是关键。如果由 AI 助手生成的 SDK 每次都略有不同，则可能会在将来导致重大的集成问题。开发人员需要相信生成的代码将是一致且可靠的——这是 AI 目前无法做到的。

一个相关的问题是“幻觉”，即 AI 生成语法正确的代码，但与底层逻辑或 API 文档不一致。例如，AI 可能会误解 API 端点或创建看似功能齐全但实际上完全不可用的函数。

这会导致令人沮丧的调试会话，开发人员必须筛选错误的 AI 生成的代码行以纠正幻觉或不一致。

**2. 输入和输出限制**

像 GPT-4 这样的大型语言模型 (LLM) 在严格的令牌限制内运行。这些限制限制了可以在一次运行中处理的输入量（例如，API 文档或 OpenAPI 规范）和输出量（例如，SDK 代码）。对于更大或更复杂的 API，这成为一个重大的瓶颈。由于 SDK 生成通常需要处理大型代码库，因此 AI 当前的令牌限制阻止它在一遍中生成完整的 SDK。

**3. 安全问题**

AI 模型是在大量现有代码上训练的，其中包括安全和不安全的示例。这使得它们容易生成容易受到常见安全威胁（如 SQL 注入、跨站点脚本 (XSS) 或路径遍历攻击）的代码。例如，一个看似无害的 AI 生成的函数可能存在隐藏的漏洞，例如允许未经授权的文件访问，如果未经适当审查。

现代 API 的复杂性通常涉及管理身份验证、速率限制和敏感数据，所有这些都需要安全处理。仅仅依靠 AI 来生成此类代码而没有人工监督可能会导致严重的安全性漏洞。因此，每段 AI 生成的代码都必须由人工开发人员仔细审查和测试。

**4. 状态管理和内存限制**

AI 生成的 SDK 的另一个挑战是 LLM 难以在长时间交互中管理状态和上下文。SDK 生成通常涉及多个步骤，其中对先前状态的记忆至关重要，例如链接 API 调用或跟踪身份验证状态。如果没有有效的内存机制，AI 可能会生成无法正确管理这些交互的代码，从而导致工作流程中断。

**混合方法：结合 AI 和确定性代码生成**

鉴于上述限制，AI 尚未准备好取代传统的 SDK 生成方法。但是，结合 AI 和确定性工具优势的混合方法提供了一种有希望的解决方案。虽然 APIMatic 等确定性代码生成器确保可靠、可重复的结果，但 AI 可以增强灵活性并帮助完成更动态的任务。
**使用 AI 探索 API**: 在深入代码之前，开发人员需要了解 API 的概念、限制和潜在用例。AI 很适合动态地回答这些类型的查询，筛选文档并提供有关 API 功能的高级见解。通过利用 AI 的自然语言理解能力，开发人员可以快速了解复杂的 API，而无需手动解析大量文档。**用于 API 访问的静态代码生成**: 一旦概念阶段结束，确定性代码生成工具应该接管。这些工具旨在处理可重复、可靠的 API 访问代码生成，包括身份验证流程、请求处理和端点通信。由于工作流程的这一部分需要一致性和安全性，因此传统方法仍然是最合适的。**使用 AI 进行自定义业务逻辑**: 静态 SDK 代码到位后，AI 可以再次帮助开发人员构建与 API 交互的自定义业务逻辑。开发人员可以利用 AI 生成样板代码，快速搭建应用程序逻辑或探索针对其特定用例的创意解决方案。但是，此阶段中每行 AI 生成的代码都应仔细审查，以避免潜在的幻觉和安全漏洞。

**AI 在 SDK 生成中的未来**

随着 AI 的不断发展，其在 SDK 生成中的作用预计会越来越大，尽管仍然存在一些挑战。目前，将 AI 与传统代码生成方法相结合，提供了一种平衡的方法来提高开发人员的生产力，而不会牺牲可靠性或安全性。但是，未来的一个重大发展是将面向工作流的规范（如 [Arazzo](https://spec.openapis.org/arazzo/latest.html)）集成到 API 设计和使用中。

Arazzo 是在 OpenAPI Initiative (OAI) 下开发的工作流规范，它允许开发人员超越基本的端点描述，并捕获 API 交互的完整序列，包括状态转换和依赖关系。通过将 AI 驱动的工具与 Arazzo 等规范相结合，开发人员可以更有效地描述和自动化复杂的 API 工作流。

此规范可以通过帮助管理需要上下文感知和状态管理的多步骤工作流，极大地有利于 AI 在 SDK 生成中的应用。例如，涉及多个身份验证步骤、支付网关或用户驱动工作流的 API 可以通过 Arazzo 更好地表示。这种抽象级别可以帮助 AI 工具更好地理解 API 调用的流程，并生成更准确、更可靠的 SDK 代码。

此外，Arazzo 的可扩展性允许开发人员在其工作流中定义自定义业务逻辑，从而在确定性代码生成和 AI 驱动的辅助之间创建更全面的集成。这意味着，虽然 AI 继续处理动态查询解析和初始代码搭建，但像 Arazzo 这样的工具可以指导生成更复杂、有状态的 API 工作流。

随着令牌限制的扩展以及 AI 系统在保持上下文和内存方面的能力的提高，未来的发展可能会使 AI 更有效地处理更大的代码库和多步骤工作流。借助 Arazzo 等增强型规范，AI 生成的 SDK 的准确性和适用性将得到提高，为更无缝、更可靠的开发体验铺平道路。

总之，AI 在 SDK 生成中的未来很可能涉及与 Arazzo 等工作流驱动规范的更深层次集成，增强 AI 处理复杂 API 交互和有状态操作的能力，同时仍然依赖传统方法进行静态代码生成和安全管理。

**结论**

AI 正在成为开发人员越来越有价值的工具，尤其是在探索 API 和自动化重复性任务方面。但是，仍然存在重大挑战，特别是在非确定性、幻觉、安全风险以及无法处理大型代码库方面。

虽然 AI 可以增强 SDK 开发过程，但它还没有准备好完全取代传统方法。目前最有效的方法是混合模型，它利用 AI 的动态能力和传统代码生成器的可靠性。

[
YOUTUBE.COM/THENEWSTACK
技术发展迅速，不要错过任何一集。订阅我们的 YouTube
频道以流式传输我们所有的播客、访谈、演示等等。
](https://youtube.com/thenewstack?sub_confirmation=1)