A new VS Code exploit can rewrite [AI agents](https://thenewstack.io/ai-agents-a-comprehensive-introduction-for-developers/) across all code repositories, an application security specialist demonstrated Thursday.

On Wednesday, the [SANS Technology Institute](https://isc.sans.edu/) reported on new zero-click exploit that only requires developers open the folder in affected editors. The [VS Code exploit](https://isc.sans.edu/diary/rss/32644?) involves a malicious `tasks.json` file that silently runs inside code editors. It was originally [identified by Oasis](https://www.oasis.security/resources/cursor-workspace-trust-vulnerability?), along with a recommended mitigation developers could apply.

Within 24 hours, [Isaac Lewis](https://www.linkedin.com/in/isaac-lewis-b16775a5/) showed how the [exploit can be used](https://ike.io/open-a-folder-all-your-agents-are-mine/)[to rewrite AI agents](https://ike.io/open-a-folder-all-your-agents-are-mine/) created within the AI-native code editor [Cursor](https://thenewstack.io/install-cursor-and-learn-programming-with-ai-help/). In Cursor, the Oasis remediations disable the AI features, Lewis said when contacted via Bluesky.

Cursor is a fork of the open source [VS Code](https://thenewstack.io/how-to-use-vs-code-as-your-python-ide/) and has been used by 31% of companies in the last year, according to an [October survey conducted by Sonar](https://www.sonarsource.com/the-state-of-code/developer-survey-report/).

Lewis warned, however, that the VS Code exploit could be used on other code editors.

“That got me thinking: Could I use this to reprogram a developer’s AI agents and get them to do what I want? Even worse — could I do this to all their code repositories?” he wrote. “Turns out: Hell yes.”

He added that while many [developers are using AI tools](https://thenewstack.io/agentic-ai-tools-for-building-and-managing-agentic-systems/) to help write code, these code editors come with “a lot of new vulnerabilities.”

“If the tools are given malicious instructions, they could sabotage your code in subtle ways that are hard to detect,” he stated. “It is quite easy to get these genAI tools to exfiltrate sensitive developer information like keys, secrets, certificates, and passwords — so, if an attacker can manipulate the way your genAI tools behave, they can create a persistent threat in your codebase.”

The exploit creates the possibility of a “distributed persistent threat,” implanting itself in a developer’s codebase and then spreading to the codebases of all the developers on a team, according to Lewis.

In his proof-of-concept, which requires no user interaction, he changed the natural-language Cursor prompts to modify the AI agent’s behavior so that it could only speak Spanish. He was able to keep the cause invisible to the developer, he added.

“The first thing I wanted to write was the mechanism for finding `.cursor` folders. I limited myself to macOS to simplify things — I wanted something that was quick, quiet, and found folders that would already be given permission by the operating system so that Cursor wouldn’t suspiciously ask for new permissions,” he wrote.

He realized, though, that it would be quicker to look for `.cursor` directories in neighboring repositories to the one he was in. After finding the cursor folders, he added the full payload.

Then he hid the rule files from the developer.

“By telling it to run on `folderOpen`, this [malicious] task will run whenever Cursor navigates to this folder, regardless of where that folder is,” he wrote. “Then if we tell it to never reveal, it won’t give the developer any indication this task is running.”

In addition to his [detailed blog about the exploit](https://ike.io/open-a-folder-all-your-agents-are-mine/), he published a [GitHub repository for the exploit](https://github.com/ike/cursor-task-hijack).

Lewis told The New Stack [via Bluesky](https://bsky.app/profile/ike.io/post/3md433qjqq22j) that the only fix is to enable Workspace Trust and thoroughly reading the `tasks.json` file *outside* of VSCode and Cursor.

Lewis is a senior software developer and application security specialist at SIGN Fracture Care International, a humanitarian aid organization focusing on orthopedic trauma care. He contributes to [OWASP Application Security Vulnerability Standard (ASVS)](https://owasp.org/www-project-application-security-verification-standard/) and has spoken at a number of conferences, including IntroSecCon.

For more on the security challenges created by coding with AI, check out The New Stack Senior Editor Darryl Taft’s article, “[Vibe coding could cause catastrophic ‘explosions’ in 2026.](https://thenewstack.io/vibe-coding-could-cause-catastrophic-explosions-in-2026/)”

*Editor’s Note: Story updated at 8:40 a.m. to reflect that Oasis identified the exploit and to include comments from Lewis sent via Bluesky.*

[YOUTUBE.COM/THENEWSTACK

Tech moves fast, don't miss an episode. Subscribe to our YouTube
channel to stream all our podcasts, interviews, demos, and more.

SUBSCRIBE](https://youtube.com/thenewstack?sub_confirmation=1)

Group
Created with Sketch.

[![](https://thenewstack.io/wp-content/uploads/2023/08/4de88b83-4756312a-326a38b7-lorainelawson2-600x600-1-600x600.jpeg)

Loraine Lawson is a veteran technology reporter who has covered technology issues from data integration to security for 25 years. Before joining The New Stack, she served as the editor of the banking technology site Bank Automation News. She has...

Read more from Loraine Lawson](https://thenewstack.io/author/loraine-lawson/)