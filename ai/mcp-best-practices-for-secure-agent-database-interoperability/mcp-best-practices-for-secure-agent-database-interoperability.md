
<!--
title: MCP：代理与数据库安全交互最佳实践
cover: https://cdn.thenewstack.io/media/2025/10/6d890993-security.jpg
summary: MCP标准化LLM应用连接，但开放性带来安全风险。主要威胁包括提示注入、恶意服务器和数据泄露。需加强身份验证、审查工具、日志监控并遵守法规，以确保代理-数据库互操作性安全。
-->

MCP标准化LLM应用连接，但开放性带来安全风险。主要威胁包括提示注入、恶意服务器和数据泄露。需加强身份验证、审查工具、日志监控并遵守法规，以确保代理-数据库互操作性安全。

> 译自：[MCP: Best Practices for Secure Agent-Database Interoperability](https://thenewstack.io/mcp-best-practices-for-secure-agent-database-interoperability/)
> 
> 作者：Thibaut Gourdel

Anthropic 于 2024 年 11 月推出的[模型上下文协议 (MCP)](https://modelcontextprotocol.io/docs/getting-started/intro) 已迅速成为现代 AI 系统的基础标准。它旨在标准化[大语言模型 (LLM)](https://thenewstack.io/introduction-to-llms/) 驱动的应用程序与各种数据源和系统连接的方式，特别是针对[代理用例](https://thenewstack.io/ai-agents-vs-agentic-ai-a-kubernetes-developers-guide/)。通过在复杂的 AI 生态系统中实现互操作性和模块化，MCP 使部署更加简便、灵活和可扩展。

然而，使 [MCP 如此强大](https://thenewstack.io/model-context-protocol-a-primer-for-the-developers/)的开放性和灵活性也可能带来巨大的安全风险。事实上，安全并非 MCP 初始设计中的核心考虑因素，鉴于该[规范](https://modelcontextprotocol.io/specification/latest)仍处于起步阶段，这造成了一个广泛的攻击面。对于任何希望将 MCP 整合到持有敏感、任务关键型数据的应用程序中的人来说，这一点尤为重要。因此，安全仍然是阻碍 MCP 在企业中更广泛采用的主要障碍。让我们探讨 MCP 带来的主要安全挑战，以及如何在代理-数据库 MCP 互操作性的背景下，通过实用建议来缓解这些挑战。

## MCP 引入了新的攻击面

模型上下文协议的威胁态势反映了许多传统的网络安全问题，但由于代理式 AI 系统的性质，它引入了放大的风险。以下是三种最常见的 MCP 相关安全威胁：

### **提示注入**

这是基于 MCP 的交互最常见且最广泛的攻击向量。它涉及诱骗代理执行非预期或恶意的操作。

例如，利用 MCP 服务器的直接提示注入可以是：
[![](https://cdn.thenewstack.io/media/2025/10/b7cc5af9-screenshot-2025-10-01-at-10.50.42%E2%80%AFam-1024x245.png)](https://cdn.thenewstack.io/media/2025/10/b7cc5af9-screenshot-2025-10-01-at-10.50.42%E2%80%AFam-1024x245.png)提示注入有多种形式和方式，包括工具描述被破坏（工具投毒）或检索到的数据本身带有恶意指令（检索-代理欺骗，简称 RADE）的情况。这些威胁主要由恶意或受损的 MCP 服务器引起。

## **恶意或受损的 MCP 服务器**

MCP 的开放协议设计允许任何服务器连接，但并非所有服务器都值得信任。恶意服务器可以冒充或篡改真实的工具，从而实现数据窃取或输出操纵。如果多个 MCP 服务器连接到同一个代理，即使是一个恶意服务器也可能干扰其他服务器，使检测变得更加困难。

一旦连接了恶意或受损的服务器，攻击者就可以使用提示注入式技术，例如工具投毒和 RADE，改变工具的感知或检索方式，以达到与直接提示注入相同的效果。

服务器可能通过多种方式受到损害。供应链漏洞很常见：通过 CI/CD 管道引入的带有后门的软件包、被篡改的库或恶意更新。此外，恶意服务器可能出现在未经审查的注册表中，伪装成合法的 MCP 服务器，诱使代理执行不安全的操作。

### **敏感数据外泄** (凭证泄露)

MCP 系统通常需要凭证才能访问外部服务。如果这些凭证存储不当或暴露，攻击者就可以利用它们。此外，从连接服务返回的数据可能会在没有保护措施的情况下意外暴露给用户或被记录，从而导致潜在的数据泄露。

虽然这些是最常见的威胁，但其他风险也影响着代理系统：

*   **系统提示泄露**：如果攻击者获取系统提示的访问权限，他们可能会发现漏洞并利用这些漏洞发起提示注入。
*   **螺旋式消耗**：类似于拒绝服务 (DoS) 攻击，强制代理进行过多的 LLM 调用或处理大量数据，可能会导致 GPU 或 API 成本飙升并降低性能。

## 安全的代理-数据库 MCP 最佳实践

### **身份验证和范围授权（最小权限原则）**

对于暴露数据或服务的 MCP 服务器而言，适当的基于角色的访问控制和强大的身份验证至关重要。这些措施确保用户和代理仅访问其被授权的工具，并有助于防止恶意服务器的滥用。

最小权限原则适用：代理应仅拥有执行其任务所需的权限，不多也不少。权限可能因用户而异，这就是为什么对用户和代理进行身份验证对于追踪错误和检测恶意活动至关重要。

应在两个层面控制访问：

*   **上游**：应用严格的基于角色的访问控制，确保代理仅使用最少必要的数据或服务。这包括强制执行读写权限，并将访问范围限定到特定的数据库或端点。例如，通过配置具有角色的数据库来限制代理能力，这遵循了最小权限原则并防止不必要的数据暴露。这可以通过实施自定义数据库角色、组织范围的资源策略和集合级权限来实现。
*   **下游**：在授予访问权限后添加进一步的约束。这包括强制执行只读模式、禁用写入操作或沙盒化代理与数据的交互。通过强制执行完全只读模式，即使上游控制被绕过，数据也能受到保护。

**MCP 服务器和工具审查**

MCP 服务器只需点击几下即可安装并集成到代理工具中，有效地充当 AI 的通用插件系统。这种易于设置的特性促成了影子 AI 的兴起，其中不仅采用了 AI 应用程序，还可以独立连接额外的 MCP 服务器。

这使得受损的 MCP 服务器成为一个严重的威胁。如今，在 Glama 或 Smithery 等注册表上提供了数千个 MCP 服务器，通常同一服务有多个版本。为了最大程度地降低风险，请始终优先选择来自受信任来源的官方服务器。像 Cursor 和 Windsurf 这样的代理 IDE 也提供官方、经过审查的列表，您可以安全使用。

如果您选择使用第三方 MCP 服务器（例如来自 GitHub 的服务器），请在连接之前仔细审查工具描述。查找工具投毒或潜在数据外泄风险的迹象。

在生产环境中，将 MCP 服务器视为任何其他关键软件。要求签名清单，并尽可能通过公钥进行验证。如果您正在开发自定义 MCP 服务器，请遵循 DevSecOps 最佳实践，包括漏洞扫描和恶意软件检测。

### **日志记录和可观测性**

如果说有一个优先事项需要实施，那就是全面的监控。MCP 服务器允许代理对您的数据库执行潜在的敏感操作。您需要清楚地了解输入和输出，最好是实时可见。

如果没有对提示活动和工具使用情况的可见性，检测滥用或恶意行为几乎是不可能的。缺乏审计追踪会使系统对滥用、数据泄露或未经授权的操作一无所知。实时监控数据流可以检测敏感信息并防止其泄露或滥用。

集中监控、异常检测和合规的日志保留为 MCP 服务器活动提供了完整的可见性、可追溯性和控制。

### **合规性与策略执行**

在企业环境中使用 MCP 时，合规性是不可协商的，尤其对于高度受监管行业的组织而言。由于 MCP 可以使 AI 系统访问敏感数据存储，因此每次交互都必须遵守数据保护法律和内部治理策略。

关键合规要求包括：

*   维护符合监管标准的审计日志。
*   强制执行数据驻留规则，以防止跨区域访问或暴露。
*   通过阻止在响应中披露个人身份信息 (PII) 来保护隐私。

一般的最佳实践是将 MCP 整合到现有治理模型中，并依赖支持强大合规控制的企业级服务和数据库。

## 确保代理-数据库互操作性

随着 MCP 系统成为代理-数据库互操作性的核心，对强大安全性的需求变得至关重要。MCP 的开放设计提供了显著的灵活性，但也引入了提示注入和服务器受损等风险。开发人员可以通过采用最佳实践来缓解这些威胁，包括用户和代理身份验证、范围授权和全面监控。

[MongoDB MCP 服务器](https://www.mongodb.com/company/blog/announcing-mongodb-mcp-server)标准化了代理连接 MongoDB 部署的方式，提供了一个安全的基础，使企业能够安全地利用代理-数据库集成的变革力量。