# RAG：在长上下文模型时代仍然相关

![RAG：在长上下文模型时代仍然相关](https://cdn.thenewstack.io/media/2024/05/1b558d74-color-3498348_1280-1024x577.jpg)

Google 最近发布了 [Gemini 1.5 Pro](https://gemini.google.com/app)，这是一款 [大型语言模型](https://thenewstack.io/do-enormous-llm-context-windows-spell-the-end-of-rag/)，拥有庞大的百万令牌上下文窗口。这在人工智能社区引起了轰动，一些人称其为“RAG 杀手”。

在我们急于为检索增强生成 (RAG) 撰写悼词之前，让我们深吸一口气，从企业角度分析一下情况。极长的上下文窗口可能会让数据科学团队更快地获得工作管道，但部署速度优势是否能证明在生产中运行成本高出许多倍的应用程序是合理的？

可能不会。

企业需要在小范围内实现高性能的应用程序。这意味着选择和定制一个合适的底层模型以及围绕它的整个支持 *LLM 系统* 生态系统。高度定制的 RAG 系统只是为高吞吐量任务提供了更好的价值。

但这些技术可以共存。虽然 RAG 仍将成为生产应用程序的主要内容，但 Gemini 1.5 Pro 和类似模型将帮助企业数据科学团队更快地进行实验和迭代。

## RAG 的明显优势：更多令牌 = 更高成本

向大型语言模型 (LLM) 提示中注入更多上下文意味着要支付更多处理能力的费用——无论是通过 API 直接按令牌收费，还是通过计算资源的成本间接支付。因此，数据科学家和开发人员必须仔细考虑每项任务的正确上下文量。

在某种程度上，这是一个不错的问题。早期由 LLM 支持的应用程序通常使用整个上下文窗口，并且难以优化适合其中的上下文。随着上下文大小从 1,000 个令牌增加到 16,000 个令牌，现在增加到一百万个令牌，开发压力已经从优先考虑最重要的文档转移到决定性能提升不再证明额外文本价格合理的地方。

无论企业如何支付其 [LLM 使用费](https://thenewstack.io/clean-data-trusted-model-ensure-good-data-hygiene-for-your-llms/)，更多令牌意味着更高的运营成本。很少有任务需要一百万个令牌的上下文。

## RAG 的模块化优势

基于 RAG 的应用程序的模块化架构提供了宝贵的灵活性。Gemini 与大多数 LLM 一样，是一个黑匣子。它无疑在某些主题和任务上表现良好，而在其他主题和任务上表现不佳。如果一个企业数据科学团队构建了一个使用 Gemini 1.5 的整个上下文窗口的应用程序，那么他们将很难用另一个模型替换 Gemini——至少在有可比的竞争对手进入市场之前。

基于 RAG 的应用程序并非如此。基于 RAG 的 LLM 系统允许数据科学团队根据其特定需求交换和 [定制每个组件](https://thenewstack.io/red-hat-podman-lab-gets-developers-started-on-genai/)。

Snorkel AI 最近与一家银行客户合作开展了一个基于 RAG 的项目。该客户需要该系统准确回答有关合同的问题。该项目从现成的组件（GPT-4 作为 LLM，LlamaIndex 作为 RAG）开始，准确率为 25%——与部署基准相差甚远。

在他们的第一个冲刺中，我们的工程师向应用程序添加了组件，以智能地分块和标记源文档。该应用程序的现成版本难以识别哪些文本包含日期。我们的团队添加了一个轻量级辅助模型，该模型明确标记了预测包含日期信息的文档块。他们还优化了提示模板，并在特定领域的​​数据上微调了嵌入模型。在短短三周内，他们将系统准确率提高到了 79%。

后来的工作将准确率提高到了 89%，但他们实现了前 54 分的提升，而根本没有修改现成的 LLM。这就是 RAG 模块化的力量。

## 更好的数据开发构建更好的 LLM 系统

如果没有由我们客户的主题专家指导的高质量数据开发，我们工程师的 64 分准确率提升是不可能的。

为了训练日期标记模型，我们需要示例段落，这些段落提到日期和没有提到日期。我们的工程师并不立即知道会遇到哪种微妙的日期引用，但主题专家知道。SME 识别出少量带有斜体或微妙日期引用的段落，并简要解释了他们标记它的原因。

在生产用例中，RAG 将获胜。其模块化、多点可定制性和相对成本效益使其成为企业人工智能的更好选择。
**更正后的 Markdown 格式：**

### 我们的工程师随后将 SME 的解释编码为 Snorkel Flow AI 数据开发平台中的标记功能。

该平台快速标记了大量文档，然后我们的工程师根据 SME 的基本事实检查了其标记功能的准确性。这使他们能够识别出不足之处并进行迭代，直到他们生成一个能够训练高精度辅助模型的高质量数据集。

最终，我们客户的 SME 花费更多时间验证模型的准确性，而不是标记数据。

虽然这种数据开发在技术上可以通过非编程方法实现，但既不高效也不实用。

## Gemini 1.5 的百万令牌上下文窗口的适用范围

虽然我不建议任何企业构建使用 Gemini 1.5 pro 的完整上下文窗口的生产 LLM 系统，但 Google 的值得注意的成就在

[企业 AI 开发](https://thenewstack.io/devs-get-ai-pixie-dust-at-google-i-o-but-no-search-updates/)

中占有一席之地。

长上下文模型将加速更简单和预生产的用例。这正是当今的许多企业 AI！Gemini 和其他模型将使数据科学团队比现在更快地完成概念验证应用程序。一旦他们证明了这个概念，他们就可以继续构建一个基于 RAG 的强大、模块化且高度定制化的应用程序。

## 定制的 RAG > 生产应用程序中的长上下文

Gemini 1.5 代表了一项重大的技术成就。我赞扬 Google 的研究人员和工程师所做的一切。Gemini 和其他长上下文模型将在企业 AI 中占据重要地位。允许数据科学团队处理具有挑战性的单次问题并更快地完成应用程序的草稿将产生真正的业务价值。

但是，当涉及到生产用例时，RAG 将胜出。其模块化、多点可定制性和相对成本效益使其成为企业 AI 的更好选择。

[YOUTUBE.COM/THENEWSTACK](https://youtube.com/thenewstack?sub_confirmation=1)

技术发展迅速，不要错过任何一集。订阅我们的 YouTube 频道以流式传输我们所有的播客、采访、演示等。