<!DOCTYPE html><html lang="en" class="text-base antialiased"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" as="image" imageSrcSet="/_next/image?url=%2Fblog%2FBlogHeader_AiAgentsFromScratch.jpg&amp;w=256&amp;q=75 256w, /_next/image?url=%2Fblog%2FBlogHeader_AiAgentsFromScratch.jpg&amp;w=384&amp;q=75 384w, /_next/image?url=%2Fblog%2FBlogHeader_AiAgentsFromScratch.jpg&amp;w=640&amp;q=75 640w, /_next/image?url=%2Fblog%2FBlogHeader_AiAgentsFromScratch.jpg&amp;w=750&amp;q=75 750w, /_next/image?url=%2Fblog%2FBlogHeader_AiAgentsFromScratch.jpg&amp;w=828&amp;q=75 828w, /_next/image?url=%2Fblog%2FBlogHeader_AiAgentsFromScratch.jpg&amp;w=1080&amp;q=75 1080w, /_next/image?url=%2Fblog%2FBlogHeader_AiAgentsFromScratch.jpg&amp;w=1200&amp;q=75 1200w, /_next/image?url=%2Fblog%2FBlogHeader_AiAgentsFromScratch.jpg&amp;w=1920&amp;q=75 1920w, /_next/image?url=%2Fblog%2FBlogHeader_AiAgentsFromScratch.jpg&amp;w=2048&amp;q=75 2048w, /_next/image?url=%2Fblog%2FBlogHeader_AiAgentsFromScratch.jpg&amp;w=3840&amp;q=75 3840w" imageSizes="(max-width: 768px) 100vw, (max-width: 1200px) 50vw, 33vw" fetchPriority="high"/><link rel="stylesheet" href="/_next/static/css/4d76846517dc3f20.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-820312bbcd7e5244.js"/><script src="/_next/static/chunks/2eb8e609-436fa41dcf41725c.js" async=""></script><script src="/_next/static/chunks/8678-8c64cdbaefd7b619.js" async=""></script><script src="/_next/static/chunks/main-app-692f12385bd92836.js" async=""></script><script src="/_next/static/chunks/app/not-found-29ca1da8157aac5a.js" async=""></script><script src="/_next/static/chunks/8853-2271113113dde66c.js" async=""></script><script src="/_next/static/chunks/6475-8ce54b349539116b.js" async=""></script><script src="/_next/static/chunks/1735-43b56eb9821f0ef4.js" async=""></script><script src="/_next/static/chunks/6557-a61c6dc420c58496.js" async=""></script><script src="/_next/static/chunks/7562-46b0926241c4cd18.js" async=""></script><script src="/_next/static/chunks/5010-01983627d358362b.js" async=""></script><script src="/_next/static/chunks/1462-df42fe1a54b4ebf5.js" async=""></script><script src="/_next/static/chunks/405-28c6568087d4ead7.js" async=""></script><script src="/_next/static/chunks/app/(other)/layout-ecad0553ecc89178.js" async=""></script><script src="/_next/static/chunks/5663-00779e166e8504ca.js" async=""></script><script src="/_next/static/chunks/app/(other)/blog/%5Bslug%5D/page-ec4878d622ff5f36.js" async=""></script><title>How to Build AI Agents Without Frameworks: A Step-by-Step Guide</title><meta name="description" content="Comprehensive tutorial for no-framework AI agent development using direct LLM interaction. Build smarter, more adaptable AI systems without the constraints of pre-built tools"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="use-credentials"/><link rel="canonical" href="https://www.pondhouse-data.com/blog/ai-agents-from-scratch"/><meta property="og:title" content="How to Build AI Agents Without Frameworks: A Step-by-Step Guide"/><meta property="og:description" content="Comprehensive tutorial for no-framework AI agent development using direct LLM interaction. Build smarter, more adaptable AI systems without the constraints of pre-built tools"/><meta property="og:image" content="https://www.pondhouse-data.com/blog/BlogHeader_AiAgentsFromScratch.jpg"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="@techscienceandy"/><meta name="twitter:title" content="How to Build AI Agents Without Frameworks: A Step-by-Step Guide"/><meta name="twitter:description" content="Comprehensive tutorial for no-framework AI agent development using direct LLM interaction. Build smarter, more adaptable AI systems without the constraints of pre-built tools"/><meta name="twitter:image" content="https://www.pondhouse-data.com/blog/BlogHeader_AiAgentsFromScratch.jpg"/><link rel="shortcut icon" href="/Icon_dark.png"/><link rel="icon" href="/favicon.ico"/><link rel="apple-touch-icon" href="/apple-touch-icon-60x60.png" sizes="60x60" type="image/png"/><link rel="apple-touch-icon" href="/apple-touch-icon-76x76.png" sizes="76x76" type="image/png"/><link rel="apple-touch-icon" href="/apple-touch-icon-120x120.png" sizes="120x120" type="image/png"/><link rel="apple-touch-icon" href="/apple-touch-icon-152x152.png" sizes="152x152" type="image/png"/><meta name="next-size-adjust"/><script src="/_next/static/chunks/polyfills-78c92fac7aa8fdd8.js" noModule=""></script></head><!--$!--><template data-dgst="BAILOUT_TO_CLIENT_SIDE_RENDERING"></template><!--/$--><body><div class="relative flex min-h-screen flex-col bg-background"><header class="sticky top-0 z-40 w-full bg-background shadow"><div class="container sticky flex h-16 items-center justify-start px-4 lg:px-20"><button class="inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none ring-offset-background hover:bg-accent hover:text-accent-foreground h-10 py-2 px-4 lg:hidden" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R16fja:" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="size-6"><line x1="4" x2="20" y1="12" y2="12"></line><line x1="4" x2="20" y1="6" y2="6"></line><line x1="4" x2="20" y1="18" y2="18"></line></svg><span class="sr-only">Toggle navigation menu</span></button><a title="Back to home" class="text-lg font-bold" href="/"><div class="flex shrink-0 items-center"><svg viewBox="0 0 2400 549.99999" class="w-48"><g id="g17" transform="matrix(1.3333333,0,0,-1.3333333,0,2666.6667)"><g id="g19" fill="currentColor" transform="translate(-100.29087,792.49973)"><g id="g21" clip-path="url(#clipPath25)" fill="currentColor"><g id="g27" transform="translate(584.3906,1035.5625)" fill="currentColor"><path d="m 0,0 c 0,3.579 -1.079,6.466 -3.233,8.658 -2.156,2.192 -5.024,3.287 -8.603,3.287 H -24.329 V -32 h 12.493 c 3.287,0 6.082,1.167 8.384,3.506 2.302,2.337 3.452,5.151 3.452,8.439 z m -12.384,33.097 c 10.082,0 18.118,-3.179 24.11,-9.535 5.551,-6.065 8.33,-13.808 8.33,-23.233 v -19.946 c 0,-9.06 -3.162,-16.805 -9.481,-23.233 -6.32,-6.43 -13.972,-9.645 -22.959,-9.645 h -11.945 v -51.727 H -45.043 V 33.097 Z" fill="currentColor" id="path29"></path></g><g id="g31" transform="translate(662.7471,1037.9736)" fill="currentColor"><path d="m 0,0 c 0,3.288 -1.151,6.082 -3.452,8.384 -2.302,2.301 -5.097,3.452 -8.384,3.452 -3.288,0 -6.101,-1.151 -8.439,-3.452 C -22.614,6.082 -23.781,3.288 -23.781,0 v -75.18 c 0,-3.288 1.167,-6.082 3.506,-8.384 2.338,-2.301 5.151,-3.452 8.439,-3.452 3.287,0 6.082,1.151 8.384,3.452 2.301,2.302 3.452,5.096 3.452,8.384 z m -11.288,32.439 c 9.131,0 16.894,-3.216 23.288,-9.644 6.393,-6.43 9.59,-14.175 9.59,-23.233 v -74.961 c 0,-9.134 -3.216,-16.896 -9.645,-23.289 -6.429,-6.394 -14.175,-9.589 -23.233,-9.589 -9.134,0 -16.878,3.214 -23.234,9.644 -6.356,6.428 -9.535,14.174 -9.535,23.234 v 74.961 c 0,9.132 3.215,16.894 9.645,23.288 6.429,6.392 14.137,9.589 23.124,9.589" fill="currentColor" id="path33"></path></g><g id="g35" transform="translate(725.7793,1068.769)" fill="currentColor"><path d="M 0,0 27.487,-92.36 V 0 H 48.201 V -137.428 H 25.953 l -28.494,88.002 v -88.002 H -23.253 V 0 Z" fill="currentColor" id="path37"></path></g><g id="g39" transform="translate(813.2119,951.8345)" fill="currentColor"><path d="m 0,0 h 12.493 c 3.288,0 6.064,1.187 8.329,3.562 2.264,2.373 3.398,5.167 3.398,8.383 v 71.893 c 0,3.287 -1.151,6.099 -3.452,8.438 -2.302,2.338 -5.06,3.507 -8.275,3.507 H 0 Z m 44.385,12.384 c 0,-9.06 -3.179,-16.805 -9.535,-23.234 -6.356,-6.43 -14.028,-9.644 -23.014,-9.644 h -32.549 v 137.429 h 32.549 c 9.058,0 16.748,-3.216 23.069,-9.644 6.319,-6.431 9.48,-14.138 9.48,-23.124 z" fill="currentColor" id="path41"></path></g><g id="g43" transform="translate(896.498,989.5337)" fill="currentColor"><path d="M 0,0 V -58.193 H -20.713 V 79.125 H 0 V 20.823 H 24.987 V 79.125 H 45.7 V -58.193 H 24.987 V 0 Z" fill="currentColor" id="path45"></path></g><g id="g47" transform="translate(1004.5537,1037.9736)" fill="currentColor"><path d="m 0,0 c 0,3.288 -1.15,6.082 -3.452,8.384 -2.302,2.301 -5.096,3.452 -8.384,3.452 -3.288,0 -6.101,-1.151 -8.438,-3.452 C -22.613,6.082 -23.781,3.288 -23.781,0 v -75.18 c 0,-3.288 1.168,-6.082 3.507,-8.384 2.337,-2.301 5.15,-3.452 8.438,-3.452 3.288,0 6.082,1.151 8.384,3.452 C -1.15,-81.262 0,-78.468 0,-75.18 Z m -11.288,32.439 c 9.132,0 16.894,-3.216 23.288,-9.644 6.393,-6.43 9.59,-14.175 9.59,-23.233 v -74.961 c 0,-9.134 -3.216,-16.896 -9.645,-23.289 -6.429,-6.394 -14.174,-9.589 -23.233,-9.589 -9.134,0 -16.877,3.214 -23.233,9.644 -6.356,6.428 -9.535,14.174 -9.535,23.234 v 74.961 c 0,9.132 3.214,16.894 9.645,23.288 6.428,6.392 14.137,9.589 23.123,9.589" fill="currentColor" id="path49"></path></g><g id="g51" transform="translate(1076.9932,929.8062)" fill="currentColor"><path d="m 0,0 c -9.135,0 -16.878,3.178 -23.234,9.535 -6.356,6.356 -9.535,14.064 -9.535,23.124 v 106.194 h 20.275 V 32.878 c 0,-3.288 1.168,-6.083 3.507,-8.384 2.338,-2.302 5.15,-3.452 8.438,-3.452 3.288,0 6.083,1.15 8.384,3.452 2.302,2.301 3.452,5.096 3.452,8.384 v 105.975 h 21.59 V 32.659 C 32.877,23.453 29.661,15.708 23.232,9.425 16.803,3.141 9.058,0 0,0" fill="currentColor" id="path53"></path></g><g id="g55" transform="translate(1195.459,965.5332)" fill="currentColor"><path d="m 0,0 c 0.146,-9.572 -2.339,-17.754 -7.451,-24.548 -3.362,-4.603 -8.111,-7.855 -14.247,-9.754 -3.288,-1.022 -7.124,-1.534 -11.508,-1.534 -8.109,0 -14.832,2.008 -20.165,6.027 -4.457,3.288 -7.983,7.763 -10.575,13.425 -2.594,5.661 -4.11,12.146 -4.548,19.453 l 19.726,1.425 c 0.877,-8.006 2.996,-13.807 6.356,-17.405 2.483,-2.717 5.333,-4.004 8.549,-3.857 4.528,0.146 8.145,2.377 10.849,6.693 1.387,2.119 2.082,5.154 2.082,9.103 0,5.703 -2.593,11.371 -7.781,17.002 -4.092,3.875 -10.229,9.688 -18.411,17.44 -6.868,6.655 -11.726,12.615 -14.576,17.881 -3.069,5.923 -4.603,12.358 -4.603,19.305 0,12.504 4.2,21.975 12.603,28.41 5.187,3.875 11.617,5.814 19.289,5.814 7.378,0 13.699,-1.644 18.959,-4.932 4.091,-2.558 7.397,-6.137 9.918,-10.74 2.52,-4.603 4.036,-9.901 4.549,-15.891 l -19.836,-3.616 c -0.586,5.625 -2.193,10.008 -4.823,13.151 -1.901,2.263 -4.64,3.397 -8.219,3.397 -3.8,0 -6.686,-1.681 -8.658,-5.041 -1.608,-2.704 -2.412,-6.065 -2.412,-10.083 0,-6.284 2.703,-12.676 8.111,-19.178 2.045,-2.485 5.112,-5.408 9.206,-8.768 4.821,-4.018 8,-6.832 9.534,-8.438 5.113,-5.115 9.059,-10.156 11.836,-15.124 1.314,-2.339 2.373,-4.493 3.179,-6.466 C -1.095,8.255 -0.073,3.872 0,0" fill="currentColor" id="path57"></path></g><g id="g59" transform="translate(1212.6621,931.3408)" fill="currentColor"><path d="M 0,0 V 137.428 H 58.961 V 116.606 H 20.713 V 79.125 H 48.658 V 58.303 H 20.713 V 20.822 H 58.961 V 0 Z" fill="currentColor" id="path61"></path></g><g id="g63" transform="translate(1349.3164,951.8345)" fill="currentColor"><path d="m 0,0 h 12.493 c 3.288,0 6.064,1.187 8.329,3.562 2.264,2.373 3.398,5.167 3.398,8.383 v 71.893 c 0,3.287 -1.151,6.099 -3.452,8.438 -2.302,2.338 -5.06,3.507 -8.275,3.507 H 0 Z m 44.385,12.384 c 0,-9.06 -3.179,-16.805 -9.535,-23.234 -6.356,-6.43 -14.028,-9.644 -23.014,-9.644 h -32.549 v 137.429 h 32.549 c 9.058,0 16.748,-3.216 23.069,-9.644 6.319,-6.431 9.48,-14.138 9.48,-23.124 z" fill="currentColor" id="path65"></path></g><g id="g67" transform="translate(1445.4258,1037.2065)" fill="currentColor"><path d="M 0,0 -7.672,-54.139 H 7.671 Z m -10.881,-74.304 -5.032,-31.562 H -37.48 L -14.136,31.453 H 14.356 L 37.37,-105.866 H 15.592 l -4.847,31.562 z" fill="currentColor" id="path69"></path></g><g id="g71" transform="translate(1502.8525,1047.8369)" fill="currentColor"><path d="M 0,0 H -22.027 V 20.822 H 42.632 V 0 H 20.713 V -116.496 H 0 Z" fill="currentColor" id="path73"></path></g><g id="g75" transform="translate(1580.7725,1037.2065)" fill="currentColor"><path d="M 0,0 -7.672,-54.139 H 7.671 Z m -10.881,-74.304 -5.032,-31.562 H -37.48 L -14.136,31.453 H 14.356 L 37.369,-105.866 H 15.592 l -4.847,31.562 z" fill="currentColor" id="path77"></path></g><g id="g79" transform="translate(1704.9355,1037.9736)" fill="currentColor"><path d="m 0,0 c 0,3.288 -1.151,6.082 -3.452,8.384 -2.302,2.301 -5.096,3.452 -8.384,3.452 -3.288,0 -6.101,-1.151 -8.438,-3.452 C -22.614,6.082 -23.781,3.288 -23.781,0 v -75.18 c 0,-3.288 1.167,-6.082 3.507,-8.384 2.337,-2.301 5.15,-3.452 8.438,-3.452 3.288,0 6.082,1.151 8.384,3.452 2.301,2.302 3.452,5.096 3.452,8.384 z m -11.288,32.439 c 9.132,0 16.894,-3.216 23.288,-9.644 6.393,-6.43 9.589,-14.175 9.589,-23.233 v -74.961 c 0,-9.134 -3.215,-16.896 -9.644,-23.289 -6.429,-6.394 -14.174,-9.589 -23.233,-9.589 -9.134,0 -16.877,3.214 -23.233,9.644 -6.357,6.428 -9.535,14.174 -9.535,23.234 v 74.961 c 0,9.132 3.213,16.894 9.644,23.288 6.429,6.392 14.138,9.589 23.124,9.589" fill="currentColor" id="path81"></path></g><g id="g83" transform="translate(1777.2637,929.5869)" fill="currentColor"><path d="m 0,0 c -9.134,0 -16.896,3.214 -23.288,9.645 -6.394,6.428 -9.589,14.137 -9.589,23.124 v 74.96 c 0,9.132 3.214,16.895 9.645,23.289 6.427,6.392 14.172,9.589 23.232,9.589 9.133,0 16.878,-3.216 23.234,-9.644 6.356,-6.43 9.535,-14.175 9.535,-23.234 V 92.058 H 11.288 v 16.109 c 0,3.288 -1.169,6.1 -3.507,8.439 -2.339,2.337 -5.15,3.507 -8.438,3.507 -3.288,0 -6.082,-1.17 -8.384,-3.507 -2.302,-2.339 -3.452,-5.151 -3.452,-8.439 V 32.988 c 0,-3.288 1.15,-6.083 3.452,-8.384 2.302,-2.302 5.096,-3.453 8.384,-3.453 3.288,0 6.099,1.148 8.438,3.442 2.338,2.295 3.507,5.083 3.507,8.362 V 59.947 H -0.219 V 80.77 H 32.769 V 32.769 C 32.769,23.635 29.553,15.891 23.124,9.535 16.694,3.178 8.987,0 0,0" fill="currentColor" id="path85"></path></g><g id="g87" transform="translate(267.7109,952.7754)" fill="currentColor"><path d="M 0,0 -77.743,19.682 -41.331,162.375 106.774,200.263 -19.928,73.561 Z" fill="currentColor" id="path89"></path></g><g id="g91" transform="translate(384.9814,1146.3584)" fill="currentColor"><path d="m 0,0 -55.2,-58.175 73.906,-18.608 48.516,-172.491 39.415,147.707 z" fill="currentColor" id="path93"></path></g><g id="g95" transform="translate(439.8594,883.0366)" fill="currentColor"><path d="M 0,0 -19.791,77.715 -74.935,25.107 -246.734,76.015 -142.778,-36.075 Z" fill="currentColor" id="path97"></path></g></g></g></g></svg></div></a><div class="flex w-full flex-row justify-end pl-8 md:pl-12 lg:justify-between"><nav aria-label="Main" data-orientation="horizontal" dir="ltr" class="relative z-10 max-w-max flex-1 items-center justify-center hidden lg:flex"><div style="position:relative"><ul data-orientation="horizontal" class="group flex flex-1 list-none items-center justify-center space-x-1" dir="ltr"><li><a class="group inline-flex h-10 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50 data-[active]:bg-accent/50 data-[state=open]:bg-accent/50" href="/" data-radix-collection-item="">Home</a></li><li><a class="group inline-flex h-10 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50 data-[active]:bg-accent/50 data-[state=open]:bg-accent/50" href="/blog" data-radix-collection-item="">Blog</a></li><li><a class="group inline-flex h-10 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50 data-[active]:bg-accent/50 data-[state=open]:bg-accent/50" href="/guides/train-your-own-llm" data-radix-collection-item="">FREE: Train your own LLM</a></li><li class="left-auto right-0"><button id="radix-:R76fja:-trigger-radix-:Rpn6fja:" data-state="closed" aria-expanded="false" aria-controls="radix-:R76fja:-content-radix-:Rpn6fja:" class="group inline-flex h-10 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50 data-[active]:bg-accent/50 data-[state=open]:bg-accent/50 group font-medium" data-radix-collection-item="">Knowledge Base<!-- --> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="relative top-[1px] ml-1 h-3 w-3 transition duration-200 group-data-[state=open]:rotate-180" aria-hidden="true"><polyline points="6 9 12 15 18 9"></polyline></svg></button></li><li class="left-auto right-0"><button id="radix-:R76fja:-trigger-radix-:R19n6fja:" data-state="closed" aria-expanded="false" aria-controls="radix-:R76fja:-content-radix-:R19n6fja:" class="group inline-flex h-10 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50 data-[active]:bg-accent/50 data-[state=open]:bg-accent/50 group font-medium" data-radix-collection-item="">Products<!-- --> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="relative top-[1px] ml-1 h-3 w-3 transition duration-200 group-data-[state=open]:rotate-180" aria-hidden="true"><polyline points="6 9 12 15 18 9"></polyline></svg></button></li></ul></div><div class="absolute inset-x-0 left-auto top-full flex justify-center"></div></nav><div class="flex gap-2"><a class="inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none ring-offset-background bg-primary text-primary-foreground hover:bg-primary/90 h-10 py-2 px-4 min-w-[80px]" href="/blog">Blog</a></div></div></div></header><div class="-mt-10 flex-1"><main><div class="bg-primary-800 pt-20"></div><article class="xl:max-w-6xl0 prose-quoteless prose mx-auto mt-20 prose-pre:m-0 prose-pre:bg-transparent prose-pre:p-0 lg:max-w-4xl prose-code:rounded-md prose-code:px-1 prose-code:py-[1px] prose-code:text-white prose-code:content-none prose-code:before:content-none prose-code:after:content-none prose-blockquote:bg-secondary-200 prose-blockquote:rounded-xl prose-blockquote:px-4 prose-blockquote:py-[1px] prose-blockquote:text-gray-700 prose-blockquote:border-l-secondary-600 pb-8"><h1 class="">How to Build AI Agents Without Frameworks: A Step-by-Step Guide</h1><div class="rounded-3xl border bg-white p-5 shadow-[#00000008] md:p-10"><div class="relative mx-auto mb-6 aspect-[1.776824] w-full"><img alt="blog preview" fetchPriority="high" loading="eager" decoding="async" data-nimg="fill" class="m-0 rounded-3xl" style="position:absolute;height:100%;width:100%;left:0;top:0;right:0;bottom:0;color:transparent" sizes="(max-width: 768px) 100vw, (max-width: 1200px) 50vw, 33vw" srcSet="/_next/image?url=%2Fblog%2FBlogHeader_AiAgentsFromScratch.jpg&amp;w=256&amp;q=75 256w, /_next/image?url=%2Fblog%2FBlogHeader_AiAgentsFromScratch.jpg&amp;w=384&amp;q=75 384w, /_next/image?url=%2Fblog%2FBlogHeader_AiAgentsFromScratch.jpg&amp;w=640&amp;q=75 640w, /_next/image?url=%2Fblog%2FBlogHeader_AiAgentsFromScratch.jpg&amp;w=750&amp;q=75 750w, /_next/image?url=%2Fblog%2FBlogHeader_AiAgentsFromScratch.jpg&amp;w=828&amp;q=75 828w, /_next/image?url=%2Fblog%2FBlogHeader_AiAgentsFromScratch.jpg&amp;w=1080&amp;q=75 1080w, /_next/image?url=%2Fblog%2FBlogHeader_AiAgentsFromScratch.jpg&amp;w=1200&amp;q=75 1200w, /_next/image?url=%2Fblog%2FBlogHeader_AiAgentsFromScratch.jpg&amp;w=1920&amp;q=75 1920w, /_next/image?url=%2Fblog%2FBlogHeader_AiAgentsFromScratch.jpg&amp;w=2048&amp;q=75 2048w, /_next/image?url=%2Fblog%2FBlogHeader_AiAgentsFromScratch.jpg&amp;w=3840&amp;q=75 3840w" src="/_next/image?url=%2Fblog%2FBlogHeader_AiAgentsFromScratch.jpg&amp;w=3840&amp;q=75"/> </div><p>AI agents are often overcomplicated. At their core, they&#x27;re just language
models with the ability to use tools and remember context. While
frameworks like <a href="https://www.langchain.com/" class="text-secondary-400 hover:text-secondary-600">LangChain</a> or
<a href="https://github.com/Significant-Gravitas/AutoGPT" class="text-secondary-400 hover:text-secondary-600">AutoGPT</a> can help you
get started quickly, they add layers of abstraction that can make it
harder to understand what&#x27;s actually happening – and harder to customize
your agent for specific use cases.</p>
<p>In this tutorial, we&#x27;ll build an AI agent from scratch using direct API
calls to GPT-4o. You&#x27;ll learn how to create an agent that can query
PostgreSQL databases, fetch information from Wikipedia, and maintain
conversation context through simple database storage. No frameworks, just
clean code and clear concepts.</p>
<p>The goal is to demonstrate that AI agents don&#x27;t need complex
architectures. We&#x27;ll focus on the essential components: prompt engineering
for tool use, storing conversation history in PostgreSQL, and managing the
interaction flow between the LLM and its tools.</p>
<p>At the end, you will know exactly, what an agent is, how it works and how
to build them. If you then decide to still use a framework - that&#x27;s fine.
However, you will have a much better understanding of what&#x27;s happening
under the hood.</p>
<p>Let&#x27;s start by understanding what makes something an AI agent, and then
build one step by step.</p>
<a class="no-underline" href="#what-are-ai-agents"><h2 class="hover:text-secondary-400" id="what-are-ai-agents">What Are AI Agents?</h2></a>
<p>An AI agent is fundamentally just a language model that can:</p>
<ul>
<li>Understand what tools it has available</li>
<li>Decide when to use these tools</li>
<li>Remember previous interactions</li>
<li>Make decisions based on all this information</li>
</ul>
<a class="no-underline" href="#what-are-tools"><h3 class="hover:text-secondary-400" id="what-are-tools">What Are Tools?</h3></a>
<p>Tools (sometimes called &quot;functions&quot; or &quot;capabilities&quot;) are simply
functions that the agent can call to interact with the outside world.
They&#x27;re just Python functions with:</p>
<ul>
<li>A clear description of what they do</li>
<li>Defined input parameters</li>
<li>Structured output</li>
</ul>
<p>Here&#x27;s a concrete example of a tool:</p>
<pre><div data-bright-theme="dark-plus" style="color:#D4D4D4;border-radius:4px;overflow:hidden;margin:1em 0;--selection-background:#264F78;--line-number-color:#858585;--tab-border:#252526;--tab-background:#1E1E1E;--tab-color:#ffffff;--inactive-tab-background:#2D2D2D;--inactive-tab-color:#ffffff80;--tab-bottom-border:#1E1E1E;color-scheme:dark"><style>
  [data-bright-theme] ::selection { background-color: var(--selection-background) }
  [data-bright-theme] [data-bright-ln] { 
    color: var(--line-number-color); 
    margin-right: 1.5ch; 
    display: inline-block;
    text-align: right;
    user-select: none;
  }
  </style><pre style="margin:0;color:#D4D4D4;background:#1E1E1E;padding:1em 0;overflow:auto"><code style="display:block;min-width:fit-content"><div style="padding:0 1em"><span><span data-bright-ln="1" style="width:2ch">1</span><span style="color:#569CD6">def </span><span style="color:#DCDCAA">search_wikipedia</span><span style="color:#D4D4D4">(</span><span style="color:#9CDCFE">query</span><span style="color:#D4D4D4">: </span><span style="color:#4EC9B0">str</span><span style="color:#D4D4D4">) -&gt; </span><span style="color:#4EC9B0">str</span><span style="color:#D4D4D4">:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="2" style="width:2ch">2</span><span style="color:#CE9178">    &quot;&quot;&quot;</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="3" style="width:2ch">3</span><span style="color:#CE9178">    Searches Wikipedia and returns the first paragraph of the most relevant article.</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="4" style="width:2ch">4</span><span style="color:#CE9178"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="5" style="width:2ch">5</span><span style="color:#CE9178">    Args:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="6" style="width:2ch">6</span><span style="color:#CE9178">        query: The search term to look up on Wikipedia</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="7" style="width:2ch">7</span><span style="color:#CE9178"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="8" style="width:2ch">8</span><span style="color:#CE9178">    Returns:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="9" style="width:2ch">9</span><span style="color:#CE9178">        str: The first paragraph of the most relevant Wikipedia article</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="10" style="width:2ch">10</span><span style="color:#CE9178">    &quot;&quot;&quot;</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="11" style="width:2ch">11</span><span style="color:#C586C0">    return</span><span style="color:#D4D4D4"> wikipedia.summary(query, </span><span style="color:#9CDCFE">sentences</span><span style="color:#D4D4D4">=</span><span style="color:#B5CEA8">3</span><span style="color:#D4D4D4">)</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="12" style="width:2ch">12</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="13" style="width:2ch">13</span><span style="color:#6A9955"># This is how we describe the tool to the LLM</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="14" style="width:2ch">14</span><span style="color:#D4D4D4">wikipedia_tool_description = </span><span style="color:#CE9178">&quot;&quot;&quot;</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="15" style="width:2ch">15</span><span style="color:#CE9178">Tool: search_wikipedia</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="16" style="width:2ch">16</span><span style="color:#CE9178">Description: Searches Wikipedia and returns a summary of the topic</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="17" style="width:2ch">17</span><span style="color:#CE9178">Input: A search query string</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="18" style="width:2ch">18</span><span style="color:#CE9178">Example: To learn about Python programming, use: search_wikipedia(&quot;Python programming language&quot;)</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="19" style="width:2ch">19</span><span style="color:#CE9178">&quot;&quot;&quot;</span><br/></span></div></code></pre></div></pre>
<p>When we give our agent access to this tool, we&#x27;re essentially telling it:
&quot;You can search Wikipedia by calling this function.&quot; The LLM then decides,
based on the user&#x27;s question, whether it needs to use this tool to provide
a good answer. When we say &quot;the LLM decides,&quot; we mean that we prompt the
LLM with the available tools and ask it to decide which one to use. The AI
model then simply returns a text response with the tool name.</p>
<p><strong>Common examples of tools include:</strong></p>
<ul>
<li>Database queries</li>
<li>Web searches</li>
<li>API calls</li>
<li>File operations</li>
<li>Calculator functions</li>
<li>Email sending capabilities</li>
</ul>
<p>To bring both the concepts of agents and tools together, we see that there
is no magic involved. It&#x27;s just AI model interactions and a bunch of
python functions.</p>
<p>Bringing this together, a pseudo-code for an AI agent might look like
this:</p>
<pre><div data-bright-theme="dark-plus" style="color:#D4D4D4;border-radius:4px;overflow:hidden;margin:1em 0;--selection-background:#264F78;--line-number-color:#858585;--tab-border:#252526;--tab-background:#1E1E1E;--tab-color:#ffffff;--inactive-tab-background:#2D2D2D;--inactive-tab-color:#ffffff80;--tab-bottom-border:#1E1E1E;color-scheme:dark"><style>
  [data-bright-theme] ::selection { background-color: var(--selection-background) }
  [data-bright-theme] [data-bright-ln] { 
    color: var(--line-number-color); 
    margin-right: 1.5ch; 
    display: inline-block;
    text-align: right;
    user-select: none;
  }
  </style><pre style="margin:0;color:#D4D4D4;background:#1E1E1E;padding:1em 0;overflow:auto"><code style="display:block;min-width:fit-content"><div style="padding:0 1em"><span><span data-bright-ln="1" style="width:2ch">1</span><span style="color:#6A9955"># This is what an agent interaction basically looks like</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="2" style="width:2ch">2</span><span style="color:#569CD6">def </span><span style="color:#DCDCAA">agent_interaction</span><span style="color:#D4D4D4">(</span><span style="color:#9CDCFE">user_input</span><span style="color:#D4D4D4">, </span><span style="color:#9CDCFE">available_tools</span><span style="color:#D4D4D4">, </span><span style="color:#9CDCFE">conversation_history</span><span style="color:#D4D4D4">):</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="3" style="width:2ch">3</span><span style="color:#6A9955">    # 1. We tell the LLM what it can do</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="4" style="width:2ch">4</span><span style="color:#D4D4D4">    prompt = </span><span style="color:#569CD6">f</span><span style="color:#CE9178">&quot;&quot;&quot;You have access to these tools:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="5" style="width:2ch">5</span><span style="color:#CE9178">    - query_database: Executes SQL queries</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="6" style="width:2ch">6</span><span style="color:#CE9178">    - search_wikipedia: Searches Wikipedia articles</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="7" style="width:2ch">7</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="8" style="width:2ch">8</span><span style="color:#CE9178">    Previous conversation:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="9" style="width:2ch">9</span><span style="color:#569CD6">    {</span><span style="color:#D4D4D4">conversation_history</span><span style="color:#569CD6">}</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="10" style="width:2ch">10</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="11" style="width:2ch">11</span><span style="color:#CE9178">    User question: </span><span style="color:#569CD6">{</span><span style="color:#D4D4D4">user_input</span><span style="color:#569CD6">}</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="12" style="width:2ch">12</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="13" style="width:2ch">13</span><span style="color:#CE9178">    Decide if you need to use a tool to answer. If yes, specify which tool and how to use it.&quot;&quot;&quot;</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="14" style="width:2ch">14</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="15" style="width:2ch">15</span><span style="color:#6A9955">    # 2. The LLM decides what to do</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="16" style="width:2ch">16</span><span style="color:#D4D4D4">    llm_response = gpt4_call(prompt)</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="17" style="width:2ch">17</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="18" style="width:2ch">18</span><span style="color:#6A9955">    # 3. We execute the tool if needed and get the final answer</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="19" style="width:2ch">19</span><span style="color:#C586C0">    if </span><span style="color:#CE9178">&quot;use query_database&quot; </span><span style="color:#569CD6">in</span><span style="color:#D4D4D4"> llm_response:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="20" style="width:2ch">20</span><span style="color:#6A9955">        # Execute database query and get result</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="21" style="width:2ch">21</span><span style="color:#D4D4D4">        data = execute_query(extract_query(llm_response))</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="22" style="width:2ch">22</span><span style="color:#C586C0">        return</span><span style="color:#D4D4D4"> get_final_answer(data)</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="23" style="width:2ch">23</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="24" style="width:2ch">24</span><span style="color:#C586C0">    return</span><span style="color:#D4D4D4"> llm_response</span><br/></span></div></code></pre></div></pre>
<p>This is the core concept of an agent. Everything else – complex planning,
multiple tool calls, sophisticated memory systems – is just an extension
of this basic pattern.</p>
<p><strong>Common misconceptions about agents:</strong></p>
<ul>
<li>They don&#x27;t need complex orchestration frameworks</li>
<li>They don&#x27;t need to run autonomously (though they can)</li>
<li>They don&#x27;t need sophisticated planning algorithms (though these can help
for complex tasks)</li>
</ul>
<p><strong>The key to building effective agents is not in the framework you use, but in:</strong></p>
<ul>
<li>Writing clear prompts that help the LLM understand its capabilities</li>
<li>Implementing reliable tools that the agent can use</li>
<li>Maintaining relevant context through some form of memory storage</li>
</ul>
<p>In the following sections, we&#x27;ll implement this pattern with real code,
building an agent that can actually query databases and search Wikipedia.
You&#x27;ll see that the complexity comes from the specific requirements of
your use case, not from the agent architecture itself.</p>
<a class="no-underline" href="#why-build-agents-without-frameworks"><h2 class="hover:text-secondary-400" id="why-build-agents-without-frameworks">Why Build Agents Without Frameworks?</h2></a>
<p>Frameworks like LangChain and AutoGPT are often recommended for building
AI agents. While they can be useful for quick prototypes, there are
compelling reasons to avoid them:</p>
<a class="no-underline" href="#understanding-what-really-happens"><h3 class="hover:text-secondary-400" id="understanding-what-really-happens">Understanding What Really Happens</h3></a>
<pre><div data-bright-theme="dark-plus" style="color:#D4D4D4;border-radius:4px;overflow:hidden;margin:1em 0;--selection-background:#264F78;--line-number-color:#858585;--tab-border:#252526;--tab-background:#1E1E1E;--tab-color:#ffffff;--inactive-tab-background:#2D2D2D;--inactive-tab-color:#ffffff80;--tab-bottom-border:#1E1E1E;color-scheme:dark"><style>
  [data-bright-theme] ::selection { background-color: var(--selection-background) }
  [data-bright-theme] [data-bright-ln] { 
    color: var(--line-number-color); 
    margin-right: 1.5ch; 
    display: inline-block;
    text-align: right;
    user-select: none;
  }
  </style><pre style="margin:0;color:#D4D4D4;background:#1E1E1E;padding:1em 0;overflow:auto"><code style="display:block;min-width:fit-content"><div style="padding:0 1em"><span><span data-bright-ln="1" style="width:2ch">1</span><span style="color:#6A9955"># With a framework:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="2" style="width:2ch">2</span><span style="color:#D4D4D4">agent = Agent.from_toolkit(SQLToolkit, WikiToolkit)</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="3" style="width:2ch">3</span><span style="color:#D4D4D4">result = agent.run(</span><span style="color:#CE9178">&quot;Find users who like pizza&quot;</span><span style="color:#D4D4D4">)</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="4" style="width:2ch">4</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="5" style="width:2ch">5</span><span style="color:#6A9955"># Without a framework - what&#x27;s actually happening:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="6" style="width:2ch">6</span><span style="color:#569CD6">def </span><span style="color:#DCDCAA">process_query</span><span style="color:#D4D4D4">(</span><span style="color:#9CDCFE">user_input</span><span style="color:#D4D4D4">: </span><span style="color:#4EC9B0">str</span><span style="color:#D4D4D4">):</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="7" style="width:2ch">7</span><span style="color:#D4D4D4">    prompt = </span><span style="color:#569CD6">f</span><span style="color:#CE9178">&quot;&quot;&quot;You have these tools:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="8" style="width:2ch">8</span><span style="color:#CE9178">    1. SQL queries: Execute database queries</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="9" style="width:2ch">9</span><span style="color:#CE9178">    2. Wikipedia search: Look up information</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="10" style="width:2ch">10</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="11" style="width:2ch">11</span><span style="color:#CE9178">    User question: </span><span style="color:#569CD6">{</span><span style="color:#D4D4D4">user_input</span><span style="color:#569CD6">}</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="12" style="width:2ch">12</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="13" style="width:2ch">13</span><span style="color:#CE9178">    Think step by step:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="14" style="width:2ch">14</span><span style="color:#CE9178">    1. Do I need any tools to answer this?</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="15" style="width:2ch">15</span><span style="color:#CE9178">    2. If yes, which tool and how should I use it?</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="16" style="width:2ch">16</span><span style="color:#CE9178">    &quot;&quot;&quot;</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="17" style="width:2ch">17</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="18" style="width:2ch">18</span><span style="color:#D4D4D4">    response = gpt4_call(prompt)</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="19" style="width:2ch">19</span><span style="color:#C586C0">    if </span><span style="color:#CE9178">&quot;SQL&quot; </span><span style="color:#569CD6">in</span><span style="color:#D4D4D4"> response:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="20" style="width:2ch">20</span><span style="color:#D4D4D4">        query = extract_sql(response)</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="21" style="width:2ch">21</span><span style="color:#D4D4D4">        data = execute_query(query)</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="22" style="width:2ch">22</span><span style="color:#C586C0">    if </span><span style="color:#CE9178">&quot;Wikipedia&quot; </span><span style="color:#569CD6">in</span><span style="color:#D4D4D4"> response:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="23" style="width:2ch">23</span><span style="color:#D4D4D4">        data = search_wikipedia(topic)</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="24" style="width:2ch">24</span><span style="color:#C586C0">        return</span><span style="color:#D4D4D4"> get_final_answer(data)</span><br/></span></div></code></pre></div></pre>
<p>The framework-free version is more explicit. You can see exactly:</p>
<ul>
<li>What the LLM is being told</li>
<li>When tools are being called</li>
<li>How decisions are being made</li>
</ul>
<a class="no-underline" href="#flexibility-and-control"><h3 class="hover:text-secondary-400" id="flexibility-and-control">Flexibility and Control</h3></a>
<p>Frameworks often make assumptions about:</p>
<ul>
<li>How tools should be structured</li>
<li>What the prompt format should be</li>
<li>How memory should work</li>
</ul>
<p>When you need to customize any of these, you often end up fighting against
the framework rather than working with it.</p>
<a class="no-underline" href="#simpler-debugging"><h3 class="hover:text-secondary-400" id="simpler-debugging">Simpler Debugging</h3></a>
<p>When something goes wrong with a framework:</p>
<pre><div data-bright-theme="dark-plus" style="color:#D4D4D4;border-radius:4px;overflow:hidden;margin:1em 0;--selection-background:#264F78;--line-number-color:#858585;--tab-border:#252526;--tab-background:#1E1E1E;--tab-color:#ffffff;--inactive-tab-background:#2D2D2D;--inactive-tab-color:#ffffff80;--tab-bottom-border:#1E1E1E;color-scheme:dark"><style>
  [data-bright-theme] ::selection { background-color: var(--selection-background) }
  [data-bright-theme] [data-bright-ln] { 
    color: var(--line-number-color); 
    margin-right: 1.5ch; 
    display: inline-block;
    text-align: right;
    user-select: none;
  }
  </style><pre style="margin:0;color:#D4D4D4;background:#1E1E1E;padding:1em 0;overflow:auto"><code style="display:block;min-width:fit-content"><div style="padding:0 1em"><span><span data-bright-ln="1" style="width:1ch">1</span><span style="color:#6A9955"># Framework error:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="2" style="width:1ch">2</span><span style="color:#D4D4D4">AgentError: Tool execution failed: SQLToolkit.query failed </span><span style="color:#C586C0">with</span><span style="color:#D4D4D4"> error:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="3" style="width:1ch">3</span><span style="color:#D4D4D4">Invalid chain configuration...</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="4" style="width:1ch">4</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="5" style="width:1ch">5</span><span style="color:#6A9955"># Without framework:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="6" style="width:1ch">6</span><span style="color:#C586C0">try</span><span style="color:#D4D4D4">:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="7" style="width:1ch">7</span><span style="color:#D4D4D4">    data = execute_query(query)</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="8" style="width:1ch">8</span><span style="color:#C586C0">except</span><span style="color:#D4D4D4"> SQLException </span><span style="color:#C586C0">as</span><span style="color:#D4D4D4"> e:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="9" style="width:1ch">9</span><span style="color:#DCDCAA">    print</span><span style="color:#D4D4D4">(</span><span style="color:#569CD6">f</span><span style="color:#CE9178">&quot;SQL error: </span><span style="color:#569CD6">{</span><span style="color:#D4D4D4">e</span><span style="color:#569CD6">}</span><span style="color:#CE9178">&quot;</span><span style="color:#D4D4D4">)  </span><span style="color:#6A9955"># Clear what went wrong</span><br/></span></div></code></pre></div></pre>
<div class="text-secondary-400 hover:text-secondary-600 border-2 border-gray-400 px-4 rounded bg-gray-100">
<p><strong>Note:</strong> This is more or less the most prominent reason why you should
build agents without frameworks. Frameworks abstract away the core of
any AI Agent - the LLM interaction. Without adding additional
infrastructure, you don&#x27;t know the exact prompts used, the specific LLM
answers replied and the tools used. This makes debugging a nightmare.</p>
</div>
<a class="no-underline" href="#lower-learning-overhead"><h3 class="hover:text-secondary-400" id="lower-learning-overhead">Lower Learning Overhead</h3></a>
<p>Building agents requires understanding:</p>
<ul>
<li>LLM prompting</li>
<li>Tool integration</li>
<li>Memory management</li>
</ul>
<p>Frameworks add another layer:</p>
<ul>
<li>Framework-specific concepts</li>
<li>Configuration options</li>
<li>Integration patterns</li>
</ul>
<p>Why learn both when you only need the fundamentals?</p>
<a class="no-underline" href="#performance-and-resources"><h3 class="hover:text-secondary-400" id="performance-and-resources">Performance and Resources</h3></a>
<p>Frameworks often:</p>
<ul>
<li>Load unnecessary components</li>
<li>Add network calls</li>
<li>Include unused features</li>
</ul>
<p>Direct implementation lets you:</p>
<ul>
<li>Load only what you need</li>
<li>Optimize critical paths</li>
<li>Control resource usage</li>
</ul>
<div class="text-secondary-400 hover:text-secondary-600 border-2 border-gray-400 px-4 rounded bg-gray-100">
<p><strong>Note:</strong> Arguably, raw performance is not the most important thing for
AI agents, as the AI model interaction in itself is quite slow. So
loading some additional modules does not add up that much.</p>
</div>
<a class="no-underline" href="#when-to-use-frameworks"><h3 class="hover:text-secondary-400" id="when-to-use-frameworks">When to Use Frameworks</h3></a>
<p>Frameworks make sense when:</p>
<ul>
<li>You&#x27;re building a quick prototype</li>
<li>You need pre-built tools</li>
<li>You&#x27;re learning agent concepts initially</li>
</ul>
<p>But for production systems or when you need full control, direct
implementation is often better.</p>
<p>Let&#x27;s move on to building our agent from scratch, where you&#x27;ll see how
straightforward the direct implementation can be.</p>
<a class="no-underline" href="#building-an-ai-agent-step-by-step"><h2 class="hover:text-secondary-400" id="building-an-ai-agent-step-by-step">Building an AI Agent Step by Step</h2></a>
<p>Before we dive into the code, let&#x27;s understand what we&#x27;ll be building in
this first step. We&#x27;ll start by defining our tools - the capabilities we
want to give our agent.</p>
<a class="no-underline" href="#step-1-defining-tools"><h3 class="hover:text-secondary-400" id="step-1-defining-tools">Step 1: Defining Tools</h3></a>
<p>In this step, we&#x27;ll create two tools:</p>
<ol>
<li>A PostgreSQL query tool that allows the agent to query your database
and search for information stored in the database.</li>
<li>A Wikipedia search tool that lets the agent look up information in
Wikipedia.</li>
</ol>
<p>We can see that both tools are quite different, so depending on the users
question, the agent should be able to decide to use one of these tools.</p>
<p>When defining tools for OpenAI&#x27;s function calling, we need three
components for each tool:</p>
<ul>
<li>A schema that tells the LLM what the tool does and how to use it. This
is basically just a json description of the python function. It will get
clearer once you see the example.</li>
<li>The actual implementation of the tool (the Python function)</li>
<li>Error handling to ensure our agent behaves gracefully when things go wrong</li>
</ul>
<p>The schema is particularly important because it acts as documentation for
the LLM. Think of it as writing API documentation - the better you
describe your tools, the better the LLM will use them. Important are the
<code class="m-0 bg-gray-400">name</code> (which should match the function name), <code class="m-0 bg-gray-400">description</code> (what the
tool does) and <code class="m-0 bg-gray-400">parameters</code> (what function parameter values we need).</p>
<p>For our database tool, we&#x27;ll:</p>
<ul>
<li>Allow only SELECT queries for safety</li>
<li>Return results as JSON for easy parsing</li>
<li>Include error handling for database connection issues</li>
</ul>
<p>For the Wikipedia tool, we&#x27;ll:</p>
<ul>
<li>Limit results to three sentences to keep responses concise</li>
<li>Handle disambiguation pages and missing articles</li>
<li>Return structured error messages when searches fail</li>
</ul>
<p>Here&#x27;s how we implement these tools:</p>
<pre><div data-bright-theme="dark-plus" style="color:#D4D4D4;border-radius:4px;overflow:hidden;margin:1em 0;--selection-background:#264F78;--line-number-color:#858585;--tab-border:#252526;--tab-background:#1E1E1E;--tab-color:#ffffff;--inactive-tab-background:#2D2D2D;--inactive-tab-color:#ffffff80;--tab-bottom-border:#1E1E1E;color-scheme:dark"><style>
  [data-bright-theme] ::selection { background-color: var(--selection-background) }
  [data-bright-theme] [data-bright-ln] { 
    color: var(--line-number-color); 
    margin-right: 1.5ch; 
    display: inline-block;
    text-align: right;
    user-select: none;
  }
  </style><pre style="margin:0;color:#D4D4D4;background:#1E1E1E;padding:1em 0;overflow:auto"><code style="display:block;min-width:fit-content"><div style="padding:0 1em"><span><span data-bright-ln="1" style="width:3ch">1</span><span style="color:#C586C0">import</span><span style="color:#D4D4D4"> json</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="2" style="width:3ch">2</span><span style="color:#C586C0">import</span><span style="color:#D4D4D4"> psycopg2</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="3" style="width:3ch">3</span><span style="color:#C586C0">import</span><span style="color:#D4D4D4"> wikipedia</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="4" style="width:3ch">4</span><span style="color:#C586C0">from</span><span style="color:#D4D4D4"> typing </span><span style="color:#C586C0">import</span><span style="color:#D4D4D4"> Dict, List, Any</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="5" style="width:3ch">5</span><span style="color:#C586C0">from</span><span style="color:#D4D4D4"> openai </span><span style="color:#C586C0">import</span><span style="color:#D4D4D4"> OpenAI</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="6" style="width:3ch">6</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="7" style="width:3ch">7</span><span style="color:#6A9955"># First, we define how the LLM should understand our tools</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="8" style="width:3ch">8</span><span style="color:#D4D4D4">tools = [</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="9" style="width:3ch">9</span><span style="color:#D4D4D4">    {</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="10" style="width:3ch">10</span><span style="color:#CE9178">        &quot;type&quot;</span><span style="color:#D4D4D4">: </span><span style="color:#CE9178">&quot;function&quot;</span><span style="color:#D4D4D4">,</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="11" style="width:3ch">11</span><span style="color:#CE9178">        &quot;function&quot;</span><span style="color:#D4D4D4">: {</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="12" style="width:3ch">12</span><span style="color:#CE9178">            &quot;name&quot;</span><span style="color:#D4D4D4">: </span><span style="color:#CE9178">&quot;query_database&quot;</span><span style="color:#D4D4D4">,</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="13" style="width:3ch">13</span><span style="color:#CE9178">            &quot;description&quot;</span><span style="color:#D4D4D4">: </span><span style="color:#CE9178">&quot;&quot;&quot;Execute a PostgreSQL SELECT query and return the results.</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="14" style="width:3ch">14</span><span style="color:#CE9178">                            Only SELECT queries are allowed for security reasons.</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="15" style="width:3ch">15</span><span style="color:#CE9178">                            Returns data in JSON format.&quot;&quot;&quot;</span><span style="color:#D4D4D4">,</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="16" style="width:3ch">16</span><span style="color:#CE9178">            &quot;parameters&quot;</span><span style="color:#D4D4D4">: {</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="17" style="width:3ch">17</span><span style="color:#CE9178">                &quot;type&quot;</span><span style="color:#D4D4D4">: </span><span style="color:#CE9178">&quot;object&quot;</span><span style="color:#D4D4D4">,</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="18" style="width:3ch">18</span><span style="color:#CE9178">                &quot;properties&quot;</span><span style="color:#D4D4D4">: {</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="19" style="width:3ch">19</span><span style="color:#CE9178">                    &quot;query&quot;</span><span style="color:#D4D4D4">: {</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="20" style="width:3ch">20</span><span style="color:#CE9178">                        &quot;type&quot;</span><span style="color:#D4D4D4">: </span><span style="color:#CE9178">&quot;string&quot;</span><span style="color:#D4D4D4">,</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="21" style="width:3ch">21</span><span style="color:#CE9178">                        &quot;description&quot;</span><span style="color:#D4D4D4">: </span><span style="color:#CE9178">&quot;&quot;&quot;The SQL SELECT query to execute.</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="22" style="width:3ch">22</span><span style="color:#CE9178">                                        Must start with SELECT and should not</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="23" style="width:3ch">23</span><span style="color:#CE9178">                                        contain any data modification commands.&quot;&quot;&quot;</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="24" style="width:3ch">24</span><span style="color:#D4D4D4">                    }</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="25" style="width:3ch">25</span><span style="color:#D4D4D4">                },</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="26" style="width:3ch">26</span><span style="color:#CE9178">                &quot;required&quot;</span><span style="color:#D4D4D4">: [</span><span style="color:#CE9178">&quot;query&quot;</span><span style="color:#D4D4D4">],</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="27" style="width:3ch">27</span><span style="color:#CE9178">                &quot;additionalProperties&quot;</span><span style="color:#D4D4D4">: </span><span style="color:#569CD6">False</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="28" style="width:3ch">28</span><span style="color:#D4D4D4">            },</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="29" style="width:3ch">29</span><span style="color:#CE9178">            &quot;strict&quot;</span><span style="color:#D4D4D4">: </span><span style="color:#569CD6">True</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="30" style="width:3ch">30</span><span style="color:#D4D4D4">        }</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="31" style="width:3ch">31</span><span style="color:#D4D4D4">    },</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="32" style="width:3ch">32</span><span style="color:#D4D4D4">    {</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="33" style="width:3ch">33</span><span style="color:#CE9178">        &quot;type&quot;</span><span style="color:#D4D4D4">: </span><span style="color:#CE9178">&quot;function&quot;</span><span style="color:#D4D4D4">,</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="34" style="width:3ch">34</span><span style="color:#CE9178">        &quot;function&quot;</span><span style="color:#D4D4D4">: {</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="35" style="width:3ch">35</span><span style="color:#CE9178">            &quot;name&quot;</span><span style="color:#D4D4D4">: </span><span style="color:#CE9178">&quot;search_wikipedia&quot;</span><span style="color:#D4D4D4">,</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="36" style="width:3ch">36</span><span style="color:#CE9178">            &quot;description&quot;</span><span style="color:#D4D4D4">: </span><span style="color:#CE9178">&quot;&quot;&quot;Search Wikipedia and return a concise summary.</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="37" style="width:3ch">37</span><span style="color:#CE9178">                            Returns the first three sentences of the most</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="38" style="width:3ch">38</span><span style="color:#CE9178">                            relevant article.&quot;&quot;&quot;</span><span style="color:#D4D4D4">,</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="39" style="width:3ch">39</span><span style="color:#CE9178">            &quot;parameters&quot;</span><span style="color:#D4D4D4">: {</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="40" style="width:3ch">40</span><span style="color:#CE9178">                &quot;type&quot;</span><span style="color:#D4D4D4">: </span><span style="color:#CE9178">&quot;object&quot;</span><span style="color:#D4D4D4">,</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="41" style="width:3ch">41</span><span style="color:#CE9178">                &quot;properties&quot;</span><span style="color:#D4D4D4">: {</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="42" style="width:3ch">42</span><span style="color:#CE9178">                    &quot;query&quot;</span><span style="color:#D4D4D4">: {</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="43" style="width:3ch">43</span><span style="color:#CE9178">                        &quot;type&quot;</span><span style="color:#D4D4D4">: </span><span style="color:#CE9178">&quot;string&quot;</span><span style="color:#D4D4D4">,</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="44" style="width:3ch">44</span><span style="color:#CE9178">                        &quot;description&quot;</span><span style="color:#D4D4D4">: </span><span style="color:#CE9178">&quot;The topic to search for on Wikipedia&quot;</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="45" style="width:3ch">45</span><span style="color:#D4D4D4">                    }</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="46" style="width:3ch">46</span><span style="color:#D4D4D4">                },</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="47" style="width:3ch">47</span><span style="color:#CE9178">                &quot;required&quot;</span><span style="color:#D4D4D4">: [</span><span style="color:#CE9178">&quot;query&quot;</span><span style="color:#D4D4D4">],</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="48" style="width:3ch">48</span><span style="color:#CE9178">                &quot;additionalProperties&quot;</span><span style="color:#D4D4D4">: </span><span style="color:#569CD6">False</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="49" style="width:3ch">49</span><span style="color:#D4D4D4">            },</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="50" style="width:3ch">50</span><span style="color:#CE9178">            &quot;strict&quot;</span><span style="color:#D4D4D4">: </span><span style="color:#569CD6">True</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="51" style="width:3ch">51</span><span style="color:#D4D4D4">        }</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="52" style="width:3ch">52</span><span style="color:#D4D4D4">    }</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="53" style="width:3ch">53</span><span style="color:#D4D4D4">]</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="54" style="width:3ch">54</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="55" style="width:3ch">55</span><span style="color:#6A9955"># Now implement the actual tool functions</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="56" style="width:3ch">56</span><span style="color:#569CD6">def </span><span style="color:#DCDCAA">query_database</span><span style="color:#D4D4D4">(</span><span style="color:#9CDCFE">query</span><span style="color:#D4D4D4">: </span><span style="color:#4EC9B0">str</span><span style="color:#D4D4D4">) -&gt; </span><span style="color:#4EC9B0">str</span><span style="color:#D4D4D4">:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="57" style="width:3ch">57</span><span style="color:#CE9178">    &quot;&quot;&quot;</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="58" style="width:3ch">58</span><span style="color:#CE9178">    Execute a PostgreSQL query and return results as a JSON string.</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="59" style="width:3ch">59</span><span style="color:#CE9178">    Includes safety checks and error handling.</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="60" style="width:3ch">60</span><span style="color:#CE9178">    &quot;&quot;&quot;</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="61" style="width:3ch">61</span><span style="color:#6A9955">    # Security check: Only allow SELECT queries</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="62" style="width:3ch">62</span><span style="color:#C586C0">    if </span><span style="color:#569CD6">not</span><span style="color:#D4D4D4"> query.lower().strip().startswith(</span><span style="color:#CE9178">&#x27;select&#x27;</span><span style="color:#D4D4D4">):</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="63" style="width:3ch">63</span><span style="color:#C586C0">        return</span><span style="color:#D4D4D4"> json.dumps({</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="64" style="width:3ch">64</span><span style="color:#CE9178">            &quot;error&quot;</span><span style="color:#D4D4D4">: </span><span style="color:#CE9178">&quot;Only SELECT queries are allowed for security reasons.&quot;</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="65" style="width:3ch">65</span><span style="color:#D4D4D4">        })</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="66" style="width:3ch">66</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="67" style="width:3ch">67</span><span style="color:#C586C0">    try</span><span style="color:#D4D4D4">:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="68" style="width:3ch">68</span><span style="color:#6A9955">        # You should use environment variables for these in production</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="69" style="width:3ch">69</span><span style="color:#D4D4D4">        conn = psycopg2.connect(</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="70" style="width:3ch">70</span><span style="color:#CE9178">            &quot;dbname=your_db user=your_user password=your_pass host=localhost&quot;</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="71" style="width:3ch">71</span><span style="color:#D4D4D4">        )</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="72" style="width:3ch">72</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="73" style="width:3ch">73</span><span style="color:#C586C0">        with</span><span style="color:#D4D4D4"> conn.cursor() </span><span style="color:#C586C0">as</span><span style="color:#D4D4D4"> cur:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="74" style="width:3ch">74</span><span style="color:#D4D4D4">            cur.execute(query)</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="75" style="width:3ch">75</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="76" style="width:3ch">76</span><span style="color:#6A9955">            # Get column names from cursor description</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="77" style="width:3ch">77</span><span style="color:#D4D4D4">            columns = [desc[</span><span style="color:#B5CEA8">0</span><span style="color:#D4D4D4">] </span><span style="color:#C586C0">for</span><span style="color:#D4D4D4"> desc </span><span style="color:#C586C0">in</span><span style="color:#D4D4D4"> cur.description]</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="78" style="width:3ch">78</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="79" style="width:3ch">79</span><span style="color:#6A9955">            # Fetch results and convert to list of dictionaries</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="80" style="width:3ch">80</span><span style="color:#D4D4D4">            results = []</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="81" style="width:3ch">81</span><span style="color:#C586C0">            for</span><span style="color:#D4D4D4"> row </span><span style="color:#C586C0">in</span><span style="color:#D4D4D4"> cur.fetchall():</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="82" style="width:3ch">82</span><span style="color:#D4D4D4">                results.append(</span><span style="color:#4EC9B0">dict</span><span style="color:#D4D4D4">(</span><span style="color:#DCDCAA">zip</span><span style="color:#D4D4D4">(columns, row)))</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="83" style="width:3ch">83</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="84" style="width:3ch">84</span><span style="color:#C586C0">            return</span><span style="color:#D4D4D4"> json.dumps({</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="85" style="width:3ch">85</span><span style="color:#CE9178">                &quot;success&quot;</span><span style="color:#D4D4D4">: </span><span style="color:#569CD6">True</span><span style="color:#D4D4D4">,</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="86" style="width:3ch">86</span><span style="color:#CE9178">                &quot;data&quot;</span><span style="color:#D4D4D4">: </span><span style="color:#4EC9B0">str</span><span style="color:#D4D4D4">(results),</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="87" style="width:3ch">87</span><span style="color:#CE9178">                &quot;row_count&quot;</span><span style="color:#D4D4D4">: </span><span style="color:#DCDCAA">len</span><span style="color:#D4D4D4">(results)</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="88" style="width:3ch">88</span><span style="color:#D4D4D4">            })</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="89" style="width:3ch">89</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="90" style="width:3ch">90</span><span style="color:#C586C0">    except</span><span style="color:#D4D4D4"> psycopg2.Error </span><span style="color:#C586C0">as</span><span style="color:#D4D4D4"> e:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="91" style="width:3ch">91</span><span style="color:#C586C0">        return</span><span style="color:#D4D4D4"> json.dumps({</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="92" style="width:3ch">92</span><span style="color:#CE9178">            &quot;error&quot;</span><span style="color:#D4D4D4">: </span><span style="color:#569CD6">f</span><span style="color:#CE9178">&quot;Database error: </span><span style="color:#569CD6">{</span><span style="color:#4EC9B0">str</span><span style="color:#D4D4D4">(e)</span><span style="color:#569CD6">}</span><span style="color:#CE9178">&quot;</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="93" style="width:3ch">93</span><span style="color:#D4D4D4">        })</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="94" style="width:3ch">94</span><span style="color:#C586C0">    except </span><span style="color:#4EC9B0">Exception </span><span style="color:#C586C0">as</span><span style="color:#D4D4D4"> e:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="95" style="width:3ch">95</span><span style="color:#C586C0">        return</span><span style="color:#D4D4D4"> json.dumps({</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="96" style="width:3ch">96</span><span style="color:#CE9178">            &quot;error&quot;</span><span style="color:#D4D4D4">: </span><span style="color:#569CD6">f</span><span style="color:#CE9178">&quot;Unexpected error: </span><span style="color:#569CD6">{</span><span style="color:#4EC9B0">str</span><span style="color:#D4D4D4">(e)</span><span style="color:#569CD6">}</span><span style="color:#CE9178">&quot;</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="97" style="width:3ch">97</span><span style="color:#D4D4D4">        })</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="98" style="width:3ch">98</span><span style="color:#C586C0">    finally</span><span style="color:#D4D4D4">:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="99" style="width:3ch">99</span><span style="color:#C586C0">        if </span><span style="color:#CE9178">&#x27;conn&#x27; </span><span style="color:#569CD6">in </span><span style="color:#DCDCAA">locals</span><span style="color:#D4D4D4">():</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="100" style="width:3ch">100</span><span style="color:#D4D4D4">            conn.close()</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="101" style="width:3ch">101</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="102" style="width:3ch">102</span><span style="color:#569CD6">def </span><span style="color:#DCDCAA">search_wikipedia</span><span style="color:#D4D4D4">(</span><span style="color:#9CDCFE">query</span><span style="color:#D4D4D4">: </span><span style="color:#4EC9B0">str</span><span style="color:#D4D4D4">) -&gt; </span><span style="color:#4EC9B0">str</span><span style="color:#D4D4D4">:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="103" style="width:3ch">103</span><span style="color:#CE9178">    &quot;&quot;&quot;</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="104" style="width:3ch">104</span><span style="color:#CE9178">    Search Wikipedia and return a concise summary.</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="105" style="width:3ch">105</span><span style="color:#CE9178">    Handles disambiguation and missing pages gracefully.</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="106" style="width:3ch">106</span><span style="color:#CE9178">    &quot;&quot;&quot;</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="107" style="width:3ch">107</span><span style="color:#C586C0">    try</span><span style="color:#D4D4D4">:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="108" style="width:3ch">108</span><span style="color:#6A9955">        # Try to get the most relevant page summary</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="109" style="width:3ch">109</span><span style="color:#D4D4D4">        summary = wikipedia.summary(</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="110" style="width:3ch">110</span><span style="color:#D4D4D4">            query,</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="111" style="width:3ch">111</span><span style="color:#9CDCFE">            sentences</span><span style="color:#D4D4D4">=</span><span style="color:#B5CEA8">3</span><span style="color:#D4D4D4">,</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="112" style="width:3ch">112</span><span style="color:#9CDCFE">            auto_suggest</span><span style="color:#D4D4D4">=</span><span style="color:#569CD6">True</span><span style="color:#D4D4D4">,</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="113" style="width:3ch">113</span><span style="color:#9CDCFE">            redirect</span><span style="color:#D4D4D4">=</span><span style="color:#569CD6">True</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="114" style="width:3ch">114</span><span style="color:#D4D4D4">        )</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="115" style="width:3ch">115</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="116" style="width:3ch">116</span><span style="color:#C586C0">        return</span><span style="color:#D4D4D4"> json.dumps({</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="117" style="width:3ch">117</span><span style="color:#CE9178">            &quot;success&quot;</span><span style="color:#D4D4D4">: </span><span style="color:#569CD6">True</span><span style="color:#D4D4D4">,</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="118" style="width:3ch">118</span><span style="color:#CE9178">            &quot;summary&quot;</span><span style="color:#D4D4D4">: summary,</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="119" style="width:3ch">119</span><span style="color:#CE9178">            &quot;url&quot;</span><span style="color:#D4D4D4">: wikipedia.page(query).url</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="120" style="width:3ch">120</span><span style="color:#D4D4D4">        })</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="121" style="width:3ch">121</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="122" style="width:3ch">122</span><span style="color:#C586C0">    except</span><span style="color:#D4D4D4"> wikipedia.DisambiguationError </span><span style="color:#C586C0">as</span><span style="color:#D4D4D4"> e:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="123" style="width:3ch">123</span><span style="color:#6A9955">        # Handle multiple matching pages</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="124" style="width:3ch">124</span><span style="color:#C586C0">        return</span><span style="color:#D4D4D4"> json.dumps({</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="125" style="width:3ch">125</span><span style="color:#CE9178">            &quot;error&quot;</span><span style="color:#D4D4D4">: </span><span style="color:#CE9178">&quot;Disambiguation error&quot;</span><span style="color:#D4D4D4">,</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="126" style="width:3ch">126</span><span style="color:#CE9178">            &quot;options&quot;</span><span style="color:#D4D4D4">: e.options[:</span><span style="color:#B5CEA8">5</span><span style="color:#D4D4D4">],  </span><span style="color:#6A9955"># List first 5 options</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="127" style="width:3ch">127</span><span style="color:#CE9178">            &quot;message&quot;</span><span style="color:#D4D4D4">: </span><span style="color:#CE9178">&quot;Topic is ambiguous. Please be more specific.&quot;</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="128" style="width:3ch">128</span><span style="color:#D4D4D4">        })</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="129" style="width:3ch">129</span><span style="color:#C586C0">    except</span><span style="color:#D4D4D4"> wikipedia.PageError:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="130" style="width:3ch">130</span><span style="color:#C586C0">        return</span><span style="color:#D4D4D4"> json.dumps({</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="131" style="width:3ch">131</span><span style="color:#CE9178">            &quot;error&quot;</span><span style="color:#D4D4D4">: </span><span style="color:#CE9178">&quot;Page not found&quot;</span><span style="color:#D4D4D4">,</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="132" style="width:3ch">132</span><span style="color:#CE9178">            &quot;message&quot;</span><span style="color:#D4D4D4">: </span><span style="color:#569CD6">f</span><span style="color:#CE9178">&quot;No Wikipedia article found for: </span><span style="color:#569CD6">{</span><span style="color:#D4D4D4">query</span><span style="color:#569CD6">}</span><span style="color:#CE9178">&quot;</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="133" style="width:3ch">133</span><span style="color:#D4D4D4">        })</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="134" style="width:3ch">134</span><span style="color:#C586C0">    except </span><span style="color:#4EC9B0">Exception </span><span style="color:#C586C0">as</span><span style="color:#D4D4D4"> e:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="135" style="width:3ch">135</span><span style="color:#C586C0">        return</span><span style="color:#D4D4D4"> json.dumps({</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="136" style="width:3ch">136</span><span style="color:#CE9178">            &quot;error&quot;</span><span style="color:#D4D4D4">: </span><span style="color:#CE9178">&quot;Unexpected error&quot;</span><span style="color:#D4D4D4">,</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="137" style="width:3ch">137</span><span style="color:#CE9178">            &quot;message&quot;</span><span style="color:#D4D4D4">: </span><span style="color:#4EC9B0">str</span><span style="color:#D4D4D4">(e)</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="138" style="width:3ch">138</span><span style="color:#D4D4D4">        })</span><br/></span></div></code></pre></div></pre>
<a class="no-underline" href="#step-2-creating-the-agent-class---detailed-design"><h3 class="hover:text-secondary-400" id="step-2-creating-the-agent-class---detailed-design">Step 2: Creating the Agent Class - Detailed Design</h3></a>
<p>Before implementing the code, let&#x27;s understand exactly what we&#x27;re building
and how it works:</p>
<a class="no-underline" href="#core-concept"><h4 class="hover:text-secondary-400" id="core-concept">Core Concept</h4></a>
<p>An AI agent is essentially a loop of:</p>
<ol>
<li>Receiving user input</li>
<li>Deciding whether to use tools</li>
<li>Using tools if needed</li>
<li>Formulating a response</li>
</ol>
<a class="no-underline" href="#key-components-design"><h4 class="hover:text-secondary-400" id="key-components-design">Key Components Design</h4></a>
<a class="no-underline" href="#1-message-management"><h5 class="hover:text-secondary-400" id="1-message-management">1. Message Management</h5></a>
<ul>
<li>We need to maintain a conversation history as a list of messages</li>
<li>Each message has a specific role: &#x27;user&#x27;, &#x27;assistant&#x27;, or &#x27;tool&#x27;</li>
<li>The history provides context for the LLM to make better decisions</li>
<li>Think of it like a chat application&#x27;s state management</li>
</ul>
<a class="no-underline" href="#2-tool-execution-system"><h5 class="hover:text-secondary-400" id="2-tool-execution-system">2. Tool Execution System</h5></a>
<ul>
<li>Works like a command dispatcher:<!-- -->
<ol>
<li>LLM decides to use a tool</li>
<li>We receive a structured function call</li>
<li>We map this to our actual Python functions</li>
<li>We handle the execution and any errors</li>
<li>We format the result for the LLM</li>
</ol>
</li>
</ul>
<a class="no-underline" href="#3-main-processing-loop"><h5 class="hover:text-secondary-400" id="3-main-processing-loop">3. Main Processing Loop</h5></a>
<pre><div data-bright-theme="dark-plus" style="color:#D4D4D4;border-radius:4px;overflow:hidden;margin:1em 0;--selection-background:#264F78;--line-number-color:#858585;--tab-border:#252526;--tab-background:#1E1E1E;--tab-color:#ffffff;--inactive-tab-background:#2D2D2D;--inactive-tab-color:#ffffff80;--tab-bottom-border:#1E1E1E;color-scheme:dark"><style>
  [data-bright-theme] ::selection { background-color: var(--selection-background) }
  [data-bright-theme] [data-bright-ln] { 
    color: var(--line-number-color); 
    margin-right: 1.5ch; 
    display: inline-block;
    text-align: right;
    user-select: none;
  }
  </style><pre style="margin:0;color:#D4D4D4;background:#1E1E1E;padding:1em 0;overflow:auto"><code style="display:block;min-width:fit-content"><div style="padding:0 1em"><span><span data-bright-ln="1" style="width:1ch">1</span><span>User Input → LLM Decision → [Tool Use?] → Final Response</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="2" style="width:1ch">2</span><span>                              ↓</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="3" style="width:1ch">3</span><span>                        Execute Tool(s)</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="4" style="width:1ch">4</span><span>                              ↓</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="5" style="width:1ch">5</span><span>                     Feed Results back to LLM</span><br/></span></div></code></pre></div></pre>
<a class="no-underline" href="#error-handling-strategy"><h4 class="hover:text-secondary-400" id="error-handling-strategy">Error Handling Strategy</h4></a>
<p>We need three layers of error handling:</p>
<ol>
<li>Tool-level errors (e.g., database connection failed)</li>
<li>LLM-level errors (e.g., API issues)</li>
<li>General processing errors (e.g., JSON parsing)</li>
</ol>
<a class="no-underline" href="#message-flow-example"><h4 class="hover:text-secondary-400" id="message-flow-example">Message Flow Example</h4></a>
<pre><div data-bright-theme="dark-plus" style="color:#D4D4D4;border-radius:4px;overflow:hidden;margin:1em 0;--selection-background:#264F78;--line-number-color:#858585;--tab-border:#252526;--tab-background:#1E1E1E;--tab-color:#ffffff;--inactive-tab-background:#2D2D2D;--inactive-tab-color:#ffffff80;--tab-bottom-border:#1E1E1E;color-scheme:dark"><style>
  [data-bright-theme] ::selection { background-color: var(--selection-background) }
  [data-bright-theme] [data-bright-ln] { 
    color: var(--line-number-color); 
    margin-right: 1.5ch; 
    display: inline-block;
    text-align: right;
    user-select: none;
  }
  </style><pre style="margin:0;color:#D4D4D4;background:#1E1E1E;padding:1em 0;overflow:auto"><code style="display:block;min-width:fit-content"><div style="padding:0 1em"><span><span data-bright-ln="1" style="width:2ch">1</span><span>User: &quot;How many users are in our database?&quot;</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="2" style="width:2ch">2</span><span>│</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="3" style="width:2ch">3</span><span>├─► LLM Thinks: &quot;I need to query the database&quot;</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="4" style="width:2ch">4</span><span>│    │</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="5" style="width:2ch">5</span><span>│    ├─► Calls query_database tool</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="6" style="width:2ch">6</span><span>│    │    │</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="7" style="width:2ch">7</span><span>│    │    └─► Returns user count</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="8" style="width:2ch">8</span><span>│    │</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="9" style="width:2ch">9</span><span>│    └─► Formulates final response with data</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="10" style="width:2ch">10</span><span>│</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="11" style="width:2ch">11</span><span>└─► Final Response: &quot;There are 1,234 users in the database&quot;</span><br/></span></div></code></pre></div></pre>
<p>This design allows for:</p>
<ul>
<li>Clear separation of concerns</li>
<li>Easy debugging and monitoring</li>
<li>Flexible extension with new tools</li>
<li>Robust error handling</li>
<li>Maintainable codebase</li>
</ul>
<p>Note that we implement the general agent structure as part of a loop. Meaning
that we send back the results of our tool calls to the LLM which then decides
whether to formulate a final answer or call another tool.</p>
<a class="no-underline" href="#implementation"><h4 class="hover:text-secondary-400" id="implementation">Implementation</h4></a>
<pre><div data-bright-theme="dark-plus" style="color:#D4D4D4;border-radius:4px;overflow:hidden;margin:1em 0;--selection-background:#264F78;--line-number-color:#858585;--tab-border:#252526;--tab-background:#1E1E1E;--tab-color:#ffffff;--inactive-tab-background:#2D2D2D;--inactive-tab-color:#ffffff80;--tab-bottom-border:#1E1E1E;color-scheme:dark"><style>
  [data-bright-theme] ::selection { background-color: var(--selection-background) }
  [data-bright-theme] [data-bright-ln] { 
    color: var(--line-number-color); 
    margin-right: 1.5ch; 
    display: inline-block;
    text-align: right;
    user-select: none;
  }
  </style><pre style="margin:0;color:#D4D4D4;background:#1E1E1E;padding:1em 0;overflow:auto"><code style="display:block;min-width:fit-content"><div style="padding:0 1em"><span><span data-bright-ln="1" style="width:3ch">1</span><span style="color:#C586C0">from</span><span style="color:#D4D4D4"> typing </span><span style="color:#C586C0">import</span><span style="color:#D4D4D4"> List, Dict, Optional, Any</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="2" style="width:3ch">2</span><span style="color:#C586C0">from</span><span style="color:#D4D4D4"> openai </span><span style="color:#C586C0">import</span><span style="color:#D4D4D4"> OpenAI</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="3" style="width:3ch">3</span><span style="color:#C586C0">import</span><span style="color:#D4D4D4"> json</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="4" style="width:3ch">4</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="5" style="width:3ch">5</span><span style="color:#569CD6">class </span><span style="color:#4EC9B0">Agent</span><span style="color:#D4D4D4">:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="6" style="width:3ch">6</span><span style="color:#569CD6">    def </span><span style="color:#DCDCAA">__init__</span><span style="color:#D4D4D4">(</span><span style="color:#9CDCFE">self</span><span style="color:#D4D4D4">, </span><span style="color:#9CDCFE">system_prompt</span><span style="color:#D4D4D4">: Optional[</span><span style="color:#4EC9B0">str</span><span style="color:#D4D4D4">] = </span><span style="color:#569CD6">None</span><span style="color:#D4D4D4">):</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="7" style="width:3ch">7</span><span style="color:#CE9178">        &quot;&quot;&quot;</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="8" style="width:3ch">8</span><span style="color:#CE9178">        Initialize an AI Agent with optional system prompt.</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="9" style="width:3ch">9</span><span style="color:#CE9178"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="10" style="width:3ch">10</span><span style="color:#CE9178">        Args:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="11" style="width:3ch">11</span><span style="color:#CE9178">            system_prompt: Initial instructions for the AI</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="12" style="width:3ch">12</span><span style="color:#CE9178">        &quot;&quot;&quot;</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="13" style="width:3ch">13</span><span style="color:#6A9955">        # Initialize OpenAI client - expects OPENAI_API_KEY in environment</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="14" style="width:3ch">14</span><span style="color:#569CD6">        self</span><span style="color:#D4D4D4">.client = OpenAI()</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="15" style="width:3ch">15</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="16" style="width:3ch">16</span><span style="color:#6A9955">        # Initialize conversation history</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="17" style="width:3ch">17</span><span style="color:#569CD6">        self</span><span style="color:#D4D4D4">.messages = []</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="18" style="width:3ch">18</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="19" style="width:3ch">19</span><span style="color:#6A9955">        # Set up system prompt if provided, otherwise use default</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="20" style="width:3ch">20</span><span style="color:#D4D4D4">        default_prompt = </span><span style="color:#CE9178">&quot;&quot;&quot;You are a helpful AI assistant with access to a database</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="21" style="width:3ch">21</span><span style="color:#CE9178">        and Wikipedia. Follow these rules:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="22" style="width:3ch">22</span><span style="color:#CE9178">        1. When asked about data, always check the database first</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="23" style="width:3ch">23</span><span style="color:#CE9178">        2. For general knowledge questions, use Wikipedia</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="24" style="width:3ch">24</span><span style="color:#CE9178">        3. If you&#x27;re unsure about data, query the database to verify</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="25" style="width:3ch">25</span><span style="color:#CE9178">        4. Always mention your source of information</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="26" style="width:3ch">26</span><span style="color:#CE9178">        5. If a tool returns an error, explain the error to the user clearly</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="27" style="width:3ch">27</span><span style="color:#CE9178">        &quot;&quot;&quot;</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="28" style="width:3ch">28</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="29" style="width:3ch">29</span><span style="color:#569CD6">        self</span><span style="color:#D4D4D4">.messages.append({</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="30" style="width:3ch">30</span><span style="color:#CE9178">            &quot;role&quot;</span><span style="color:#D4D4D4">: </span><span style="color:#CE9178">&quot;system&quot;</span><span style="color:#D4D4D4">,</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="31" style="width:3ch">31</span><span style="color:#CE9178">            &quot;content&quot;</span><span style="color:#D4D4D4">: system_prompt </span><span style="color:#569CD6">or</span><span style="color:#D4D4D4"> default_prompt</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="32" style="width:3ch">32</span><span style="color:#D4D4D4">        })</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="33" style="width:3ch">33</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="34" style="width:3ch">34</span><span style="color:#569CD6">    def </span><span style="color:#DCDCAA">execute_tool</span><span style="color:#D4D4D4">(</span><span style="color:#9CDCFE">self</span><span style="color:#D4D4D4">, </span><span style="color:#9CDCFE">tool_call</span><span style="color:#D4D4D4">: Any) -&gt; </span><span style="color:#4EC9B0">str</span><span style="color:#D4D4D4">:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="35" style="width:3ch">35</span><span style="color:#CE9178">        &quot;&quot;&quot;</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="36" style="width:3ch">36</span><span style="color:#CE9178">        Execute a tool based on the LLM&#x27;s decision.</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="37" style="width:3ch">37</span><span style="color:#CE9178"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="38" style="width:3ch">38</span><span style="color:#CE9178">        Args:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="39" style="width:3ch">39</span><span style="color:#CE9178">            tool_call: The function call object from OpenAI&#x27;s API</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="40" style="width:3ch">40</span><span style="color:#CE9178"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="41" style="width:3ch">41</span><span style="color:#CE9178">        Returns:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="42" style="width:3ch">42</span><span style="color:#CE9178">            str: JSON-formatted result of the tool execution</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="43" style="width:3ch">43</span><span style="color:#CE9178">        &quot;&quot;&quot;</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="44" style="width:3ch">44</span><span style="color:#C586C0">        try</span><span style="color:#D4D4D4">:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="45" style="width:3ch">45</span><span style="color:#D4D4D4">            function_name = tool_call.function.name</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="46" style="width:3ch">46</span><span style="color:#D4D4D4">            function_args = json.loads(tool_call.function.arguments)</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="47" style="width:3ch">47</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="48" style="width:3ch">48</span><span style="color:#6A9955">            # Execute the appropriate tool. Add more here as needed.</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="49" style="width:3ch">49</span><span style="color:#C586C0">            if</span><span style="color:#D4D4D4"> function_name == </span><span style="color:#CE9178">&quot;query_database&quot;</span><span style="color:#D4D4D4">:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="50" style="width:3ch">50</span><span style="color:#D4D4D4">                result = query_database(function_args[</span><span style="color:#CE9178">&quot;query&quot;</span><span style="color:#D4D4D4">])</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="51" style="width:3ch">51</span><span style="color:#C586C0">            elif</span><span style="color:#D4D4D4"> function_name == </span><span style="color:#CE9178">&quot;search_wikipedia&quot;</span><span style="color:#D4D4D4">:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="52" style="width:3ch">52</span><span style="color:#D4D4D4">                result = search_wikipedia(function_args[</span><span style="color:#CE9178">&quot;query&quot;</span><span style="color:#D4D4D4">])</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="53" style="width:3ch">53</span><span style="color:#C586C0">            else</span><span style="color:#D4D4D4">:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="54" style="width:3ch">54</span><span style="color:#D4D4D4">                result = json.dumps({</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="55" style="width:3ch">55</span><span style="color:#CE9178">                    &quot;error&quot;</span><span style="color:#D4D4D4">: </span><span style="color:#569CD6">f</span><span style="color:#CE9178">&quot;Unknown tool: </span><span style="color:#569CD6">{</span><span style="color:#D4D4D4">function_name</span><span style="color:#569CD6">}</span><span style="color:#CE9178">&quot;</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="56" style="width:3ch">56</span><span style="color:#D4D4D4">                })</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="57" style="width:3ch">57</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="58" style="width:3ch">58</span><span style="color:#C586C0">            return</span><span style="color:#D4D4D4"> result</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="59" style="width:3ch">59</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="60" style="width:3ch">60</span><span style="color:#C586C0">        except</span><span style="color:#D4D4D4"> json.JSONDecodeError:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="61" style="width:3ch">61</span><span style="color:#C586C0">            return</span><span style="color:#D4D4D4"> json.dumps({</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="62" style="width:3ch">62</span><span style="color:#CE9178">                &quot;error&quot;</span><span style="color:#D4D4D4">: </span><span style="color:#CE9178">&quot;Failed to parse tool arguments&quot;</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="63" style="width:3ch">63</span><span style="color:#D4D4D4">            })</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="64" style="width:3ch">64</span><span style="color:#C586C0">        except </span><span style="color:#4EC9B0">Exception </span><span style="color:#C586C0">as</span><span style="color:#D4D4D4"> e:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="65" style="width:3ch">65</span><span style="color:#C586C0">            return</span><span style="color:#D4D4D4"> json.dumps({</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="66" style="width:3ch">66</span><span style="color:#CE9178">                &quot;error&quot;</span><span style="color:#D4D4D4">: </span><span style="color:#569CD6">f</span><span style="color:#CE9178">&quot;Tool execution failed: </span><span style="color:#569CD6">{</span><span style="color:#4EC9B0">str</span><span style="color:#D4D4D4">(e)</span><span style="color:#569CD6">}</span><span style="color:#CE9178">&quot;</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="67" style="width:3ch">67</span><span style="color:#D4D4D4">            })</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="68" style="width:3ch">68</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="69" style="width:3ch">69</span><span style="color:#569CD6">    def </span><span style="color:#DCDCAA">process_query</span><span style="color:#D4D4D4">(</span><span style="color:#9CDCFE">self</span><span style="color:#D4D4D4">, </span><span style="color:#9CDCFE">user_input</span><span style="color:#D4D4D4">: </span><span style="color:#4EC9B0">str</span><span style="color:#D4D4D4">) -&gt; </span><span style="color:#4EC9B0">str</span><span style="color:#D4D4D4">:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="70" style="width:3ch">70</span><span style="color:#CE9178">        &quot;&quot;&quot;</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="71" style="width:3ch">71</span><span style="color:#CE9178">        Process a user query through the AI agent.</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="72" style="width:3ch">72</span><span style="color:#CE9178"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="73" style="width:3ch">73</span><span style="color:#CE9178">        Args:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="74" style="width:3ch">74</span><span style="color:#CE9178">            user_input: The user&#x27;s question or command</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="75" style="width:3ch">75</span><span style="color:#CE9178"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="76" style="width:3ch">76</span><span style="color:#CE9178">        Returns:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="77" style="width:3ch">77</span><span style="color:#CE9178">            str: The agent&#x27;s response</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="78" style="width:3ch">78</span><span style="color:#CE9178">        &quot;&quot;&quot;</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="79" style="width:3ch">79</span><span style="color:#6A9955">        # Add user input to conversation history</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="80" style="width:3ch">80</span><span style="color:#569CD6">        self</span><span style="color:#D4D4D4">.messages.append({</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="81" style="width:3ch">81</span><span style="color:#CE9178">            &quot;role&quot;</span><span style="color:#D4D4D4">: </span><span style="color:#CE9178">&quot;user&quot;</span><span style="color:#D4D4D4">,</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="82" style="width:3ch">82</span><span style="color:#CE9178">            &quot;content&quot;</span><span style="color:#D4D4D4">: user_input</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="83" style="width:3ch">83</span><span style="color:#D4D4D4">        })</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="84" style="width:3ch">84</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="85" style="width:3ch">85</span><span style="color:#C586C0">        try</span><span style="color:#D4D4D4">:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="86" style="width:3ch">86</span><span style="color:#D4D4D4">            max_iterations = </span><span style="color:#B5CEA8">5</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="87" style="width:3ch">87</span><span style="color:#D4D4D4">            current_iteration = </span><span style="color:#B5CEA8">0</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="88" style="width:3ch">88</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="89" style="width:3ch">89</span><span style="color:#C586C0">            while</span><span style="color:#D4D4D4"> current_iteration &lt; max_iterations:  </span><span style="color:#6A9955"># Limit to 5 iterations</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="90" style="width:3ch">90</span><span style="color:#D4D4D4">                current_iteration += </span><span style="color:#B5CEA8">1</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="91" style="width:3ch">91</span><span style="color:#D4D4D4">                completion = </span><span style="color:#569CD6">self</span><span style="color:#D4D4D4">.client.chat.completions.create(</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="92" style="width:3ch">92</span><span style="color:#9CDCFE">                    model</span><span style="color:#D4D4D4">=</span><span style="color:#CE9178">&quot;gpt-4o&quot;</span><span style="color:#D4D4D4">,</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="93" style="width:3ch">93</span><span style="color:#9CDCFE">                    messages</span><span style="color:#D4D4D4">=</span><span style="color:#569CD6">self</span><span style="color:#D4D4D4">.messages,</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="94" style="width:3ch">94</span><span style="color:#9CDCFE">                    tools</span><span style="color:#D4D4D4">=tools,  </span><span style="color:#6A9955"># Global tools list from Step 1</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="95" style="width:3ch">95</span><span style="color:#9CDCFE">                    tool_choice</span><span style="color:#D4D4D4">=</span><span style="color:#CE9178">&quot;auto&quot;  </span><span style="color:#6A9955"># Let the model decide when to use tools</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="96" style="width:3ch">96</span><span style="color:#D4D4D4">                )</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="97" style="width:3ch">97</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="98" style="width:3ch">98</span><span style="color:#D4D4D4">                response_message = completion.choices[</span><span style="color:#B5CEA8">0</span><span style="color:#D4D4D4">].message</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="99" style="width:3ch">99</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="100" style="width:3ch">100</span><span style="color:#6A9955">                # If no tool calls, we&#x27;re done</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="101" style="width:3ch">101</span><span style="color:#C586C0">                if </span><span style="color:#569CD6">not</span><span style="color:#D4D4D4"> response_message.tool_calls:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="102" style="width:3ch">102</span><span style="color:#569CD6">                    self</span><span style="color:#D4D4D4">.messages.append(response_message)</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="103" style="width:3ch">103</span><span style="color:#C586C0">                    return</span><span style="color:#D4D4D4"> response_message.content</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="104" style="width:3ch">104</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="105" style="width:3ch">105</span><span style="color:#6A9955">                # Add the model&#x27;s thinking to conversation history</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="106" style="width:3ch">106</span><span style="color:#569CD6">                self</span><span style="color:#D4D4D4">.messages.append(response_message)</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="107" style="width:3ch">107</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="108" style="width:3ch">108</span><span style="color:#6A9955">                # Process all tool calls</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="109" style="width:3ch">109</span><span style="color:#C586C0">                for</span><span style="color:#D4D4D4"> tool_call </span><span style="color:#C586C0">in</span><span style="color:#D4D4D4"> response_message.tool_calls:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="110" style="width:3ch">110</span><span style="color:#C586C0">                    try</span><span style="color:#D4D4D4">:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="111" style="width:3ch">111</span><span style="color:#DCDCAA">                        print</span><span style="color:#D4D4D4">(</span><span style="color:#CE9178">&quot;Tool call:&quot;</span><span style="color:#D4D4D4">, tool_call)</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="112" style="width:3ch">112</span><span style="color:#D4D4D4">                        result = </span><span style="color:#569CD6">self</span><span style="color:#D4D4D4">.execute_tool(tool_call)</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="113" style="width:3ch">113</span><span style="color:#DCDCAA">                        print</span><span style="color:#D4D4D4">(</span><span style="color:#CE9178">&quot;Tool executed......&quot;</span><span style="color:#D4D4D4">)</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="114" style="width:3ch">114</span><span style="color:#C586C0">                    except </span><span style="color:#4EC9B0">Exception </span><span style="color:#C586C0">as</span><span style="color:#D4D4D4"> e:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="115" style="width:3ch">115</span><span style="color:#DCDCAA">                        print</span><span style="color:#D4D4D4">(</span><span style="color:#CE9178">&quot;Execution failed......&quot;</span><span style="color:#D4D4D4">)</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="116" style="width:3ch">116</span><span style="color:#D4D4D4">                        result = json.dumps({</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="117" style="width:3ch">117</span><span style="color:#CE9178">                            &quot;error&quot;</span><span style="color:#D4D4D4">: </span><span style="color:#569CD6">f</span><span style="color:#CE9178">&quot;Tool execution failed: </span><span style="color:#569CD6">{</span><span style="color:#4EC9B0">str</span><span style="color:#D4D4D4">(e)</span><span style="color:#569CD6">}</span><span style="color:#CE9178">&quot;</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="118" style="width:3ch">118</span><span style="color:#D4D4D4">                        })</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="119" style="width:3ch">119</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="120" style="width:3ch">120</span><span style="color:#DCDCAA">                    print</span><span style="color:#D4D4D4">(</span><span style="color:#569CD6">f</span><span style="color:#CE9178">&quot;Tool result custom: </span><span style="color:#569CD6">{</span><span style="color:#D4D4D4">result</span><span style="color:#569CD6">}</span><span style="color:#CE9178">&quot;</span><span style="color:#D4D4D4">)</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="121" style="width:3ch">121</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="122" style="width:3ch">122</span><span style="color:#569CD6">                    self</span><span style="color:#D4D4D4">.messages.append({</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="123" style="width:3ch">123</span><span style="color:#CE9178">                        &quot;role&quot;</span><span style="color:#D4D4D4">: </span><span style="color:#CE9178">&quot;tool&quot;</span><span style="color:#D4D4D4">,</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="124" style="width:3ch">124</span><span style="color:#CE9178">                        &quot;tool_call_id&quot;</span><span style="color:#D4D4D4">: tool_call.id,</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="125" style="width:3ch">125</span><span style="color:#CE9178">                        &quot;content&quot;</span><span style="color:#D4D4D4">: </span><span style="color:#4EC9B0">str</span><span style="color:#D4D4D4">(result)</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="126" style="width:3ch">126</span><span style="color:#D4D4D4">                    })</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="127" style="width:3ch">127</span><span style="color:#DCDCAA">                    print</span><span style="color:#D4D4D4">(</span><span style="color:#CE9178">&quot;Messages:&quot;</span><span style="color:#D4D4D4">, </span><span style="color:#569CD6">self</span><span style="color:#D4D4D4">.messages)</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="128" style="width:3ch">128</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="129" style="width:3ch">129</span><span style="color:#6A9955">            # If we&#x27;ve reached max iterations, return a message indicating this</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="130" style="width:3ch">130</span><span style="color:#D4D4D4">            max_iterations_message = {</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="131" style="width:3ch">131</span><span style="color:#CE9178">                &quot;role&quot;</span><span style="color:#D4D4D4">: </span><span style="color:#CE9178">&quot;assistant&quot;</span><span style="color:#D4D4D4">,</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="132" style="width:3ch">132</span><span style="color:#CE9178">                &quot;content&quot;</span><span style="color:#D4D4D4">: </span><span style="color:#CE9178">&quot;I&#x27;ve reached the maximum number of tool calls (5) without finding a complete answer. Here&#x27;s what I know so far: &quot;</span><span style="color:#D4D4D4"> + response_message.content</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="133" style="width:3ch">133</span><span style="color:#D4D4D4">            }</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="134" style="width:3ch">134</span><span style="color:#569CD6">            self</span><span style="color:#D4D4D4">.messages.append(max_iterations_message)</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="135" style="width:3ch">135</span><span style="color:#C586C0">            return</span><span style="color:#D4D4D4"> max_iterations_message[</span><span style="color:#CE9178">&quot;content&quot;</span><span style="color:#D4D4D4">]</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="136" style="width:3ch">136</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="137" style="width:3ch">137</span><span style="color:#C586C0">        except </span><span style="color:#4EC9B0">Exception </span><span style="color:#C586C0">as</span><span style="color:#D4D4D4"> e:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="138" style="width:3ch">138</span><span style="color:#D4D4D4">            error_message = </span><span style="color:#569CD6">f</span><span style="color:#CE9178">&quot;Error processing query: </span><span style="color:#569CD6">{</span><span style="color:#4EC9B0">str</span><span style="color:#D4D4D4">(e)</span><span style="color:#569CD6">}</span><span style="color:#CE9178">&quot;</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="139" style="width:3ch">139</span><span style="color:#569CD6">            self</span><span style="color:#D4D4D4">.messages.append({</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="140" style="width:3ch">140</span><span style="color:#CE9178">                &quot;role&quot;</span><span style="color:#D4D4D4">: </span><span style="color:#CE9178">&quot;assistant&quot;</span><span style="color:#D4D4D4">,</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="141" style="width:3ch">141</span><span style="color:#CE9178">                &quot;content&quot;</span><span style="color:#D4D4D4">: error_message</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="142" style="width:3ch">142</span><span style="color:#D4D4D4">            })</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="143" style="width:3ch">143</span><span style="color:#C586C0">            return</span><span style="color:#D4D4D4"> error_message</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="144" style="width:3ch">144</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="145" style="width:3ch">145</span><span style="color:#569CD6">    def </span><span style="color:#DCDCAA">get_conversation_history</span><span style="color:#D4D4D4">(</span><span style="color:#9CDCFE">self</span><span style="color:#D4D4D4">) -&gt; List[Dict[</span><span style="color:#4EC9B0">str</span><span style="color:#D4D4D4">, </span><span style="color:#4EC9B0">str</span><span style="color:#D4D4D4">]]:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="146" style="width:3ch">146</span><span style="color:#CE9178">        &quot;&quot;&quot;</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="147" style="width:3ch">147</span><span style="color:#CE9178">        Get the current conversation history.</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="148" style="width:3ch">148</span><span style="color:#CE9178"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="149" style="width:3ch">149</span><span style="color:#CE9178">        Returns:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="150" style="width:3ch">150</span><span style="color:#CE9178">            List[Dict[str, str]]: The conversation history</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="151" style="width:3ch">151</span><span style="color:#CE9178">        &quot;&quot;&quot;</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="152" style="width:3ch">152</span><span style="color:#C586C0">        return </span><span style="color:#569CD6">self</span><span style="color:#D4D4D4">.messages</span><br/></span></div></code></pre></div></pre>
<a class="no-underline" href="#optional-step-3-adding-memory-to-our-agent"><h3 class="hover:text-secondary-400" id="optional-step-3-adding-memory-to-our-agent">(Optional) Step 3: Adding Memory to Our Agent</h3></a>
<div class="text-secondary-400 hover:text-secondary-600 border-2 border-gray-400 px-4 rounded bg-gray-100">
<p><strong>Note:</strong> Please consider whether you need memory at all. Does your
application really need to store and retrieve conversation histories?
More often than not, the answer is no! But if you do need memory, here&#x27;s
how you can add it.</p>
</div>
<p>Memory in AI agents is often overcomplicated. Let&#x27;s understand what we&#x27;re
actually trying to achieve:</p>
<a class="no-underline" href="#what-is-agent-memory"><h4 class="hover:text-secondary-400" id="what-is-agent-memory">What is Agent Memory?</h4></a>
<p>At its core, agent memory is just:</p>
<ol>
<li>Storing conversations and their context</li>
<li>Retrieving relevant information when needed</li>
<li>Summarizing past interactions when they become too long</li>
</ol>
<a class="no-underline" href="#memory-types-well-implement"><h4 class="hover:text-secondary-400" id="memory-types-well-implement">Memory Types We&#x27;ll Implement</h4></a>
<ol>
<li>
<p><strong>Conversation History</strong></p>
<ul>
<li>Store: User inputs, agent responses, tool usage results</li>
<li>Purpose: Keep track of the current conversation flow</li>
</ul>
</li>
<li>
<p><strong>Summary Memory</strong></p>
<ul>
<li>What: Periodic summaries of longer conversations</li>
<li>Why: Prevent context window overflow</li>
<li>How: Create summaries after X messages or on demand</li>
</ul>
</li>
</ol>
<a class="no-underline" href="#database-schema"><h3 class="hover:text-secondary-400" id="database-schema">Database Schema</h3></a>
<pre><div data-bright-theme="dark-plus" style="color:#D4D4D4;border-radius:4px;overflow:hidden;margin:1em 0;--selection-background:#264F78;--line-number-color:#858585;--tab-border:#252526;--tab-background:#1E1E1E;--tab-color:#ffffff;--inactive-tab-background:#2D2D2D;--inactive-tab-color:#ffffff80;--tab-bottom-border:#1E1E1E;color-scheme:dark"><style>
  [data-bright-theme] ::selection { background-color: var(--selection-background) }
  [data-bright-theme] [data-bright-ln] { 
    color: var(--line-number-color); 
    margin-right: 1.5ch; 
    display: inline-block;
    text-align: right;
    user-select: none;
  }
  </style><pre style="margin:0;color:#D4D4D4;background:#1E1E1E;padding:1em 0;overflow:auto"><code style="display:block;min-width:fit-content"><div style="padding:0 1em"><span><span data-bright-ln="1" style="width:2ch">1</span><span style="color:#569CD6">CREATE TABLE </span><span style="color:#DCDCAA">conversations</span><span style="color:#D4D4D4"> (</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="2" style="width:2ch">2</span><span style="color:#D4D4D4">    id </span><span style="color:#569CD6">SERIAL PRIMARY KEY</span><span style="color:#D4D4D4">,</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="3" style="width:2ch">3</span><span style="color:#D4D4D4">    session_id UUID,</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="4" style="width:2ch">4</span><span style="color:#D4D4D4">    user_input </span><span style="color:#569CD6">TEXT</span><span style="color:#D4D4D4">,</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="5" style="width:2ch">5</span><span style="color:#D4D4D4">    agent_response </span><span style="color:#569CD6">TEXT</span><span style="color:#D4D4D4">,</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="6" style="width:2ch">6</span><span style="color:#D4D4D4">    tool_calls JSONB,  </span><span style="color:#6A9955">-- Store tool usage</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="7" style="width:2ch">7</span><span style="color:#569CD6">    timestamp TIMESTAMPTZ DEFAULT NOW</span><span style="color:#D4D4D4">()</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="8" style="width:2ch">8</span><span style="color:#D4D4D4">);</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="9" style="width:2ch">9</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="10" style="width:2ch">10</span><span style="color:#569CD6">CREATE TABLE </span><span style="color:#DCDCAA">conversation_summaries</span><span style="color:#D4D4D4"> (</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="11" style="width:2ch">11</span><span style="color:#D4D4D4">    id </span><span style="color:#569CD6">SERIAL PRIMARY KEY</span><span style="color:#D4D4D4">,</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="12" style="width:2ch">12</span><span style="color:#D4D4D4">    session_id UUID,</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="13" style="width:2ch">13</span><span style="color:#D4D4D4">    summary </span><span style="color:#569CD6">TEXT</span><span style="color:#D4D4D4">,</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="14" style="width:2ch">14</span><span style="color:#D4D4D4">    start_time </span><span style="color:#569CD6">TIMESTAMPTZ</span><span style="color:#D4D4D4">,</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="15" style="width:2ch">15</span><span style="color:#D4D4D4">    end_time </span><span style="color:#569CD6">TIMESTAMPTZ</span><span style="color:#D4D4D4">,</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="16" style="width:2ch">16</span><span style="color:#D4D4D4">    message_count </span><span style="color:#569CD6">INTEGER</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="17" style="width:2ch">17</span><span style="color:#D4D4D4">);</span><br/></span></div></code></pre></div></pre>
<a class="no-underline" href="#memory-flow"><h4 class="hover:text-secondary-400" id="memory-flow">Memory Flow</h4></a>
<pre><div data-bright-theme="dark-plus" style="color:#D4D4D4;border-radius:4px;overflow:hidden;margin:1em 0;--selection-background:#264F78;--line-number-color:#858585;--tab-border:#252526;--tab-background:#1E1E1E;--tab-color:#ffffff;--inactive-tab-background:#2D2D2D;--inactive-tab-color:#ffffff80;--tab-bottom-border:#1E1E1E;color-scheme:dark"><style>
  [data-bright-theme] ::selection { background-color: var(--selection-background) }
  [data-bright-theme] [data-bright-ln] { 
    color: var(--line-number-color); 
    margin-right: 1.5ch; 
    display: inline-block;
    text-align: right;
    user-select: none;
  }
  </style><pre style="margin:0;color:#D4D4D4;background:#1E1E1E;padding:1em 0;overflow:auto"><code style="display:block;min-width:fit-content"><div style="padding:0 1em"><span><span data-bright-ln="1" style="width:2ch">1</span><span>User Input ─► Store in DB ─────────────┐</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="2" style="width:2ch">2</span><span>                                       │</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="3" style="width:2ch">3</span><span>                                       ▼</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="4" style="width:2ch">4</span><span>                            Check Context Length</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="5" style="width:2ch">5</span><span>                                       │</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="6" style="width:2ch">6</span><span>                                       ▼</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="7" style="width:2ch">7</span><span>                          If too long, Summarize</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="8" style="width:2ch">8</span><span>                                       │</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="9" style="width:2ch">9</span><span>                                       ▼</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="10" style="width:2ch">10</span><span>                         Load Relevant Context</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="11" style="width:2ch">11</span><span>                                       │</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="12" style="width:2ch">12</span><span>                                       ▼</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="13" style="width:2ch">13</span><span>                           Send to LLM with</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="14" style="width:2ch">14</span><span>                           Next User Input</span><br/></span></div></code></pre></div></pre>
<a class="no-underline" href="#implementation-of-memory-for-an-ai-agent"><h4 class="hover:text-secondary-400" id="implementation-of-memory-for-an-ai-agent">Implementation of Memory for an AI Agent</h4></a>
<pre><div data-bright-theme="dark-plus" style="color:#D4D4D4;border-radius:4px;overflow:hidden;margin:1em 0;--selection-background:#264F78;--line-number-color:#858585;--tab-border:#252526;--tab-background:#1E1E1E;--tab-color:#ffffff;--inactive-tab-background:#2D2D2D;--inactive-tab-color:#ffffff80;--tab-bottom-border:#1E1E1E;color-scheme:dark"><style>
  [data-bright-theme] ::selection { background-color: var(--selection-background) }
  [data-bright-theme] [data-bright-ln] { 
    color: var(--line-number-color); 
    margin-right: 1.5ch; 
    display: inline-block;
    text-align: right;
    user-select: none;
  }
  </style><pre style="margin:0;color:#D4D4D4;background:#1E1E1E;padding:1em 0;overflow:auto"><code style="display:block;min-width:fit-content"><div style="padding:0 1em"><span><span data-bright-ln="1" style="width:3ch">1</span><span style="color:#C586C0">from</span><span style="color:#D4D4D4"> datetime </span><span style="color:#C586C0">import</span><span style="color:#D4D4D4"> datetime</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="2" style="width:3ch">2</span><span style="color:#C586C0">import</span><span style="color:#D4D4D4"> uuid</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="3" style="width:3ch">3</span><span style="color:#C586C0">from</span><span style="color:#D4D4D4"> typing </span><span style="color:#C586C0">import</span><span style="color:#D4D4D4"> List, Dict, Optional</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="4" style="width:3ch">4</span><span style="color:#C586C0">from</span><span style="color:#D4D4D4"> dataclasses </span><span style="color:#C586C0">import</span><span style="color:#D4D4D4"> dataclass</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="5" style="width:3ch">5</span><span style="color:#C586C0">import</span><span style="color:#D4D4D4"> psycopg2</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="6" style="width:3ch">6</span><span style="color:#C586C0">from</span><span style="color:#D4D4D4"> psycopg2.extras </span><span style="color:#C586C0">import</span><span style="color:#D4D4D4"> Json, UUID_adapter</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="7" style="width:3ch">7</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="8" style="width:3ch">8</span><span style="color:#DCDCAA">@dataclass</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="9" style="width:3ch">9</span><span style="color:#569CD6">class </span><span style="color:#4EC9B0">MemoryConfig</span><span style="color:#D4D4D4">:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="10" style="width:3ch">10</span><span style="color:#CE9178">    &quot;&quot;&quot;Configuration for memory management&quot;&quot;&quot;</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="11" style="width:3ch">11</span><span style="color:#D4D4D4">    max_messages: </span><span style="color:#4EC9B0">int</span><span style="color:#D4D4D4"> = </span><span style="color:#B5CEA8">20  </span><span style="color:#6A9955"># When to summarize</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="12" style="width:3ch">12</span><span style="color:#D4D4D4">    summary_length: </span><span style="color:#4EC9B0">int</span><span style="color:#D4D4D4"> = </span><span style="color:#B5CEA8">2000  </span><span style="color:#6A9955"># Max summary length in words</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="13" style="width:3ch">13</span><span style="color:#D4D4D4">    db_connection: </span><span style="color:#4EC9B0">str</span><span style="color:#D4D4D4"> = </span><span style="color:#CE9178">&quot;dbname=your_db user=your_user password=your_pass&quot;</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="14" style="width:3ch">14</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="15" style="width:3ch">15</span><span style="color:#569CD6">class </span><span style="color:#4EC9B0">AgentMemory</span><span style="color:#D4D4D4">:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="16" style="width:3ch">16</span><span style="color:#569CD6">    def </span><span style="color:#DCDCAA">__init__</span><span style="color:#D4D4D4">(</span><span style="color:#9CDCFE">self</span><span style="color:#D4D4D4">, </span><span style="color:#9CDCFE">config</span><span style="color:#D4D4D4">: Optional[MemoryConfig] = </span><span style="color:#569CD6">None</span><span style="color:#D4D4D4">):</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="17" style="width:3ch">17</span><span style="color:#569CD6">        self</span><span style="color:#D4D4D4">.config = config </span><span style="color:#569CD6">or</span><span style="color:#D4D4D4"> MemoryConfig()</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="18" style="width:3ch">18</span><span style="color:#569CD6">        self</span><span style="color:#D4D4D4">.session_id = uuid.uuid4()</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="19" style="width:3ch">19</span><span style="color:#569CD6">        self</span><span style="color:#D4D4D4">.setup_database()</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="20" style="width:3ch">20</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="21" style="width:3ch">21</span><span style="color:#569CD6">    def </span><span style="color:#DCDCAA">setup_database</span><span style="color:#D4D4D4">(</span><span style="color:#9CDCFE">self</span><span style="color:#D4D4D4">):</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="22" style="width:3ch">22</span><span style="color:#CE9178">        &quot;&quot;&quot;Create necessary database tables if they don&#x27;t exist&quot;&quot;&quot;</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="23" style="width:3ch">23</span><span style="color:#D4D4D4">        queries = [</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="24" style="width:3ch">24</span><span style="color:#CE9178">            &quot;&quot;&quot;</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="25" style="width:3ch">25</span><span style="color:#CE9178">            CREATE TABLE IF NOT EXISTS conversations (</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="26" style="width:3ch">26</span><span style="color:#CE9178">                id SERIAL PRIMARY KEY,</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="27" style="width:3ch">27</span><span style="color:#CE9178">                session_id UUID NOT NULL,</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="28" style="width:3ch">28</span><span style="color:#CE9178">                user_input TEXT NOT NULL,</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="29" style="width:3ch">29</span><span style="color:#CE9178">                agent_response TEXT NOT NULL,</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="30" style="width:3ch">30</span><span style="color:#CE9178">                tool_calls JSONB,</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="31" style="width:3ch">31</span><span style="color:#CE9178">                timestamp TIMESTAMPTZ DEFAULT NOW()</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="32" style="width:3ch">32</span><span style="color:#CE9178">            );</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="33" style="width:3ch">33</span><span style="color:#CE9178">            &quot;&quot;&quot;</span><span style="color:#D4D4D4">,</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="34" style="width:3ch">34</span><span style="color:#CE9178">            &quot;&quot;&quot;</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="35" style="width:3ch">35</span><span style="color:#CE9178">            CREATE TABLE IF NOT EXISTS conversation_summaries (</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="36" style="width:3ch">36</span><span style="color:#CE9178">                id SERIAL PRIMARY KEY,</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="37" style="width:3ch">37</span><span style="color:#CE9178">                session_id UUID NOT NULL,</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="38" style="width:3ch">38</span><span style="color:#CE9178">                summary TEXT NOT NULL,</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="39" style="width:3ch">39</span><span style="color:#CE9178">                start_time TIMESTAMPTZ NOT NULL,</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="40" style="width:3ch">40</span><span style="color:#CE9178">                end_time TIMESTAMPTZ NOT NULL,</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="41" style="width:3ch">41</span><span style="color:#CE9178">                message_count INTEGER NOT NULL</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="42" style="width:3ch">42</span><span style="color:#CE9178">            );</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="43" style="width:3ch">43</span><span style="color:#CE9178">            &quot;&quot;&quot;</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="44" style="width:3ch">44</span><span style="color:#D4D4D4">        ]</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="45" style="width:3ch">45</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="46" style="width:3ch">46</span><span style="color:#C586C0">        with</span><span style="color:#D4D4D4"> psycopg2.connect(</span><span style="color:#569CD6">self</span><span style="color:#D4D4D4">.config.db_connection) </span><span style="color:#C586C0">as</span><span style="color:#D4D4D4"> conn:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="47" style="width:3ch">47</span><span style="color:#C586C0">            with</span><span style="color:#D4D4D4"> conn.cursor() </span><span style="color:#C586C0">as</span><span style="color:#D4D4D4"> cur:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="48" style="width:3ch">48</span><span style="color:#C586C0">                for</span><span style="color:#D4D4D4"> query </span><span style="color:#C586C0">in</span><span style="color:#D4D4D4"> queries:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="49" style="width:3ch">49</span><span style="color:#D4D4D4">                    cur.execute(query)</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="50" style="width:3ch">50</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="51" style="width:3ch">51</span><span style="color:#569CD6">    def </span><span style="color:#DCDCAA">store_interaction</span><span style="color:#D4D4D4">(</span><span style="color:#9CDCFE">self</span><span style="color:#D4D4D4">,</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="52" style="width:3ch">52</span><span style="color:#9CDCFE">                         user_input</span><span style="color:#D4D4D4">: </span><span style="color:#4EC9B0">str</span><span style="color:#D4D4D4">,</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="53" style="width:3ch">53</span><span style="color:#9CDCFE">                         agent_response</span><span style="color:#D4D4D4">: </span><span style="color:#4EC9B0">str</span><span style="color:#D4D4D4">,</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="54" style="width:3ch">54</span><span style="color:#9CDCFE">                         tool_calls</span><span style="color:#D4D4D4">: Optional[List[Dict]] = </span><span style="color:#569CD6">None</span><span style="color:#D4D4D4">):</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="55" style="width:3ch">55</span><span style="color:#CE9178">        &quot;&quot;&quot;Store a single interaction in the database&quot;&quot;&quot;</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="56" style="width:3ch">56</span><span style="color:#D4D4D4">        query = </span><span style="color:#CE9178">&quot;&quot;&quot;</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="57" style="width:3ch">57</span><span style="color:#CE9178">        INSERT INTO conversations</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="58" style="width:3ch">58</span><span style="color:#CE9178">            (session_id, user_input, agent_response, tool_calls)</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="59" style="width:3ch">59</span><span style="color:#CE9178">        VALUES (</span><span style="color:#569CD6">%s</span><span style="color:#CE9178">, </span><span style="color:#569CD6">%s</span><span style="color:#CE9178">, </span><span style="color:#569CD6">%s</span><span style="color:#CE9178">, </span><span style="color:#569CD6">%s</span><span style="color:#CE9178">)</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="60" style="width:3ch">60</span><span style="color:#CE9178">        &quot;&quot;&quot;</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="61" style="width:3ch">61</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="62" style="width:3ch">62</span><span style="color:#C586C0">        with</span><span style="color:#D4D4D4"> psycopg2.connect(</span><span style="color:#569CD6">self</span><span style="color:#D4D4D4">.config.db_connection) </span><span style="color:#C586C0">as</span><span style="color:#D4D4D4"> conn:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="63" style="width:3ch">63</span><span style="color:#C586C0">            with</span><span style="color:#D4D4D4"> conn.cursor() </span><span style="color:#C586C0">as</span><span style="color:#D4D4D4"> cur:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="64" style="width:3ch">64</span><span style="color:#D4D4D4">                cur.execute(query, (</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="65" style="width:3ch">65</span><span style="color:#569CD6">                    self</span><span style="color:#D4D4D4">.session_id,</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="66" style="width:3ch">66</span><span style="color:#D4D4D4">                    user_input,</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="67" style="width:3ch">67</span><span style="color:#D4D4D4">                    agent_response,</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="68" style="width:3ch">68</span><span style="color:#D4D4D4">                    Json(tool_calls) </span><span style="color:#C586C0">if</span><span style="color:#D4D4D4"> tool_calls </span><span style="color:#C586C0">else </span><span style="color:#569CD6">None</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="69" style="width:3ch">69</span><span style="color:#D4D4D4">                ))</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="70" style="width:3ch">70</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="71" style="width:3ch">71</span><span style="color:#569CD6">    def </span><span style="color:#DCDCAA">create_summary</span><span style="color:#D4D4D4">(</span><span style="color:#9CDCFE">self</span><span style="color:#D4D4D4">, </span><span style="color:#9CDCFE">messages</span><span style="color:#D4D4D4">: List[Dict]) -&gt; </span><span style="color:#4EC9B0">str</span><span style="color:#D4D4D4">:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="72" style="width:3ch">72</span><span style="color:#CE9178">        &quot;&quot;&quot;Create a summary of messages using the LLM&quot;&quot;&quot;</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="73" style="width:3ch">73</span><span style="color:#D4D4D4">        client = OpenAI()</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="74" style="width:3ch">74</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="75" style="width:3ch">75</span><span style="color:#6A9955">        # Prepare messages for summarization</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="76" style="width:3ch">76</span><span style="color:#D4D4D4">        summary_prompt = </span><span style="color:#569CD6">f</span><span style="color:#CE9178">&quot;&quot;&quot;</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="77" style="width:3ch">77</span><span style="color:#CE9178">        Summarize the following conversation in less than </span><span style="color:#569CD6">{self</span><span style="color:#D4D4D4">.config.summary_length</span><span style="color:#569CD6">}</span><span style="color:#CE9178"> words.</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="78" style="width:3ch">78</span><span style="color:#CE9178">        Focus on key points, decisions, and important information discovered through tool usage.</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="79" style="width:3ch">79</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="80" style="width:3ch">80</span><span style="color:#CE9178">        Conversation:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="81" style="width:3ch">81</span><span style="color:#569CD6">        {</span><span style="color:#D4D4D4">messages</span><span style="color:#569CD6">}</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="82" style="width:3ch">82</span><span style="color:#CE9178">        &quot;&quot;&quot;</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="83" style="width:3ch">83</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="84" style="width:3ch">84</span><span style="color:#D4D4D4">        response = client.chat.completions.create(</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="85" style="width:3ch">85</span><span style="color:#9CDCFE">            model</span><span style="color:#D4D4D4">=</span><span style="color:#CE9178">&quot;gpt-4o&quot;</span><span style="color:#D4D4D4">,</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="86" style="width:3ch">86</span><span style="color:#9CDCFE">            messages</span><span style="color:#D4D4D4">=[{</span><span style="color:#CE9178">&quot;role&quot;</span><span style="color:#D4D4D4">: </span><span style="color:#CE9178">&quot;user&quot;</span><span style="color:#D4D4D4">, </span><span style="color:#CE9178">&quot;content&quot;</span><span style="color:#D4D4D4">: summary_prompt}]</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="87" style="width:3ch">87</span><span style="color:#D4D4D4">        )</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="88" style="width:3ch">88</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="89" style="width:3ch">89</span><span style="color:#C586C0">        return</span><span style="color:#D4D4D4"> response.choices[</span><span style="color:#B5CEA8">0</span><span style="color:#D4D4D4">].message.content</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="90" style="width:3ch">90</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="91" style="width:3ch">91</span><span style="color:#569CD6">    def </span><span style="color:#DCDCAA">store_summary</span><span style="color:#D4D4D4">(</span><span style="color:#9CDCFE">self</span><span style="color:#D4D4D4">, </span><span style="color:#9CDCFE">summary</span><span style="color:#D4D4D4">: </span><span style="color:#4EC9B0">str</span><span style="color:#D4D4D4">, </span><span style="color:#9CDCFE">start_time</span><span style="color:#D4D4D4">: datetime, </span><span style="color:#9CDCFE">end_time</span><span style="color:#D4D4D4">: datetime, </span><span style="color:#9CDCFE">message_count</span><span style="color:#D4D4D4">: </span><span style="color:#4EC9B0">int</span><span style="color:#D4D4D4">):</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="92" style="width:3ch">92</span><span style="color:#CE9178">        &quot;&quot;&quot;Store a conversation summary&quot;&quot;&quot;</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="93" style="width:3ch">93</span><span style="color:#D4D4D4">        query = </span><span style="color:#CE9178">&quot;&quot;&quot;</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="94" style="width:3ch">94</span><span style="color:#CE9178">        INSERT INTO conversation_summaries</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="95" style="width:3ch">95</span><span style="color:#CE9178">            (session_id, summary, start_time, end_time, message_count)</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="96" style="width:3ch">96</span><span style="color:#CE9178">        VALUES (</span><span style="color:#569CD6">%s</span><span style="color:#CE9178">, </span><span style="color:#569CD6">%s</span><span style="color:#CE9178">, </span><span style="color:#569CD6">%s</span><span style="color:#CE9178">, </span><span style="color:#569CD6">%s</span><span style="color:#CE9178">, </span><span style="color:#569CD6">%s</span><span style="color:#CE9178">)</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="97" style="width:3ch">97</span><span style="color:#CE9178">        &quot;&quot;&quot;</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="98" style="width:3ch">98</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="99" style="width:3ch">99</span><span style="color:#C586C0">        with</span><span style="color:#D4D4D4"> psycopg2.connect(</span><span style="color:#569CD6">self</span><span style="color:#D4D4D4">.config.db_connection) </span><span style="color:#C586C0">as</span><span style="color:#D4D4D4"> conn:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="100" style="width:3ch">100</span><span style="color:#C586C0">            with</span><span style="color:#D4D4D4"> conn.cursor() </span><span style="color:#C586C0">as</span><span style="color:#D4D4D4"> cur:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="101" style="width:3ch">101</span><span style="color:#D4D4D4">                cur.execute(query, (</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="102" style="width:3ch">102</span><span style="color:#569CD6">                    self</span><span style="color:#D4D4D4">.session_id,</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="103" style="width:3ch">103</span><span style="color:#D4D4D4">                    summary,</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="104" style="width:3ch">104</span><span style="color:#D4D4D4">                    start_time,</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="105" style="width:3ch">105</span><span style="color:#D4D4D4">                    end_time,</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="106" style="width:3ch">106</span><span style="color:#D4D4D4">                    message_count</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="107" style="width:3ch">107</span><span style="color:#D4D4D4">                ))</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="108" style="width:3ch">108</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="109" style="width:3ch">109</span><span style="color:#569CD6">    def </span><span style="color:#DCDCAA">get_recent_context</span><span style="color:#D4D4D4">(</span><span style="color:#9CDCFE">self</span><span style="color:#D4D4D4">) -&gt; </span><span style="color:#4EC9B0">str</span><span style="color:#D4D4D4">:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="110" style="width:3ch">110</span><span style="color:#CE9178">        &quot;&quot;&quot;Get recent conversations and summaries for context&quot;&quot;&quot;</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="111" style="width:3ch">111</span><span style="color:#6A9955">        # First, get the most recent summary</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="112" style="width:3ch">112</span><span style="color:#D4D4D4">        summary_query = </span><span style="color:#CE9178">&quot;&quot;&quot;</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="113" style="width:3ch">113</span><span style="color:#CE9178">        SELECT summary, end_time</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="114" style="width:3ch">114</span><span style="color:#CE9178">        FROM conversation_summaries</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="115" style="width:3ch">115</span><span style="color:#CE9178">        WHERE session_id = </span><span style="color:#569CD6">%s</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="116" style="width:3ch">116</span><span style="color:#CE9178">        ORDER BY end_time DESC</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="117" style="width:3ch">117</span><span style="color:#CE9178">        LIMIT 1</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="118" style="width:3ch">118</span><span style="color:#CE9178">        &quot;&quot;&quot;</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="119" style="width:3ch">119</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="120" style="width:3ch">120</span><span style="color:#6A9955">        # Then get conversations after the summary</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="121" style="width:3ch">121</span><span style="color:#D4D4D4">        conversations_query = </span><span style="color:#CE9178">&quot;&quot;&quot;</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="122" style="width:3ch">122</span><span style="color:#CE9178">        SELECT user_input, agent_response, tool_calls, timestamp</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="123" style="width:3ch">123</span><span style="color:#CE9178">        FROM conversations</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="124" style="width:3ch">124</span><span style="color:#CE9178">        WHERE session_id = </span><span style="color:#569CD6">%s</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="125" style="width:3ch">125</span><span style="color:#CE9178">        AND timestamp &gt; </span><span style="color:#569CD6">%s</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="126" style="width:3ch">126</span><span style="color:#CE9178">        ORDER BY timestamp ASC</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="127" style="width:3ch">127</span><span style="color:#CE9178">        &quot;&quot;&quot;</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="128" style="width:3ch">128</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="129" style="width:3ch">129</span><span style="color:#C586C0">        with</span><span style="color:#D4D4D4"> psycopg2.connect(</span><span style="color:#569CD6">self</span><span style="color:#D4D4D4">.config.db_connection) </span><span style="color:#C586C0">as</span><span style="color:#D4D4D4"> conn:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="130" style="width:3ch">130</span><span style="color:#C586C0">            with</span><span style="color:#D4D4D4"> conn.cursor() </span><span style="color:#C586C0">as</span><span style="color:#D4D4D4"> cur:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="131" style="width:3ch">131</span><span style="color:#6A9955">                # Get latest summary</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="132" style="width:3ch">132</span><span style="color:#D4D4D4">                cur.execute(summary_query, (</span><span style="color:#569CD6">self</span><span style="color:#D4D4D4">.session_id,))</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="133" style="width:3ch">133</span><span style="color:#D4D4D4">                summary_row = cur.fetchone()</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="134" style="width:3ch">134</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="135" style="width:3ch">135</span><span style="color:#C586C0">                if</span><span style="color:#D4D4D4"> summary_row:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="136" style="width:3ch">136</span><span style="color:#D4D4D4">                    summary, last_summary_time = summary_row</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="137" style="width:3ch">137</span><span style="color:#6A9955">                    # Get conversations after the summary</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="138" style="width:3ch">138</span><span style="color:#D4D4D4">                    cur.execute(conversations_query, (</span><span style="color:#569CD6">self</span><span style="color:#D4D4D4">.session_id, last_summary_time))</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="139" style="width:3ch">139</span><span style="color:#C586C0">                else</span><span style="color:#D4D4D4">:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="140" style="width:3ch">140</span><span style="color:#6A9955">                    # If no summary exists, get recent conversations</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="141" style="width:3ch">141</span><span style="color:#D4D4D4">                    cur.execute(</span><span style="color:#CE9178">&quot;&quot;&quot;</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="142" style="width:3ch">142</span><span style="color:#CE9178">                        SELECT user_input, agent_response, tool_calls, timestamp</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="143" style="width:3ch">143</span><span style="color:#CE9178">                        FROM conversations</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="144" style="width:3ch">144</span><span style="color:#CE9178">                        WHERE session_id = </span><span style="color:#569CD6">%s</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="145" style="width:3ch">145</span><span style="color:#CE9178">                        ORDER BY timestamp DESC</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="146" style="width:3ch">146</span><span style="color:#CE9178">                        LIMIT </span><span style="color:#569CD6">%s</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="147" style="width:3ch">147</span><span style="color:#CE9178">                    &quot;&quot;&quot;</span><span style="color:#D4D4D4">, (</span><span style="color:#569CD6">self</span><span style="color:#D4D4D4">.session_id, </span><span style="color:#569CD6">self</span><span style="color:#D4D4D4">.config.max_messages))</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="148" style="width:3ch">148</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="149" style="width:3ch">149</span><span style="color:#D4D4D4">                conversations = cur.fetchall()</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="150" style="width:3ch">150</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="151" style="width:3ch">151</span><span style="color:#6A9955">        # Format context</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="152" style="width:3ch">152</span><span style="color:#D4D4D4">        context = []</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="153" style="width:3ch">153</span><span style="color:#C586C0">        if</span><span style="color:#D4D4D4"> summary_row:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="154" style="width:3ch">154</span><span style="color:#D4D4D4">            context.append(</span><span style="color:#569CD6">f</span><span style="color:#CE9178">&quot;Previous conversation summary: </span><span style="color:#569CD6">{</span><span style="color:#D4D4D4">summary</span><span style="color:#569CD6">}</span><span style="color:#CE9178">&quot;</span><span style="color:#D4D4D4">)</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="155" style="width:3ch">155</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="156" style="width:3ch">156</span><span style="color:#C586C0">        for</span><span style="color:#D4D4D4"> conv </span><span style="color:#C586C0">in</span><span style="color:#D4D4D4"> conversations:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="157" style="width:3ch">157</span><span style="color:#D4D4D4">            user_input, agent_response, tool_calls, _ = conv</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="158" style="width:3ch">158</span><span style="color:#D4D4D4">            context.append(</span><span style="color:#569CD6">f</span><span style="color:#CE9178">&quot;User: </span><span style="color:#569CD6">{</span><span style="color:#D4D4D4">user_input</span><span style="color:#569CD6">}</span><span style="color:#CE9178">&quot;</span><span style="color:#D4D4D4">)</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="159" style="width:3ch">159</span><span style="color:#C586C0">            if</span><span style="color:#D4D4D4"> tool_calls:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="160" style="width:3ch">160</span><span style="color:#D4D4D4">                context.append(</span><span style="color:#569CD6">f</span><span style="color:#CE9178">&quot;Tool Usage: </span><span style="color:#569CD6">{</span><span style="color:#D4D4D4">tool_calls</span><span style="color:#569CD6">}</span><span style="color:#CE9178">&quot;</span><span style="color:#D4D4D4">)</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="161" style="width:3ch">161</span><span style="color:#D4D4D4">            context.append(</span><span style="color:#569CD6">f</span><span style="color:#CE9178">&quot;Assistant: </span><span style="color:#569CD6">{</span><span style="color:#D4D4D4">agent_response</span><span style="color:#569CD6">}</span><span style="color:#CE9178">&quot;</span><span style="color:#D4D4D4">)</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="162" style="width:3ch">162</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="163" style="width:3ch">163</span><span style="color:#C586C0">        return </span><span style="color:#CE9178">&quot;</span><span style="color:#D7BA7D">\n</span><span style="color:#CE9178">&quot;</span><span style="color:#D4D4D4">.join(context)</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="164" style="width:3ch">164</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="165" style="width:3ch">165</span><span style="color:#569CD6">    def </span><span style="color:#DCDCAA">check_and_summarize</span><span style="color:#D4D4D4">(</span><span style="color:#9CDCFE">self</span><span style="color:#D4D4D4">):</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="166" style="width:3ch">166</span><span style="color:#CE9178">        &quot;&quot;&quot;Check if we need to summarize and do it if necessary&quot;&quot;&quot;</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="167" style="width:3ch">167</span><span style="color:#D4D4D4">        query = </span><span style="color:#CE9178">&quot;&quot;&quot;</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="168" style="width:3ch">168</span><span style="color:#CE9178">        SELECT COUNT(*)</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="169" style="width:3ch">169</span><span style="color:#CE9178">        FROM conversations</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="170" style="width:3ch">170</span><span style="color:#CE9178">        WHERE session_id = </span><span style="color:#569CD6">%s</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="171" style="width:3ch">171</span><span style="color:#CE9178">        AND timestamp &gt; (</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="172" style="width:3ch">172</span><span style="color:#CE9178">            SELECT COALESCE(MAX(end_time), &#x27;1970-01-01&#x27;::timestamptz)</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="173" style="width:3ch">173</span><span style="color:#CE9178">            FROM conversation_summaries</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="174" style="width:3ch">174</span><span style="color:#CE9178">            WHERE session_id = </span><span style="color:#569CD6">%s</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="175" style="width:3ch">175</span><span style="color:#CE9178">        )</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="176" style="width:3ch">176</span><span style="color:#CE9178">        &quot;&quot;&quot;</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="177" style="width:3ch">177</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="178" style="width:3ch">178</span><span style="color:#C586C0">        with</span><span style="color:#D4D4D4"> psycopg2.connect(</span><span style="color:#569CD6">self</span><span style="color:#D4D4D4">.config.db_connection) </span><span style="color:#C586C0">as</span><span style="color:#D4D4D4"> conn:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="179" style="width:3ch">179</span><span style="color:#C586C0">            with</span><span style="color:#D4D4D4"> conn.cursor() </span><span style="color:#C586C0">as</span><span style="color:#D4D4D4"> cur:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="180" style="width:3ch">180</span><span style="color:#D4D4D4">                cur.execute(query, (</span><span style="color:#569CD6">self</span><span style="color:#D4D4D4">.session_id, </span><span style="color:#569CD6">self</span><span style="color:#D4D4D4">.session_id))</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="181" style="width:3ch">181</span><span style="color:#D4D4D4">                count = cur.fetchone()[</span><span style="color:#B5CEA8">0</span><span style="color:#D4D4D4">]</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="182" style="width:3ch">182</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="183" style="width:3ch">183</span><span style="color:#C586C0">                if</span><span style="color:#D4D4D4"> count &gt;= </span><span style="color:#569CD6">self</span><span style="color:#D4D4D4">.config.max_messages:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="184" style="width:3ch">184</span><span style="color:#6A9955">                    # Get messages to summarize</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="185" style="width:3ch">185</span><span style="color:#D4D4D4">                    cur.execute(</span><span style="color:#CE9178">&quot;&quot;&quot;</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="186" style="width:3ch">186</span><span style="color:#CE9178">                        SELECT user_input, agent_response, tool_calls, timestamp</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="187" style="width:3ch">187</span><span style="color:#CE9178">                        FROM conversations</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="188" style="width:3ch">188</span><span style="color:#CE9178">                        WHERE session_id = </span><span style="color:#569CD6">%s</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="189" style="width:3ch">189</span><span style="color:#CE9178">                        ORDER BY timestamp ASC</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="190" style="width:3ch">190</span><span style="color:#CE9178">                        LIMIT </span><span style="color:#569CD6">%s</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="191" style="width:3ch">191</span><span style="color:#CE9178">                    &quot;&quot;&quot;</span><span style="color:#D4D4D4">, (</span><span style="color:#569CD6">self</span><span style="color:#D4D4D4">.session_id, count))</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="192" style="width:3ch">192</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="193" style="width:3ch">193</span><span style="color:#D4D4D4">                    messages = cur.fetchall()</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="194" style="width:3ch">194</span><span style="color:#C586C0">                    if</span><span style="color:#D4D4D4"> messages:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="195" style="width:3ch">195</span><span style="color:#6A9955">                        # Create and store summary</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="196" style="width:3ch">196</span><span style="color:#D4D4D4">                        summary = </span><span style="color:#569CD6">self</span><span style="color:#D4D4D4">.create_summary(messages)</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="197" style="width:3ch">197</span><span style="color:#569CD6">                        self</span><span style="color:#D4D4D4">.store_summary(</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="198" style="width:3ch">198</span><span style="color:#D4D4D4">                            summary,</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="199" style="width:3ch">199</span><span style="color:#D4D4D4">                            messages[</span><span style="color:#B5CEA8">0</span><span style="color:#D4D4D4">][</span><span style="color:#B5CEA8">3</span><span style="color:#D4D4D4">],  </span><span style="color:#6A9955"># start_time</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="200" style="width:3ch">200</span><span style="color:#D4D4D4">                            messages[-</span><span style="color:#B5CEA8">1</span><span style="color:#D4D4D4">][</span><span style="color:#B5CEA8">3</span><span style="color:#D4D4D4">],  </span><span style="color:#6A9955"># end_time</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="201" style="width:3ch">201</span><span style="color:#DCDCAA">                            len</span><span style="color:#D4D4D4">(messages)</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="202" style="width:3ch">202</span><span style="color:#D4D4D4">                        )</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="203" style="width:3ch">203</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="204" style="width:3ch">204</span><span style="color:#6A9955"># Update Agent class to use memory.</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="205" style="width:3ch">205</span><span style="color:#569CD6">class </span><span style="color:#4EC9B0">MemoryAgent</span><span style="color:#D4D4D4">(</span><span style="color:#4EC9B0">Agent</span><span style="color:#D4D4D4">):</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="206" style="width:3ch">206</span><span style="color:#569CD6">    def </span><span style="color:#DCDCAA">__init__</span><span style="color:#D4D4D4">(</span><span style="color:#9CDCFE">self</span><span style="color:#D4D4D4">, </span><span style="color:#9CDCFE">memory_config</span><span style="color:#D4D4D4">: Optional[MemoryConfig] = </span><span style="color:#569CD6">None</span><span style="color:#D4D4D4">):</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="207" style="width:3ch">207</span><span style="color:#569CD6">        self</span><span style="color:#D4D4D4">.client = OpenAI()</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="208" style="width:3ch">208</span><span style="color:#569CD6">        self</span><span style="color:#D4D4D4">.memory = AgentMemory(memory_config)</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="209" style="width:3ch">209</span><span style="color:#569CD6">        self</span><span style="color:#D4D4D4">.messages = []</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="210" style="width:3ch">210</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="211" style="width:3ch">211</span><span style="color:#6A9955">        # Initialize with system prompt</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="212" style="width:3ch">212</span><span style="color:#569CD6">        self</span><span style="color:#D4D4D4">.messages.append({</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="213" style="width:3ch">213</span><span style="color:#CE9178">            &quot;role&quot;</span><span style="color:#D4D4D4">: </span><span style="color:#CE9178">&quot;system&quot;</span><span style="color:#D4D4D4">,</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="214" style="width:3ch">214</span><span style="color:#CE9178">            &quot;content&quot;</span><span style="color:#D4D4D4">: </span><span style="color:#CE9178">&quot;You are a helpful AI assistant...&quot;</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="215" style="width:3ch">215</span><span style="color:#D4D4D4">        })</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="216" style="width:3ch">216</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="217" style="width:3ch">217</span><span style="color:#569CD6">    def </span><span style="color:#DCDCAA">process_query</span><span style="color:#D4D4D4">(</span><span style="color:#9CDCFE">self</span><span style="color:#D4D4D4">, </span><span style="color:#9CDCFE">user_input</span><span style="color:#D4D4D4">: </span><span style="color:#4EC9B0">str</span><span style="color:#D4D4D4">) -&gt; </span><span style="color:#4EC9B0">str</span><span style="color:#D4D4D4">:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="218" style="width:3ch">218</span><span style="color:#C586C0">        try</span><span style="color:#D4D4D4">:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="219" style="width:3ch">219</span><span style="color:#6A9955">            # Check if we need to summarize before adding new messages</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="220" style="width:3ch">220</span><span style="color:#569CD6">            self</span><span style="color:#D4D4D4">.memory.check_and_summarize()</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="221" style="width:3ch">221</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="222" style="width:3ch">222</span><span style="color:#6A9955">            # Get context (including summaries) from memory</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="223" style="width:3ch">223</span><span style="color:#D4D4D4">            context = </span><span style="color:#569CD6">self</span><span style="color:#D4D4D4">.memory.get_recent_context()</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="224" style="width:3ch">224</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="225" style="width:3ch">225</span><span style="color:#6A9955">            # Add context to messages if it exists</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="226" style="width:3ch">226</span><span style="color:#C586C0">            if</span><span style="color:#D4D4D4"> context:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="227" style="width:3ch">227</span><span style="color:#569CD6">                self</span><span style="color:#D4D4D4">.messages = [</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="228" style="width:3ch">228</span><span style="color:#569CD6">                    self</span><span style="color:#D4D4D4">.messages[</span><span style="color:#B5CEA8">0</span><span style="color:#D4D4D4">],  </span><span style="color:#6A9955"># Keep system prompt</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="229" style="width:3ch">229</span><span style="color:#D4D4D4">                    {</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="230" style="width:3ch">230</span><span style="color:#CE9178">                        &quot;role&quot;</span><span style="color:#D4D4D4">: </span><span style="color:#CE9178">&quot;system&quot;</span><span style="color:#D4D4D4">,</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="231" style="width:3ch">231</span><span style="color:#CE9178">                        &quot;content&quot;</span><span style="color:#D4D4D4">: </span><span style="color:#569CD6">f</span><span style="color:#CE9178">&quot;Previous conversation context:</span><span style="color:#D7BA7D">\n</span><span style="color:#569CD6">{</span><span style="color:#D4D4D4">context</span><span style="color:#569CD6">}</span><span style="color:#CE9178">&quot;</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="232" style="width:3ch">232</span><span style="color:#D4D4D4">                    }</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="233" style="width:3ch">233</span><span style="color:#D4D4D4">                ]</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="234" style="width:3ch">234</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="235" style="width:3ch">235</span><span style="color:#6A9955">            # Process the query as before...</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="236" style="width:3ch">236</span><span style="color:#D4D4D4">            response = </span><span style="color:#4EC9B0">super</span><span style="color:#D4D4D4">().process_query(user_input)</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="237" style="width:3ch">237</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="238" style="width:3ch">238</span><span style="color:#6A9955">            # Store the interaction in memory</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="239" style="width:3ch">239</span><span style="color:#D4D4D4">            tool_calls = </span><span style="color:#569CD6">None</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="240" style="width:3ch">240</span><span style="color:#C586C0">            if </span><span style="color:#DCDCAA">hasattr</span><span style="color:#D4D4D4">(</span><span style="color:#569CD6">self</span><span style="color:#D4D4D4">, </span><span style="color:#CE9178">&#x27;last_tool_calls&#x27;</span><span style="color:#D4D4D4">):</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="241" style="width:3ch">241</span><span style="color:#D4D4D4">                tool_calls = </span><span style="color:#569CD6">self</span><span style="color:#D4D4D4">.last_tool_calls</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="242" style="width:3ch">242</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="243" style="width:3ch">243</span><span style="color:#569CD6">            self</span><span style="color:#D4D4D4">.memory.store_interaction(</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="244" style="width:3ch">244</span><span style="color:#9CDCFE">                user_input</span><span style="color:#D4D4D4">=user_input,</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="245" style="width:3ch">245</span><span style="color:#9CDCFE">                agent_response</span><span style="color:#D4D4D4">=response,</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="246" style="width:3ch">246</span><span style="color:#9CDCFE">                tool_calls</span><span style="color:#D4D4D4">=tool_calls</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="247" style="width:3ch">247</span><span style="color:#D4D4D4">            )</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="248" style="width:3ch">248</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="249" style="width:3ch">249</span><span style="color:#C586C0">            return</span><span style="color:#D4D4D4"> response</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="250" style="width:3ch">250</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="251" style="width:3ch">251</span><span style="color:#C586C0">        except </span><span style="color:#4EC9B0">Exception </span><span style="color:#C586C0">as</span><span style="color:#D4D4D4"> e:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="252" style="width:3ch">252</span><span style="color:#D4D4D4">            error_message = </span><span style="color:#569CD6">f</span><span style="color:#CE9178">&quot;Error processing query: </span><span style="color:#569CD6">{</span><span style="color:#4EC9B0">str</span><span style="color:#D4D4D4">(e)</span><span style="color:#569CD6">}</span><span style="color:#CE9178">&quot;</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="253" style="width:3ch">253</span><span style="color:#569CD6">            self</span><span style="color:#D4D4D4">.memory.store_interaction(</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="254" style="width:3ch">254</span><span style="color:#9CDCFE">                user_input</span><span style="color:#D4D4D4">=user_input,</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="255" style="width:3ch">255</span><span style="color:#9CDCFE">                agent_response</span><span style="color:#D4D4D4">=error_message</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="256" style="width:3ch">256</span><span style="color:#D4D4D4">            )</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="257" style="width:3ch">257</span><span style="color:#C586C0">            return</span><span style="color:#D4D4D4"> error_message</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="258" style="width:3ch">258</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="259" style="width:3ch">259</span><span style="color:#569CD6">    def </span><span style="color:#DCDCAA">execute_tool</span><span style="color:#D4D4D4">(</span><span style="color:#9CDCFE">self</span><span style="color:#D4D4D4">, </span><span style="color:#9CDCFE">tool_call</span><span style="color:#D4D4D4">: Any) -&gt; </span><span style="color:#4EC9B0">str</span><span style="color:#D4D4D4">:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="260" style="width:3ch">260</span><span style="color:#6A9955">        # Store tool calls for memory</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="261" style="width:3ch">261</span><span style="color:#C586C0">        if </span><span style="color:#569CD6">not </span><span style="color:#DCDCAA">hasattr</span><span style="color:#D4D4D4">(</span><span style="color:#569CD6">self</span><span style="color:#D4D4D4">, </span><span style="color:#CE9178">&#x27;last_tool_calls&#x27;</span><span style="color:#D4D4D4">):</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="262" style="width:3ch">262</span><span style="color:#569CD6">            self</span><span style="color:#D4D4D4">.last_tool_calls = []</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="263" style="width:3ch">263</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="264" style="width:3ch">264</span><span style="color:#D4D4D4">        result = </span><span style="color:#4EC9B0">super</span><span style="color:#D4D4D4">().execute_tool(tool_call)</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="265" style="width:3ch">265</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="266" style="width:3ch">266</span><span style="color:#6A9955">        # Store tool call information</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="267" style="width:3ch">267</span><span style="color:#569CD6">        self</span><span style="color:#D4D4D4">.last_tool_calls.append({</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="268" style="width:3ch">268</span><span style="color:#CE9178">            &#x27;tool&#x27;</span><span style="color:#D4D4D4">: tool_call.function.name,</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="269" style="width:3ch">269</span><span style="color:#CE9178">            &#x27;arguments&#x27;</span><span style="color:#D4D4D4">: tool_call.function.arguments,</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="270" style="width:3ch">270</span><span style="color:#CE9178">            &#x27;result&#x27;</span><span style="color:#D4D4D4">: result</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="271" style="width:3ch">271</span><span style="color:#D4D4D4">        })</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="272" style="width:3ch">272</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="273" style="width:3ch">273</span><span style="color:#C586C0">        return</span><span style="color:#D4D4D4"> result</span><br/></span></div></code></pre></div></pre>
<hr/>
<p>Before we continue...</p>
<h2 class="mt-0">Interested in how to train your very own Large Language Model?</h2><p>We prepared a well-researched guide for how to use the latest advancements in Open Source technology to fine-tune your own LLM. This has many advantages like:</p><ul><li>Cost control</li><li>Data privacy</li><li>Excellent performance - adjusted specifically for your intended use</li></ul><div class="flex w-full justify-center"><a class="inline-flex items-center justify-center rounded-md text-sm transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none ring-offset-background bg-primary text-primary-foreground hover:bg-primary/90 h-10 py-2 px-4 no-underline font-bold" href="../guides/train-your-own-llm">Get your free LLM training guide</a></div>
<hr/>
<a class="no-underline" href="#step-4-using-your-ai-agent"><h3 class="hover:text-secondary-400" id="step-4-using-your-ai-agent">Step 4: Using Your AI Agent</h3></a>
<p>After all the setup, using the agent is surprisingly straightforward. Here&#x27;s how:</p>
<pre><div data-bright-theme="dark-plus" style="color:#D4D4D4;border-radius:4px;overflow:hidden;margin:1em 0;--selection-background:#264F78;--line-number-color:#858585;--tab-border:#252526;--tab-background:#1E1E1E;--tab-color:#ffffff;--inactive-tab-background:#2D2D2D;--inactive-tab-color:#ffffff80;--tab-bottom-border:#1E1E1E;color-scheme:dark"><style>
  [data-bright-theme] ::selection { background-color: var(--selection-background) }
  [data-bright-theme] [data-bright-ln] { 
    color: var(--line-number-color); 
    margin-right: 1.5ch; 
    display: inline-block;
    text-align: right;
    user-select: none;
  }
  </style><pre style="margin:0;color:#D4D4D4;background:#1E1E1E;padding:1em 0;overflow:auto"><code style="display:block;min-width:fit-content"><div style="padding:0 1em"><span><span data-bright-ln="1" style="width:2ch">1</span><span style="color:#C586C0">from</span><span style="color:#D4D4D4"> your_agent </span><span style="color:#C586C0">import</span><span style="color:#D4D4D4"> Agent, MemoryConfig  </span><span style="color:#6A9955"># assuming we saved our code in your_agent.py</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="2" style="width:2ch">2</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="3" style="width:2ch">3</span><span style="color:#6A9955"># Create an agent</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="4" style="width:2ch">4</span><span style="color:#D4D4D4">agent = Agent(</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="5" style="width:2ch">5</span><span style="color:#9CDCFE">    memory_config</span><span style="color:#D4D4D4">=MemoryConfig(</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="6" style="width:2ch">6</span><span style="color:#9CDCFE">        max_messages</span><span style="color:#D4D4D4">=</span><span style="color:#B5CEA8">10</span><span style="color:#D4D4D4">,  </span><span style="color:#6A9955"># summarize after 10 messages</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="7" style="width:2ch">7</span><span style="color:#9CDCFE">        db_connection</span><span style="color:#D4D4D4">=</span><span style="color:#CE9178">&quot;postgresql://user:pass@localhost/your_db&quot;</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="8" style="width:2ch">8</span><span style="color:#D4D4D4">    )</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="9" style="width:2ch">9</span><span style="color:#D4D4D4">)</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="10" style="width:2ch">10</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="11" style="width:2ch">11</span><span style="color:#6A9955"># Simple question-answer interaction</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="12" style="width:2ch">12</span><span style="color:#569CD6">def </span><span style="color:#DCDCAA">chat_with_agent</span><span style="color:#D4D4D4">(</span><span style="color:#9CDCFE">question</span><span style="color:#D4D4D4">: </span><span style="color:#4EC9B0">str</span><span style="color:#D4D4D4">):</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="13" style="width:2ch">13</span><span style="color:#DCDCAA">    print</span><span style="color:#D4D4D4">(</span><span style="color:#569CD6">f</span><span style="color:#CE9178">&quot;</span><span style="color:#D7BA7D">\n</span><span style="color:#CE9178">User: </span><span style="color:#569CD6">{</span><span style="color:#D4D4D4">question</span><span style="color:#569CD6">}</span><span style="color:#CE9178">&quot;</span><span style="color:#D4D4D4">)</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="14" style="width:2ch">14</span><span style="color:#DCDCAA">    print</span><span style="color:#D4D4D4">(</span><span style="color:#569CD6">f</span><span style="color:#CE9178">&quot;Assistant: </span><span style="color:#569CD6">{</span><span style="color:#D4D4D4">agent.process_query(question)</span><span style="color:#569CD6">}</span><span style="color:#CE9178">&quot;</span><span style="color:#D4D4D4">)</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="15" style="width:2ch">15</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="16" style="width:2ch">16</span><span style="color:#C586C0">if </span><span style="color:#9CDCFE">__name__</span><span style="color:#D4D4D4"> == </span><span style="color:#CE9178">&quot;__main__&quot;</span><span style="color:#D4D4D4">:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="17" style="width:2ch">17</span><span style="color:#D4D4D4">    chat_with_agent(</span><span style="color:#CE9178">&quot;How many users do we have in our database?&quot;</span><span style="color:#D4D4D4">)</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="18" style="width:2ch">18</span><span style="color:#D4D4D4">    chat_with_agent(</span><span style="color:#CE9178">&quot;What&#x27;s the average age of users from New York?&quot;</span><span style="color:#D4D4D4">)</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="19" style="width:2ch">19</span><span style="color:#D4D4D4">    chat_with_agent(</span><span style="color:#CE9178">&quot;Compare our user base in California with PostgreSQL&#x27;s popularity there&quot;</span><span style="color:#D4D4D4">)</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="20" style="width:2ch">20</span><span style="color:#D4D4D4">    chat_with_agent(</span><span style="color:#CE9178">&quot;What were the numbers you just mentioned?&quot;</span><span style="color:#D4D4D4">)</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="21" style="width:2ch">21</span><span style="color:#D4D4D4">    chat_with_agent(</span><span style="color:#CE9178">&quot;What are the most interesting trends you can find in our user data?&quot;</span><span style="color:#D4D4D4">)</span><br/></span></div></code></pre></div></pre>
<p>That&#x27;s it! The agent will:</p>
<ul>
<li>Use the database when needed</li>
<li>Search Wikipedia when appropriate</li>
<li>Remember previous context</li>
<li>Create summaries automatically</li>
<li>Handle all the complexity behind the scenes - but at the same time giving us
direct debugging access</li>
</ul>
<p>The output looks clean and natural:</p>
<pre><div data-bright-theme="dark-plus" style="color:#D4D4D4;border-radius:4px;overflow:hidden;margin:1em 0;--selection-background:#264F78;--line-number-color:#858585;--tab-border:#252526;--tab-background:#1E1E1E;--tab-color:#ffffff;--inactive-tab-background:#2D2D2D;--inactive-tab-color:#ffffff80;--tab-bottom-border:#1E1E1E;color-scheme:dark"><style>
  [data-bright-theme] ::selection { background-color: var(--selection-background) }
  [data-bright-theme] [data-bright-ln] { 
    color: var(--line-number-color); 
    margin-right: 1.5ch; 
    display: inline-block;
    text-align: right;
    user-select: none;
  }
  </style><pre style="margin:0;color:#D4D4D4;background:#1E1E1E;padding:1em 0;overflow:auto"><code style="display:block;min-width:fit-content"><div style="padding:0 1em"><span><span data-bright-ln="1" style="width:1ch">1</span><span>User: How many users do we have in our database?</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="2" style="width:1ch">2</span><span>Assistant: According to the database, we currently have 10,432 registered users.</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="3" style="width:1ch">3</span><span></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="4" style="width:1ch">4</span><span>User: What&#x27;s the average age of users from New York?</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="5" style="width:1ch">5</span><span>Assistant: I&#x27;ve queried the database and found that users from New York have an average age of 31.5 years.</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="6" style="width:1ch">6</span><span></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="7" style="width:1ch">7</span><span>User: Compare our user base in California with PostgreSQL&#x27;s popularity there</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="8" style="width:1ch">8</span><span>Assistant: Let me check both sources. According to our database, we have 2,345 users from California. From Wikipedia, PostgreSQL is particularly popular in the Silicon Valley region, being used by companies like Apple, Instagram, and Reddit. In fact, many of our California users (43%) are in the tech industry, which aligns with PostgreSQL&#x27;s strong presence in the region.</span><br/></span></div></code></pre></div></pre>
<a class="no-underline" href="#enhanced-database-tool-with-schema-awareness"><h2 class="hover:text-secondary-400" id="enhanced-database-tool-with-schema-awareness">Enhanced Database Tool with Schema Awareness</h2></a>
<p>Arguably, the above PostgreSQL database tool is a little simple isn&#x27;t it?
From where should the AI model know what database columns are available?
You are right with that - we left out this crucial detail for more
clarity. We&#x27;ll modify our database tool to include schema information,
which helps the LLM understand what data is available and how to query it
correctly:</p>
<pre><div data-bright-theme="dark-plus" style="color:#D4D4D4;border-radius:4px;overflow:hidden;margin:1em 0;--selection-background:#264F78;--line-number-color:#858585;--tab-border:#252526;--tab-background:#1E1E1E;--tab-color:#ffffff;--inactive-tab-background:#2D2D2D;--inactive-tab-color:#ffffff80;--tab-bottom-border:#1E1E1E;color-scheme:dark"><style>
  [data-bright-theme] ::selection { background-color: var(--selection-background) }
  [data-bright-theme] [data-bright-ln] { 
    color: var(--line-number-color); 
    margin-right: 1.5ch; 
    display: inline-block;
    text-align: right;
    user-select: none;
  }
  </style><pre style="margin:0;color:#D4D4D4;background:#1E1E1E;padding:1em 0;overflow:auto"><code style="display:block;min-width:fit-content"><div style="padding:0 1em"><span><span data-bright-ln="1" style="width:3ch">1</span><span style="color:#569CD6">def </span><span style="color:#DCDCAA">get_database_schema</span><span style="color:#D4D4D4">() -&gt; </span><span style="color:#4EC9B0">str</span><span style="color:#D4D4D4">:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="2" style="width:3ch">2</span><span style="color:#CE9178">    &quot;&quot;&quot;Retrieve the database schema information&quot;&quot;&quot;</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="3" style="width:3ch">3</span><span style="color:#D4D4D4">    schema_query = </span><span style="color:#CE9178">&quot;&quot;&quot;</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="4" style="width:3ch">4</span><span style="color:#CE9178">    SELECT</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="5" style="width:3ch">5</span><span style="color:#CE9178">        t.table_name,</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="6" style="width:3ch">6</span><span style="color:#CE9178">        array_agg(</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="7" style="width:3ch">7</span><span style="color:#CE9178">            c.column_name || &#x27; &#x27; ||</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="8" style="width:3ch">8</span><span style="color:#CE9178">            c.data_type ||</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="9" style="width:3ch">9</span><span style="color:#CE9178">            CASE</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="10" style="width:3ch">10</span><span style="color:#CE9178">                WHEN c.is_nullable = &#x27;NO&#x27; THEN &#x27; NOT NULL&#x27;</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="11" style="width:3ch">11</span><span style="color:#CE9178">                ELSE &#x27;&#x27;</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="12" style="width:3ch">12</span><span style="color:#CE9178">            END</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="13" style="width:3ch">13</span><span style="color:#CE9178">        ) as columns</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="14" style="width:3ch">14</span><span style="color:#CE9178">    FROM information_schema.tables t</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="15" style="width:3ch">15</span><span style="color:#CE9178">    JOIN information_schema.columns c</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="16" style="width:3ch">16</span><span style="color:#CE9178">        ON c.table_name = t.table_name</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="17" style="width:3ch">17</span><span style="color:#CE9178">    WHERE t.table_schema = &#x27;public&#x27;</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="18" style="width:3ch">18</span><span style="color:#CE9178">        AND t.table_type = &#x27;BASE TABLE&#x27;</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="19" style="width:3ch">19</span><span style="color:#CE9178">    GROUP BY t.table_name;</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="20" style="width:3ch">20</span><span style="color:#CE9178">    &quot;&quot;&quot;</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="21" style="width:3ch">21</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="22" style="width:3ch">22</span><span style="color:#C586C0">    try</span><span style="color:#D4D4D4">:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="23" style="width:3ch">23</span><span style="color:#C586C0">        with</span><span style="color:#D4D4D4"> psycopg2.connect(</span><span style="color:#CE9178">&quot;dbname=your_db user=your_user password=your_pass&quot;</span><span style="color:#D4D4D4">) </span><span style="color:#C586C0">as</span><span style="color:#D4D4D4"> conn:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="24" style="width:3ch">24</span><span style="color:#C586C0">            with</span><span style="color:#D4D4D4"> conn.cursor() </span><span style="color:#C586C0">as</span><span style="color:#D4D4D4"> cur:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="25" style="width:3ch">25</span><span style="color:#D4D4D4">                cur.execute(schema_query)</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="26" style="width:3ch">26</span><span style="color:#D4D4D4">                schema = cur.fetchall()</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="27" style="width:3ch">27</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="28" style="width:3ch">28</span><span style="color:#6A9955">                # Format schema information</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="29" style="width:3ch">29</span><span style="color:#D4D4D4">                schema_str = </span><span style="color:#CE9178">&quot;Database Schema:</span><span style="color:#D7BA7D">\n</span><span style="color:#CE9178">&quot;</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="30" style="width:3ch">30</span><span style="color:#C586C0">                for</span><span style="color:#D4D4D4"> table_name, columns </span><span style="color:#C586C0">in</span><span style="color:#D4D4D4"> schema:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="31" style="width:3ch">31</span><span style="color:#D4D4D4">                    schema_str += </span><span style="color:#569CD6">f</span><span style="color:#CE9178">&quot;</span><span style="color:#D7BA7D">\n</span><span style="color:#569CD6">{</span><span style="color:#D4D4D4">table_name</span><span style="color:#569CD6">}</span><span style="color:#D7BA7D">\n</span><span style="color:#CE9178">&quot;</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="32" style="width:3ch">32</span><span style="color:#C586C0">                    for</span><span style="color:#D4D4D4"> col </span><span style="color:#C586C0">in</span><span style="color:#D4D4D4"> columns:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="33" style="width:3ch">33</span><span style="color:#D4D4D4">                        schema_str += </span><span style="color:#569CD6">f</span><span style="color:#CE9178">&quot;  - </span><span style="color:#569CD6">{</span><span style="color:#D4D4D4">col</span><span style="color:#569CD6">}</span><span style="color:#D7BA7D">\n</span><span style="color:#CE9178">&quot;</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="34" style="width:3ch">34</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="35" style="width:3ch">35</span><span style="color:#C586C0">                return</span><span style="color:#D4D4D4"> schema_str</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="36" style="width:3ch">36</span><span style="color:#C586C0">    except </span><span style="color:#4EC9B0">Exception </span><span style="color:#C586C0">as</span><span style="color:#D4D4D4"> e:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="37" style="width:3ch">37</span><span style="color:#C586C0">        return </span><span style="color:#569CD6">f</span><span style="color:#CE9178">&quot;Error fetching schema: </span><span style="color:#569CD6">{</span><span style="color:#4EC9B0">str</span><span style="color:#D4D4D4">(e)</span><span style="color:#569CD6">}</span><span style="color:#CE9178">&quot;</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="38" style="width:3ch">38</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="39" style="width:3ch">39</span><span style="color:#6A9955"># Updated tool definition with schema information;</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="40" style="width:3ch">40</span><span style="color:#6A9955"># Note that we could also dynamically fetch the schema when needed</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="41" style="width:3ch">41</span><span style="color:#D4D4D4">tools = [</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="42" style="width:3ch">42</span><span style="color:#D4D4D4">    {</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="43" style="width:3ch">43</span><span style="color:#CE9178">        &quot;type&quot;</span><span style="color:#D4D4D4">: </span><span style="color:#CE9178">&quot;function&quot;</span><span style="color:#D4D4D4">,</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="44" style="width:3ch">44</span><span style="color:#CE9178">        &quot;function&quot;</span><span style="color:#D4D4D4">: {</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="45" style="width:3ch">45</span><span style="color:#CE9178">            &quot;name&quot;</span><span style="color:#D4D4D4">: </span><span style="color:#CE9178">&quot;query_database&quot;</span><span style="color:#D4D4D4">,</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="46" style="width:3ch">46</span><span style="color:#CE9178">            &quot;description&quot;</span><span style="color:#D4D4D4">: </span><span style="color:#CE9178">&quot;&quot;&quot;Execute a PostgreSQL SELECT query and return the results.</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="47" style="width:3ch">47</span><span style="color:#CE9178">            Available tables and their schemas:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="48" style="width:3ch">48</span><span style="color:#CE9178"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="49" style="width:3ch">49</span><span style="color:#CE9178">            users</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="50" style="width:3ch">50</span><span style="color:#CE9178">              - id SERIAL PRIMARY KEY</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="51" style="width:3ch">51</span><span style="color:#CE9178">              - email VARCHAR(255) NOT NULL</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="52" style="width:3ch">52</span><span style="color:#CE9178">              - age INTEGER</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="53" style="width:3ch">53</span><span style="color:#CE9178">              - location VARCHAR(100)</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="54" style="width:3ch">54</span><span style="color:#CE9178">              - signup_date DATE NOT NULL</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="55" style="width:3ch">55</span><span style="color:#CE9178">              - last_login TIMESTAMP WITH TIME ZONE</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="56" style="width:3ch">56</span><span style="color:#CE9178">              - job_industry VARCHAR(100)</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="57" style="width:3ch">57</span><span style="color:#CE9178"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="58" style="width:3ch">58</span><span style="color:#CE9178">            user_activity</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="59" style="width:3ch">59</span><span style="color:#CE9178">              - id SERIAL PRIMARY KEY</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="60" style="width:3ch">60</span><span style="color:#CE9178">              - user_id INTEGER REFERENCES users(id)</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="61" style="width:3ch">61</span><span style="color:#CE9178">              - activity_date DATE NOT NULL</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="62" style="width:3ch">62</span><span style="color:#CE9178">              - activity_type VARCHAR(50) NOT NULL</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="63" style="width:3ch">63</span><span style="color:#CE9178">            &quot;&quot;&quot;</span><span style="color:#D4D4D4">,</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="64" style="width:3ch">64</span><span style="color:#CE9178">            &quot;parameters&quot;</span><span style="color:#D4D4D4">: {</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="65" style="width:3ch">65</span><span style="color:#CE9178">                &quot;type&quot;</span><span style="color:#D4D4D4">: </span><span style="color:#CE9178">&quot;object&quot;</span><span style="color:#D4D4D4">,</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="66" style="width:3ch">66</span><span style="color:#CE9178">                &quot;properties&quot;</span><span style="color:#D4D4D4">: {</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="67" style="width:3ch">67</span><span style="color:#CE9178">                    &quot;query&quot;</span><span style="color:#D4D4D4">: {</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="68" style="width:3ch">68</span><span style="color:#CE9178">                        &quot;type&quot;</span><span style="color:#D4D4D4">: </span><span style="color:#CE9178">&quot;string&quot;</span><span style="color:#D4D4D4">,</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="69" style="width:3ch">69</span><span style="color:#CE9178">                        &quot;description&quot;</span><span style="color:#D4D4D4">: </span><span style="color:#CE9178">&quot;The SQL SELECT query to execute. Must start with SELECT for security.&quot;</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="70" style="width:3ch">70</span><span style="color:#D4D4D4">                    }</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="71" style="width:3ch">71</span><span style="color:#D4D4D4">                },</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="72" style="width:3ch">72</span><span style="color:#CE9178">                &quot;required&quot;</span><span style="color:#D4D4D4">: [</span><span style="color:#CE9178">&quot;query&quot;</span><span style="color:#D4D4D4">],</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="73" style="width:3ch">73</span><span style="color:#CE9178">                &quot;additionalProperties&quot;</span><span style="color:#D4D4D4">: </span><span style="color:#569CD6">False</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="74" style="width:3ch">74</span><span style="color:#D4D4D4">            },</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="75" style="width:3ch">75</span><span style="color:#CE9178">            &quot;strict&quot;</span><span style="color:#D4D4D4">: </span><span style="color:#569CD6">True</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="76" style="width:3ch">76</span><span style="color:#D4D4D4">        }</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="77" style="width:3ch">77</span><span style="color:#D4D4D4">    }</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="78" style="width:3ch">78</span><span style="color:#D4D4D4">]</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="79" style="width:3ch">79</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="80" style="width:3ch">80</span><span style="color:#6A9955"># Updated database query function</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="81" style="width:3ch">81</span><span style="color:#569CD6">def </span><span style="color:#DCDCAA">query_database</span><span style="color:#D4D4D4">(</span><span style="color:#9CDCFE">query</span><span style="color:#D4D4D4">: </span><span style="color:#4EC9B0">str</span><span style="color:#D4D4D4">) -&gt; </span><span style="color:#4EC9B0">str</span><span style="color:#D4D4D4">:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="82" style="width:3ch">82</span><span style="color:#CE9178">    &quot;&quot;&quot;</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="83" style="width:3ch">83</span><span style="color:#CE9178">    Execute a PostgreSQL query with schema awareness</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="84" style="width:3ch">84</span><span style="color:#CE9178">    &quot;&quot;&quot;</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="85" style="width:3ch">85</span><span style="color:#C586C0">    if </span><span style="color:#569CD6">not</span><span style="color:#D4D4D4"> query.lower().strip().startswith(</span><span style="color:#CE9178">&#x27;select&#x27;</span><span style="color:#D4D4D4">):</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="86" style="width:3ch">86</span><span style="color:#C586C0">        return</span><span style="color:#D4D4D4"> json.dumps({</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="87" style="width:3ch">87</span><span style="color:#CE9178">            &quot;error&quot;</span><span style="color:#D4D4D4">: </span><span style="color:#CE9178">&quot;Only SELECT queries are allowed for security reasons.&quot;</span><span style="color:#D4D4D4">,</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="88" style="width:3ch">88</span><span style="color:#CE9178">            &quot;schema&quot;</span><span style="color:#D4D4D4">: get_database_schema()  </span><span style="color:#6A9955"># Return schema for reference</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="89" style="width:3ch">89</span><span style="color:#D4D4D4">        })</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="90" style="width:3ch">90</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="91" style="width:3ch">91</span><span style="color:#C586C0">    try</span><span style="color:#D4D4D4">:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="92" style="width:3ch">92</span><span style="color:#C586C0">        with</span><span style="color:#D4D4D4"> psycopg2.connect(</span><span style="color:#CE9178">&quot;dbname=your_db user=your_user password=your_pass&quot;</span><span style="color:#D4D4D4">) </span><span style="color:#C586C0">as</span><span style="color:#D4D4D4"> conn:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="93" style="width:3ch">93</span><span style="color:#C586C0">            with</span><span style="color:#D4D4D4"> conn.cursor() </span><span style="color:#C586C0">as</span><span style="color:#D4D4D4"> cur:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="94" style="width:3ch">94</span><span style="color:#D4D4D4">                cur.execute(query)</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="95" style="width:3ch">95</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="96" style="width:3ch">96</span><span style="color:#6A9955">                # Get column names from cursor description</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="97" style="width:3ch">97</span><span style="color:#D4D4D4">                columns = [desc[</span><span style="color:#B5CEA8">0</span><span style="color:#D4D4D4">] </span><span style="color:#C586C0">for</span><span style="color:#D4D4D4"> desc </span><span style="color:#C586C0">in</span><span style="color:#D4D4D4"> cur.description]</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="98" style="width:3ch">98</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="99" style="width:3ch">99</span><span style="color:#6A9955">                # Fetch results and convert to list of dictionaries</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="100" style="width:3ch">100</span><span style="color:#D4D4D4">                results = []</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="101" style="width:3ch">101</span><span style="color:#C586C0">                for</span><span style="color:#D4D4D4"> row </span><span style="color:#C586C0">in</span><span style="color:#D4D4D4"> cur.fetchall():</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="102" style="width:3ch">102</span><span style="color:#D4D4D4">                    results.append(</span><span style="color:#4EC9B0">dict</span><span style="color:#D4D4D4">(</span><span style="color:#DCDCAA">zip</span><span style="color:#D4D4D4">(columns, row)))</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="103" style="width:3ch">103</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="104" style="width:3ch">104</span><span style="color:#C586C0">                return</span><span style="color:#D4D4D4"> json.dumps({</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="105" style="width:3ch">105</span><span style="color:#CE9178">                    &quot;success&quot;</span><span style="color:#D4D4D4">: </span><span style="color:#569CD6">True</span><span style="color:#D4D4D4">,</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="106" style="width:3ch">106</span><span style="color:#CE9178">                    &quot;data&quot;</span><span style="color:#D4D4D4">: </span><span style="color:#4EC9B0">str</span><span style="color:#D4D4D4">(results),</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="107" style="width:3ch">107</span><span style="color:#CE9178">                    &quot;row_count&quot;</span><span style="color:#D4D4D4">: </span><span style="color:#DCDCAA">len</span><span style="color:#D4D4D4">(results),</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="108" style="width:3ch">108</span><span style="color:#CE9178">                    &quot;columns&quot;</span><span style="color:#D4D4D4">: columns</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="109" style="width:3ch">109</span><span style="color:#D4D4D4">                })</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="110" style="width:3ch">110</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="111" style="width:3ch">111</span><span style="color:#C586C0">    except </span><span style="color:#4EC9B0">Exception </span><span style="color:#C586C0">as</span><span style="color:#D4D4D4"> e:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="112" style="width:3ch">112</span><span style="color:#C586C0">        return</span><span style="color:#D4D4D4"> json.dumps({</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="113" style="width:3ch">113</span><span style="color:#CE9178">            &quot;error&quot;</span><span style="color:#D4D4D4">: </span><span style="color:#4EC9B0">str</span><span style="color:#D4D4D4">(e),</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="114" style="width:3ch">114</span><span style="color:#CE9178">            &quot;schema&quot;</span><span style="color:#D4D4D4">: get_database_schema()  </span><span style="color:#6A9955"># Return schema on error for help</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="115" style="width:3ch">115</span><span style="color:#D4D4D4">        })</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="116" style="width:3ch">116</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="117" style="width:3ch">117</span><span style="color:#6A9955"># Usage example:</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="118" style="width:3ch">118</span><span style="color:#D4D4D4">agent = Agent()</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="119" style="width:3ch">119</span><span style="color:#D4D4D4"></span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="120" style="width:3ch">120</span><span style="color:#6A9955"># The agent now knows about the schema and can write better queries</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="121" style="width:3ch">121</span><span style="color:#D4D4D4">response = agent.process_query(</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="122" style="width:3ch">122</span><span style="color:#CE9178">    &quot;What&#x27;s the age distribution of users by location and industry?&quot;</span><br/></span></div><div style="padding:0 1em"><span><span data-bright-ln="123" style="width:3ch">123</span><span style="color:#D4D4D4">)</span><br/></span></div></code></pre></div></pre>
<p>Key improvements:</p>
<ol>
<li>Schema information in tool description</li>
<li>Column types and constraints included</li>
<li>Schema returned on errors for better error handling</li>
<li>Detailed result structure with column names</li>
</ol>
<p>This helps the LLM:</p>
<ul>
<li>Write correct queries on the first try</li>
<li>Understand available data</li>
<li>Handle errors better</li>
<li>Provide more detailed responses</li>
</ul>
<a class="no-underline" href="#further-reading"><h2 class="hover:text-secondary-400" id="further-reading">Further Reading</h2></a>
<ul>
<li><a href="/blog/dspy-build-better-ai-systems-with-automated-prompt-optimization" class="text-secondary-400 hover:text-secondary-600">DSPy: Automatic prompt tuning and creating</a></li>
<li><a href="/blog/introduction-to-libre-chat" class="text-secondary-400 hover:text-secondary-600">Free and open source ChatGPT alternative:
LibreChat</a></li>
<li><a href="/blog/rag-with-azure-ai-search" class="text-secondary-400 hover:text-secondary-600">How to: RAG with Azure AI search</a></li>
</ul></div></article><div class="xl:max-w-6xl0 mx-auto flex max-w-xl flex-col items-center justify-center gap-10 pb-24 sm:flex-row sm:justify-between sm:gap-0"><div class="flex w-56 flex-col items-center text-center"><div class="mb-6 text-sm">More information on our managed RAG solution?</div><a class="inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none ring-offset-background bg-primary text-primary-foreground hover:bg-primary/90 h-10 py-2 px-4" href="/">To Pondhouse AI</a></div><div class="flex w-56 flex-col items-center text-center"><div class="mb-6 text-sm">More tips and tricks on how to work with AI?</div><a class="inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none ring-offset-background bg-primary text-primary-foreground hover:bg-primary/90 h-10 py-2 px-4" href="/blog">To our Blog</a></div></div></main><div class="bg-primary-800 xs:mt-20 relative mt-80 sm:mt-0"><div class="absolute inset-0 flex items-center" aria-hidden="true"><div class="w-full border-t border-gray-300"></div></div></div></div><footer class="bg-background" aria-labelledby="footer-heading"><h2 id="footer-heading" class="sr-only">Footer</h2><div class="flex w-full flex-col justify-center gap-4 border-t pb-2 pl-20 pr-6 pt-10 sm:pt-10 md:flex-row md:gap-48 md:pl-6 lg:px-8 lg:pt-10"><div class="xl:col-span-2"><svg viewBox="0 0 2400 549.99999" class="w-48 text-foreground"><g id="g17" transform="matrix(1.3333333,0,0,-1.3333333,0,2666.6667)"><g id="g19" fill="currentColor" transform="translate(-100.29087,792.49973)"><g id="g21" clip-path="url(#clipPath25)" fill="currentColor"><g id="g27" transform="translate(584.3906,1035.5625)" fill="currentColor"><path d="m 0,0 c 0,3.579 -1.079,6.466 -3.233,8.658 -2.156,2.192 -5.024,3.287 -8.603,3.287 H -24.329 V -32 h 12.493 c 3.287,0 6.082,1.167 8.384,3.506 2.302,2.337 3.452,5.151 3.452,8.439 z m -12.384,33.097 c 10.082,0 18.118,-3.179 24.11,-9.535 5.551,-6.065 8.33,-13.808 8.33,-23.233 v -19.946 c 0,-9.06 -3.162,-16.805 -9.481,-23.233 -6.32,-6.43 -13.972,-9.645 -22.959,-9.645 h -11.945 v -51.727 H -45.043 V 33.097 Z" fill="currentColor" id="path29"></path></g><g id="g31" transform="translate(662.7471,1037.9736)" fill="currentColor"><path d="m 0,0 c 0,3.288 -1.151,6.082 -3.452,8.384 -2.302,2.301 -5.097,3.452 -8.384,3.452 -3.288,0 -6.101,-1.151 -8.439,-3.452 C -22.614,6.082 -23.781,3.288 -23.781,0 v -75.18 c 0,-3.288 1.167,-6.082 3.506,-8.384 2.338,-2.301 5.151,-3.452 8.439,-3.452 3.287,0 6.082,1.151 8.384,3.452 2.301,2.302 3.452,5.096 3.452,8.384 z m -11.288,32.439 c 9.131,0 16.894,-3.216 23.288,-9.644 6.393,-6.43 9.59,-14.175 9.59,-23.233 v -74.961 c 0,-9.134 -3.216,-16.896 -9.645,-23.289 -6.429,-6.394 -14.175,-9.589 -23.233,-9.589 -9.134,0 -16.878,3.214 -23.234,9.644 -6.356,6.428 -9.535,14.174 -9.535,23.234 v 74.961 c 0,9.132 3.215,16.894 9.645,23.288 6.429,6.392 14.137,9.589 23.124,9.589" fill="currentColor" id="path33"></path></g><g id="g35" transform="translate(725.7793,1068.769)" fill="currentColor"><path d="M 0,0 27.487,-92.36 V 0 H 48.201 V -137.428 H 25.953 l -28.494,88.002 v -88.002 H -23.253 V 0 Z" fill="currentColor" id="path37"></path></g><g id="g39" transform="translate(813.2119,951.8345)" fill="currentColor"><path d="m 0,0 h 12.493 c 3.288,0 6.064,1.187 8.329,3.562 2.264,2.373 3.398,5.167 3.398,8.383 v 71.893 c 0,3.287 -1.151,6.099 -3.452,8.438 -2.302,2.338 -5.06,3.507 -8.275,3.507 H 0 Z m 44.385,12.384 c 0,-9.06 -3.179,-16.805 -9.535,-23.234 -6.356,-6.43 -14.028,-9.644 -23.014,-9.644 h -32.549 v 137.429 h 32.549 c 9.058,0 16.748,-3.216 23.069,-9.644 6.319,-6.431 9.48,-14.138 9.48,-23.124 z" fill="currentColor" id="path41"></path></g><g id="g43" transform="translate(896.498,989.5337)" fill="currentColor"><path d="M 0,0 V -58.193 H -20.713 V 79.125 H 0 V 20.823 H 24.987 V 79.125 H 45.7 V -58.193 H 24.987 V 0 Z" fill="currentColor" id="path45"></path></g><g id="g47" transform="translate(1004.5537,1037.9736)" fill="currentColor"><path d="m 0,0 c 0,3.288 -1.15,6.082 -3.452,8.384 -2.302,2.301 -5.096,3.452 -8.384,3.452 -3.288,0 -6.101,-1.151 -8.438,-3.452 C -22.613,6.082 -23.781,3.288 -23.781,0 v -75.18 c 0,-3.288 1.168,-6.082 3.507,-8.384 2.337,-2.301 5.15,-3.452 8.438,-3.452 3.288,0 6.082,1.151 8.384,3.452 C -1.15,-81.262 0,-78.468 0,-75.18 Z m -11.288,32.439 c 9.132,0 16.894,-3.216 23.288,-9.644 6.393,-6.43 9.59,-14.175 9.59,-23.233 v -74.961 c 0,-9.134 -3.216,-16.896 -9.645,-23.289 -6.429,-6.394 -14.174,-9.589 -23.233,-9.589 -9.134,0 -16.877,3.214 -23.233,9.644 -6.356,6.428 -9.535,14.174 -9.535,23.234 v 74.961 c 0,9.132 3.214,16.894 9.645,23.288 6.428,6.392 14.137,9.589 23.123,9.589" fill="currentColor" id="path49"></path></g><g id="g51" transform="translate(1076.9932,929.8062)" fill="currentColor"><path d="m 0,0 c -9.135,0 -16.878,3.178 -23.234,9.535 -6.356,6.356 -9.535,14.064 -9.535,23.124 v 106.194 h 20.275 V 32.878 c 0,-3.288 1.168,-6.083 3.507,-8.384 2.338,-2.302 5.15,-3.452 8.438,-3.452 3.288,0 6.083,1.15 8.384,3.452 2.302,2.301 3.452,5.096 3.452,8.384 v 105.975 h 21.59 V 32.659 C 32.877,23.453 29.661,15.708 23.232,9.425 16.803,3.141 9.058,0 0,0" fill="currentColor" id="path53"></path></g><g id="g55" transform="translate(1195.459,965.5332)" fill="currentColor"><path d="m 0,0 c 0.146,-9.572 -2.339,-17.754 -7.451,-24.548 -3.362,-4.603 -8.111,-7.855 -14.247,-9.754 -3.288,-1.022 -7.124,-1.534 -11.508,-1.534 -8.109,0 -14.832,2.008 -20.165,6.027 -4.457,3.288 -7.983,7.763 -10.575,13.425 -2.594,5.661 -4.11,12.146 -4.548,19.453 l 19.726,1.425 c 0.877,-8.006 2.996,-13.807 6.356,-17.405 2.483,-2.717 5.333,-4.004 8.549,-3.857 4.528,0.146 8.145,2.377 10.849,6.693 1.387,2.119 2.082,5.154 2.082,9.103 0,5.703 -2.593,11.371 -7.781,17.002 -4.092,3.875 -10.229,9.688 -18.411,17.44 -6.868,6.655 -11.726,12.615 -14.576,17.881 -3.069,5.923 -4.603,12.358 -4.603,19.305 0,12.504 4.2,21.975 12.603,28.41 5.187,3.875 11.617,5.814 19.289,5.814 7.378,0 13.699,-1.644 18.959,-4.932 4.091,-2.558 7.397,-6.137 9.918,-10.74 2.52,-4.603 4.036,-9.901 4.549,-15.891 l -19.836,-3.616 c -0.586,5.625 -2.193,10.008 -4.823,13.151 -1.901,2.263 -4.64,3.397 -8.219,3.397 -3.8,0 -6.686,-1.681 -8.658,-5.041 -1.608,-2.704 -2.412,-6.065 -2.412,-10.083 0,-6.284 2.703,-12.676 8.111,-19.178 2.045,-2.485 5.112,-5.408 9.206,-8.768 4.821,-4.018 8,-6.832 9.534,-8.438 5.113,-5.115 9.059,-10.156 11.836,-15.124 1.314,-2.339 2.373,-4.493 3.179,-6.466 C -1.095,8.255 -0.073,3.872 0,0" fill="currentColor" id="path57"></path></g><g id="g59" transform="translate(1212.6621,931.3408)" fill="currentColor"><path d="M 0,0 V 137.428 H 58.961 V 116.606 H 20.713 V 79.125 H 48.658 V 58.303 H 20.713 V 20.822 H 58.961 V 0 Z" fill="currentColor" id="path61"></path></g><g id="g63" transform="translate(1349.3164,951.8345)" fill="currentColor"><path d="m 0,0 h 12.493 c 3.288,0 6.064,1.187 8.329,3.562 2.264,2.373 3.398,5.167 3.398,8.383 v 71.893 c 0,3.287 -1.151,6.099 -3.452,8.438 -2.302,2.338 -5.06,3.507 -8.275,3.507 H 0 Z m 44.385,12.384 c 0,-9.06 -3.179,-16.805 -9.535,-23.234 -6.356,-6.43 -14.028,-9.644 -23.014,-9.644 h -32.549 v 137.429 h 32.549 c 9.058,0 16.748,-3.216 23.069,-9.644 6.319,-6.431 9.48,-14.138 9.48,-23.124 z" fill="currentColor" id="path65"></path></g><g id="g67" transform="translate(1445.4258,1037.2065)" fill="currentColor"><path d="M 0,0 -7.672,-54.139 H 7.671 Z m -10.881,-74.304 -5.032,-31.562 H -37.48 L -14.136,31.453 H 14.356 L 37.37,-105.866 H 15.592 l -4.847,31.562 z" fill="currentColor" id="path69"></path></g><g id="g71" transform="translate(1502.8525,1047.8369)" fill="currentColor"><path d="M 0,0 H -22.027 V 20.822 H 42.632 V 0 H 20.713 V -116.496 H 0 Z" fill="currentColor" id="path73"></path></g><g id="g75" transform="translate(1580.7725,1037.2065)" fill="currentColor"><path d="M 0,0 -7.672,-54.139 H 7.671 Z m -10.881,-74.304 -5.032,-31.562 H -37.48 L -14.136,31.453 H 14.356 L 37.369,-105.866 H 15.592 l -4.847,31.562 z" fill="currentColor" id="path77"></path></g><g id="g79" transform="translate(1704.9355,1037.9736)" fill="currentColor"><path d="m 0,0 c 0,3.288 -1.151,6.082 -3.452,8.384 -2.302,2.301 -5.096,3.452 -8.384,3.452 -3.288,0 -6.101,-1.151 -8.438,-3.452 C -22.614,6.082 -23.781,3.288 -23.781,0 v -75.18 c 0,-3.288 1.167,-6.082 3.507,-8.384 2.337,-2.301 5.15,-3.452 8.438,-3.452 3.288,0 6.082,1.151 8.384,3.452 2.301,2.302 3.452,5.096 3.452,8.384 z m -11.288,32.439 c 9.132,0 16.894,-3.216 23.288,-9.644 6.393,-6.43 9.589,-14.175 9.589,-23.233 v -74.961 c 0,-9.134 -3.215,-16.896 -9.644,-23.289 -6.429,-6.394 -14.174,-9.589 -23.233,-9.589 -9.134,0 -16.877,3.214 -23.233,9.644 -6.357,6.428 -9.535,14.174 -9.535,23.234 v 74.961 c 0,9.132 3.213,16.894 9.644,23.288 6.429,6.392 14.138,9.589 23.124,9.589" fill="currentColor" id="path81"></path></g><g id="g83" transform="translate(1777.2637,929.5869)" fill="currentColor"><path d="m 0,0 c -9.134,0 -16.896,3.214 -23.288,9.645 -6.394,6.428 -9.589,14.137 -9.589,23.124 v 74.96 c 0,9.132 3.214,16.895 9.645,23.289 6.427,6.392 14.172,9.589 23.232,9.589 9.133,0 16.878,-3.216 23.234,-9.644 6.356,-6.43 9.535,-14.175 9.535,-23.234 V 92.058 H 11.288 v 16.109 c 0,3.288 -1.169,6.1 -3.507,8.439 -2.339,2.337 -5.15,3.507 -8.438,3.507 -3.288,0 -6.082,-1.17 -8.384,-3.507 -2.302,-2.339 -3.452,-5.151 -3.452,-8.439 V 32.988 c 0,-3.288 1.15,-6.083 3.452,-8.384 2.302,-2.302 5.096,-3.453 8.384,-3.453 3.288,0 6.099,1.148 8.438,3.442 2.338,2.295 3.507,5.083 3.507,8.362 V 59.947 H -0.219 V 80.77 H 32.769 V 32.769 C 32.769,23.635 29.553,15.891 23.124,9.535 16.694,3.178 8.987,0 0,0" fill="currentColor" id="path85"></path></g><g id="g87" transform="translate(267.7109,952.7754)" fill="currentColor"><path d="M 0,0 -77.743,19.682 -41.331,162.375 106.774,200.263 -19.928,73.561 Z" fill="currentColor" id="path89"></path></g><g id="g91" transform="translate(384.9814,1146.3584)" fill="currentColor"><path d="m 0,0 -55.2,-58.175 73.906,-18.608 48.516,-172.491 39.415,147.707 z" fill="currentColor" id="path93"></path></g><g id="g95" transform="translate(439.8594,883.0366)" fill="currentColor"><path d="M 0,0 -19.791,77.715 -74.935,25.107 -246.734,76.015 -142.778,-36.075 Z" fill="currentColor" id="path97"></path></g></g></g></g></svg><p class="ml-3 mt-0 text-sm text-muted-foreground">We know data.</p></div><div class="mt-6 xl:mt-0"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-2 inline h-6 w-6 text-foreground" aria-hidden="true"><path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"></path><circle cx="12" cy="10" r="3"></circle></svg><span class="font-semibold leading-6 text-foreground">Location</span><ul role="list" class="space-y ml-8 mt-2 text-foreground"><li>Pondhouse Data OG</li><li>Litscherweg 10/21</li><li>6800 Feldkirch</li><li class="mt-1">Austria</li></ul></div><div><div class="mt-6 xl:mt-0"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-2 inline h-6 w-6 text-foreground" aria-hidden="true"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"></path></svg><span class="font-semibold leading-6 text-foreground">Phone</span><ul role="list" class="space-y ml-8 mt-2 text-foreground"><li>+43 650 9820448</li></ul></div><div class="mt-8 md:mt-4"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-2 inline h-6 w-6 text-foreground" aria-hidden="true"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg><span class="font-semibold leading-6 text-foreground">Links</span><ul role="list" class="ml-8 mt-2 space-y-2 text-foreground"><li class="mt-0"><a class="hover:text-muted-foreground" href="/impressum">Impressum</a></li><li class="mt-0"><a class="hover:text-muted-foreground" href="/privacy">Data Protection</a></li><li class="mt-0"><a class="hover:text-muted-foreground" href="/archive">Article-Archive</a></li></ul></div></div></div><div class="bg-primary-900 mt-4 flex items-center justify-center border-t border-foreground/10 py-8"><p class="text-xs leading-5 text-muted-foreground">© <!-- -->2025<!-- --> Pondhouse Data OG. All rights reserved.</p></div></footer><div role="region" aria-label="Notifications (F8)" tabindex="-1" style="pointer-events:none"><ol tabindex="-1" class="fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]"></ol></div></div><script src="/_next/static/chunks/webpack-820312bbcd7e5244.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0]);self.__next_f.push([2,null])</script><script>self.__next_f.push([1,"1:HL[\"/_next/static/css/4d76846517dc3f20.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"2:I[4462,[],\"\"]\n5:I[52753,[],\"\"]\n7:I[77590,[],\"\"]\n9:I[72800,[\"9160\",\"static/chunks/app/not-found-29ca1da8157aac5a.js\"],\"default\"]\nb:I[1048,[],\"\"]\n6:[\"slug\",\"ai-agents-from-scratch\",\"d\"]\nc:[]\n0:[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/4d76846517dc3f20.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}]],[\"$\",\"$L2\",null,{\"buildId\":\"gYapkKoyo3_kkOCc2T8WK\",\"assetPrefix\":\"\",\"initialCanonicalUrl\":\"/blog/ai-agents-from-scratch\",\"initialTree\":[\"\",{\"children\":[\"(other)\",{\"children\":[\"blog\",{\"children\":[[\"slug\",\"ai-agents-from-scratch\",\"d\"],{\"children\":[\"__PAGE__?{\\\"slug\\\":\\\"ai-agents-from-scratch\\\"}\",{}]}]}]}]},\"$undefined\",\"$undefined\",true],\"initialSeedData\":[\"\",{\"children\":[\"(other)\",{\"children\":[\"blog\",{\"children\":[[\"slug\",\"ai-agents-from-scratch\",\"d\"],{\"children\":[\"__PAGE__\",{},[[\"$L3\",\"$L4\"],null],null]},[\"$\",\"$L5\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"(other)\",\"children\",\"blog\",\"children\",\"$6\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L7\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":null}],null]},[\"$\",\"$L5\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"(other)\",\"children\",\"blog\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L7\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":null}],null]},[\"$L8\",null],null]},[[\"$\",\"$L5\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L7\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[\"$\",\"$L9\",null,{}],\"notFoundStyles\":[],\"styles\":null}],null],null],\"couldBeIntercepted\":false,\"initialHead\":[null,\"$La\"],\"globalErrorComponent\":\"$b\",\"missingSlots\":\"$Wc\"}]]\n"])</script><script>self.__next_f.push([1,"d:\"$Sreact.suspense\"\ne:I[20934,[\"8853\",\"static/chunks/8853-2271113113dde66c.js\",\"6475\",\"static/chunks/6475-8ce54b349539116b.js\",\"1735\",\"static/chunks/1735-43b56eb9821f0ef4.js\",\"6557\",\"static/chunks/6557-a61c6dc420c58496.js\",\"7562\",\"static/chunks/7562-46b0926241c4cd18.js\",\"5010\",\"static/chunks/5010-01983627d358362b.js\",\"1462\",\"static/chunks/1462-df42fe1a54b4ebf5.js\",\"405\",\"static/chunks/405-28c6568087d4ead7.js\",\"613\",\"static/chunks/app/(other)/layout-ecad0553ecc89178.js\"],\"PostHogPageview\"]\nf:I[20934,[\"8853\",\"static/chunks/8853-2271113113dde66c.js\",\"6475\",\"static/chunks/6475-8ce54b349539116b.js\",\"1735\",\"static/chunks/1735-43b56eb9821f0ef4.js\",\"6557\",\"static/chunks/6557-a61c6dc420c58496.js\",\"7562\",\"static/chunks/7562-46b0926241c4cd18.js\",\"5010\",\"static/chunks/5010-01983627d358362b.js\",\"1462\",\"static/chunks/1462-df42fe1a54b4ebf5.js\",\"405\",\"static/chunks/405-28c6568087d4ead7.js\",\"613\",\"static/chunks/app/(other)/layout-ecad0553ecc89178.js\"],\"PHProvider\"]\n10:I[12969,[\"8853\",\"static/chunks/8853-2271113113dde66c.js\",\"6475\",\"static/chunks/6475-8ce54b349539116b.js\",\"1735\",\"static/chunks/1735-43b56eb9821f0ef4.js\",\"6557\",\"static/chunks/6557-a61c6dc420c58496.js\",\"7562\",\"static/chunks/7562-46b0926241c4cd18.js\",\"5010\",\"static/chunks/5010-01983627d358362b.js\",\"1462\",\"static/chunks/1462-df42fe1a54b4ebf5.js\",\"405\",\"static/chunks/405-28c6568087d4ead7.js\",\"613\",\"static/chunks/app/(other)/layout-ecad0553ecc89178.js\"],\"TopNavigation\"]\n12:I[98853,[\"8853\",\"static/chunks/8853-2271113113dde66c.js\",\"5663\",\"static/chunks/5663-00779e166e8504ca.js\",\"9477\",\"static/chunks/app/(other)/blog/%5Bslug%5D/page-ec4878d622ff5f36.js\"],\"\"]\n13:I[63353,[\"8853\",\"static/chunks/8853-2271113113dde66c.js\",\"6475\",\"static/chunks/6475-8ce54b349539116b.js\",\"1735\",\"static/chunks/1735-43b56eb9821f0ef4.js\",\"6557\",\"static/chunks/6557-a61c6dc420c58496.js\",\"7562\",\"static/chunks/7562-46b0926241c4cd18.js\",\"5010\",\"static/chunks/5010-01983627d358362b.js\",\"1462\",\"static/chunks/1462-df42fe1a54b4ebf5.js\",\"405\",\"static/chunks/405-28c6568087d4ead7.js\",\"613\",\"static/chunks/app/(ot"])</script><script>self.__next_f.push([1,"her)/layout-ecad0553ecc89178.js\"],\"Toaster\"]\n14:I[75663,[\"8853\",\"static/chunks/8853-2271113113dde66c.js\",\"5663\",\"static/chunks/5663-00779e166e8504ca.js\",\"9477\",\"static/chunks/app/(other)/blog/%5Bslug%5D/page-ec4878d622ff5f36.js\"],\"Image\"]\n11:T492,m 0,0 c 0.146,-9.572 -2.339,-17.754 -7.451,-24.548 -3.362,-4.603 -8.111,-7.855 -14.247,-9.754 -3.288,-1.022 -7.124,-1.534 -11.508,-1.534 -8.109,0 -14.832,2.008 -20.165,6.027 -4.457,3.288 -7.983,7.763 -10.575,13.425 -2.594,5.661 -4.11,12.146 -4.548,19.453 l 19.726,1.425 c 0.877,-8.006 2.996,-13.807 6.356,-17.405 2.483,-2.717 5.333,-4.004 8.549,-3.857 4.528,0.146 8.145,2.377 10.849,6.693 1.387,2.119 2.082,5.154 2.082,9.103 0,5.703 -2.593,11.371 -7.781,17.002 -4.092,3.875 -10.229,9.688 -18.411,17.44 -6.868,6.655 -11.726,12.615 -14.576,17.881 -3.069,5.923 -4.603,12.358 -4.603,19.305 0,12.504 4.2,21.975 12.603,28.41 5.187,3.875 11.617,5.814 19.289,5.814 7.378,0 13.699,-1.644 18.959,-4.932 4.091,-2.558 7.397,-6.137 9.918,-10.74 2.52,-4.603 4.036,-9.901 4.549,-15.891 l -19.836,-3.616 c -0.586,5.625 -2.193,10.008 -4.823,13.151 -1.901,2.263 -4.64,3.397 -8.219,3.397 -3.8,0 -6.686,-1.681 -8.658,-5.041 -1.608,-2.704 -2.412,-6.065 -2.412,-10.083 0,-6.284 2.703,-12.676 8.111,-19.178 2.045,-2.485 5.112,-5.408 9.206,-8.768 4.821,-4.018 8,-6.832 9.534,-8.438 5.113,-5.115 9.059,-10.156 11.836,-15.124 1.314,-2.339 2.373,-4.493 3.179,-6.466 C -1.095,8.255 -0.073,3.872 0,0"])</script><script>self.__next_f.push([1,"8:[\"$\",\"html\",null,{\"lang\":\"en\",\"className\":\"text-base antialiased\",\"children\":[[\"$\",\"$d\",null,{\"children\":[\"$\",\"$Le\",null,{}]}],[\"$\",\"$Lf\",null,{\"children\":[\"$\",\"body\",null,{\"children\":[\"$\",\"div\",null,{\"className\":\"relative flex min-h-screen flex-col bg-background\",\"children\":[[\"$\",\"$L10\",null,{\"noLocale\":true,\"items\":[{\"title\":\"Home\",\"href\":\"/\"},{\"title\":\"Blog\",\"href\":\"/blog\"},{\"title\":\"Knowledge Base\",\"subitems\":[{\"title\":\"All Categories\",\"href\":\"/blog/categories\",\"description\":\"Browse all knowledge categories in our library.\"},{\"title\":\"Ai\",\"href\":\"/blog/category/ai\",\"description\":\"Clear, practical explanations of Artificial Intelligence and its real-world impact. Covering machine learning, language models, and AI applications, this section breaks down complex topics into understandable insights. Find analysis of current AI tools, developments in the field, and discussions about practical implementation - written for both practitioners and interested observers in the AI space\"},{\"title\":\"Rag\",\"href\":\"/blog/category/rag\",\"description\":\"Learn about Retrieval-Augmented Generation (RAG), a practical approach to enhance AI applications with external knowledge bases. Explore how RAG helps create more accurate AI systems by combining language models with real-world data. Find practical guides, implementation examples, and best practices for building RAG systems. Ideal for developers and teams working on AI applications who want to improve their models' accuracy and reliability\"},{\"title\":\"Agents\",\"href\":\"/blog/category/agents\",\"description\":\"Discover the latest trends and insights in AI Agents, focusing on building conversational AI systems. Learn about the latest developments in AI Agents, including chatbots, virtual assistants, and conversational AI platforms. Find practical guides, case studies, and best practices for building AI Agents that can understand and respond to human language. Ideal for developers, data scientists, and teams working on conversational AI systems\"},{\"title\":\"Genai\",\"href\":\"/blog/category/genai\",\"description\":\"Explore the world of Generative AI, focusing on building AI systems that create new content. Learn about the latest trends in Generative AI, including language models, image generation, and music composition. Find practical guides, case studies, and best practices for building Generative AI systems that can generate new content. Ideal for developers, data scientists, and teams working on AI applications that require creative content generation\"},{\"title\":\"Azure\",\"href\":\"/blog/category/azure\",\"description\":\"Discover the latest trends and insights in Azure AI, focusing on building AI systems with Microsoft Azure. Learn about the latest developments in Azure AI, including machine learning, cognitive services, and AI applications. Find practical guides, case studies, and best practices for building AI systems with Microsoft Azure. Ideal for developers, data scientists, and teams working on AI applications that use Microsoft Azure\"}]},{\"title\":\"FREE: Train your own LLM\",\"href\":\"/guides/train-your-own-llm\",\"bold\":true},{\"title\":\"Products\",\"subitems\":[{\"title\":\"Pondhouse Docs - Document AI Assistant\",\"href\":\"/products/pondhouse-docs\",\"description\":\"The best Retrieval Augmented Generation solution for technical documentation.\"},{\"title\":\"Prompt Validator\",\"href\":\"/products/prompt-validator\",\"description\":\"Automatically validate and harden your AI prompts - for FREE\"},{\"title\":\"FREE: Train your own LLM\",\"href\":\"/guides/train-your-own-llm\",\"description\":\"Guide on how to train your own Language Model.\"}]}],\"actionButtons\":[{\"title\":\"Blog\",\"href\":\"/blog\"}]}],[\"$\",\"div\",null,{\"className\":\"-mt-10 flex-1\",\"children\":[\"$\",\"$L5\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"(other)\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L7\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":null}]}],[\"$\",\"footer\",null,{\"className\":\"bg-background\",\"aria-labelledby\":\"footer-heading\",\"children\":[[\"$\",\"h2\",null,{\"id\":\"footer-heading\",\"className\":\"sr-only\",\"children\":\"Footer\"}],[\"$\",\"div\",null,{\"className\":\"flex w-full flex-col justify-center gap-4 border-t pb-2 pl-20 pr-6 pt-10 sm:pt-10 md:flex-row md:gap-48 md:pl-6 lg:px-8 lg:pt-10\",\"children\":[[\"$\",\"div\",null,{\"className\":\"xl:col-span-2\",\"children\":[[\"$\",\"svg\",null,{\"viewBox\":\"0 0 2400 549.99999\",\"className\":\"w-48 text-foreground\",\"children\":[\"$\",\"g\",null,{\"id\":\"g17\",\"transform\":\"matrix(1.3333333,0,0,-1.3333333,0,2666.6667)\",\"children\":[\"$\",\"g\",null,{\"id\":\"g19\",\"fill\":\"currentColor\",\"transform\":\"translate(-100.29087,792.49973)\",\"children\":[\"$\",\"g\",null,{\"id\":\"g21\",\"clipPath\":\"url(#clipPath25)\",\"fill\":\"currentColor\",\"children\":[[\"$\",\"g\",null,{\"id\":\"g27\",\"transform\":\"translate(584.3906,1035.5625)\",\"fill\":\"currentColor\",\"children\":[\"$\",\"path\",null,{\"d\":\"m 0,0 c 0,3.579 -1.079,6.466 -3.233,8.658 -2.156,2.192 -5.024,3.287 -8.603,3.287 H -24.329 V -32 h 12.493 c 3.287,0 6.082,1.167 8.384,3.506 2.302,2.337 3.452,5.151 3.452,8.439 z m -12.384,33.097 c 10.082,0 18.118,-3.179 24.11,-9.535 5.551,-6.065 8.33,-13.808 8.33,-23.233 v -19.946 c 0,-9.06 -3.162,-16.805 -9.481,-23.233 -6.32,-6.43 -13.972,-9.645 -22.959,-9.645 h -11.945 v -51.727 H -45.043 V 33.097 Z\",\"fill\":\"currentColor\",\"id\":\"path29\"}]}],[\"$\",\"g\",null,{\"id\":\"g31\",\"transform\":\"translate(662.7471,1037.9736)\",\"fill\":\"currentColor\",\"children\":[\"$\",\"path\",null,{\"d\":\"m 0,0 c 0,3.288 -1.151,6.082 -3.452,8.384 -2.302,2.301 -5.097,3.452 -8.384,3.452 -3.288,0 -6.101,-1.151 -8.439,-3.452 C -22.614,6.082 -23.781,3.288 -23.781,0 v -75.18 c 0,-3.288 1.167,-6.082 3.506,-8.384 2.338,-2.301 5.151,-3.452 8.439,-3.452 3.287,0 6.082,1.151 8.384,3.452 2.301,2.302 3.452,5.096 3.452,8.384 z m -11.288,32.439 c 9.131,0 16.894,-3.216 23.288,-9.644 6.393,-6.43 9.59,-14.175 9.59,-23.233 v -74.961 c 0,-9.134 -3.216,-16.896 -9.645,-23.289 -6.429,-6.394 -14.175,-9.589 -23.233,-9.589 -9.134,0 -16.878,3.214 -23.234,9.644 -6.356,6.428 -9.535,14.174 -9.535,23.234 v 74.961 c 0,9.132 3.215,16.894 9.645,23.288 6.429,6.392 14.137,9.589 23.124,9.589\",\"fill\":\"currentColor\",\"id\":\"path33\"}]}],[\"$\",\"g\",null,{\"id\":\"g35\",\"transform\":\"translate(725.7793,1068.769)\",\"fill\":\"currentColor\",\"children\":[\"$\",\"path\",null,{\"d\":\"M 0,0 27.487,-92.36 V 0 H 48.201 V -137.428 H 25.953 l -28.494,88.002 v -88.002 H -23.253 V 0 Z\",\"fill\":\"currentColor\",\"id\":\"path37\"}]}],[\"$\",\"g\",null,{\"id\":\"g39\",\"transform\":\"translate(813.2119,951.8345)\",\"fill\":\"currentColor\",\"children\":[\"$\",\"path\",null,{\"d\":\"m 0,0 h 12.493 c 3.288,0 6.064,1.187 8.329,3.562 2.264,2.373 3.398,5.167 3.398,8.383 v 71.893 c 0,3.287 -1.151,6.099 -3.452,8.438 -2.302,2.338 -5.06,3.507 -8.275,3.507 H 0 Z m 44.385,12.384 c 0,-9.06 -3.179,-16.805 -9.535,-23.234 -6.356,-6.43 -14.028,-9.644 -23.014,-9.644 h -32.549 v 137.429 h 32.549 c 9.058,0 16.748,-3.216 23.069,-9.644 6.319,-6.431 9.48,-14.138 9.48,-23.124 z\",\"fill\":\"currentColor\",\"id\":\"path41\"}]}],[\"$\",\"g\",null,{\"id\":\"g43\",\"transform\":\"translate(896.498,989.5337)\",\"fill\":\"currentColor\",\"children\":[\"$\",\"path\",null,{\"d\":\"M 0,0 V -58.193 H -20.713 V 79.125 H 0 V 20.823 H 24.987 V 79.125 H 45.7 V -58.193 H 24.987 V 0 Z\",\"fill\":\"currentColor\",\"id\":\"path45\"}]}],[\"$\",\"g\",null,{\"id\":\"g47\",\"transform\":\"translate(1004.5537,1037.9736)\",\"fill\":\"currentColor\",\"children\":[\"$\",\"path\",null,{\"d\":\"m 0,0 c 0,3.288 -1.15,6.082 -3.452,8.384 -2.302,2.301 -5.096,3.452 -8.384,3.452 -3.288,0 -6.101,-1.151 -8.438,-3.452 C -22.613,6.082 -23.781,3.288 -23.781,0 v -75.18 c 0,-3.288 1.168,-6.082 3.507,-8.384 2.337,-2.301 5.15,-3.452 8.438,-3.452 3.288,0 6.082,1.151 8.384,3.452 C -1.15,-81.262 0,-78.468 0,-75.18 Z m -11.288,32.439 c 9.132,0 16.894,-3.216 23.288,-9.644 6.393,-6.43 9.59,-14.175 9.59,-23.233 v -74.961 c 0,-9.134 -3.216,-16.896 -9.645,-23.289 -6.429,-6.394 -14.174,-9.589 -23.233,-9.589 -9.134,0 -16.877,3.214 -23.233,9.644 -6.356,6.428 -9.535,14.174 -9.535,23.234 v 74.961 c 0,9.132 3.214,16.894 9.645,23.288 6.428,6.392 14.137,9.589 23.123,9.589\",\"fill\":\"currentColor\",\"id\":\"path49\"}]}],[\"$\",\"g\",null,{\"id\":\"g51\",\"transform\":\"translate(1076.9932,929.8062)\",\"fill\":\"currentColor\",\"children\":[\"$\",\"path\",null,{\"d\":\"m 0,0 c -9.135,0 -16.878,3.178 -23.234,9.535 -6.356,6.356 -9.535,14.064 -9.535,23.124 v 106.194 h 20.275 V 32.878 c 0,-3.288 1.168,-6.083 3.507,-8.384 2.338,-2.302 5.15,-3.452 8.438,-3.452 3.288,0 6.083,1.15 8.384,3.452 2.302,2.301 3.452,5.096 3.452,8.384 v 105.975 h 21.59 V 32.659 C 32.877,23.453 29.661,15.708 23.232,9.425 16.803,3.141 9.058,0 0,0\",\"fill\":\"currentColor\",\"id\":\"path53\"}]}],[\"$\",\"g\",null,{\"id\":\"g55\",\"transform\":\"translate(1195.459,965.5332)\",\"fill\":\"currentColor\",\"children\":[\"$\",\"path\",null,{\"d\":\"$11\",\"fill\":\"currentColor\",\"id\":\"path57\"}]}],[\"$\",\"g\",null,{\"id\":\"g59\",\"transform\":\"translate(1212.6621,931.3408)\",\"fill\":\"currentColor\",\"children\":[\"$\",\"path\",null,{\"d\":\"M 0,0 V 137.428 H 58.961 V 116.606 H 20.713 V 79.125 H 48.658 V 58.303 H 20.713 V 20.822 H 58.961 V 0 Z\",\"fill\":\"currentColor\",\"id\":\"path61\"}]}],[\"$\",\"g\",null,{\"id\":\"g63\",\"transform\":\"translate(1349.3164,951.8345)\",\"fill\":\"currentColor\",\"children\":[\"$\",\"path\",null,{\"d\":\"m 0,0 h 12.493 c 3.288,0 6.064,1.187 8.329,3.562 2.264,2.373 3.398,5.167 3.398,8.383 v 71.893 c 0,3.287 -1.151,6.099 -3.452,8.438 -2.302,2.338 -5.06,3.507 -8.275,3.507 H 0 Z m 44.385,12.384 c 0,-9.06 -3.179,-16.805 -9.535,-23.234 -6.356,-6.43 -14.028,-9.644 -23.014,-9.644 h -32.549 v 137.429 h 32.549 c 9.058,0 16.748,-3.216 23.069,-9.644 6.319,-6.431 9.48,-14.138 9.48,-23.124 z\",\"fill\":\"currentColor\",\"id\":\"path65\"}]}],[\"$\",\"g\",null,{\"id\":\"g67\",\"transform\":\"translate(1445.4258,1037.2065)\",\"fill\":\"currentColor\",\"children\":[\"$\",\"path\",null,{\"d\":\"M 0,0 -7.672,-54.139 H 7.671 Z m -10.881,-74.304 -5.032,-31.562 H -37.48 L -14.136,31.453 H 14.356 L 37.37,-105.866 H 15.592 l -4.847,31.562 z\",\"fill\":\"currentColor\",\"id\":\"path69\"}]}],[\"$\",\"g\",null,{\"id\":\"g71\",\"transform\":\"translate(1502.8525,1047.8369)\",\"fill\":\"currentColor\",\"children\":[\"$\",\"path\",null,{\"d\":\"M 0,0 H -22.027 V 20.822 H 42.632 V 0 H 20.713 V -116.496 H 0 Z\",\"fill\":\"currentColor\",\"id\":\"path73\"}]}],[\"$\",\"g\",null,{\"id\":\"g75\",\"transform\":\"translate(1580.7725,1037.2065)\",\"fill\":\"currentColor\",\"children\":[\"$\",\"path\",null,{\"d\":\"M 0,0 -7.672,-54.139 H 7.671 Z m -10.881,-74.304 -5.032,-31.562 H -37.48 L -14.136,31.453 H 14.356 L 37.369,-105.866 H 15.592 l -4.847,31.562 z\",\"fill\":\"currentColor\",\"id\":\"path77\"}]}],[\"$\",\"g\",null,{\"id\":\"g79\",\"transform\":\"translate(1704.9355,1037.9736)\",\"fill\":\"currentColor\",\"children\":[\"$\",\"path\",null,{\"d\":\"m 0,0 c 0,3.288 -1.151,6.082 -3.452,8.384 -2.302,2.301 -5.096,3.452 -8.384,3.452 -3.288,0 -6.101,-1.151 -8.438,-3.452 C -22.614,6.082 -23.781,3.288 -23.781,0 v -75.18 c 0,-3.288 1.167,-6.082 3.507,-8.384 2.337,-2.301 5.15,-3.452 8.438,-3.452 3.288,0 6.082,1.151 8.384,3.452 2.301,2.302 3.452,5.096 3.452,8.384 z m -11.288,32.439 c 9.132,0 16.894,-3.216 23.288,-9.644 6.393,-6.43 9.589,-14.175 9.589,-23.233 v -74.961 c 0,-9.134 -3.215,-16.896 -9.644,-23.289 -6.429,-6.394 -14.174,-9.589 -23.233,-9.589 -9.134,0 -16.877,3.214 -23.233,9.644 -6.357,6.428 -9.535,14.174 -9.535,23.234 v 74.961 c 0,9.132 3.213,16.894 9.644,23.288 6.429,6.392 14.138,9.589 23.124,9.589\",\"fill\":\"currentColor\",\"id\":\"path81\"}]}],[\"$\",\"g\",null,{\"id\":\"g83\",\"transform\":\"translate(1777.2637,929.5869)\",\"fill\":\"currentColor\",\"children\":[\"$\",\"path\",null,{\"d\":\"m 0,0 c -9.134,0 -16.896,3.214 -23.288,9.645 -6.394,6.428 -9.589,14.137 -9.589,23.124 v 74.96 c 0,9.132 3.214,16.895 9.645,23.289 6.427,6.392 14.172,9.589 23.232,9.589 9.133,0 16.878,-3.216 23.234,-9.644 6.356,-6.43 9.535,-14.175 9.535,-23.234 V 92.058 H 11.288 v 16.109 c 0,3.288 -1.169,6.1 -3.507,8.439 -2.339,2.337 -5.15,3.507 -8.438,3.507 -3.288,0 -6.082,-1.17 -8.384,-3.507 -2.302,-2.339 -3.452,-5.151 -3.452,-8.439 V 32.988 c 0,-3.288 1.15,-6.083 3.452,-8.384 2.302,-2.302 5.096,-3.453 8.384,-3.453 3.288,0 6.099,1.148 8.438,3.442 2.338,2.295 3.507,5.083 3.507,8.362 V 59.947 H -0.219 V 80.77 H 32.769 V 32.769 C 32.769,23.635 29.553,15.891 23.124,9.535 16.694,3.178 8.987,0 0,0\",\"fill\":\"currentColor\",\"id\":\"path85\"}]}],[\"$\",\"g\",null,{\"id\":\"g87\",\"transform\":\"translate(267.7109,952.7754)\",\"fill\":\"currentColor\",\"children\":[\"$\",\"path\",null,{\"d\":\"M 0,0 -77.743,19.682 -41.331,162.375 106.774,200.263 -19.928,73.561 Z\",\"fill\":\"currentColor\",\"id\":\"path89\"}]}],[\"$\",\"g\",null,{\"id\":\"g91\",\"transform\":\"translate(384.9814,1146.3584)\",\"fill\":\"currentColor\",\"children\":[\"$\",\"path\",null,{\"d\":\"m 0,0 -55.2,-58.175 73.906,-18.608 48.516,-172.491 39.415,147.707 z\",\"fill\":\"currentColor\",\"id\":\"path93\"}]}],[\"$\",\"g\",null,{\"id\":\"g95\",\"transform\":\"translate(439.8594,883.0366)\",\"fill\":\"currentColor\",\"children\":[\"$\",\"path\",null,{\"d\":\"M 0,0 -19.791,77.715 -74.935,25.107 -246.734,76.015 -142.778,-36.075 Z\",\"fill\":\"currentColor\",\"id\":\"path97\"}]}]]}]}]}]}],[\"$\",\"p\",null,{\"className\":\"ml-3 mt-0 text-sm text-muted-foreground\",\"children\":\"We know data.\"}]]}],[\"$\",\"div\",null,{\"className\":\"mt-6 xl:mt-0\",\"children\":[[\"$\",\"svg\",null,{\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":24,\"height\":24,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"mr-2 inline h-6 w-6 text-foreground\",\"aria-hidden\":\"true\",\"children\":[[\"$\",\"path\",\"2oe9fu\",{\"d\":\"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z\"}],[\"$\",\"circle\",\"ilqhr7\",{\"cx\":\"12\",\"cy\":\"10\",\"r\":\"3\"}],\"$undefined\"]}],[\"$\",\"span\",null,{\"className\":\"font-semibold leading-6 text-foreground\",\"children\":\"Location\"}],[\"$\",\"ul\",null,{\"role\":\"list\",\"className\":\"space-y ml-8 mt-2 text-foreground\",\"children\":[[\"$\",\"li\",null,{\"children\":\"Pondhouse Data OG\"}],[\"$\",\"li\",null,{\"children\":\"Litscherweg 10/21\"}],[\"$\",\"li\",null,{\"children\":\"6800 Feldkirch\"}],[\"$\",\"li\",null,{\"className\":\"mt-1\",\"children\":\"Austria\"}]]}]]}],[\"$\",\"div\",null,{\"children\":[[\"$\",\"div\",null,{\"className\":\"mt-6 xl:mt-0\",\"children\":[[\"$\",\"svg\",null,{\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":24,\"height\":24,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"mr-2 inline h-6 w-6 text-foreground\",\"aria-hidden\":\"true\",\"children\":[[\"$\",\"path\",\"foiqr5\",{\"d\":\"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z\"}],\"$undefined\"]}],[\"$\",\"span\",null,{\"className\":\"font-semibold leading-6 text-foreground\",\"children\":\"Phone\"}],[\"$\",\"ul\",null,{\"role\":\"list\",\"className\":\"space-y ml-8 mt-2 text-foreground\",\"children\":[\"$\",\"li\",null,{\"children\":\"+43 650 9820448\"}]}]]}],[\"$\",\"div\",null,{\"className\":\"mt-8 md:mt-4\",\"children\":[[\"$\",\"svg\",null,{\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":24,\"height\":24,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"mr-2 inline h-6 w-6 text-foreground\",\"aria-hidden\":\"true\",\"children\":[[\"$\",\"path\",\"1cjeqo\",{\"d\":\"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71\"}],[\"$\",\"path\",\"19qd67\",{\"d\":\"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71\"}],\"$undefined\"]}],[\"$\",\"span\",null,{\"className\":\"font-semibold leading-6 text-foreground\",\"children\":\"Links\"}],[\"$\",\"ul\",null,{\"role\":\"list\",\"className\":\"ml-8 mt-2 space-y-2 text-foreground\",\"children\":[[\"$\",\"li\",null,{\"className\":\"mt-0\",\"children\":[\"$\",\"$L12\",null,{\"className\":\"hover:text-muted-foreground\",\"href\":\"/impressum\",\"children\":\"Impressum\"}]}],[\"$\",\"li\",null,{\"className\":\"mt-0\",\"children\":[\"$\",\"$L12\",null,{\"className\":\"hover:text-muted-foreground\",\"href\":\"/privacy\",\"children\":\"Data Protection\"}]}],[\"$\",\"li\",null,{\"className\":\"mt-0\",\"children\":[\"$\",\"$L12\",null,{\"className\":\"hover:text-muted-foreground\",\"href\":\"/archive\",\"children\":\"Article-Archive\"}]}]]}]]}]]}]]}],[\"$\",\"div\",null,{\"className\":\"bg-primary-900 mt-4 flex items-center justify-center border-t border-foreground/10 py-8\",\"children\":[\"$\",\"p\",null,{\"className\":\"text-xs leading-5 text-muted-foreground\",\"children\":[\"© \",\"2025\",\" Pondhouse Data OG. All rights reserved.\"]}]}]]}],null,[\"$\",\"$L13\",null,{}]]}]}]}]]}]\n"])</script><script>self.__next_f.push([1,"4:[[\"$\",\"main\",null,{\"children\":[[\"$\",\"div\",null,{\"className\":\"bg-primary-800 pt-20\"}],[\"$\",\"article\",null,{\"className\":\"xl:max-w-6xl0 prose-quoteless prose mx-auto mt-20 prose-pre:m-0 prose-pre:bg-transparent prose-pre:p-0 lg:max-w-4xl prose-code:rounded-md prose-code:px-1 prose-code:py-[1px] prose-code:text-white prose-code:content-none prose-code:before:content-none prose-code:after:content-none prose-blockquote:bg-secondary-200 prose-blockquote:rounded-xl prose-blockquote:px-4 prose-blockquote:py-[1px] prose-blockquote:text-gray-700 prose-blockquote:border-l-secondary-600 pb-8\",\"children\":[[\"$\",\"h1\",null,{\"className\":\"\",\"children\":\"How to Build AI Agents Without Frameworks: A Step-by-Step Guide\"}],[\"$\",\"div\",null,{\"className\":\"rounded-3xl border bg-white p-5 shadow-[#00000008] md:p-10\",\"children\":[[\"$\",\"div\",null,{\"className\":\"relative mx-auto mb-6 aspect-[1.776824] w-full\",\"children\":[[\"$\",\"$L14\",null,{\"className\":\"m-0 rounded-3xl\",\"src\":\"/blog/BlogHeader_AiAgentsFromScratch.jpg\",\"alt\":\"blog preview\",\"priority\":true,\"fill\":true,\"sizes\":\"(max-width: 768px) 100vw, (max-width: 1200px) 50vw, 33vw\",\"loading\":\"eager\"}],\" \"]}],\"$L15\",false]}]]}],[\"$\",\"div\",null,{\"className\":\"xl:max-w-6xl0 mx-auto flex max-w-xl flex-col items-center justify-center gap-10 pb-24 sm:flex-row sm:justify-between sm:gap-0\",\"children\":[[\"$\",\"div\",null,{\"className\":\"flex w-56 flex-col items-center text-center\",\"children\":[[\"$\",\"div\",null,{\"className\":\"mb-6 text-sm\",\"children\":\"More information on our managed RAG solution?\"}],[\"$\",\"$L12\",null,{\"href\":\"/\",\"className\":\"inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none ring-offset-background bg-primary text-primary-foreground hover:bg-primary/90 h-10 py-2 px-4\",\"children\":\"To Pondhouse AI\"}]]}],[\"$\",\"div\",null,{\"className\":\"flex w-56 flex-col items-center text-center\",\"children\":[[\"$\",\"div\",null,{\"className\":\"mb-6 text-sm\",\"children\":\"More tips and tricks on how to work with AI?\"}],[\"$\",\"$L12\",null,{\"href\":\"/blog\",\"className\":\"inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none ring-offset-background bg-primary text-primary-foreground hover:bg-primary/90 h-10 py-2 px-4\",\"children\":\"To our Blog\"}]]}]]}]]}],[\"$\",\"div\",null,{\"className\":\"bg-primary-800 xs:mt-20 relative mt-80 sm:mt-0\",\"children\":[\"$\",\"div\",null,{\"className\":\"absolute inset-0 flex items-center\",\"aria-hidden\":\"true\",\"children\":[\"$\",\"div\",null,{\"className\":\"w-full border-t border-gray-300\"}]}]}]]\n"])</script><script>self.__next_f.push([1,"a:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"meta\",\"1\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"2\",{\"children\":\"How to Build AI Agents Without Frameworks: A Step-by-Step Guide\"}],[\"$\",\"meta\",\"3\",{\"name\":\"description\",\"content\":\"Comprehensive tutorial for no-framework AI agent development using direct LLM interaction. Build smarter, more adaptable AI systems without the constraints of pre-built tools\"}],[\"$\",\"link\",\"4\",{\"rel\":\"manifest\",\"href\":\"/manifest.webmanifest\",\"crossOrigin\":\"use-credentials\"}],[\"$\",\"link\",\"5\",{\"rel\":\"canonical\",\"href\":\"https://www.pondhouse-data.com/blog/ai-agents-from-scratch\"}],[\"$\",\"meta\",\"6\",{\"property\":\"og:title\",\"content\":\"How to Build AI Agents Without Frameworks: A Step-by-Step Guide\"}],[\"$\",\"meta\",\"7\",{\"property\":\"og:description\",\"content\":\"Comprehensive tutorial for no-framework AI agent development using direct LLM interaction. Build smarter, more adaptable AI systems without the constraints of pre-built tools\"}],[\"$\",\"meta\",\"8\",{\"property\":\"og:image\",\"content\":\"https://www.pondhouse-data.com/blog/BlogHeader_AiAgentsFromScratch.jpg\"}],[\"$\",\"meta\",\"9\",{\"name\":\"twitter:card\",\"content\":\"summary_large_image\"}],[\"$\",\"meta\",\"10\",{\"name\":\"twitter:site\",\"content\":\"@techscienceandy\"}],[\"$\",\"meta\",\"11\",{\"name\":\"twitter:title\",\"content\":\"How to Build AI Agents Without Frameworks: A Step-by-Step Guide\"}],[\"$\",\"meta\",\"12\",{\"name\":\"twitter:description\",\"content\":\"Comprehensive tutorial for no-framework AI agent development using direct LLM interaction. Build smarter, more adaptable AI systems without the constraints of pre-built tools\"}],[\"$\",\"meta\",\"13\",{\"name\":\"twitter:image\",\"content\":\"https://www.pondhouse-data.com/blog/BlogHeader_AiAgentsFromScratch.jpg\"}],[\"$\",\"link\",\"14\",{\"rel\":\"shortcut icon\",\"href\":\"/Icon_dark.png\"}],[\"$\",\"link\",\"15\",{\"rel\":\"icon\",\"href\":\"/favicon.ico\"}],[\"$\",\"link\",\"16\",{\"rel\":\"apple-touch-icon\",\"href\":\"/apple-touch-icon-60x60.png\",\"sizes\":\"60x60\",\"type\":\"image/png\"}],[\"$\",\"link\",\"17\",{\"rel\":\"apple-touch-icon\",\"href\":\"/apple-touch-icon-76x76.png\",\"sizes\":\"76x76\",\"type\":\"image/png\"}],[\"$\",\"link\",\"18\",{\"rel\":\"apple-touch-icon\",\"href\":\"/apple-touch-icon-120x120.png\",\"sizes\":\"120x120\",\"type\":\"image/png\"}],[\"$\",\"link\",\"19\",{\"rel\":\"apple-touch-icon\",\"href\":\"/apple-touch-icon-152x152.png\",\"sizes\":\"152x152\",\"type\":\"image/png\"}],[\"$\",\"meta\",\"20\",{\"name\":\"next-size-adjust\"}]]\n"])</script><script>self.__next_f.push([1,"3:null\n"])</script><script>self.__next_f.push([1,"15:[[\"$\",\"p\",null,{\"children\":[\"AI agents are often overcomplicated. At their core, they're just language\\nmodels with the ability to use tools and remember context. While\\nframeworks like \",[\"$\",\"a\",null,{\"href\":\"https://www.langchain.com/\",\"children\":\"LangChain\",\"className\":\"text-secondary-400 hover:text-secondary-600\"}],\" or\\n\",[\"$\",\"a\",null,{\"href\":\"https://github.com/Significant-Gravitas/AutoGPT\",\"children\":\"AutoGPT\",\"className\":\"text-secondary-400 hover:text-secondary-600\"}],\" can help you\\nget started quickly, they add layers of abstraction that can make it\\nharder to understand what's actually happening – and harder to customize\\nyour agent for specific use cases.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"In this tutorial, we'll build an AI agent from scratch using direct API\\ncalls to GPT-4o. You'll learn how to create an agent that can query\\nPostgreSQL databases, fetch information from Wikipedia, and maintain\\nconversation context through simple database storage. No frameworks, just\\nclean code and clear concepts.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"The goal is to demonstrate that AI agents don't need complex\\narchitectures. We'll focus on the essential components: prompt engineering\\nfor tool use, storing conversation history in PostgreSQL, and managing the\\ninteraction flow between the LLM and its tools.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"At the end, you will know exactly, what an agent is, how it works and how\\nto build them. If you then decide to still use a framework - that's fine.\\nHowever, you will have a much better understanding of what's happening\\nunder the hood.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Let's start by understanding what makes something an AI agent, and then\\nbuild one step by step.\"}],\"\\n\",[\"$\",\"$L12\",null,{\"className\":\"no-underline\",\"href\":\"#what-are-ai-agents\",\"children\":[\"$\",\"h2\",null,{\"className\":\"hover:text-secondary-400\",\"id\":\"what-are-ai-agents\",\"children\":\"What Are AI Agents?\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"An AI agent is fundamentally just a language model that can:\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"Understand what tools it has available\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Decide when to use these tools\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Remember previous interactions\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Make decisions based on all this information\"}],\"\\n\"]}],\"\\n\",[\"$\",\"$L12\",null,{\"className\":\"no-underline\",\"href\":\"#what-are-tools\",\"children\":[\"$\",\"h3\",null,{\"className\":\"hover:text-secondary-400\",\"id\":\"what-are-tools\",\"children\":\"What Are Tools?\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Tools (sometimes called \\\"functions\\\" or \\\"capabilities\\\") are simply\\nfunctions that the agent can call to interact with the outside world.\\nThey're just Python functions with:\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"A clear description of what they do\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Defined input parameters\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Structured output\"}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Here's a concrete example of a tool:\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":\"$L16\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"When we give our agent access to this tool, we're essentially telling it:\\n\\\"You can search Wikipedia by calling this function.\\\" The LLM then decides,\\nbased on the user's question, whether it needs to use this tool to provide\\na good answer. When we say \\\"the LLM decides,\\\" we mean that we prompt the\\nLLM with the available tools and ask it to decide which one to use. The AI\\nmodel then simply returns a text response with the tool name.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":\"Common examples of tools include:\"}]}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"Database queries\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Web searches\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"API calls\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"File operations\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Calculator functions\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Email sending capabilities\"}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"To bring both the concepts of agents and tools together, we see that there\\nis no magic involved. It's just AI model interactions and a bunch of\\npython functions.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Bringing this together, a pseudo-code for an AI agent might look like\\nthis:\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":\"$L17\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"This is the core concept of an agent. Everything else – complex planning,\\nmultiple tool calls, sophisticated memory systems – is just an extension\\nof this basic pattern.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":\"Common misconceptions about agents:\"}]}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"They don't need complex orchestration frameworks\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"They don't need to run autonomously (though they can)\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"They don't need sophisticated planning algorithms (though these can help\\nfor complex tasks)\"}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":\"The key to building effective agents is not in the framework you use, but in:\"}]}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"Writing clear prompts that help the LLM understand its capabilities\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Implementing reliable tools that the agent can use\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Maintaining relevant context through some form of memory storage\"}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"In the following sections, we'll implement this pattern with real code,\\nbuilding an agent that can actually query databases and search Wikipedia.\\nYou'll see that the complexity comes from the specific requirements of\\nyour use case, not from the agent architecture itself.\"}],\"\\n\",[\"$\",\"$L12\",null,{\"className\":\"no-underline\",\"href\":\"#why-build-agents-without-frameworks\",\"children\":[\"$\",\"h2\",null,{\"className\":\"hover:text-secondary-400\",\"id\":\"why-build-agents-without-frameworks\",\"children\":\"Why Build Agents Without Frameworks?\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Frameworks like LangChain and AutoGPT are often recommended for building\\nAI agents. While they can be useful for quick prototypes, there are\\ncompelling reasons to avoid them:\"}],\"\\n\",[\"$\",\"$L12\",null,{\"className\":\"no-underline\",\"href\":\"#understanding-what-really-happens\",\"children\":[\"$\",\"h3\",null,{\"className\":\"hover:text-secondary-400\",\"id\":\"understanding-what-really-happens\",\"children\":\"Understanding What Really Happens\"}]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":\"$L18\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"The framework-free version is more explicit. You can see exactly:\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"What the LLM is being told\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"When tools are being called\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"How decisions are being made\"}],\"\\n\"]}],\"\\n\",[\"$\",\"$L12\",null,{\"className\":\"no-underline\",\"href\":\"#flexibility-and-control\",\"children\":[\"$\",\"h3\",null,{\"className\":\"hover:text-secondary-400\",\"id\":\"flexibility-and-control\",\"children\":\"Flexibility and Control\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Frameworks often make assumptions about:\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"How tools should be structured\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"What the prompt format should be\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"How memory should work\"}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"When you need to customize any of these, you often end up fighting against\\nthe framework rather than working with it.\"}],\"\\n\",[\"$\",\"$L12\",null,{\"className\":\"no-underline\",\"href\":\"#simpler-debugging\",\"children\":[\"$\",\"h3\",null,{\"className\":\"hover:text-secondary-400\",\"id\":\"simpler-debugging\",\"children\":\"Simpler Debugging\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"When something goes wrong with a framework:\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":\"$L19\"}],\"\\n\",[\"$\",\"div\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"Note:\"}],\" This is more or less the most prominent reason why you should\\nbuild agents without frameworks. Frameworks abstract away the core of\\nany AI Agent - the LLM interaction. Without adding additional\\ninfrastructure, you don't know the exact prompts used, the specific LLM\\nanswers replied and the tools used. This makes debugging a nightmare.\"]}],\"\\n\"],\"className\":\"text-secondary-400 hover:text-secondary-600 border-2 border-gray-400 px-4 rounded bg-gray-100\"}],\"\\n\",[\"$\",\"$L12\",null,{\"className\":\"no-underline\",\"href\":\"#lower-learning-overhead\",\"children\":[\"$\",\"h3\",null,{\"className\":\"hover:text-secondary-400\",\"id\":\"lower-learning-overhead\",\"children\":\"Lower Learning Overhead\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Building agents requires understanding:\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"LLM prompting\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Tool integration\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Memory management\"}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Frameworks add another layer:\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"Framework-specific concepts\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Configuration options\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Integration patterns\"}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Why learn both when you only need the fundamentals?\"}],\"\\n\",[\"$\",\"$L12\",null,{\"className\":\"no-underline\",\"href\":\"#performance-and-resources\",\"children\":[\"$\",\"h3\",null,{\"className\":\"hover:text-secondary-400\",\"id\":\"performance-and-resources\",\"children\":\"Performance and Resources\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Frameworks often:\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"Load unnecessary components\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Add network calls\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Include unused features\"}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Direct implementation lets you:\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"Load only what you need\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Optimize critical paths\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Control resource usage\"}],\"\\n\"]}],\"\\n\",[\"$\",\"div\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"Note:\"}],\" Arguably, raw performance is not the most important thing for\\nAI agents, as the AI model interaction in itself is quite slow. So\\nloading some additional modules does not add up that much.\"]}],\"\\n\"],\"className\":\"text-secondary-400 hover:text-secondary-600 border-2 border-gray-400 px-4 rounded bg-gray-100\"}],\"\\n\",[\"$\",\"$L12\",null,{\"className\":\"no-underline\",\"href\":\"#when-to-use-frameworks\",\"children\":[\"$\",\"h3\",null,{\"className\":\"hover:text-secondary-400\",\"id\":\"when-to-use-frameworks\",\"children\":\"When to Use Frameworks\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Frameworks make sense when:\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"You're building a quick prototype\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"You need pre-built tools\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"You're learning agent concepts initially\"}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"But for production systems or when you need full control, direct\\nimplementation is often better.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Let's move on to building our agent from scratch, where you'll see how\\nstraightforward the direct implementation can be.\"}],\"\\n\",[\"$\",\"$L12\",null,{\"className\":\"no-underline\",\"href\":\"#building-an-ai-agent-step-by-step\",\"children\":[\"$\",\"h2\",null,{\"className\":\"hover:text-secondary-400\",\"id\":\"building-an-ai-agent-step-by-step\",\"children\":\"Building an AI Agent Step by Step\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Before we dive into the code, let's understand what we'll be building in\\nthis first step. We'll start by defining our tools - the capabilities we\\nwant to give our agent.\"}],\"\\n\",[\"$\",\"$L12\",null,{\"className\":\"no-underline\",\"href\":\"#step-1-defining-tools\",\"children\":[\"$\",\"h3\",null,{\"className\":\"hover:text-secondary-400\",\"id\":\"step-1-defining-tools\",\"children\":\"Step 1: Defining Tools\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"In this step, we'll create two tools:\"}],\"\\n\",[\"$\",\"ol\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"A PostgreSQL query tool that allows the agent to query your database\\nand search for information stored in the database.\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"A Wikipedia search tool that lets the agent look up information in\\nWikipedia.\"}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"We can see that both tools are quite different, so depending on the users\\nquestion, the agent should be able to decide to use one of these tools.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"When defining tools for OpenAI's function calling, we need three\\ncomponents for each tool:\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"A schema that tells the LLM what the tool does and how to use it. This\\nis basically just a json description of the python function. It will get\\nclearer once you see the example.\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"The actual implementation of the tool (the Python function)\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Error handling to ensure our agent behaves gracefully when things go wrong\"}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"The schema is particularly important because it acts as documentation for\\nthe LLM. Think of it as writing API documentation - the better you\\ndescribe your tools, the better the LLM will use them. Important are the\\n\",[\"$\",\"code\",null,{\"className\":\"m-0 bg-gray-400\",\"children\":\"name\"}],\" (which should match the function name), \",[\"$\",\"code\",null,{\"className\":\"m-0 bg-gray-400\",\"children\":\"description\"}],\" (what the\\ntool does) and \",[\"$\",\"code\",null,{\"className\":\"m-0 bg-gray-400\",\"children\":\"parameters\"}],\" (what function parameter values we need).\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"For our database tool, we'll:\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"Allow only SELECT queries for safety\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Return results as JSON for easy parsing\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Include error handling for database connection issues\"}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"For the Wikipedia tool, we'll:\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"Limit results to three sentences to keep responses concise\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Handle disambiguation pages and missing articles\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Return structured error messages when searches fail\"}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Here's how we implement these tools:\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":\"$L1a\"}],\"\\n\",[\"$\",\"$L12\",null,{\"className\":\"no-underline\",\"href\":\"#step-2-creating-the-agent-class---detailed-design\",\"children\":[\"$\",\"h3\",null,{\"className\":\"hover:text-secondary-400\",\"id\":\"step-2-creating-the-agent-class---detailed-design\",\"children\":\"Step 2: Creating the Agent Class - Detailed Design\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Before implementing the code, let's understand exactly what we're building\\nand how it works:\"}],\"\\n\",[\"$\",\"$L12\",null,{\"className\":\"no-underline\",\"href\":\"#core-concept\",\"children\":[\"$\",\"h4\",null,{\"className\":\"hover:text-secondary-400\",\"id\":\"core-concept\",\"children\":\"Core Concept\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"An AI agent is essentially a loop of:\"}],\"\\n\",[\"$\",\"ol\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"Receiving user input\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Deciding whether to use tools\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Using tools if needed\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Formulating a response\"}],\"\\n\"]}],\"\\n\",[\"$\",\"$L12\",null,{\"className\":\"no-underline\",\"href\":\"#key-components-design\",\"children\":[\"$\",\"h4\",null,{\"className\":\"hover:text-secondary-400\",\"id\":\"key-components-design\",\"children\":\"Key Components Design\"}]}],\"\\n\",[\"$\",\"$L12\",null,{\"className\":\"no-underline\",\"href\":\"#1-message-management\",\"children\":[\"$\",\"h5\",null,{\"className\":\"hover:text-secondary-400\",\"id\":\"1-message-management\",\"children\":\"1. Message Management\"}]}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"We need to maintain a conversation history as a list of messages\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Each message has a specific role: 'user', 'assistant', or 'tool'\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"The history provides context for the LLM to make better decisions\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Think of it like a chat application's state management\"}],\"\\n\"]}],\"\\n\",[\"$\",\"$L12\",null,{\"className\":\"no-underline\",\"href\":\"#2-tool-execution-system\",\"children\":[\"$\",\"h5\",null,{\"className\":\"hover:text-secondary-400\",\"id\":\"2-tool-execution-system\",\"children\":\"2. Tool Execution System\"}]}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"Works like a command dispatcher:\",\"\\n\",[\"$\",\"ol\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"LLM decides to use a tool\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"We receive a structured function call\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"We map this to our actual Python functions\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"We handle the execution and any errors\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"We format the result for the LLM\"}],\"\\n\"]}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"$L12\",null,{\"className\":\"no-underline\",\"href\":\"#3-main-processing-loop\",\"children\":[\"$\",\"h5\",null,{\"className\":\"hover:text-secondary-400\",\"id\":\"3-main-processing-loop\",\"children\":\"3. Main Processing Loop\"}]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":\"$L1b\"}],\"\\n\",[\"$\",\"$L12\",null,{\"className\":\"no-underline\",\"href\":\"#error-handling-strategy\",\"children\":[\"$\",\"h4\",null,{\"className\":\"hover:text-secondary-400\",\"id\":\"error-handling-strategy\",\"children\":\"Error Handling Strategy\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"We need three layers of error handling:\"}],\"\\n\",[\"$\",\"ol\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"Tool-level errors (e.g., database connection failed)\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"LLM-level errors (e.g., API issues)\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"General processing errors (e.g., JSON parsing)\"}],\"\\n\"]}],\"\\n\",[\"$\",\"$L12\",null,{\"className\":\"no-underline\",\"href\":\"#message-flow-example\",\"children\":[\"$\",\"h4\",null,{\"className\":\"hover:text-secondary-400\",\"id\":\"message-flow-example\",\"children\":\"Message Flow Example\"}]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":\"$L1c\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"This design allows for:\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"Clear separation of concerns\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Easy debugging and monitoring\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Flexible extension with new tools\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Robust error handling\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Maintainable codebase\"}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Note that we implement the general agent structure as part of a loop. Meaning\\nthat we send back the results of our tool calls to the LLM which then decides\\nwhether to formulate a final answer or call another tool.\"}],\"\\n\",[\"$\",\"$L12\",null,{\"className\":\"no-underline\",\"href\":\"#implementation\",\"children\":[\"$\",\"h4\",null,{\"className\":\"hover:text-secondary-400\",\"id\":\"implementation\",\"children\":\"Implementation\"}]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":\"$L1d\"}],\"\\n\",[\"$\",\"$L12\",null,{\"className\":\"no-underline\",\"href\":\"#optional-step-3-adding-memory-to-our-agent\",\"children\":[\"$\",\"h3\",null,{\"className\":\"hover:text-secondary-400\",\"id\":\"optional-step-3-adding-memory-to-our-agent\",\"children\":\"(Optional) Step 3: Adding Memory to Our Agent\"}]}],\"\\n\",[\"$\",\"div\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"Note:\"}],\" Please consider whether you need memory at all. Does your\\napplication really need to store and retrieve conversation histories?\\nMore often than not, the answer is no! But if you do need memory, here's\\nhow you can add it.\"]}],\"\\n\"],\"className\":\"text-secondary-400 hover:text-secondary-600 border-2 border-gray-400 px-4 rounded bg-gray-100\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Memory in AI agents is often overcomplicated. Let's understand what we're\\nactually trying to achieve:\"}],\"\\n\",[\"$\",\"$L12\",null,{\"className\":\"no-underline\",\"href\":\"#what-is-agent-memory\",\"children\":[\"$\",\"h4\",null,{\"className\":\"hover:text-secondary-400\",\"id\":\"what-is-agent-memory\",\"children\":\"What is Agent Memory?\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"At its core, agent memory is just:\"}],\"\\n\",[\"$\",\"ol\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"Storing conversations and their context\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Retrieving relevant information when needed\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Summarizing past interactions when they become too long\"}],\"\\n\"]}],\"\\n\",[\"$\",\"$L12\",null,{\"className\":\"no-underline\",\"href\":\"#memory-types-well-implement\",\"children\":[\"$\",\"h4\",null,{\"className\":\"hover:text-secondary-400\",\"id\":\"memory-types-well-implement\",\"children\":\"Memory Types We'll Implement\"}]}],\"\\n\",[\"$\",\"ol\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":\"Conversation History\"}]}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"Store: User inputs, agent responses, tool usage results\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Purpose: Keep track of the current conversation flow\"}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":\"Summary Memory\"}]}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"What: Periodic summaries of longer conversations\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Why: Prevent context window overflow\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"How: Create summaries after X messages or on demand\"}],\"\\n\"]}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"$L12\",null,{\"className\":\"no-underline\",\"href\":\"#database-schema\",\"children\":[\"$\",\"h3\",null,{\"className\":\"hover:text-secondary-400\",\"id\":\"database-schema\",\"children\":\"Database Schema\"}]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":\"$L1e\"}],\"\\n\",[\"$\",\"$L12\",null,{\"className\":\"no-underline\",\"href\":\"#memory-flow\",\"children\":[\"$\",\"h4\",null,{\"className\":\"hover:text-secondary-400\",\"id\":\"memory-flow\",\"children\":\"Memory Flow\"}]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":\"$L1f\"}],\"\\n\",[\"$\",\"$L12\",null,{\"className\":\"no-underline\",\"href\":\"#implementation-of-memory-for-an-ai-agent\",\"children\":[\"$\",\"h4\",null,{\"className\":\"hover:text-secondary-400\",\"id\":\"implementation-of-memory-for-an-ai-agent\",\"children\":\"Implementation of Memory for an AI Agent\"}]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":\"$L20\"}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Before we continue...\"}],\"\\n\",[[\"$\",\"h2\",null,{\"className\":\"mt-0\",\"children\":\"Interested in how to train your very own Large Language Model?\"}],[\"$\",\"p\",null,{\"children\":\"We prepared a well-researched guide for how to use the latest advancements in Open Source technology to fine-tune your own LLM. This has many advantages like:\"}],[\"$\",\"ul\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":\"Cost control\"}],[\"$\",\"li\",null,{\"children\":\"Data privacy\"}],[\"$\",\"li\",null,{\"children\":\"Excellent performance - adjusted specifically for your intended use\"}]]}],[\"$\",\"div\",null,{\"className\":\"flex w-full justify-center\",\"children\":[\"$\",\"$L12\",null,{\"href\":\"../guides/train-your-own-llm\",\"className\":\"inline-flex items-center justify-center rounded-md text-sm transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none ring-offset-background bg-primary text-primary-foreground hover:bg-primary/90 h-10 py-2 px-4 no-underline font-bold\",\"children\":\"Get your free LLM training guide\"}]}]],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"$L12\",null,{\"className\":\"no-underline\",\"href\":\"#step-4-using-your-ai-agent\",\"children\":[\"$\",\"h3\",null,{\"className\":\"hover:text-secondary-400\",\"id\":\"step-4-using-your-ai-agent\",\"children\":\"Step 4: Using Your AI Agent\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"After all the setup, using the agent is surprisingly straightforward. Here's how:\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":\"$L21\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"That's it! The agent will:\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"Use the database when needed\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Search Wikipedia when appropriate\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Remember previous context\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Create summaries automatically\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Handle all the complexity behind the scenes - but at the same time giving us\\ndirect debugging access\"}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"The output looks clean and natural:\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":\"$L22\"}],\"\\n\",[\"$\",\"$L12\",null,{\"className\":\"no-underline\",\"href\":\"#enhanced-database-tool-with-schema-awareness\",\"children\":[\"$\",\"h2\",null,{\"className\":\"hover:text-secondary-400\",\"id\":\"enhanced-database-tool-with-schema-awareness\",\"children\":\"Enhanced Database Tool with Schema Awareness\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Arguably, the above PostgreSQL database tool is a little simple isn't it?\\nFrom where should the AI model know what database columns are available?\\nYou are right with that - we left out this crucial detail for more\\nclarity. We'll modify our database tool to include schema information,\\nwhich helps the LLM understand what data is available and how to query it\\ncorrectly:\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":\"$L23\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Key improvements:\"}],\"\\n\",[\"$\",\"ol\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"Schema information in tool description\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Column types and constraints included\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Schema returned on errors for better error handling\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Detailed result structure with column names\"}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"This helps the LLM:\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"Write correct queries on the first try\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Understand available data\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Handle errors better\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Provide more detailed responses\"}],\"\\n\"]}],\"\\n\",[\"$\",\"$L12\",null,{\"className\":\"no-underline\",\"href\":\"#further-reading\",\"children\":[\"$\",\"h2\",null,{\"className\":\"hover:text-secondary-400\",\"id\":\"further-reading\",\"children\":\"Further Reading\"}]}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"/blog/dspy-build-better-ai-systems-with-automated-prompt-optimization\",\"children\":\"DSPy: Automatic prompt tuning and creating\",\"className\":\"text-secondary-400 hover:text-secondary-600\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"/blog/introduction-to-libre-chat\",\"children\":\"Free and open source ChatGPT alternative:\\nLibreChat\",\"className\":\"text-secondary-400 hover:text-secondary-600\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"/blog/rag-with-azure-ai-search\",\"children\":\"How to: RAG with Azure AI search\",\"className\":\"text-secondary-400 hover:text-secondary-600\"}]}],\"\\n\"]}]]\n"])</script><script>self.__next_f.push([1,"1b:[\"$\",\"div\",null,{\"data-bright-theme\":\"dark-plus\",\"data-bright-mode\":\"$undefined\",\"className\":\"$undefined\",\"style\":{\"color\":\"#D4D4D4\",\"borderRadius\":\"4px\",\"overflow\":\"hidden\",\"margin\":\"1em 0\",\"--selection-background\":\"#264F78\",\"--line-number-color\":\"#858585\",\"--tab-border\":\"#252526\",\"--tab-background\":\"#1E1E1E\",\"--tab-color\":\"#ffffff\",\"--inactive-tab-background\":\"#2D2D2D\",\"--inactive-tab-color\":\"#ffffff80\",\"--tab-top-border\":\"$undefined\",\"--tab-bottom-border\":\"#1E1E1E\",\"colorScheme\":\"dark\"},\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"\\n  [data-bright-theme] ::selection { background-color: var(--selection-background) }\\n  [data-bright-theme] [data-bright-ln] { \\n    color: var(--line-number-color); \\n    margin-right: 1.5ch; \\n    display: inline-block;\\n    text-align: right;\\n    user-select: none;\\n  }\\n  \"}}],\"$undefined\",[\"$\",\"pre\",null,{\"style\":{\"margin\":0,\"color\":\"#D4D4D4\",\"background\":\"#1E1E1E\",\"padding\":\"1em 0\",\"overflow\":\"auto\"},\"children\":[\"$\",\"code\",null,{\"className\":\"$undefined\",\"style\":{\"display\":\"block\",\"minWidth\":\"fit-content\"},\"children\":[[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":1,\"style\":{\"width\":\"1ch\"},\"children\":1}],[[\"$\",\"span\",null,{\"style\":{},\"children\":\"User Input → LLM Decision → [Tool Use?] → Final Response\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":2,\"style\":{\"width\":\"1ch\"},\"children\":2}],[[\"$\",\"span\",null,{\"style\":{},\"children\":\"                              ↓\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":3,\"style\":{\"width\":\"1ch\"},\"children\":3}],[[\"$\",\"span\",null,{\"style\":{},\"children\":\"                        Execute Tool(s)\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":4,\"style\":{\"width\":\"1ch\"},\"children\":4}],[[\"$\",\"span\",null,{\"style\":{},\"children\":\"                              ↓\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":5,\"style\":{\"width\":\"1ch\"},\"children\":5}],[[\"$\",\"span\",null,{\"style\":{},\"children\":\"                     Feed Results back to LLM\"}]],[\"$\",\"br\",null,{}]]}]}]]}]}]]}]\n"])</script><script>self.__next_f.push([1,"1c:[\"$\",\"div\",null,{\"data-bright-theme\":\"dark-plus\",\"data-bright-mode\":\"$undefined\",\"className\":\"$undefined\",\"style\":{\"color\":\"#D4D4D4\",\"borderRadius\":\"4px\",\"overflow\":\"hidden\",\"margin\":\"1em 0\",\"--selection-background\":\"#264F78\",\"--line-number-color\":\"#858585\",\"--tab-border\":\"#252526\",\"--tab-background\":\"#1E1E1E\",\"--tab-color\":\"#ffffff\",\"--inactive-tab-background\":\"#2D2D2D\",\"--inactive-tab-color\":\"#ffffff80\",\"--tab-top-border\":\"$undefined\",\"--tab-bottom-border\":\"#1E1E1E\",\"colorScheme\":\"dark\"},\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"\\n  [data-bright-theme] ::selection { background-color: var(--selection-background) }\\n  [data-bright-theme] [data-bright-ln] { \\n    color: var(--line-number-color); \\n    margin-right: 1.5ch; \\n    display: inline-block;\\n    text-align: right;\\n    user-select: none;\\n  }\\n  \"}}],\"$undefined\",[\"$\",\"pre\",null,{\"style\":{\"margin\":0,\"color\":\"#D4D4D4\",\"background\":\"#1E1E1E\",\"padding\":\"1em 0\",\"overflow\":\"auto\"},\"children\":[\"$\",\"code\",null,{\"className\":\"$undefined\",\"style\":{\"display\":\"block\",\"minWidth\":\"fit-content\"},\"children\":[[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":1,\"style\":{\"width\":\"2ch\"},\"children\":1}],[[\"$\",\"span\",null,{\"style\":{},\"children\":\"User: \\\"How many users are in our database?\\\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":2,\"style\":{\"width\":\"2ch\"},\"children\":2}],[[\"$\",\"span\",null,{\"style\":{},\"children\":\"│\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":3,\"style\":{\"width\":\"2ch\"},\"children\":3}],[[\"$\",\"span\",null,{\"style\":{},\"children\":\"├─► LLM Thinks: \\\"I need to query the database\\\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":4,\"style\":{\"width\":\"2ch\"},\"children\":4}],[[\"$\",\"span\",null,{\"style\":{},\"children\":\"│    │\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":5,\"style\":{\"width\":\"2ch\"},\"children\":5}],[[\"$\",\"span\",null,{\"style\":{},\"children\":\"│    ├─► Calls query_database tool\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":6,\"style\":{\"width\":\"2ch\"},\"children\":6}],[[\"$\",\"span\",null,{\"style\":{},\"children\":\"│    │    │\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":7,\"style\":{\"width\":\"2ch\"},\"children\":7}],[[\"$\",\"span\",null,{\"style\":{},\"children\":\"│    │    └─► Returns user count\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":8,\"style\":{\"width\":\"2ch\"},\"children\":8}],[[\"$\",\"span\",null,{\"style\":{},\"children\":\"│    │\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":9,\"style\":{\"width\":\"2ch\"},\"children\":9}],[[\"$\",\"span\",null,{\"style\":{},\"children\":\"│    └─► Formulates final response with data\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":10,\"style\":{\"width\":\"2ch\"},\"children\":10}],[[\"$\",\"span\",null,{\"style\":{},\"children\":\"│\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":11,\"style\":{\"width\":\"2ch\"},\"children\":11}],[[\"$\",\"span\",null,{\"style\":{},\"children\":\"└─► Final Response: \\\"There are 1,234 users in the database\\\"\"}]],[\"$\",\"br\",null,{}]]}]}]]}]}]]}]\n"])</script><script>self.__next_f.push([1,"1f:[\"$\",\"div\",null,{\"data-bright-theme\":\"dark-plus\",\"data-bright-mode\":\"$undefined\",\"className\":\"$undefined\",\"style\":{\"color\":\"#D4D4D4\",\"borderRadius\":\"4px\",\"overflow\":\"hidden\",\"margin\":\"1em 0\",\"--selection-background\":\"#264F78\",\"--line-number-color\":\"#858585\",\"--tab-border\":\"#252526\",\"--tab-background\":\"#1E1E1E\",\"--tab-color\":\"#ffffff\",\"--inactive-tab-background\":\"#2D2D2D\",\"--inactive-tab-color\":\"#ffffff80\",\"--tab-top-border\":\"$undefined\",\"--tab-bottom-border\":\"#1E1E1E\",\"colorScheme\":\"dark\"},\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"\\n  [data-bright-theme] ::selection { background-color: var(--selection-background) }\\n  [data-bright-theme] [data-bright-ln] { \\n    color: var(--line-number-color); \\n    margin-right: 1.5ch; \\n    display: inline-block;\\n    text-align: right;\\n    user-select: none;\\n  }\\n  \"}}],\"$undefined\",[\"$\",\"pre\",null,{\"style\":{\"margin\":0,\"color\":\"#D4D4D4\",\"background\":\"#1E1E1E\",\"padding\":\"1em 0\",\"overflow\":\"auto\"},\"children\":[\"$\",\"code\",null,{\"className\":\"$undefined\",\"style\":{\"display\":\"block\",\"minWidth\":\"fit-content\"},\"children\":[[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":1,\"style\":{\"width\":\"2ch\"},\"children\":1}],[[\"$\",\"span\",null,{\"style\":{},\"children\":\"User Input ─► Store in DB ─────────────┐\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":2,\"style\":{\"width\":\"2ch\"},\"children\":2}],[[\"$\",\"span\",null,{\"style\":{},\"children\":\"                                       │\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":3,\"style\":{\"width\":\"2ch\"},\"children\":3}],[[\"$\",\"span\",null,{\"style\":{},\"children\":\"                                       ▼\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":4,\"style\":{\"width\":\"2ch\"},\"children\":4}],[[\"$\",\"span\",null,{\"style\":{},\"children\":\"                            Check Context Length\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":5,\"style\":{\"width\":\"2ch\"},\"children\":5}],[[\"$\",\"span\",null,{\"style\":{},\"children\":\"                                       │\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":6,\"style\":{\"width\":\"2ch\"},\"children\":6}],[[\"$\",\"span\",null,{\"style\":{},\"children\":\"                                       ▼\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":7,\"style\":{\"width\":\"2ch\"},\"children\":7}],[[\"$\",\"span\",null,{\"style\":{},\"children\":\"                          If too long, Summarize\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":8,\"style\":{\"width\":\"2ch\"},\"children\":8}],[[\"$\",\"span\",null,{\"style\":{},\"children\":\"                                       │\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":9,\"style\":{\"width\":\"2ch\"},\"children\":9}],[[\"$\",\"span\",null,{\"style\":{},\"children\":\"                                       ▼\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":10,\"style\":{\"width\":\"2ch\"},\"children\":10}],[[\"$\",\"span\",null,{\"style\":{},\"children\":\"                         Load Relevant Context\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":11,\"style\":{\"width\":\"2ch\"},\"children\":11}],[[\"$\",\"span\",null,{\"style\":{},\"children\":\"                                       │\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":12,\"style\":{\"width\":\"2ch\"},\"children\":12}],[[\"$\",\"span\",null,{\"style\":{},\"children\":\"                                       ▼\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":13,\"style\":{\"width\":\"2ch\"},\"children\":13}],[[\"$\",\"span\",null,{\"style\":{},\"children\":\"                           Send to LLM with\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":14,\"style\":{\"width\":\"2ch\"},\"children\":14}],[[\"$\",\"span\",null,{\"style\":{},\"children\":\"                           Next User Input\"}]],[\"$\",\"br\",null,{}]]}]}]]}]}]]}]\n"])</script><script>self.__next_f.push([1,"22:[\"$\",\"div\",null,{\"data-bright-theme\":\"dark-plus\",\"data-bright-mode\":\"$undefined\",\"className\":\"$undefined\",\"style\":{\"color\":\"#D4D4D4\",\"borderRadius\":\"4px\",\"overflow\":\"hidden\",\"margin\":\"1em 0\",\"--selection-background\":\"#264F78\",\"--line-number-color\":\"#858585\",\"--tab-border\":\"#252526\",\"--tab-background\":\"#1E1E1E\",\"--tab-color\":\"#ffffff\",\"--inactive-tab-background\":\"#2D2D2D\",\"--inactive-tab-color\":\"#ffffff80\",\"--tab-top-border\":\"$undefined\",\"--tab-bottom-border\":\"#1E1E1E\",\"colorScheme\":\"dark\"},\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"\\n  [data-bright-theme] ::selection { background-color: var(--selection-background) }\\n  [data-bright-theme] [data-bright-ln] { \\n    color: var(--line-number-color); \\n    margin-right: 1.5ch; \\n    display: inline-block;\\n    text-align: right;\\n    user-select: none;\\n  }\\n  \"}}],\"$undefined\",[\"$\",\"pre\",null,{\"style\":{\"margin\":0,\"color\":\"#D4D4D4\",\"background\":\"#1E1E1E\",\"padding\":\"1em 0\",\"overflow\":\"auto\"},\"children\":[\"$\",\"code\",null,{\"className\":\"$undefined\",\"style\":{\"display\":\"block\",\"minWidth\":\"fit-content\"},\"children\":[[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":1,\"style\":{\"width\":\"1ch\"},\"children\":1}],[[\"$\",\"span\",null,{\"style\":{},\"children\":\"User: How many users do we have in our database?\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":2,\"style\":{\"width\":\"1ch\"},\"children\":2}],[[\"$\",\"span\",null,{\"style\":{},\"children\":\"Assistant: According to the database, we currently have 10,432 registered users.\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":3,\"style\":{\"width\":\"1ch\"},\"children\":3}],[[\"$\",\"span\",null,{\"style\":{},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":4,\"style\":{\"width\":\"1ch\"},\"children\":4}],[[\"$\",\"span\",null,{\"style\":{},\"children\":\"User: What's the average age of users from New York?\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":5,\"style\":{\"width\":\"1ch\"},\"children\":5}],[[\"$\",\"span\",null,{\"style\":{},\"children\":\"Assistant: I've queried the database and found that users from New York have an average age of 31.5 years.\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":6,\"style\":{\"width\":\"1ch\"},\"children\":6}],[[\"$\",\"span\",null,{\"style\":{},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":7,\"style\":{\"width\":\"1ch\"},\"children\":7}],[[\"$\",\"span\",null,{\"style\":{},\"children\":\"User: Compare our user base in California with PostgreSQL's popularity there\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":8,\"style\":{\"width\":\"1ch\"},\"children\":8}],[[\"$\",\"span\",null,{\"style\":{},\"children\":\"Assistant: Let me check both sources. According to our database, we have 2,345 users from California. From Wikipedia, PostgreSQL is particularly popular in the Silicon Valley region, being used by companies like Apple, Instagram, and Reddit. In fact, many of our California users (43%) are in the tech industry, which aligns with PostgreSQL's strong presence in the region.\"}]],[\"$\",\"br\",null,{}]]}]}]]}]}]]}]\n"])</script><script>self.__next_f.push([1,"16:[\"$\",\"div\",null,{\"data-bright-theme\":\"dark-plus\",\"data-bright-mode\":\"$undefined\",\"className\":\"$undefined\",\"style\":{\"color\":\"#D4D4D4\",\"borderRadius\":\"4px\",\"overflow\":\"hidden\",\"margin\":\"1em 0\",\"--selection-background\":\"#264F78\",\"--line-number-color\":\"#858585\",\"--tab-border\":\"#252526\",\"--tab-background\":\"#1E1E1E\",\"--tab-color\":\"#ffffff\",\"--inactive-tab-background\":\"#2D2D2D\",\"--inactive-tab-color\":\"#ffffff80\",\"--tab-top-border\":\"$undefined\",\"--tab-bottom-border\":\"#1E1E1E\",\"colorScheme\":\"dark\"},\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"\\n  [data-bright-theme] ::selection { background-color: var(--selection-background) }\\n  [data-bright-theme] [data-bright-ln] { \\n    color: var(--line-number-color); \\n    margin-right: 1.5ch; \\n    display: inline-block;\\n    text-align: right;\\n    user-select: none;\\n  }\\n  \"}}],\"$undefined\",[\"$\",\"pre\",null,{\"style\":{\"margin\":0,\"color\":\"#D4D4D4\",\"background\":\"#1E1E1E\",\"padding\":\"1em 0\",\"overflow\":\"auto\"},\"children\":[\"$\",\"code\",null,{\"className\":\"$undefined\",\"style\":{\"display\":\"block\",\"minWidth\":\"fit-content\"},\"children\":[[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":1,\"style\":{\"width\":\"2ch\"},\"children\":1}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"def \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCDCAA\"},\"children\":\"search_wikipedia\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#9CDCFE\"},\"children\":\"query\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4EC9B0\"},\"children\":\"str\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\") -\u003e \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4EC9B0\"},\"children\":\"str\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\":\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":2,\"style\":{\"width\":\"2ch\"},\"children\":2}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"    \\\"\\\"\\\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":3,\"style\":{\"width\":\"2ch\"},\"children\":3}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"    Searches Wikipedia and returns the first paragraph of the most relevant article.\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":4,\"style\":{\"width\":\"2ch\"},\"children\":4}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":5,\"style\":{\"width\":\"2ch\"},\"children\":5}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"    Args:\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":6,\"style\":{\"width\":\"2ch\"},\"children\":6}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"        query: The search term to look up on Wikipedia\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":7,\"style\":{\"width\":\"2ch\"},\"children\":7}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":8,\"style\":{\"width\":\"2ch\"},\"children\":8}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"    Returns:\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":9,\"style\":{\"width\":\"2ch\"},\"children\":9}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"        str: The first paragraph of the most relevant Wikipedia article\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":10,\"style\":{\"width\":\"2ch\"},\"children\":10}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"    \\\"\\\"\\\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":11,\"style\":{\"width\":\"2ch\"},\"children\":11}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"    return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" wikipedia.summary(query, \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#9CDCFE\"},\"children\":\"sentences\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B5CEA8\"},\"children\":\"3\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\")\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":12,\"style\":{\"width\":\"2ch\"},\"children\":12}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":13,\"style\":{\"width\":\"2ch\"},\"children\":13}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6A9955\"},\"children\":\"# This is how we describe the tool to the LLM\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":14,\"style\":{\"width\":\"2ch\"},\"children\":14}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"wikipedia_tool_description = \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"\\\"\\\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":15,\"style\":{\"width\":\"2ch\"},\"children\":15}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"Tool: search_wikipedia\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":16,\"style\":{\"width\":\"2ch\"},\"children\":16}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"Description: Searches Wikipedia and returns a summary of the topic\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":17,\"style\":{\"width\":\"2ch\"},\"children\":17}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"Input: A search query string\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":18,\"style\":{\"width\":\"2ch\"},\"children\":18}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"Example: To learn about Python programming, use: search_wikipedia(\\\"Python programming language\\\")\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":19,\"style\":{\"width\":\"2ch\"},\"children\":19}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"\\\"\\\"\"}]],[\"$\",\"br\",null,{}]]}]}]]}]}]]}]\n"])</script><script>self.__next_f.push([1,"17:[\"$\",\"div\",null,{\"data-bright-theme\":\"dark-plus\",\"data-bright-mode\":\"$undefined\",\"className\":\"$undefined\",\"style\":{\"color\":\"#D4D4D4\",\"borderRadius\":\"4px\",\"overflow\":\"hidden\",\"margin\":\"1em 0\",\"--selection-background\":\"#264F78\",\"--line-number-color\":\"#858585\",\"--tab-border\":\"#252526\",\"--tab-background\":\"#1E1E1E\",\"--tab-color\":\"#ffffff\",\"--inactive-tab-background\":\"#2D2D2D\",\"--inactive-tab-color\":\"#ffffff80\",\"--tab-top-border\":\"$undefined\",\"--tab-bottom-border\":\"#1E1E1E\",\"colorScheme\":\"dark\"},\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"\\n  [data-bright-theme] ::selection { background-color: var(--selection-background) }\\n  [data-bright-theme] [data-bright-ln] { \\n    color: var(--line-number-color); \\n    margin-right: 1.5ch; \\n    display: inline-block;\\n    text-align: right;\\n    user-select: none;\\n  }\\n  \"}}],\"$undefined\",[\"$\",\"pre\",null,{\"style\":{\"margin\":0,\"color\":\"#D4D4D4\",\"background\":\"#1E1E1E\",\"padding\":\"1em 0\",\"overflow\":\"auto\"},\"children\":[\"$\",\"code\",null,{\"className\":\"$undefined\",\"style\":{\"display\":\"block\",\"minWidth\":\"fit-content\"},\"children\":[[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":1,\"style\":{\"width\":\"2ch\"},\"children\":1}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6A9955\"},\"children\":\"# This is what an agent interaction basically looks like\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":2,\"style\":{\"width\":\"2ch\"},\"children\":2}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"def \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCDCAA\"},\"children\":\"agent_interaction\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#9CDCFE\"},\"children\":\"user_input\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#9CDCFE\"},\"children\":\"available_tools\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#9CDCFE\"},\"children\":\"conversation_history\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"):\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":3,\"style\":{\"width\":\"2ch\"},\"children\":3}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6A9955\"},\"children\":\"    # 1. We tell the LLM what it can do\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":4,\"style\":{\"width\":\"2ch\"},\"children\":4}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"    prompt = \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"f\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"\\\"\\\"You have access to these tools:\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":5,\"style\":{\"width\":\"2ch\"},\"children\":5}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"    - query_database: Executes SQL queries\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":6,\"style\":{\"width\":\"2ch\"},\"children\":6}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"    - search_wikipedia: Searches Wikipedia articles\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":7,\"style\":{\"width\":\"2ch\"},\"children\":7}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":8,\"style\":{\"width\":\"2ch\"},\"children\":8}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"    Previous conversation:\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":9,\"style\":{\"width\":\"2ch\"},\"children\":9}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"    {\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"conversation_history\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"}\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":10,\"style\":{\"width\":\"2ch\"},\"children\":10}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":11,\"style\":{\"width\":\"2ch\"},\"children\":11}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"    User question: \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"user_input\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"}\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":12,\"style\":{\"width\":\"2ch\"},\"children\":12}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":13,\"style\":{\"width\":\"2ch\"},\"children\":13}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"    Decide if you need to use a tool to answer. If yes, specify which tool and how to use it.\\\"\\\"\\\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":14,\"style\":{\"width\":\"2ch\"},\"children\":14}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":15,\"style\":{\"width\":\"2ch\"},\"children\":15}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6A9955\"},\"children\":\"    # 2. The LLM decides what to do\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":16,\"style\":{\"width\":\"2ch\"},\"children\":16}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"    llm_response = gpt4_call(prompt)\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":17,\"style\":{\"width\":\"2ch\"},\"children\":17}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":18,\"style\":{\"width\":\"2ch\"},\"children\":18}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6A9955\"},\"children\":\"    # 3. We execute the tool if needed and get the final answer\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":19,\"style\":{\"width\":\"2ch\"},\"children\":19}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"    if \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"use query_database\\\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"in\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" llm_response:\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":20,\"style\":{\"width\":\"2ch\"},\"children\":20}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6A9955\"},\"children\":\"        # Execute database query and get result\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":21,\"style\":{\"width\":\"2ch\"},\"children\":21}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"        data = execute_query(extract_query(llm_response))\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":22,\"style\":{\"width\":\"2ch\"},\"children\":22}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"        return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" get_final_answer(data)\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":23,\"style\":{\"width\":\"2ch\"},\"children\":23}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":24,\"style\":{\"width\":\"2ch\"},\"children\":24}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"    return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" llm_response\"}]],[\"$\",\"br\",null,{}]]}]}]]}]}]]}]\n"])</script><script>self.__next_f.push([1,"18:[\"$\",\"div\",null,{\"data-bright-theme\":\"dark-plus\",\"data-bright-mode\":\"$undefined\",\"className\":\"$undefined\",\"style\":{\"color\":\"#D4D4D4\",\"borderRadius\":\"4px\",\"overflow\":\"hidden\",\"margin\":\"1em 0\",\"--selection-background\":\"#264F78\",\"--line-number-color\":\"#858585\",\"--tab-border\":\"#252526\",\"--tab-background\":\"#1E1E1E\",\"--tab-color\":\"#ffffff\",\"--inactive-tab-background\":\"#2D2D2D\",\"--inactive-tab-color\":\"#ffffff80\",\"--tab-top-border\":\"$undefined\",\"--tab-bottom-border\":\"#1E1E1E\",\"colorScheme\":\"dark\"},\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"\\n  [data-bright-theme] ::selection { background-color: var(--selection-background) }\\n  [data-bright-theme] [data-bright-ln] { \\n    color: var(--line-number-color); \\n    margin-right: 1.5ch; \\n    display: inline-block;\\n    text-align: right;\\n    user-select: none;\\n  }\\n  \"}}],\"$undefined\",[\"$\",\"pre\",null,{\"style\":{\"margin\":0,\"color\":\"#D4D4D4\",\"background\":\"#1E1E1E\",\"padding\":\"1em 0\",\"overflow\":\"auto\"},\"children\":[\"$\",\"code\",null,{\"className\":\"$undefined\",\"style\":{\"display\":\"block\",\"minWidth\":\"fit-content\"},\"children\":[[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":1,\"style\":{\"width\":\"2ch\"},\"children\":1}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6A9955\"},\"children\":\"# With a framework:\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":2,\"style\":{\"width\":\"2ch\"},\"children\":2}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"agent = Agent.from_toolkit(SQLToolkit, WikiToolkit)\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":3,\"style\":{\"width\":\"2ch\"},\"children\":3}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"result = agent.run(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"Find users who like pizza\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\")\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":4,\"style\":{\"width\":\"2ch\"},\"children\":4}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":5,\"style\":{\"width\":\"2ch\"},\"children\":5}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6A9955\"},\"children\":\"# Without a framework - what's actually happening:\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":6,\"style\":{\"width\":\"2ch\"},\"children\":6}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"def \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCDCAA\"},\"children\":\"process_query\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#9CDCFE\"},\"children\":\"user_input\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4EC9B0\"},\"children\":\"str\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"):\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":7,\"style\":{\"width\":\"2ch\"},\"children\":7}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"    prompt = \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"f\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"\\\"\\\"You have these tools:\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":8,\"style\":{\"width\":\"2ch\"},\"children\":8}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"    1. SQL queries: Execute database queries\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":9,\"style\":{\"width\":\"2ch\"},\"children\":9}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"    2. Wikipedia search: Look up information\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":10,\"style\":{\"width\":\"2ch\"},\"children\":10}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":11,\"style\":{\"width\":\"2ch\"},\"children\":11}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"    User question: \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"user_input\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"}\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":12,\"style\":{\"width\":\"2ch\"},\"children\":12}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":13,\"style\":{\"width\":\"2ch\"},\"children\":13}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"    Think step by step:\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":14,\"style\":{\"width\":\"2ch\"},\"children\":14}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"    1. Do I need any tools to answer this?\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":15,\"style\":{\"width\":\"2ch\"},\"children\":15}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"    2. If yes, which tool and how should I use it?\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":16,\"style\":{\"width\":\"2ch\"},\"children\":16}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"    \\\"\\\"\\\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":17,\"style\":{\"width\":\"2ch\"},\"children\":17}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":18,\"style\":{\"width\":\"2ch\"},\"children\":18}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"    response = gpt4_call(prompt)\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":19,\"style\":{\"width\":\"2ch\"},\"children\":19}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"    if \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"SQL\\\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"in\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" response:\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":20,\"style\":{\"width\":\"2ch\"},\"children\":20}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"        query = extract_sql(response)\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":21,\"style\":{\"width\":\"2ch\"},\"children\":21}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"        data = execute_query(query)\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":22,\"style\":{\"width\":\"2ch\"},\"children\":22}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"    if \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"Wikipedia\\\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"in\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" response:\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":23,\"style\":{\"width\":\"2ch\"},\"children\":23}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"        data = search_wikipedia(topic)\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":24,\"style\":{\"width\":\"2ch\"},\"children\":24}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"        return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" get_final_answer(data)\"}]],[\"$\",\"br\",null,{}]]}]}]]}]}]]}]\n"])</script><script>self.__next_f.push([1,"19:[\"$\",\"div\",null,{\"data-bright-theme\":\"dark-plus\",\"data-bright-mode\":\"$undefined\",\"className\":\"$undefined\",\"style\":{\"color\":\"#D4D4D4\",\"borderRadius\":\"4px\",\"overflow\":\"hidden\",\"margin\":\"1em 0\",\"--selection-background\":\"#264F78\",\"--line-number-color\":\"#858585\",\"--tab-border\":\"#252526\",\"--tab-background\":\"#1E1E1E\",\"--tab-color\":\"#ffffff\",\"--inactive-tab-background\":\"#2D2D2D\",\"--inactive-tab-color\":\"#ffffff80\",\"--tab-top-border\":\"$undefined\",\"--tab-bottom-border\":\"#1E1E1E\",\"colorScheme\":\"dark\"},\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"\\n  [data-bright-theme] ::selection { background-color: var(--selection-background) }\\n  [data-bright-theme] [data-bright-ln] { \\n    color: var(--line-number-color); \\n    margin-right: 1.5ch; \\n    display: inline-block;\\n    text-align: right;\\n    user-select: none;\\n  }\\n  \"}}],\"$undefined\",[\"$\",\"pre\",null,{\"style\":{\"margin\":0,\"color\":\"#D4D4D4\",\"background\":\"#1E1E1E\",\"padding\":\"1em 0\",\"overflow\":\"auto\"},\"children\":[\"$\",\"code\",null,{\"className\":\"$undefined\",\"style\":{\"display\":\"block\",\"minWidth\":\"fit-content\"},\"children\":[[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":1,\"style\":{\"width\":\"1ch\"},\"children\":1}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6A9955\"},\"children\":\"# Framework error:\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":2,\"style\":{\"width\":\"1ch\"},\"children\":2}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"AgentError: Tool execution failed: SQLToolkit.query failed \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"with\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" error:\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":3,\"style\":{\"width\":\"1ch\"},\"children\":3}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"Invalid chain configuration...\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":4,\"style\":{\"width\":\"1ch\"},\"children\":4}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":5,\"style\":{\"width\":\"1ch\"},\"children\":5}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6A9955\"},\"children\":\"# Without framework:\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":6,\"style\":{\"width\":\"1ch\"},\"children\":6}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"try\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\":\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":7,\"style\":{\"width\":\"1ch\"},\"children\":7}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"    data = execute_query(query)\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":8,\"style\":{\"width\":\"1ch\"},\"children\":8}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"except\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" SQLException \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"as\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" e:\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":9,\"style\":{\"width\":\"1ch\"},\"children\":9}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCDCAA\"},\"children\":\"    print\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"f\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"SQL error: \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\")  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6A9955\"},\"children\":\"# Clear what went wrong\"}]],[\"$\",\"br\",null,{}]]}]}]]}]}]]}]\n"])</script><script>self.__next_f.push([1,"1a:[\"$\",\"div\",null,{\"data-bright-theme\":\"dark-plus\",\"data-bright-mode\":\"$undefined\",\"className\":\"$undefined\",\"style\":{\"color\":\"#D4D4D4\",\"borderRadius\":\"4px\",\"overflow\":\"hidden\",\"margin\":\"1em 0\",\"--selection-background\":\"#264F78\",\"--line-number-color\":\"#858585\",\"--tab-border\":\"#252526\",\"--tab-background\":\"#1E1E1E\",\"--tab-color\":\"#ffffff\",\"--inactive-tab-background\":\"#2D2D2D\",\"--inactive-tab-color\":\"#ffffff80\",\"--tab-top-border\":\"$undefined\",\"--tab-bottom-border\":\"#1E1E1E\",\"colorScheme\":\"dark\"},\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"\\n  [data-bright-theme] ::selection { background-color: var(--selection-background) }\\n  [data-bright-theme] [data-bright-ln] { \\n    color: var(--line-number-color); \\n    margin-right: 1.5ch; \\n    display: inline-block;\\n    text-align: right;\\n    user-select: none;\\n  }\\n  \"}}],\"$undefined\",[\"$\",\"pre\",null,{\"style\":{\"margin\":0,\"color\":\"#D4D4D4\",\"background\":\"#1E1E1E\",\"padding\":\"1em 0\",\"overflow\":\"auto\"},\"children\":[\"$\",\"code\",null,{\"className\":\"$undefined\",\"style\":{\"display\":\"block\",\"minWidth\":\"fit-content\"},\"children\":[[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":1,\"style\":{\"width\":\"3ch\"},\"children\":1}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"import\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" json\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":2,\"style\":{\"width\":\"3ch\"},\"children\":2}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"import\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" psycopg2\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":3,\"style\":{\"width\":\"3ch\"},\"children\":3}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"import\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" wikipedia\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":4,\"style\":{\"width\":\"3ch\"},\"children\":4}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"from\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" typing \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"import\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" Dict, List, Any\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":5,\"style\":{\"width\":\"3ch\"},\"children\":5}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"from\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" openai \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"import\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" OpenAI\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":6,\"style\":{\"width\":\"3ch\"},\"children\":6}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":7,\"style\":{\"width\":\"3ch\"},\"children\":7}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6A9955\"},\"children\":\"# First, we define how the LLM should understand our tools\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":8,\"style\":{\"width\":\"3ch\"},\"children\":8}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"tools = [\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":9,\"style\":{\"width\":\"3ch\"},\"children\":9}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"    {\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":10,\"style\":{\"width\":\"3ch\"},\"children\":10}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"        \\\"type\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"function\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\",\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":11,\"style\":{\"width\":\"3ch\"},\"children\":11}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"        \\\"function\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": {\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":12,\"style\":{\"width\":\"3ch\"},\"children\":12}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"            \\\"name\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"query_database\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\",\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":13,\"style\":{\"width\":\"3ch\"},\"children\":13}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"            \\\"description\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"\\\"\\\"Execute a PostgreSQL SELECT query and return the results.\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":14,\"style\":{\"width\":\"3ch\"},\"children\":14}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"                            Only SELECT queries are allowed for security reasons.\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":15,\"style\":{\"width\":\"3ch\"},\"children\":15}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"                            Returns data in JSON format.\\\"\\\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\",\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":16,\"style\":{\"width\":\"3ch\"},\"children\":16}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"            \\\"parameters\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": {\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":17,\"style\":{\"width\":\"3ch\"},\"children\":17}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"                \\\"type\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"object\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\",\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":18,\"style\":{\"width\":\"3ch\"},\"children\":18}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"                \\\"properties\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": {\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":19,\"style\":{\"width\":\"3ch\"},\"children\":19}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"                    \\\"query\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": {\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":20,\"style\":{\"width\":\"3ch\"},\"children\":20}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"                        \\\"type\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"string\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\",\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":21,\"style\":{\"width\":\"3ch\"},\"children\":21}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"                        \\\"description\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"\\\"\\\"The SQL SELECT query to execute.\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":22,\"style\":{\"width\":\"3ch\"},\"children\":22}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"                                        Must start with SELECT and should not\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":23,\"style\":{\"width\":\"3ch\"},\"children\":23}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"                                        contain any data modification commands.\\\"\\\"\\\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":24,\"style\":{\"width\":\"3ch\"},\"children\":24}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"                    }\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":25,\"style\":{\"width\":\"3ch\"},\"children\":25}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"                },\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":26,\"style\":{\"width\":\"3ch\"},\"children\":26}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"                \\\"required\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": [\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"query\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"],\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":27,\"style\":{\"width\":\"3ch\"},\"children\":27}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"                \\\"additionalProperties\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"False\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":28,\"style\":{\"width\":\"3ch\"},\"children\":28}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"            },\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":29,\"style\":{\"width\":\"3ch\"},\"children\":29}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"            \\\"strict\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"True\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":30,\"style\":{\"width\":\"3ch\"},\"children\":30}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"        }\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":31,\"style\":{\"width\":\"3ch\"},\"children\":31}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"    },\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":32,\"style\":{\"width\":\"3ch\"},\"children\":32}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"    {\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":33,\"style\":{\"width\":\"3ch\"},\"children\":33}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"        \\\"type\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"function\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\",\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":34,\"style\":{\"width\":\"3ch\"},\"children\":34}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"        \\\"function\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": {\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":35,\"style\":{\"width\":\"3ch\"},\"children\":35}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"            \\\"name\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"search_wikipedia\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\",\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":36,\"style\":{\"width\":\"3ch\"},\"children\":36}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"            \\\"description\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"\\\"\\\"Search Wikipedia and return a concise summary.\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":37,\"style\":{\"width\":\"3ch\"},\"children\":37}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"                            Returns the first three sentences of the most\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":38,\"style\":{\"width\":\"3ch\"},\"children\":38}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"                            relevant article.\\\"\\\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\",\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":39,\"style\":{\"width\":\"3ch\"},\"children\":39}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"            \\\"parameters\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": {\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":40,\"style\":{\"width\":\"3ch\"},\"children\":40}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"                \\\"type\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"object\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\",\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":41,\"style\":{\"width\":\"3ch\"},\"children\":41}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"                \\\"properties\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": {\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":42,\"style\":{\"width\":\"3ch\"},\"children\":42}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"                    \\\"query\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": {\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":43,\"style\":{\"width\":\"3ch\"},\"children\":43}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"                        \\\"type\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"string\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\",\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":44,\"style\":{\"width\":\"3ch\"},\"children\":44}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"                        \\\"description\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"The topic to search for on Wikipedia\\\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":45,\"style\":{\"width\":\"3ch\"},\"children\":45}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"                    }\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":46,\"style\":{\"width\":\"3ch\"},\"children\":46}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"                },\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":47,\"style\":{\"width\":\"3ch\"},\"children\":47}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"                \\\"required\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": [\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"query\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"],\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":48,\"style\":{\"width\":\"3ch\"},\"children\":48}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"                \\\"additionalProperties\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"False\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":49,\"style\":{\"width\":\"3ch\"},\"children\":49}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"            },\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":50,\"style\":{\"width\":\"3ch\"},\"children\":50}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"            \\\"strict\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"True\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":51,\"style\":{\"width\":\"3ch\"},\"children\":51}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"        }\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":52,\"style\":{\"width\":\"3ch\"},\"children\":52}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"    }\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":53,\"style\":{\"width\":\"3ch\"},\"children\":53}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"]\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":54,\"style\":{\"width\":\"3ch\"},\"children\":54}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":55,\"style\":{\"width\":\"3ch\"},\"children\":55}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6A9955\"},\"children\":\"# Now implement the actual tool functions\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":56,\"style\":{\"width\":\"3ch\"},\"children\":56}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"def \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCDCAA\"},\"children\":\"query_database\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#9CDCFE\"},\"children\":\"query\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4EC9B0\"},\"children\":\"str\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\") -\u003e \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4EC9B0\"},\"children\":\"str\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\":\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":57,\"style\":{\"width\":\"3ch\"},\"children\":57}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"    \\\"\\\"\\\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":58,\"style\":{\"width\":\"3ch\"},\"children\":58}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"    Execute a PostgreSQL query and return results as a JSON string.\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":59,\"style\":{\"width\":\"3ch\"},\"children\":59}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"    Includes safety checks and error handling.\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":60,\"style\":{\"width\":\"3ch\"},\"children\":60}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"    \\\"\\\"\\\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":61,\"style\":{\"width\":\"3ch\"},\"children\":61}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6A9955\"},\"children\":\"    # Security check: Only allow SELECT queries\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":62,\"style\":{\"width\":\"3ch\"},\"children\":62}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"    if \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"not\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" query.lower().strip().startswith(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"'select'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"):\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":63,\"style\":{\"width\":\"3ch\"},\"children\":63}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"        return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" json.dumps({\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":64,\"style\":{\"width\":\"3ch\"},\"children\":64}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"            \\\"error\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"Only SELECT queries are allowed for security reasons.\\\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":65,\"style\":{\"width\":\"3ch\"},\"children\":65}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"        })\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":66,\"style\":{\"width\":\"3ch\"},\"children\":66}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":67,\"style\":{\"width\":\"3ch\"},\"children\":67}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"    try\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\":\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":68,\"style\":{\"width\":\"3ch\"},\"children\":68}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6A9955\"},\"children\":\"        # You should use environment variables for these in production\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":69,\"style\":{\"width\":\"3ch\"},\"children\":69}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"        conn = psycopg2.connect(\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":70,\"style\":{\"width\":\"3ch\"},\"children\":70}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"            \\\"dbname=your_db user=your_user password=your_pass host=localhost\\\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":71,\"style\":{\"width\":\"3ch\"},\"children\":71}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"        )\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":72,\"style\":{\"width\":\"3ch\"},\"children\":72}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":73,\"style\":{\"width\":\"3ch\"},\"children\":73}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"        with\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" conn.cursor() \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"as\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" cur:\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":74,\"style\":{\"width\":\"3ch\"},\"children\":74}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"            cur.execute(query)\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":75,\"style\":{\"width\":\"3ch\"},\"children\":75}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":76,\"style\":{\"width\":\"3ch\"},\"children\":76}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6A9955\"},\"children\":\"            # Get column names from cursor description\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":77,\"style\":{\"width\":\"3ch\"},\"children\":77}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"            columns = [desc[\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B5CEA8\"},\"children\":\"0\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"] \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"for\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" desc \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"in\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" cur.description]\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":78,\"style\":{\"width\":\"3ch\"},\"children\":78}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":79,\"style\":{\"width\":\"3ch\"},\"children\":79}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6A9955\"},\"children\":\"            # Fetch results and convert to list of dictionaries\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":80,\"style\":{\"width\":\"3ch\"},\"children\":80}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"            results = []\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":81,\"style\":{\"width\":\"3ch\"},\"children\":81}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"            for\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" row \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"in\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" cur.fetchall():\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":82,\"style\":{\"width\":\"3ch\"},\"children\":82}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"                results.append(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4EC9B0\"},\"children\":\"dict\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCDCAA\"},\"children\":\"zip\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"(columns, row)))\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":83,\"style\":{\"width\":\"3ch\"},\"children\":83}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":84,\"style\":{\"width\":\"3ch\"},\"children\":84}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"            return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" json.dumps({\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":85,\"style\":{\"width\":\"3ch\"},\"children\":85}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"                \\\"success\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"True\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\",\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":86,\"style\":{\"width\":\"3ch\"},\"children\":86}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"                \\\"data\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4EC9B0\"},\"children\":\"str\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"(results),\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":87,\"style\":{\"width\":\"3ch\"},\"children\":87}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"                \\\"row_count\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCDCAA\"},\"children\":\"len\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"(results)\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":88,\"style\":{\"width\":\"3ch\"},\"children\":88}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"            })\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":89,\"style\":{\"width\":\"3ch\"},\"children\":89}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":90,\"style\":{\"width\":\"3ch\"},\"children\":90}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"    except\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" psycopg2.Error \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"as\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" e:\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":91,\"style\":{\"width\":\"3ch\"},\"children\":91}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"        return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" json.dumps({\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":92,\"style\":{\"width\":\"3ch\"},\"children\":92}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"            \\\"error\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"f\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"Database error: \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4EC9B0\"},\"children\":\"str\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"(e)\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":93,\"style\":{\"width\":\"3ch\"},\"children\":93}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"        })\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":94,\"style\":{\"width\":\"3ch\"},\"children\":94}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"    except \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4EC9B0\"},\"children\":\"Exception \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"as\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" e:\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":95,\"style\":{\"width\":\"3ch\"},\"children\":95}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"        return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" json.dumps({\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":96,\"style\":{\"width\":\"3ch\"},\"children\":96}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"            \\\"error\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"f\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"Unexpected error: \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4EC9B0\"},\"children\":\"str\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"(e)\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":97,\"style\":{\"width\":\"3ch\"},\"children\":97}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"        })\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":98,\"style\":{\"width\":\"3ch\"},\"children\":98}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"    finally\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\":\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":99,\"style\":{\"width\":\"3ch\"},\"children\":99}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"        if \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"'conn' \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"in \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCDCAA\"},\"children\":\"locals\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"():\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":100,\"style\":{\"width\":\"3ch\"},\"children\":100}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"            conn.close()\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":101,\"style\":{\"width\":\"3ch\"},\"children\":101}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":102,\"style\":{\"width\":\"3ch\"},\"children\":102}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"def \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCDCAA\"},\"children\":\"search_wikipedia\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#9CDCFE\"},\"children\":\"query\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4EC9B0\"},\"children\":\"str\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\") -\u003e \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4EC9B0\"},\"children\":\"str\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\":\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":103,\"style\":{\"width\":\"3ch\"},\"children\":103}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"    \\\"\\\"\\\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":104,\"style\":{\"width\":\"3ch\"},\"children\":104}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"    Search Wikipedia and return a concise summary.\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":105,\"style\":{\"width\":\"3ch\"},\"children\":105}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"    Handles disambiguation and missing pages gracefully.\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":106,\"style\":{\"width\":\"3ch\"},\"children\":106}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"    \\\"\\\"\\\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":107,\"style\":{\"width\":\"3ch\"},\"children\":107}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"    try\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\":\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":108,\"style\":{\"width\":\"3ch\"},\"children\":108}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6A9955\"},\"children\":\"        # Try to get the most relevant page summary\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":109,\"style\":{\"width\":\"3ch\"},\"children\":109}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"        summary = wikipedia.summary(\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":110,\"style\":{\"width\":\"3ch\"},\"children\":110}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"            query,\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":111,\"style\":{\"width\":\"3ch\"},\"children\":111}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#9CDCFE\"},\"children\":\"            sentences\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B5CEA8\"},\"children\":\"3\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\",\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":112,\"style\":{\"width\":\"3ch\"},\"children\":112}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#9CDCFE\"},\"children\":\"            auto_suggest\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"True\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\",\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":113,\"style\":{\"width\":\"3ch\"},\"children\":113}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#9CDCFE\"},\"children\":\"            redirect\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"True\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":114,\"style\":{\"width\":\"3ch\"},\"children\":114}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"        )\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":115,\"style\":{\"width\":\"3ch\"},\"children\":115}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":116,\"style\":{\"width\":\"3ch\"},\"children\":116}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"        return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" json.dumps({\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":117,\"style\":{\"width\":\"3ch\"},\"children\":117}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"            \\\"success\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"True\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\",\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":118,\"style\":{\"width\":\"3ch\"},\"children\":118}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"            \\\"summary\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": summary,\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":119,\"style\":{\"width\":\"3ch\"},\"children\":119}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"            \\\"url\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": wikipedia.page(query).url\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":120,\"style\":{\"width\":\"3ch\"},\"children\":120}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"        })\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":121,\"style\":{\"width\":\"3ch\"},\"children\":121}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":122,\"style\":{\"width\":\"3ch\"},\"children\":122}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"    except\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" wikipedia.DisambiguationError \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"as\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" e:\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":123,\"style\":{\"width\":\"3ch\"},\"children\":123}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6A9955\"},\"children\":\"        # Handle multiple matching pages\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":124,\"style\":{\"width\":\"3ch\"},\"children\":124}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"        return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" json.dumps({\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":125,\"style\":{\"width\":\"3ch\"},\"children\":125}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"            \\\"error\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"Disambiguation error\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\",\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":126,\"style\":{\"width\":\"3ch\"},\"children\":126}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"            \\\"options\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": e.options[:\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B5CEA8\"},\"children\":\"5\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"],  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6A9955\"},\"children\":\"# List first 5 options\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":127,\"style\":{\"width\":\"3ch\"},\"children\":127}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"            \\\"message\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"Topic is ambiguous. Please be more specific.\\\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":128,\"style\":{\"width\":\"3ch\"},\"children\":128}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"        })\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":129,\"style\":{\"width\":\"3ch\"},\"children\":129}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"    except\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" wikipedia.PageError:\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":130,\"style\":{\"width\":\"3ch\"},\"children\":130}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"        return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" json.dumps({\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":131,\"style\":{\"width\":\"3ch\"},\"children\":131}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"            \\\"error\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"Page not found\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\",\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":132,\"style\":{\"width\":\"3ch\"},\"children\":132}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"            \\\"message\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"f\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"No Wikipedia article found for: \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"query\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":133,\"style\":{\"width\":\"3ch\"},\"children\":133}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"        })\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":134,\"style\":{\"width\":\"3ch\"},\"children\":134}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"    except \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4EC9B0\"},\"children\":\"Exception \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"as\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" e:\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":135,\"style\":{\"width\":\"3ch\"},\"children\":135}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"        return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" json.dumps({\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":136,\"style\":{\"width\":\"3ch\"},\"children\":136}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"            \\\"error\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"Unexpected error\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\",\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":137,\"style\":{\"width\":\"3ch\"},\"children\":137}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"            \\\"message\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4EC9B0\"},\"children\":\"str\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"(e)\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":138,\"style\":{\"width\":\"3ch\"},\"children\":138}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"        })\"}]],[\"$\",\"br\",null,{}]]}]}]]}]}]]}]\n"])</script><script>self.__next_f.push([1,"1d:[\"$\",\"div\",null,{\"data-bright-theme\":\"dark-plus\",\"data-bright-mode\":\"$undefined\",\"className\":\"$undefined\",\"style\":{\"color\":\"#D4D4D4\",\"borderRadius\":\"4px\",\"overflow\":\"hidden\",\"margin\":\"1em 0\",\"--selection-background\":\"#264F78\",\"--line-number-color\":\"#858585\",\"--tab-border\":\"#252526\",\"--tab-background\":\"#1E1E1E\",\"--tab-color\":\"#ffffff\",\"--inactive-tab-background\":\"#2D2D2D\",\"--inactive-tab-color\":\"#ffffff80\",\"--tab-top-border\":\"$undefined\",\"--tab-bottom-border\":\"#1E1E1E\",\"colorScheme\":\"dark\"},\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"\\n  [data-bright-theme] ::selection { background-color: var(--selection-background) }\\n  [data-bright-theme] [data-bright-ln] { \\n    color: var(--line-number-color); \\n    margin-right: 1.5ch; \\n    display: inline-block;\\n    text-align: right;\\n    user-select: none;\\n  }\\n  \"}}],\"$undefined\",[\"$\",\"pre\",null,{\"style\":{\"margin\":0,\"color\":\"#D4D4D4\",\"background\":\"#1E1E1E\",\"padding\":\"1em 0\",\"overflow\":\"auto\"},\"children\":[\"$\",\"code\",null,{\"className\":\"$undefined\",\"style\":{\"display\":\"block\",\"minWidth\":\"fit-content\"},\"children\":[[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":1,\"style\":{\"width\":\"3ch\"},\"children\":1}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"from\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" typing \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"import\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" List, Dict, Optional, Any\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":2,\"style\":{\"width\":\"3ch\"},\"children\":2}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"from\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" openai \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"import\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" OpenAI\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":3,\"style\":{\"width\":\"3ch\"},\"children\":3}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"import\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" json\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":4,\"style\":{\"width\":\"3ch\"},\"children\":4}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":5,\"style\":{\"width\":\"3ch\"},\"children\":5}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"class \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4EC9B0\"},\"children\":\"Agent\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\":\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":6,\"style\":{\"width\":\"3ch\"},\"children\":6}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"    def \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCDCAA\"},\"children\":\"__init__\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#9CDCFE\"},\"children\":\"self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#9CDCFE\"},\"children\":\"system_prompt\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": Optional[\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4EC9B0\"},\"children\":\"str\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"] = \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"None\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"):\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":7,\"style\":{\"width\":\"3ch\"},\"children\":7}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"        \\\"\\\"\\\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":8,\"style\":{\"width\":\"3ch\"},\"children\":8}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"        Initialize an AI Agent with optional system prompt.\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":9,\"style\":{\"width\":\"3ch\"},\"children\":9}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":10,\"style\":{\"width\":\"3ch\"},\"children\":10}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"        Args:\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":11,\"style\":{\"width\":\"3ch\"},\"children\":11}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"            system_prompt: Initial instructions for the AI\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":12,\"style\":{\"width\":\"3ch\"},\"children\":12}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"        \\\"\\\"\\\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":13,\"style\":{\"width\":\"3ch\"},\"children\":13}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6A9955\"},\"children\":\"        # Initialize OpenAI client - expects OPENAI_API_KEY in environment\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":14,\"style\":{\"width\":\"3ch\"},\"children\":14}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"        self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\".client = OpenAI()\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":15,\"style\":{\"width\":\"3ch\"},\"children\":15}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":16,\"style\":{\"width\":\"3ch\"},\"children\":16}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6A9955\"},\"children\":\"        # Initialize conversation history\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":17,\"style\":{\"width\":\"3ch\"},\"children\":17}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"        self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\".messages = []\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":18,\"style\":{\"width\":\"3ch\"},\"children\":18}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":19,\"style\":{\"width\":\"3ch\"},\"children\":19}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6A9955\"},\"children\":\"        # Set up system prompt if provided, otherwise use default\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":20,\"style\":{\"width\":\"3ch\"},\"children\":20}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"        default_prompt = \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"\\\"\\\"You are a helpful AI assistant with access to a database\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":21,\"style\":{\"width\":\"3ch\"},\"children\":21}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"        and Wikipedia. Follow these rules:\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":22,\"style\":{\"width\":\"3ch\"},\"children\":22}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"        1. When asked about data, always check the database first\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":23,\"style\":{\"width\":\"3ch\"},\"children\":23}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"        2. For general knowledge questions, use Wikipedia\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":24,\"style\":{\"width\":\"3ch\"},\"children\":24}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"        3. If you're unsure about data, query the database to verify\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":25,\"style\":{\"width\":\"3ch\"},\"children\":25}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"        4. Always mention your source of information\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":26,\"style\":{\"width\":\"3ch\"},\"children\":26}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"        5. If a tool returns an error, explain the error to the user clearly\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":27,\"style\":{\"width\":\"3ch\"},\"children\":27}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"        \\\"\\\"\\\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":28,\"style\":{\"width\":\"3ch\"},\"children\":28}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":29,\"style\":{\"width\":\"3ch\"},\"children\":29}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"        self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\".messages.append({\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":30,\"style\":{\"width\":\"3ch\"},\"children\":30}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"            \\\"role\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"system\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\",\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":31,\"style\":{\"width\":\"3ch\"},\"children\":31}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"            \\\"content\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": system_prompt \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"or\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" default_prompt\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":32,\"style\":{\"width\":\"3ch\"},\"children\":32}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"        })\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":33,\"style\":{\"width\":\"3ch\"},\"children\":33}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":34,\"style\":{\"width\":\"3ch\"},\"children\":34}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"    def \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCDCAA\"},\"children\":\"execute_tool\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#9CDCFE\"},\"children\":\"self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#9CDCFE\"},\"children\":\"tool_call\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": Any) -\u003e \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4EC9B0\"},\"children\":\"str\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\":\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":35,\"style\":{\"width\":\"3ch\"},\"children\":35}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"        \\\"\\\"\\\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":36,\"style\":{\"width\":\"3ch\"},\"children\":36}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"        Execute a tool based on the LLM's decision.\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":37,\"style\":{\"width\":\"3ch\"},\"children\":37}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":38,\"style\":{\"width\":\"3ch\"},\"children\":38}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"        Args:\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":39,\"style\":{\"width\":\"3ch\"},\"children\":39}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"            tool_call: The function call object from OpenAI's API\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":40,\"style\":{\"width\":\"3ch\"},\"children\":40}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":41,\"style\":{\"width\":\"3ch\"},\"children\":41}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"        Returns:\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":42,\"style\":{\"width\":\"3ch\"},\"children\":42}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"            str: JSON-formatted result of the tool execution\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":43,\"style\":{\"width\":\"3ch\"},\"children\":43}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"        \\\"\\\"\\\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":44,\"style\":{\"width\":\"3ch\"},\"children\":44}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"        try\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\":\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":45,\"style\":{\"width\":\"3ch\"},\"children\":45}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"            function_name = tool_call.function.name\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":46,\"style\":{\"width\":\"3ch\"},\"children\":46}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"            function_args = json.loads(tool_call.function.arguments)\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":47,\"style\":{\"width\":\"3ch\"},\"children\":47}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":48,\"style\":{\"width\":\"3ch\"},\"children\":48}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6A9955\"},\"children\":\"            # Execute the appropriate tool. Add more here as needed.\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":49,\"style\":{\"width\":\"3ch\"},\"children\":49}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"            if\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" function_name == \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"query_database\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\":\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":50,\"style\":{\"width\":\"3ch\"},\"children\":50}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"                result = query_database(function_args[\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"query\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"])\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":51,\"style\":{\"width\":\"3ch\"},\"children\":51}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"            elif\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" function_name == \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"search_wikipedia\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\":\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":52,\"style\":{\"width\":\"3ch\"},\"children\":52}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"                result = search_wikipedia(function_args[\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"query\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"])\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":53,\"style\":{\"width\":\"3ch\"},\"children\":53}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"            else\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\":\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":54,\"style\":{\"width\":\"3ch\"},\"children\":54}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"                result = json.dumps({\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":55,\"style\":{\"width\":\"3ch\"},\"children\":55}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"                    \\\"error\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"f\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"Unknown tool: \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"function_name\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":56,\"style\":{\"width\":\"3ch\"},\"children\":56}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"                })\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":57,\"style\":{\"width\":\"3ch\"},\"children\":57}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":58,\"style\":{\"width\":\"3ch\"},\"children\":58}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"            return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" result\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":59,\"style\":{\"width\":\"3ch\"},\"children\":59}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":60,\"style\":{\"width\":\"3ch\"},\"children\":60}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"        except\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" json.JSONDecodeError:\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":61,\"style\":{\"width\":\"3ch\"},\"children\":61}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"            return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" json.dumps({\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":62,\"style\":{\"width\":\"3ch\"},\"children\":62}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"                \\\"error\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"Failed to parse tool arguments\\\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":63,\"style\":{\"width\":\"3ch\"},\"children\":63}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"            })\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":64,\"style\":{\"width\":\"3ch\"},\"children\":64}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"        except \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4EC9B0\"},\"children\":\"Exception \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"as\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" e:\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":65,\"style\":{\"width\":\"3ch\"},\"children\":65}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"            return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" json.dumps({\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":66,\"style\":{\"width\":\"3ch\"},\"children\":66}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"                \\\"error\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"f\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"Tool execution failed: \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4EC9B0\"},\"children\":\"str\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"(e)\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":67,\"style\":{\"width\":\"3ch\"},\"children\":67}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"            })\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":68,\"style\":{\"width\":\"3ch\"},\"children\":68}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":69,\"style\":{\"width\":\"3ch\"},\"children\":69}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"    def \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCDCAA\"},\"children\":\"process_query\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#9CDCFE\"},\"children\":\"self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#9CDCFE\"},\"children\":\"user_input\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4EC9B0\"},\"children\":\"str\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\") -\u003e \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4EC9B0\"},\"children\":\"str\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\":\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":70,\"style\":{\"width\":\"3ch\"},\"children\":70}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"        \\\"\\\"\\\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":71,\"style\":{\"width\":\"3ch\"},\"children\":71}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"        Process a user query through the AI agent.\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":72,\"style\":{\"width\":\"3ch\"},\"children\":72}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":73,\"style\":{\"width\":\"3ch\"},\"children\":73}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"        Args:\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":74,\"style\":{\"width\":\"3ch\"},\"children\":74}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"            user_input: The user's question or command\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":75,\"style\":{\"width\":\"3ch\"},\"children\":75}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":76,\"style\":{\"width\":\"3ch\"},\"children\":76}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"        Returns:\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":77,\"style\":{\"width\":\"3ch\"},\"children\":77}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"            str: The agent's response\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":78,\"style\":{\"width\":\"3ch\"},\"children\":78}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"        \\\"\\\"\\\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":79,\"style\":{\"width\":\"3ch\"},\"children\":79}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6A9955\"},\"children\":\"        # Add user input to conversation history\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":80,\"style\":{\"width\":\"3ch\"},\"children\":80}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"        self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\".messages.append({\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":81,\"style\":{\"width\":\"3ch\"},\"children\":81}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"            \\\"role\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"user\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\",\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":82,\"style\":{\"width\":\"3ch\"},\"children\":82}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"            \\\"content\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": user_input\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":83,\"style\":{\"width\":\"3ch\"},\"children\":83}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"        })\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":84,\"style\":{\"width\":\"3ch\"},\"children\":84}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":85,\"style\":{\"width\":\"3ch\"},\"children\":85}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"        try\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\":\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":86,\"style\":{\"width\":\"3ch\"},\"children\":86}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"            max_iterations = \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B5CEA8\"},\"children\":\"5\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":87,\"style\":{\"width\":\"3ch\"},\"children\":87}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"            current_iteration = \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B5CEA8\"},\"children\":\"0\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":88,\"style\":{\"width\":\"3ch\"},\"children\":88}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":89,\"style\":{\"width\":\"3ch\"},\"children\":89}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"            while\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" current_iteration \u003c max_iterations:  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6A9955\"},\"children\":\"# Limit to 5 iterations\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":90,\"style\":{\"width\":\"3ch\"},\"children\":90}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"                current_iteration += \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B5CEA8\"},\"children\":\"1\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":91,\"style\":{\"width\":\"3ch\"},\"children\":91}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"                completion = \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\".client.chat.completions.create(\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":92,\"style\":{\"width\":\"3ch\"},\"children\":92}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#9CDCFE\"},\"children\":\"                    model\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"gpt-4o\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\",\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":93,\"style\":{\"width\":\"3ch\"},\"children\":93}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#9CDCFE\"},\"children\":\"                    messages\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\".messages,\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":94,\"style\":{\"width\":\"3ch\"},\"children\":94}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#9CDCFE\"},\"children\":\"                    tools\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"=tools,  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6A9955\"},\"children\":\"# Global tools list from Step 1\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":95,\"style\":{\"width\":\"3ch\"},\"children\":95}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#9CDCFE\"},\"children\":\"                    tool_choice\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"auto\\\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6A9955\"},\"children\":\"# Let the model decide when to use tools\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":96,\"style\":{\"width\":\"3ch\"},\"children\":96}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"                )\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":97,\"style\":{\"width\":\"3ch\"},\"children\":97}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":98,\"style\":{\"width\":\"3ch\"},\"children\":98}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"                response_message = completion.choices[\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B5CEA8\"},\"children\":\"0\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"].message\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":99,\"style\":{\"width\":\"3ch\"},\"children\":99}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":100,\"style\":{\"width\":\"3ch\"},\"children\":100}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6A9955\"},\"children\":\"                # If no tool calls, we're done\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":101,\"style\":{\"width\":\"3ch\"},\"children\":101}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"                if \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"not\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" response_message.tool_calls:\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":102,\"style\":{\"width\":\"3ch\"},\"children\":102}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"                    self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\".messages.append(response_message)\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":103,\"style\":{\"width\":\"3ch\"},\"children\":103}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"                    return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" response_message.content\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":104,\"style\":{\"width\":\"3ch\"},\"children\":104}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":105,\"style\":{\"width\":\"3ch\"},\"children\":105}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6A9955\"},\"children\":\"                # Add the model's thinking to conversation history\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":106,\"style\":{\"width\":\"3ch\"},\"children\":106}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"                self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\".messages.append(response_message)\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":107,\"style\":{\"width\":\"3ch\"},\"children\":107}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":108,\"style\":{\"width\":\"3ch\"},\"children\":108}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6A9955\"},\"children\":\"                # Process all tool calls\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":109,\"style\":{\"width\":\"3ch\"},\"children\":109}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"                for\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" tool_call \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"in\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" response_message.tool_calls:\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":110,\"style\":{\"width\":\"3ch\"},\"children\":110}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"                    try\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\":\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":111,\"style\":{\"width\":\"3ch\"},\"children\":111}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCDCAA\"},\"children\":\"                        print\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"Tool call:\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\", tool_call)\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":112,\"style\":{\"width\":\"3ch\"},\"children\":112}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"                        result = \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\".execute_tool(tool_call)\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":113,\"style\":{\"width\":\"3ch\"},\"children\":113}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCDCAA\"},\"children\":\"                        print\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"Tool executed......\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\")\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":114,\"style\":{\"width\":\"3ch\"},\"children\":114}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"                    except \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4EC9B0\"},\"children\":\"Exception \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"as\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" e:\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":115,\"style\":{\"width\":\"3ch\"},\"children\":115}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCDCAA\"},\"children\":\"                        print\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"Execution failed......\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\")\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":116,\"style\":{\"width\":\"3ch\"},\"children\":116}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"                        result = json.dumps({\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":117,\"style\":{\"width\":\"3ch\"},\"children\":117}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"                            \\\"error\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"f\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"Tool execution failed: \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4EC9B0\"},\"children\":\"str\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"(e)\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":118,\"style\":{\"width\":\"3ch\"},\"children\":118}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"                        })\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":119,\"style\":{\"width\":\"3ch\"},\"children\":119}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":120,\"style\":{\"width\":\"3ch\"},\"children\":120}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCDCAA\"},\"children\":\"                    print\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"f\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"Tool result custom: \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"result\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\")\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":121,\"style\":{\"width\":\"3ch\"},\"children\":121}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":122,\"style\":{\"width\":\"3ch\"},\"children\":122}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"                    self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\".messages.append({\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":123,\"style\":{\"width\":\"3ch\"},\"children\":123}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"                        \\\"role\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"tool\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\",\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":124,\"style\":{\"width\":\"3ch\"},\"children\":124}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"                        \\\"tool_call_id\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": tool_call.id,\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":125,\"style\":{\"width\":\"3ch\"},\"children\":125}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"                        \\\"content\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4EC9B0\"},\"children\":\"str\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"(result)\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":126,\"style\":{\"width\":\"3ch\"},\"children\":126}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"                    })\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":127,\"style\":{\"width\":\"3ch\"},\"children\":127}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCDCAA\"},\"children\":\"                    print\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"Messages:\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\".messages)\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":128,\"style\":{\"width\":\"3ch\"},\"children\":128}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":129,\"style\":{\"width\":\"3ch\"},\"children\":129}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6A9955\"},\"children\":\"            # If we've reached max iterations, return a message indicating this\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":130,\"style\":{\"width\":\"3ch\"},\"children\":130}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"            max_iterations_message = {\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":131,\"style\":{\"width\":\"3ch\"},\"children\":131}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"                \\\"role\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"assistant\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\",\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":132,\"style\":{\"width\":\"3ch\"},\"children\":132}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"                \\\"content\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"I've reached the maximum number of tool calls (5) without finding a complete answer. Here's what I know so far: \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" + response_message.content\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":133,\"style\":{\"width\":\"3ch\"},\"children\":133}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"            }\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":134,\"style\":{\"width\":\"3ch\"},\"children\":134}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"            self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\".messages.append(max_iterations_message)\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":135,\"style\":{\"width\":\"3ch\"},\"children\":135}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"            return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" max_iterations_message[\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"content\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"]\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":136,\"style\":{\"width\":\"3ch\"},\"children\":136}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":137,\"style\":{\"width\":\"3ch\"},\"children\":137}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"        except \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4EC9B0\"},\"children\":\"Exception \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"as\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" e:\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":138,\"style\":{\"width\":\"3ch\"},\"children\":138}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"            error_message = \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"f\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"Error processing query: \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4EC9B0\"},\"children\":\"str\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"(e)\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":139,\"style\":{\"width\":\"3ch\"},\"children\":139}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"            self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\".messages.append({\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":140,\"style\":{\"width\":\"3ch\"},\"children\":140}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"                \\\"role\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"assistant\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\",\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":141,\"style\":{\"width\":\"3ch\"},\"children\":141}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"                \\\"content\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": error_message\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":142,\"style\":{\"width\":\"3ch\"},\"children\":142}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"            })\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":143,\"style\":{\"width\":\"3ch\"},\"children\":143}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"            return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" error_message\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":144,\"style\":{\"width\":\"3ch\"},\"children\":144}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":145,\"style\":{\"width\":\"3ch\"},\"children\":145}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"    def \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCDCAA\"},\"children\":\"get_conversation_history\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#9CDCFE\"},\"children\":\"self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\") -\u003e List[Dict[\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4EC9B0\"},\"children\":\"str\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4EC9B0\"},\"children\":\"str\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"]]:\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":146,\"style\":{\"width\":\"3ch\"},\"children\":146}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"        \\\"\\\"\\\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":147,\"style\":{\"width\":\"3ch\"},\"children\":147}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"        Get the current conversation history.\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":148,\"style\":{\"width\":\"3ch\"},\"children\":148}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":149,\"style\":{\"width\":\"3ch\"},\"children\":149}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"        Returns:\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":150,\"style\":{\"width\":\"3ch\"},\"children\":150}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"            List[Dict[str, str]]: The conversation history\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":151,\"style\":{\"width\":\"3ch\"},\"children\":151}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"        \\\"\\\"\\\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":152,\"style\":{\"width\":\"3ch\"},\"children\":152}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"        return \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\".messages\"}]],[\"$\",\"br\",null,{}]]}]}]]}]}]]}]\n"])</script><script>self.__next_f.push([1,"20:[\"$\",\"div\",null,{\"data-bright-theme\":\"dark-plus\",\"data-bright-mode\":\"$undefined\",\"className\":\"$undefined\",\"style\":{\"color\":\"#D4D4D4\",\"borderRadius\":\"4px\",\"overflow\":\"hidden\",\"margin\":\"1em 0\",\"--selection-background\":\"#264F78\",\"--line-number-color\":\"#858585\",\"--tab-border\":\"#252526\",\"--tab-background\":\"#1E1E1E\",\"--tab-color\":\"#ffffff\",\"--inactive-tab-background\":\"#2D2D2D\",\"--inactive-tab-color\":\"#ffffff80\",\"--tab-top-border\":\"$undefined\",\"--tab-bottom-border\":\"#1E1E1E\",\"colorScheme\":\"dark\"},\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"\\n  [data-bright-theme] ::selection { background-color: var(--selection-background) }\\n  [data-bright-theme] [data-bright-ln] { \\n    color: var(--line-number-color); \\n    margin-right: 1.5ch; \\n    display: inline-block;\\n    text-align: right;\\n    user-select: none;\\n  }\\n  \"}}],\"$undefined\",[\"$\",\"pre\",null,{\"style\":{\"margin\":0,\"color\":\"#D4D4D4\",\"background\":\"#1E1E1E\",\"padding\":\"1em 0\",\"overflow\":\"auto\"},\"children\":[\"$\",\"code\",null,{\"className\":\"$undefined\",\"style\":{\"display\":\"block\",\"minWidth\":\"fit-content\"},\"children\":[[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":1,\"style\":{\"width\":\"3ch\"},\"children\":1}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"from\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" datetime \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"import\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" datetime\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":2,\"style\":{\"width\":\"3ch\"},\"children\":2}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"import\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" uuid\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":3,\"style\":{\"width\":\"3ch\"},\"children\":3}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"from\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" typing \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"import\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" List, Dict, Optional\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":4,\"style\":{\"width\":\"3ch\"},\"children\":4}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"from\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" dataclasses \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"import\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" dataclass\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":5,\"style\":{\"width\":\"3ch\"},\"children\":5}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"import\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" psycopg2\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":6,\"style\":{\"width\":\"3ch\"},\"children\":6}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"from\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" psycopg2.extras \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"import\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" Json, UUID_adapter\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":7,\"style\":{\"width\":\"3ch\"},\"children\":7}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":8,\"style\":{\"width\":\"3ch\"},\"children\":8}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCDCAA\"},\"children\":\"@dataclass\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":9,\"style\":{\"width\":\"3ch\"},\"children\":9}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"class \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4EC9B0\"},\"children\":\"MemoryConfig\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\":\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":10,\"style\":{\"width\":\"3ch\"},\"children\":10}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"    \\\"\\\"\\\"Configuration for memory management\\\"\\\"\\\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":11,\"style\":{\"width\":\"3ch\"},\"children\":11}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"    max_messages: \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4EC9B0\"},\"children\":\"int\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" = \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B5CEA8\"},\"children\":\"20  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6A9955\"},\"children\":\"# When to summarize\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":12,\"style\":{\"width\":\"3ch\"},\"children\":12}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"    summary_length: \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4EC9B0\"},\"children\":\"int\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" = \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B5CEA8\"},\"children\":\"2000  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6A9955\"},\"children\":\"# Max summary length in words\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":13,\"style\":{\"width\":\"3ch\"},\"children\":13}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"    db_connection: \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4EC9B0\"},\"children\":\"str\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" = \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"dbname=your_db user=your_user password=your_pass\\\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":14,\"style\":{\"width\":\"3ch\"},\"children\":14}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":15,\"style\":{\"width\":\"3ch\"},\"children\":15}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"class \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4EC9B0\"},\"children\":\"AgentMemory\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\":\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":16,\"style\":{\"width\":\"3ch\"},\"children\":16}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"    def \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCDCAA\"},\"children\":\"__init__\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#9CDCFE\"},\"children\":\"self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#9CDCFE\"},\"children\":\"config\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": Optional[MemoryConfig] = \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"None\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"):\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":17,\"style\":{\"width\":\"3ch\"},\"children\":17}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"        self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\".config = config \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"or\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" MemoryConfig()\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":18,\"style\":{\"width\":\"3ch\"},\"children\":18}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"        self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\".session_id = uuid.uuid4()\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":19,\"style\":{\"width\":\"3ch\"},\"children\":19}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"        self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\".setup_database()\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":20,\"style\":{\"width\":\"3ch\"},\"children\":20}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":21,\"style\":{\"width\":\"3ch\"},\"children\":21}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"    def \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCDCAA\"},\"children\":\"setup_database\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#9CDCFE\"},\"children\":\"self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"):\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":22,\"style\":{\"width\":\"3ch\"},\"children\":22}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"        \\\"\\\"\\\"Create necessary database tables if they don't exist\\\"\\\"\\\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":23,\"style\":{\"width\":\"3ch\"},\"children\":23}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"        queries = [\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":24,\"style\":{\"width\":\"3ch\"},\"children\":24}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"            \\\"\\\"\\\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":25,\"style\":{\"width\":\"3ch\"},\"children\":25}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"            CREATE TABLE IF NOT EXISTS conversations (\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":26,\"style\":{\"width\":\"3ch\"},\"children\":26}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"                id SERIAL PRIMARY KEY,\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":27,\"style\":{\"width\":\"3ch\"},\"children\":27}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"                session_id UUID NOT NULL,\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":28,\"style\":{\"width\":\"3ch\"},\"children\":28}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"                user_input TEXT NOT NULL,\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":29,\"style\":{\"width\":\"3ch\"},\"children\":29}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"                agent_response TEXT NOT NULL,\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":30,\"style\":{\"width\":\"3ch\"},\"children\":30}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"                tool_calls JSONB,\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":31,\"style\":{\"width\":\"3ch\"},\"children\":31}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"                timestamp TIMESTAMPTZ DEFAULT NOW()\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":32,\"style\":{\"width\":\"3ch\"},\"children\":32}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"            );\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":33,\"style\":{\"width\":\"3ch\"},\"children\":33}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"            \\\"\\\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\",\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":34,\"style\":{\"width\":\"3ch\"},\"children\":34}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"            \\\"\\\"\\\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":35,\"style\":{\"width\":\"3ch\"},\"children\":35}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"            CREATE TABLE IF NOT EXISTS conversation_summaries (\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":36,\"style\":{\"width\":\"3ch\"},\"children\":36}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"                id SERIAL PRIMARY KEY,\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":37,\"style\":{\"width\":\"3ch\"},\"children\":37}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"                session_id UUID NOT NULL,\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":38,\"style\":{\"width\":\"3ch\"},\"children\":38}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"                summary TEXT NOT NULL,\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":39,\"style\":{\"width\":\"3ch\"},\"children\":39}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"                start_time TIMESTAMPTZ NOT NULL,\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":40,\"style\":{\"width\":\"3ch\"},\"children\":40}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"                end_time TIMESTAMPTZ NOT NULL,\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":41,\"style\":{\"width\":\"3ch\"},\"children\":41}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"                message_count INTEGER NOT NULL\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":42,\"style\":{\"width\":\"3ch\"},\"children\":42}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"            );\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":43,\"style\":{\"width\":\"3ch\"},\"children\":43}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"            \\\"\\\"\\\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":44,\"style\":{\"width\":\"3ch\"},\"children\":44}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"        ]\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":45,\"style\":{\"width\":\"3ch\"},\"children\":45}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":46,\"style\":{\"width\":\"3ch\"},\"children\":46}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"        with\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" psycopg2.connect(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\".config.db_connection) \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"as\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" conn:\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":47,\"style\":{\"width\":\"3ch\"},\"children\":47}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"            with\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" conn.cursor() \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"as\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" cur:\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":48,\"style\":{\"width\":\"3ch\"},\"children\":48}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"                for\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" query \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"in\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" queries:\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":49,\"style\":{\"width\":\"3ch\"},\"children\":49}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"                    cur.execute(query)\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":50,\"style\":{\"width\":\"3ch\"},\"children\":50}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":51,\"style\":{\"width\":\"3ch\"},\"children\":51}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"    def \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCDCAA\"},\"children\":\"store_interaction\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#9CDCFE\"},\"children\":\"self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\",\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":52,\"style\":{\"width\":\"3ch\"},\"children\":52}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#9CDCFE\"},\"children\":\"                         user_input\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4EC9B0\"},\"children\":\"str\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\",\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":53,\"style\":{\"width\":\"3ch\"},\"children\":53}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#9CDCFE\"},\"children\":\"                         agent_response\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4EC9B0\"},\"children\":\"str\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\",\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":54,\"style\":{\"width\":\"3ch\"},\"children\":54}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#9CDCFE\"},\"children\":\"                         tool_calls\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": Optional[List[Dict]] = \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"None\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"):\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":55,\"style\":{\"width\":\"3ch\"},\"children\":55}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"        \\\"\\\"\\\"Store a single interaction in the database\\\"\\\"\\\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":56,\"style\":{\"width\":\"3ch\"},\"children\":56}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"        query = \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"\\\"\\\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":57,\"style\":{\"width\":\"3ch\"},\"children\":57}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"        INSERT INTO conversations\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":58,\"style\":{\"width\":\"3ch\"},\"children\":58}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"            (session_id, user_input, agent_response, tool_calls)\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":59,\"style\":{\"width\":\"3ch\"},\"children\":59}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"        VALUES (\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"%s\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"%s\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"%s\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"%s\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\")\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":60,\"style\":{\"width\":\"3ch\"},\"children\":60}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"        \\\"\\\"\\\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":61,\"style\":{\"width\":\"3ch\"},\"children\":61}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":62,\"style\":{\"width\":\"3ch\"},\"children\":62}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"        with\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" psycopg2.connect(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\".config.db_connection) \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"as\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" conn:\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":63,\"style\":{\"width\":\"3ch\"},\"children\":63}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"            with\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" conn.cursor() \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"as\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" cur:\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":64,\"style\":{\"width\":\"3ch\"},\"children\":64}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"                cur.execute(query, (\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":65,\"style\":{\"width\":\"3ch\"},\"children\":65}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"                    self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\".session_id,\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":66,\"style\":{\"width\":\"3ch\"},\"children\":66}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"                    user_input,\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":67,\"style\":{\"width\":\"3ch\"},\"children\":67}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"                    agent_response,\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":68,\"style\":{\"width\":\"3ch\"},\"children\":68}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"                    Json(tool_calls) \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"if\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" tool_calls \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"else \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"None\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":69,\"style\":{\"width\":\"3ch\"},\"children\":69}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"                ))\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":70,\"style\":{\"width\":\"3ch\"},\"children\":70}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":71,\"style\":{\"width\":\"3ch\"},\"children\":71}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"    def \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCDCAA\"},\"children\":\"create_summary\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#9CDCFE\"},\"children\":\"self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#9CDCFE\"},\"children\":\"messages\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": List[Dict]) -\u003e \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4EC9B0\"},\"children\":\"str\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\":\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":72,\"style\":{\"width\":\"3ch\"},\"children\":72}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"        \\\"\\\"\\\"Create a summary of messages using the LLM\\\"\\\"\\\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":73,\"style\":{\"width\":\"3ch\"},\"children\":73}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"        client = OpenAI()\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":74,\"style\":{\"width\":\"3ch\"},\"children\":74}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":75,\"style\":{\"width\":\"3ch\"},\"children\":75}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6A9955\"},\"children\":\"        # Prepare messages for summarization\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":76,\"style\":{\"width\":\"3ch\"},\"children\":76}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"        summary_prompt = \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"f\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"\\\"\\\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":77,\"style\":{\"width\":\"3ch\"},\"children\":77}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"        Summarize the following conversation in less than \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"{self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\".config.summary_length\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\" words.\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":78,\"style\":{\"width\":\"3ch\"},\"children\":78}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"        Focus on key points, decisions, and important information discovered through tool usage.\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":79,\"style\":{\"width\":\"3ch\"},\"children\":79}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":80,\"style\":{\"width\":\"3ch\"},\"children\":80}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"        Conversation:\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":81,\"style\":{\"width\":\"3ch\"},\"children\":81}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"        {\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"messages\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"}\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":82,\"style\":{\"width\":\"3ch\"},\"children\":82}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"        \\\"\\\"\\\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":83,\"style\":{\"width\":\"3ch\"},\"children\":83}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":84,\"style\":{\"width\":\"3ch\"},\"children\":84}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"        response = client.chat.completions.create(\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":85,\"style\":{\"width\":\"3ch\"},\"children\":85}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#9CDCFE\"},\"children\":\"            model\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"gpt-4o\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\",\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":86,\"style\":{\"width\":\"3ch\"},\"children\":86}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#9CDCFE\"},\"children\":\"            messages\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"=[{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"role\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"user\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"content\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": summary_prompt}]\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":87,\"style\":{\"width\":\"3ch\"},\"children\":87}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"        )\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":88,\"style\":{\"width\":\"3ch\"},\"children\":88}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":89,\"style\":{\"width\":\"3ch\"},\"children\":89}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"        return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" response.choices[\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B5CEA8\"},\"children\":\"0\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"].message.content\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":90,\"style\":{\"width\":\"3ch\"},\"children\":90}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":91,\"style\":{\"width\":\"3ch\"},\"children\":91}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"    def \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCDCAA\"},\"children\":\"store_summary\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#9CDCFE\"},\"children\":\"self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#9CDCFE\"},\"children\":\"summary\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4EC9B0\"},\"children\":\"str\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#9CDCFE\"},\"children\":\"start_time\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": datetime, \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#9CDCFE\"},\"children\":\"end_time\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": datetime, \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#9CDCFE\"},\"children\":\"message_count\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4EC9B0\"},\"children\":\"int\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"):\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":92,\"style\":{\"width\":\"3ch\"},\"children\":92}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"        \\\"\\\"\\\"Store a conversation summary\\\"\\\"\\\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":93,\"style\":{\"width\":\"3ch\"},\"children\":93}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"        query = \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"\\\"\\\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":94,\"style\":{\"width\":\"3ch\"},\"children\":94}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"        INSERT INTO conversation_summaries\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":95,\"style\":{\"width\":\"3ch\"},\"children\":95}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"            (session_id, summary, start_time, end_time, message_count)\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":96,\"style\":{\"width\":\"3ch\"},\"children\":96}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"        VALUES (\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"%s\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"%s\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"%s\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"%s\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"%s\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\")\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":97,\"style\":{\"width\":\"3ch\"},\"children\":97}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"        \\\"\\\"\\\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":98,\"style\":{\"width\":\"3ch\"},\"children\":98}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":99,\"style\":{\"width\":\"3ch\"},\"children\":99}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"        with\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" psycopg2.connect(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\".config.db_connection) \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"as\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" conn:\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":100,\"style\":{\"width\":\"3ch\"},\"children\":100}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"            with\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" conn.cursor() \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"as\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" cur:\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":101,\"style\":{\"width\":\"3ch\"},\"children\":101}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"                cur.execute(query, (\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":102,\"style\":{\"width\":\"3ch\"},\"children\":102}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"                    self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\".session_id,\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":103,\"style\":{\"width\":\"3ch\"},\"children\":103}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"                    summary,\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":104,\"style\":{\"width\":\"3ch\"},\"children\":104}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"                    start_time,\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":105,\"style\":{\"width\":\"3ch\"},\"children\":105}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"                    end_time,\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":106,\"style\":{\"width\":\"3ch\"},\"children\":106}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"                    message_count\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":107,\"style\":{\"width\":\"3ch\"},\"children\":107}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"                ))\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":108,\"style\":{\"width\":\"3ch\"},\"children\":108}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":109,\"style\":{\"width\":\"3ch\"},\"children\":109}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"    def \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCDCAA\"},\"children\":\"get_recent_context\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#9CDCFE\"},\"children\":\"self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\") -\u003e \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4EC9B0\"},\"children\":\"str\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\":\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":110,\"style\":{\"width\":\"3ch\"},\"children\":110}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"        \\\"\\\"\\\"Get recent conversations and summaries for context\\\"\\\"\\\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":111,\"style\":{\"width\":\"3ch\"},\"children\":111}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6A9955\"},\"children\":\"        # First, get the most recent summary\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":112,\"style\":{\"width\":\"3ch\"},\"children\":112}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"        summary_query = \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"\\\"\\\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":113,\"style\":{\"width\":\"3ch\"},\"children\":113}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"        SELECT summary, end_time\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":114,\"style\":{\"width\":\"3ch\"},\"children\":114}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"        FROM conversation_summaries\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":115,\"style\":{\"width\":\"3ch\"},\"children\":115}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"        WHERE session_id = \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"%s\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":116,\"style\":{\"width\":\"3ch\"},\"children\":116}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"        ORDER BY end_time DESC\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":117,\"style\":{\"width\":\"3ch\"},\"children\":117}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"        LIMIT 1\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":118,\"style\":{\"width\":\"3ch\"},\"children\":118}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"        \\\"\\\"\\\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":119,\"style\":{\"width\":\"3ch\"},\"children\":119}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":120,\"style\":{\"width\":\"3ch\"},\"children\":120}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6A9955\"},\"children\":\"        # Then get conversations after the summary\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":121,\"style\":{\"width\":\"3ch\"},\"children\":121}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"        conversations_query = \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"\\\"\\\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":122,\"style\":{\"width\":\"3ch\"},\"children\":122}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"        SELECT user_input, agent_response, tool_calls, timestamp\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":123,\"style\":{\"width\":\"3ch\"},\"children\":123}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"        FROM conversations\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":124,\"style\":{\"width\":\"3ch\"},\"children\":124}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"        WHERE session_id = \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"%s\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":125,\"style\":{\"width\":\"3ch\"},\"children\":125}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"        AND timestamp \u003e \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"%s\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":126,\"style\":{\"width\":\"3ch\"},\"children\":126}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"        ORDER BY timestamp ASC\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":127,\"style\":{\"width\":\"3ch\"},\"children\":127}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"        \\\"\\\"\\\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":128,\"style\":{\"width\":\"3ch\"},\"children\":128}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":129,\"style\":{\"width\":\"3ch\"},\"children\":129}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"        with\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" psycopg2.connect(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\".config.db_connection) \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"as\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" conn:\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":130,\"style\":{\"width\":\"3ch\"},\"children\":130}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"            with\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" conn.cursor() \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"as\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" cur:\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":131,\"style\":{\"width\":\"3ch\"},\"children\":131}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6A9955\"},\"children\":\"                # Get latest summary\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":132,\"style\":{\"width\":\"3ch\"},\"children\":132}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"                cur.execute(summary_query, (\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\".session_id,))\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":133,\"style\":{\"width\":\"3ch\"},\"children\":133}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"                summary_row = cur.fetchone()\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":134,\"style\":{\"width\":\"3ch\"},\"children\":134}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":135,\"style\":{\"width\":\"3ch\"},\"children\":135}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"                if\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" summary_row:\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":136,\"style\":{\"width\":\"3ch\"},\"children\":136}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"                    summary, last_summary_time = summary_row\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":137,\"style\":{\"width\":\"3ch\"},\"children\":137}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6A9955\"},\"children\":\"                    # Get conversations after the summary\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":138,\"style\":{\"width\":\"3ch\"},\"children\":138}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"                    cur.execute(conversations_query, (\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\".session_id, last_summary_time))\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":139,\"style\":{\"width\":\"3ch\"},\"children\":139}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"                else\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\":\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":140,\"style\":{\"width\":\"3ch\"},\"children\":140}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6A9955\"},\"children\":\"                    # If no summary exists, get recent conversations\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":141,\"style\":{\"width\":\"3ch\"},\"children\":141}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"                    cur.execute(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"\\\"\\\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":142,\"style\":{\"width\":\"3ch\"},\"children\":142}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"                        SELECT user_input, agent_response, tool_calls, timestamp\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":143,\"style\":{\"width\":\"3ch\"},\"children\":143}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"                        FROM conversations\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":144,\"style\":{\"width\":\"3ch\"},\"children\":144}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"                        WHERE session_id = \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"%s\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":145,\"style\":{\"width\":\"3ch\"},\"children\":145}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"                        ORDER BY timestamp DESC\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":146,\"style\":{\"width\":\"3ch\"},\"children\":146}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"                        LIMIT \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"%s\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":147,\"style\":{\"width\":\"3ch\"},\"children\":147}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"                    \\\"\\\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\", (\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\".session_id, \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\".config.max_messages))\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":148,\"style\":{\"width\":\"3ch\"},\"children\":148}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":149,\"style\":{\"width\":\"3ch\"},\"children\":149}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"                conversations = cur.fetchall()\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":150,\"style\":{\"width\":\"3ch\"},\"children\":150}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":151,\"style\":{\"width\":\"3ch\"},\"children\":151}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6A9955\"},\"children\":\"        # Format context\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":152,\"style\":{\"width\":\"3ch\"},\"children\":152}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"        context = []\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":153,\"style\":{\"width\":\"3ch\"},\"children\":153}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"        if\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" summary_row:\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":154,\"style\":{\"width\":\"3ch\"},\"children\":154}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"            context.append(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"f\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"Previous conversation summary: \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"summary\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\")\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":155,\"style\":{\"width\":\"3ch\"},\"children\":155}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":156,\"style\":{\"width\":\"3ch\"},\"children\":156}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"        for\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" conv \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"in\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" conversations:\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":157,\"style\":{\"width\":\"3ch\"},\"children\":157}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"            user_input, agent_response, tool_calls, _ = conv\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":158,\"style\":{\"width\":\"3ch\"},\"children\":158}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"            context.append(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"f\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"User: \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"user_input\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\")\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":159,\"style\":{\"width\":\"3ch\"},\"children\":159}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"            if\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" tool_calls:\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":160,\"style\":{\"width\":\"3ch\"},\"children\":160}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"                context.append(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"f\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"Tool Usage: \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"tool_calls\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\")\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":161,\"style\":{\"width\":\"3ch\"},\"children\":161}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"            context.append(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"f\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"Assistant: \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"agent_response\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\")\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":162,\"style\":{\"width\":\"3ch\"},\"children\":162}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":163,\"style\":{\"width\":\"3ch\"},\"children\":163}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"        return \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D7BA7D\"},\"children\":\"\\\\n\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\".join(context)\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":164,\"style\":{\"width\":\"3ch\"},\"children\":164}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":165,\"style\":{\"width\":\"3ch\"},\"children\":165}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"    def \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCDCAA\"},\"children\":\"check_and_summarize\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#9CDCFE\"},\"children\":\"self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"):\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":166,\"style\":{\"width\":\"3ch\"},\"children\":166}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"        \\\"\\\"\\\"Check if we need to summarize and do it if necessary\\\"\\\"\\\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":167,\"style\":{\"width\":\"3ch\"},\"children\":167}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"        query = \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"\\\"\\\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":168,\"style\":{\"width\":\"3ch\"},\"children\":168}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"        SELECT COUNT(*)\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":169,\"style\":{\"width\":\"3ch\"},\"children\":169}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"        FROM conversations\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":170,\"style\":{\"width\":\"3ch\"},\"children\":170}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"        WHERE session_id = \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"%s\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":171,\"style\":{\"width\":\"3ch\"},\"children\":171}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"        AND timestamp \u003e (\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":172,\"style\":{\"width\":\"3ch\"},\"children\":172}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"            SELECT COALESCE(MAX(end_time), '1970-01-01'::timestamptz)\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":173,\"style\":{\"width\":\"3ch\"},\"children\":173}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"            FROM conversation_summaries\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":174,\"style\":{\"width\":\"3ch\"},\"children\":174}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"            WHERE session_id = \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"%s\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":175,\"style\":{\"width\":\"3ch\"},\"children\":175}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"        )\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":176,\"style\":{\"width\":\"3ch\"},\"children\":176}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"        \\\"\\\"\\\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":177,\"style\":{\"width\":\"3ch\"},\"children\":177}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":178,\"style\":{\"width\":\"3ch\"},\"children\":178}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"        with\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" psycopg2.connect(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\".config.db_connection) \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"as\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" conn:\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":179,\"style\":{\"width\":\"3ch\"},\"children\":179}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"            with\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" conn.cursor() \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"as\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" cur:\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":180,\"style\":{\"width\":\"3ch\"},\"children\":180}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"                cur.execute(query, (\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\".session_id, \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\".session_id))\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":181,\"style\":{\"width\":\"3ch\"},\"children\":181}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"                count = cur.fetchone()[\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B5CEA8\"},\"children\":\"0\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"]\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":182,\"style\":{\"width\":\"3ch\"},\"children\":182}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":183,\"style\":{\"width\":\"3ch\"},\"children\":183}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"                if\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" count \u003e= \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\".config.max_messages:\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":184,\"style\":{\"width\":\"3ch\"},\"children\":184}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6A9955\"},\"children\":\"                    # Get messages to summarize\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":185,\"style\":{\"width\":\"3ch\"},\"children\":185}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"                    cur.execute(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"\\\"\\\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":186,\"style\":{\"width\":\"3ch\"},\"children\":186}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"                        SELECT user_input, agent_response, tool_calls, timestamp\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":187,\"style\":{\"width\":\"3ch\"},\"children\":187}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"                        FROM conversations\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":188,\"style\":{\"width\":\"3ch\"},\"children\":188}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"                        WHERE session_id = \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"%s\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":189,\"style\":{\"width\":\"3ch\"},\"children\":189}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"                        ORDER BY timestamp ASC\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":190,\"style\":{\"width\":\"3ch\"},\"children\":190}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"                        LIMIT \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"%s\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":191,\"style\":{\"width\":\"3ch\"},\"children\":191}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"                    \\\"\\\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\", (\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\".session_id, count))\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":192,\"style\":{\"width\":\"3ch\"},\"children\":192}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":193,\"style\":{\"width\":\"3ch\"},\"children\":193}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"                    messages = cur.fetchall()\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":194,\"style\":{\"width\":\"3ch\"},\"children\":194}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"                    if\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" messages:\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":195,\"style\":{\"width\":\"3ch\"},\"children\":195}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6A9955\"},\"children\":\"                        # Create and store summary\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":196,\"style\":{\"width\":\"3ch\"},\"children\":196}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"                        summary = \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\".create_summary(messages)\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":197,\"style\":{\"width\":\"3ch\"},\"children\":197}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"                        self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\".store_summary(\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":198,\"style\":{\"width\":\"3ch\"},\"children\":198}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"                            summary,\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":199,\"style\":{\"width\":\"3ch\"},\"children\":199}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"                            messages[\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B5CEA8\"},\"children\":\"0\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"][\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B5CEA8\"},\"children\":\"3\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"],  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6A9955\"},\"children\":\"# start_time\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":200,\"style\":{\"width\":\"3ch\"},\"children\":200}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"                            messages[-\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B5CEA8\"},\"children\":\"1\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"][\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B5CEA8\"},\"children\":\"3\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"],  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6A9955\"},\"children\":\"# end_time\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":201,\"style\":{\"width\":\"3ch\"},\"children\":201}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCDCAA\"},\"children\":\"                            len\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"(messages)\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":202,\"style\":{\"width\":\"3ch\"},\"children\":202}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"                        )\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":203,\"style\":{\"width\":\"3ch\"},\"children\":203}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":204,\"style\":{\"width\":\"3ch\"},\"children\":204}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6A9955\"},\"children\":\"# Update Agent class to use memory.\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":205,\"style\":{\"width\":\"3ch\"},\"children\":205}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"class \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4EC9B0\"},\"children\":\"MemoryAgent\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4EC9B0\"},\"children\":\"Agent\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"):\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":206,\"style\":{\"width\":\"3ch\"},\"children\":206}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"    def \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCDCAA\"},\"children\":\"__init__\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#9CDCFE\"},\"children\":\"self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#9CDCFE\"},\"children\":\"memory_config\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": Optional[MemoryConfig] = \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"None\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"):\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":207,\"style\":{\"width\":\"3ch\"},\"children\":207}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"        self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\".client = OpenAI()\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":208,\"style\":{\"width\":\"3ch\"},\"children\":208}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"        self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\".memory = AgentMemory(memory_config)\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":209,\"style\":{\"width\":\"3ch\"},\"children\":209}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"        self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\".messages = []\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":210,\"style\":{\"width\":\"3ch\"},\"children\":210}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":211,\"style\":{\"width\":\"3ch\"},\"children\":211}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6A9955\"},\"children\":\"        # Initialize with system prompt\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":212,\"style\":{\"width\":\"3ch\"},\"children\":212}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"        self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\".messages.append({\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":213,\"style\":{\"width\":\"3ch\"},\"children\":213}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"            \\\"role\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"system\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\",\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":214,\"style\":{\"width\":\"3ch\"},\"children\":214}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"            \\\"content\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"You are a helpful AI assistant...\\\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":215,\"style\":{\"width\":\"3ch\"},\"children\":215}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"        })\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":216,\"style\":{\"width\":\"3ch\"},\"children\":216}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":217,\"style\":{\"width\":\"3ch\"},\"children\":217}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"    def \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCDCAA\"},\"children\":\"process_query\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#9CDCFE\"},\"children\":\"self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#9CDCFE\"},\"children\":\"user_input\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4EC9B0\"},\"children\":\"str\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\") -\u003e \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4EC9B0\"},\"children\":\"str\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\":\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":218,\"style\":{\"width\":\"3ch\"},\"children\":218}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"        try\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\":\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":219,\"style\":{\"width\":\"3ch\"},\"children\":219}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6A9955\"},\"children\":\"            # Check if we need to summarize before adding new messages\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":220,\"style\":{\"width\":\"3ch\"},\"children\":220}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"            self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\".memory.check_and_summarize()\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":221,\"style\":{\"width\":\"3ch\"},\"children\":221}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":222,\"style\":{\"width\":\"3ch\"},\"children\":222}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6A9955\"},\"children\":\"            # Get context (including summaries) from memory\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":223,\"style\":{\"width\":\"3ch\"},\"children\":223}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"            context = \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\".memory.get_recent_context()\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":224,\"style\":{\"width\":\"3ch\"},\"children\":224}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":225,\"style\":{\"width\":\"3ch\"},\"children\":225}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6A9955\"},\"children\":\"            # Add context to messages if it exists\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":226,\"style\":{\"width\":\"3ch\"},\"children\":226}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"            if\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" context:\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":227,\"style\":{\"width\":\"3ch\"},\"children\":227}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"                self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\".messages = [\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":228,\"style\":{\"width\":\"3ch\"},\"children\":228}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"                    self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\".messages[\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B5CEA8\"},\"children\":\"0\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"],  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6A9955\"},\"children\":\"# Keep system prompt\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":229,\"style\":{\"width\":\"3ch\"},\"children\":229}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"                    {\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":230,\"style\":{\"width\":\"3ch\"},\"children\":230}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"                        \\\"role\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"system\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\",\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":231,\"style\":{\"width\":\"3ch\"},\"children\":231}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"                        \\\"content\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"f\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"Previous conversation context:\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D7BA7D\"},\"children\":\"\\\\n\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"context\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":232,\"style\":{\"width\":\"3ch\"},\"children\":232}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"                    }\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":233,\"style\":{\"width\":\"3ch\"},\"children\":233}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"                ]\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":234,\"style\":{\"width\":\"3ch\"},\"children\":234}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":235,\"style\":{\"width\":\"3ch\"},\"children\":235}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6A9955\"},\"children\":\"            # Process the query as before...\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":236,\"style\":{\"width\":\"3ch\"},\"children\":236}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"            response = \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4EC9B0\"},\"children\":\"super\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"().process_query(user_input)\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":237,\"style\":{\"width\":\"3ch\"},\"children\":237}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":238,\"style\":{\"width\":\"3ch\"},\"children\":238}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6A9955\"},\"children\":\"            # Store the interaction in memory\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":239,\"style\":{\"width\":\"3ch\"},\"children\":239}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"            tool_calls = \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"None\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":240,\"style\":{\"width\":\"3ch\"},\"children\":240}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"            if \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCDCAA\"},\"children\":\"hasattr\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"'last_tool_calls'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"):\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":241,\"style\":{\"width\":\"3ch\"},\"children\":241}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"                tool_calls = \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\".last_tool_calls\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":242,\"style\":{\"width\":\"3ch\"},\"children\":242}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":243,\"style\":{\"width\":\"3ch\"},\"children\":243}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"            self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\".memory.store_interaction(\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":244,\"style\":{\"width\":\"3ch\"},\"children\":244}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#9CDCFE\"},\"children\":\"                user_input\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"=user_input,\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":245,\"style\":{\"width\":\"3ch\"},\"children\":245}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#9CDCFE\"},\"children\":\"                agent_response\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"=response,\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":246,\"style\":{\"width\":\"3ch\"},\"children\":246}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#9CDCFE\"},\"children\":\"                tool_calls\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"=tool_calls\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":247,\"style\":{\"width\":\"3ch\"},\"children\":247}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"            )\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":248,\"style\":{\"width\":\"3ch\"},\"children\":248}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":249,\"style\":{\"width\":\"3ch\"},\"children\":249}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"            return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" response\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":250,\"style\":{\"width\":\"3ch\"},\"children\":250}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":251,\"style\":{\"width\":\"3ch\"},\"children\":251}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"        except \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4EC9B0\"},\"children\":\"Exception \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"as\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" e:\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":252,\"style\":{\"width\":\"3ch\"},\"children\":252}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"            error_message = \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"f\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"Error processing query: \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4EC9B0\"},\"children\":\"str\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"(e)\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":253,\"style\":{\"width\":\"3ch\"},\"children\":253}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"            self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\".memory.store_interaction(\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":254,\"style\":{\"width\":\"3ch\"},\"children\":254}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#9CDCFE\"},\"children\":\"                user_input\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"=user_input,\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":255,\"style\":{\"width\":\"3ch\"},\"children\":255}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#9CDCFE\"},\"children\":\"                agent_response\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"=error_message\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":256,\"style\":{\"width\":\"3ch\"},\"children\":256}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"            )\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":257,\"style\":{\"width\":\"3ch\"},\"children\":257}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"            return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" error_message\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":258,\"style\":{\"width\":\"3ch\"},\"children\":258}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":259,\"style\":{\"width\":\"3ch\"},\"children\":259}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"    def \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCDCAA\"},\"children\":\"execute_tool\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#9CDCFE\"},\"children\":\"self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#9CDCFE\"},\"children\":\"tool_call\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": Any) -\u003e \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4EC9B0\"},\"children\":\"str\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\":\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":260,\"style\":{\"width\":\"3ch\"},\"children\":260}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6A9955\"},\"children\":\"        # Store tool calls for memory\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":261,\"style\":{\"width\":\"3ch\"},\"children\":261}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"        if \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"not \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCDCAA\"},\"children\":\"hasattr\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"'last_tool_calls'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"):\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":262,\"style\":{\"width\":\"3ch\"},\"children\":262}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"            self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\".last_tool_calls = []\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":263,\"style\":{\"width\":\"3ch\"},\"children\":263}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":264,\"style\":{\"width\":\"3ch\"},\"children\":264}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"        result = \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4EC9B0\"},\"children\":\"super\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"().execute_tool(tool_call)\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":265,\"style\":{\"width\":\"3ch\"},\"children\":265}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":266,\"style\":{\"width\":\"3ch\"},\"children\":266}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6A9955\"},\"children\":\"        # Store tool call information\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":267,\"style\":{\"width\":\"3ch\"},\"children\":267}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"        self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\".last_tool_calls.append({\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":268,\"style\":{\"width\":\"3ch\"},\"children\":268}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"            'tool'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": tool_call.function.name,\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":269,\"style\":{\"width\":\"3ch\"},\"children\":269}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"            'arguments'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": tool_call.function.arguments,\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":270,\"style\":{\"width\":\"3ch\"},\"children\":270}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"            'result'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": result\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":271,\"style\":{\"width\":\"3ch\"},\"children\":271}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"        })\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":272,\"style\":{\"width\":\"3ch\"},\"children\":272}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":273,\"style\":{\"width\":\"3ch\"},\"children\":273}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"        return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" result\"}]],[\"$\",\"br\",null,{}]]}]}]]}]}]]}]\n"])</script><script>self.__next_f.push([1,"21:[\"$\",\"div\",null,{\"data-bright-theme\":\"dark-plus\",\"data-bright-mode\":\"$undefined\",\"className\":\"$undefined\",\"style\":{\"color\":\"#D4D4D4\",\"borderRadius\":\"4px\",\"overflow\":\"hidden\",\"margin\":\"1em 0\",\"--selection-background\":\"#264F78\",\"--line-number-color\":\"#858585\",\"--tab-border\":\"#252526\",\"--tab-background\":\"#1E1E1E\",\"--tab-color\":\"#ffffff\",\"--inactive-tab-background\":\"#2D2D2D\",\"--inactive-tab-color\":\"#ffffff80\",\"--tab-top-border\":\"$undefined\",\"--tab-bottom-border\":\"#1E1E1E\",\"colorScheme\":\"dark\"},\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"\\n  [data-bright-theme] ::selection { background-color: var(--selection-background) }\\n  [data-bright-theme] [data-bright-ln] { \\n    color: var(--line-number-color); \\n    margin-right: 1.5ch; \\n    display: inline-block;\\n    text-align: right;\\n    user-select: none;\\n  }\\n  \"}}],\"$undefined\",[\"$\",\"pre\",null,{\"style\":{\"margin\":0,\"color\":\"#D4D4D4\",\"background\":\"#1E1E1E\",\"padding\":\"1em 0\",\"overflow\":\"auto\"},\"children\":[\"$\",\"code\",null,{\"className\":\"$undefined\",\"style\":{\"display\":\"block\",\"minWidth\":\"fit-content\"},\"children\":[[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":1,\"style\":{\"width\":\"2ch\"},\"children\":1}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"from\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" your_agent \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"import\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" Agent, MemoryConfig  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6A9955\"},\"children\":\"# assuming we saved our code in your_agent.py\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":2,\"style\":{\"width\":\"2ch\"},\"children\":2}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":3,\"style\":{\"width\":\"2ch\"},\"children\":3}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6A9955\"},\"children\":\"# Create an agent\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":4,\"style\":{\"width\":\"2ch\"},\"children\":4}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"agent = Agent(\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":5,\"style\":{\"width\":\"2ch\"},\"children\":5}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#9CDCFE\"},\"children\":\"    memory_config\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"=MemoryConfig(\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":6,\"style\":{\"width\":\"2ch\"},\"children\":6}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#9CDCFE\"},\"children\":\"        max_messages\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B5CEA8\"},\"children\":\"10\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\",  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6A9955\"},\"children\":\"# summarize after 10 messages\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":7,\"style\":{\"width\":\"2ch\"},\"children\":7}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#9CDCFE\"},\"children\":\"        db_connection\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"postgresql://user:pass@localhost/your_db\\\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":8,\"style\":{\"width\":\"2ch\"},\"children\":8}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"    )\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":9,\"style\":{\"width\":\"2ch\"},\"children\":9}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\")\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":10,\"style\":{\"width\":\"2ch\"},\"children\":10}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":11,\"style\":{\"width\":\"2ch\"},\"children\":11}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6A9955\"},\"children\":\"# Simple question-answer interaction\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":12,\"style\":{\"width\":\"2ch\"},\"children\":12}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"def \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCDCAA\"},\"children\":\"chat_with_agent\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#9CDCFE\"},\"children\":\"question\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4EC9B0\"},\"children\":\"str\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"):\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":13,\"style\":{\"width\":\"2ch\"},\"children\":13}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCDCAA\"},\"children\":\"    print\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"f\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D7BA7D\"},\"children\":\"\\\\n\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"User: \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"question\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\")\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":14,\"style\":{\"width\":\"2ch\"},\"children\":14}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCDCAA\"},\"children\":\"    print\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"f\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"Assistant: \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"agent.process_query(question)\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\")\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":15,\"style\":{\"width\":\"2ch\"},\"children\":15}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":16,\"style\":{\"width\":\"2ch\"},\"children\":16}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"if \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#9CDCFE\"},\"children\":\"__name__\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" == \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"__main__\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\":\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":17,\"style\":{\"width\":\"2ch\"},\"children\":17}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"    chat_with_agent(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"How many users do we have in our database?\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\")\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":18,\"style\":{\"width\":\"2ch\"},\"children\":18}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"    chat_with_agent(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"What's the average age of users from New York?\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\")\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":19,\"style\":{\"width\":\"2ch\"},\"children\":19}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"    chat_with_agent(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"Compare our user base in California with PostgreSQL's popularity there\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\")\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":20,\"style\":{\"width\":\"2ch\"},\"children\":20}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"    chat_with_agent(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"What were the numbers you just mentioned?\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\")\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":21,\"style\":{\"width\":\"2ch\"},\"children\":21}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"    chat_with_agent(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"What are the most interesting trends you can find in our user data?\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\")\"}]],[\"$\",\"br\",null,{}]]}]}]]}]}]]}]\n"])</script><script>self.__next_f.push([1,"23:[\"$\",\"div\",null,{\"data-bright-theme\":\"dark-plus\",\"data-bright-mode\":\"$undefined\",\"className\":\"$undefined\",\"style\":{\"color\":\"#D4D4D4\",\"borderRadius\":\"4px\",\"overflow\":\"hidden\",\"margin\":\"1em 0\",\"--selection-background\":\"#264F78\",\"--line-number-color\":\"#858585\",\"--tab-border\":\"#252526\",\"--tab-background\":\"#1E1E1E\",\"--tab-color\":\"#ffffff\",\"--inactive-tab-background\":\"#2D2D2D\",\"--inactive-tab-color\":\"#ffffff80\",\"--tab-top-border\":\"$undefined\",\"--tab-bottom-border\":\"#1E1E1E\",\"colorScheme\":\"dark\"},\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"\\n  [data-bright-theme] ::selection { background-color: var(--selection-background) }\\n  [data-bright-theme] [data-bright-ln] { \\n    color: var(--line-number-color); \\n    margin-right: 1.5ch; \\n    display: inline-block;\\n    text-align: right;\\n    user-select: none;\\n  }\\n  \"}}],\"$undefined\",[\"$\",\"pre\",null,{\"style\":{\"margin\":0,\"color\":\"#D4D4D4\",\"background\":\"#1E1E1E\",\"padding\":\"1em 0\",\"overflow\":\"auto\"},\"children\":[\"$\",\"code\",null,{\"className\":\"$undefined\",\"style\":{\"display\":\"block\",\"minWidth\":\"fit-content\"},\"children\":[[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":1,\"style\":{\"width\":\"3ch\"},\"children\":1}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"def \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCDCAA\"},\"children\":\"get_database_schema\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"() -\u003e \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4EC9B0\"},\"children\":\"str\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\":\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":2,\"style\":{\"width\":\"3ch\"},\"children\":2}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"    \\\"\\\"\\\"Retrieve the database schema information\\\"\\\"\\\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":3,\"style\":{\"width\":\"3ch\"},\"children\":3}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"    schema_query = \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"\\\"\\\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":4,\"style\":{\"width\":\"3ch\"},\"children\":4}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"    SELECT\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":5,\"style\":{\"width\":\"3ch\"},\"children\":5}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"        t.table_name,\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":6,\"style\":{\"width\":\"3ch\"},\"children\":6}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"        array_agg(\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":7,\"style\":{\"width\":\"3ch\"},\"children\":7}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"            c.column_name || ' ' ||\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":8,\"style\":{\"width\":\"3ch\"},\"children\":8}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"            c.data_type ||\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":9,\"style\":{\"width\":\"3ch\"},\"children\":9}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"            CASE\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":10,\"style\":{\"width\":\"3ch\"},\"children\":10}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"                WHEN c.is_nullable = 'NO' THEN ' NOT NULL'\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":11,\"style\":{\"width\":\"3ch\"},\"children\":11}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"                ELSE ''\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":12,\"style\":{\"width\":\"3ch\"},\"children\":12}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"            END\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":13,\"style\":{\"width\":\"3ch\"},\"children\":13}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"        ) as columns\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":14,\"style\":{\"width\":\"3ch\"},\"children\":14}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"    FROM information_schema.tables t\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":15,\"style\":{\"width\":\"3ch\"},\"children\":15}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"    JOIN information_schema.columns c\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":16,\"style\":{\"width\":\"3ch\"},\"children\":16}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"        ON c.table_name = t.table_name\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":17,\"style\":{\"width\":\"3ch\"},\"children\":17}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"    WHERE t.table_schema = 'public'\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":18,\"style\":{\"width\":\"3ch\"},\"children\":18}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"        AND t.table_type = 'BASE TABLE'\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":19,\"style\":{\"width\":\"3ch\"},\"children\":19}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"    GROUP BY t.table_name;\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":20,\"style\":{\"width\":\"3ch\"},\"children\":20}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"    \\\"\\\"\\\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":21,\"style\":{\"width\":\"3ch\"},\"children\":21}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":22,\"style\":{\"width\":\"3ch\"},\"children\":22}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"    try\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\":\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":23,\"style\":{\"width\":\"3ch\"},\"children\":23}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"        with\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" psycopg2.connect(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"dbname=your_db user=your_user password=your_pass\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\") \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"as\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" conn:\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":24,\"style\":{\"width\":\"3ch\"},\"children\":24}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"            with\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" conn.cursor() \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"as\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" cur:\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":25,\"style\":{\"width\":\"3ch\"},\"children\":25}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"                cur.execute(schema_query)\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":26,\"style\":{\"width\":\"3ch\"},\"children\":26}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"                schema = cur.fetchall()\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":27,\"style\":{\"width\":\"3ch\"},\"children\":27}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":28,\"style\":{\"width\":\"3ch\"},\"children\":28}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6A9955\"},\"children\":\"                # Format schema information\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":29,\"style\":{\"width\":\"3ch\"},\"children\":29}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"                schema_str = \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"Database Schema:\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D7BA7D\"},\"children\":\"\\\\n\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":30,\"style\":{\"width\":\"3ch\"},\"children\":30}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"                for\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" table_name, columns \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"in\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" schema:\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":31,\"style\":{\"width\":\"3ch\"},\"children\":31}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"                    schema_str += \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"f\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D7BA7D\"},\"children\":\"\\\\n\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"table_name\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D7BA7D\"},\"children\":\"\\\\n\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":32,\"style\":{\"width\":\"3ch\"},\"children\":32}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"                    for\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" col \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"in\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" columns:\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":33,\"style\":{\"width\":\"3ch\"},\"children\":33}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"                        schema_str += \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"f\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"  - \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"col\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D7BA7D\"},\"children\":\"\\\\n\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":34,\"style\":{\"width\":\"3ch\"},\"children\":34}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":35,\"style\":{\"width\":\"3ch\"},\"children\":35}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"                return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" schema_str\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":36,\"style\":{\"width\":\"3ch\"},\"children\":36}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"    except \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4EC9B0\"},\"children\":\"Exception \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"as\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" e:\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":37,\"style\":{\"width\":\"3ch\"},\"children\":37}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"        return \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"f\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"Error fetching schema: \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4EC9B0\"},\"children\":\"str\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"(e)\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":38,\"style\":{\"width\":\"3ch\"},\"children\":38}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":39,\"style\":{\"width\":\"3ch\"},\"children\":39}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6A9955\"},\"children\":\"# Updated tool definition with schema information;\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":40,\"style\":{\"width\":\"3ch\"},\"children\":40}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6A9955\"},\"children\":\"# Note that we could also dynamically fetch the schema when needed\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":41,\"style\":{\"width\":\"3ch\"},\"children\":41}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"tools = [\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":42,\"style\":{\"width\":\"3ch\"},\"children\":42}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"    {\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":43,\"style\":{\"width\":\"3ch\"},\"children\":43}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"        \\\"type\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"function\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\",\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":44,\"style\":{\"width\":\"3ch\"},\"children\":44}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"        \\\"function\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": {\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":45,\"style\":{\"width\":\"3ch\"},\"children\":45}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"            \\\"name\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"query_database\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\",\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":46,\"style\":{\"width\":\"3ch\"},\"children\":46}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"            \\\"description\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"\\\"\\\"Execute a PostgreSQL SELECT query and return the results.\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":47,\"style\":{\"width\":\"3ch\"},\"children\":47}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"            Available tables and their schemas:\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":48,\"style\":{\"width\":\"3ch\"},\"children\":48}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":49,\"style\":{\"width\":\"3ch\"},\"children\":49}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"            users\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":50,\"style\":{\"width\":\"3ch\"},\"children\":50}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"              - id SERIAL PRIMARY KEY\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":51,\"style\":{\"width\":\"3ch\"},\"children\":51}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"              - email VARCHAR(255) NOT NULL\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":52,\"style\":{\"width\":\"3ch\"},\"children\":52}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"              - age INTEGER\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":53,\"style\":{\"width\":\"3ch\"},\"children\":53}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"              - location VARCHAR(100)\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":54,\"style\":{\"width\":\"3ch\"},\"children\":54}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"              - signup_date DATE NOT NULL\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":55,\"style\":{\"width\":\"3ch\"},\"children\":55}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"              - last_login TIMESTAMP WITH TIME ZONE\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":56,\"style\":{\"width\":\"3ch\"},\"children\":56}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"              - job_industry VARCHAR(100)\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":57,\"style\":{\"width\":\"3ch\"},\"children\":57}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":58,\"style\":{\"width\":\"3ch\"},\"children\":58}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"            user_activity\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":59,\"style\":{\"width\":\"3ch\"},\"children\":59}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"              - id SERIAL PRIMARY KEY\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":60,\"style\":{\"width\":\"3ch\"},\"children\":60}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"              - user_id INTEGER REFERENCES users(id)\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":61,\"style\":{\"width\":\"3ch\"},\"children\":61}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"              - activity_date DATE NOT NULL\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":62,\"style\":{\"width\":\"3ch\"},\"children\":62}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"              - activity_type VARCHAR(50) NOT NULL\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":63,\"style\":{\"width\":\"3ch\"},\"children\":63}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"            \\\"\\\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\",\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":64,\"style\":{\"width\":\"3ch\"},\"children\":64}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"            \\\"parameters\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": {\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":65,\"style\":{\"width\":\"3ch\"},\"children\":65}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"                \\\"type\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"object\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\",\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":66,\"style\":{\"width\":\"3ch\"},\"children\":66}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"                \\\"properties\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": {\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":67,\"style\":{\"width\":\"3ch\"},\"children\":67}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"                    \\\"query\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": {\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":68,\"style\":{\"width\":\"3ch\"},\"children\":68}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"                        \\\"type\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"string\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\",\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":69,\"style\":{\"width\":\"3ch\"},\"children\":69}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"                        \\\"description\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"The SQL SELECT query to execute. Must start with SELECT for security.\\\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":70,\"style\":{\"width\":\"3ch\"},\"children\":70}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"                    }\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":71,\"style\":{\"width\":\"3ch\"},\"children\":71}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"                },\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":72,\"style\":{\"width\":\"3ch\"},\"children\":72}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"                \\\"required\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": [\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"query\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"],\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":73,\"style\":{\"width\":\"3ch\"},\"children\":73}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"                \\\"additionalProperties\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"False\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":74,\"style\":{\"width\":\"3ch\"},\"children\":74}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"            },\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":75,\"style\":{\"width\":\"3ch\"},\"children\":75}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"            \\\"strict\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"True\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":76,\"style\":{\"width\":\"3ch\"},\"children\":76}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"        }\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":77,\"style\":{\"width\":\"3ch\"},\"children\":77}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"    }\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":78,\"style\":{\"width\":\"3ch\"},\"children\":78}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"]\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":79,\"style\":{\"width\":\"3ch\"},\"children\":79}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":80,\"style\":{\"width\":\"3ch\"},\"children\":80}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6A9955\"},\"children\":\"# Updated database query function\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":81,\"style\":{\"width\":\"3ch\"},\"children\":81}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"def \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCDCAA\"},\"children\":\"query_database\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#9CDCFE\"},\"children\":\"query\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4EC9B0\"},\"children\":\"str\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\") -\u003e \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4EC9B0\"},\"children\":\"str\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\":\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":82,\"style\":{\"width\":\"3ch\"},\"children\":82}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"    \\\"\\\"\\\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":83,\"style\":{\"width\":\"3ch\"},\"children\":83}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"    Execute a PostgreSQL query with schema awareness\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":84,\"style\":{\"width\":\"3ch\"},\"children\":84}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"    \\\"\\\"\\\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":85,\"style\":{\"width\":\"3ch\"},\"children\":85}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"    if \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"not\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" query.lower().strip().startswith(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"'select'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"):\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":86,\"style\":{\"width\":\"3ch\"},\"children\":86}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"        return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" json.dumps({\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":87,\"style\":{\"width\":\"3ch\"},\"children\":87}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"            \\\"error\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"Only SELECT queries are allowed for security reasons.\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\",\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":88,\"style\":{\"width\":\"3ch\"},\"children\":88}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"            \\\"schema\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": get_database_schema()  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6A9955\"},\"children\":\"# Return schema for reference\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":89,\"style\":{\"width\":\"3ch\"},\"children\":89}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"        })\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":90,\"style\":{\"width\":\"3ch\"},\"children\":90}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":91,\"style\":{\"width\":\"3ch\"},\"children\":91}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"    try\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\":\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":92,\"style\":{\"width\":\"3ch\"},\"children\":92}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"        with\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" psycopg2.connect(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"\\\"dbname=your_db user=your_user password=your_pass\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\") \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"as\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" conn:\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":93,\"style\":{\"width\":\"3ch\"},\"children\":93}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"            with\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" conn.cursor() \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"as\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" cur:\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":94,\"style\":{\"width\":\"3ch\"},\"children\":94}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"                cur.execute(query)\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":95,\"style\":{\"width\":\"3ch\"},\"children\":95}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":96,\"style\":{\"width\":\"3ch\"},\"children\":96}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6A9955\"},\"children\":\"                # Get column names from cursor description\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":97,\"style\":{\"width\":\"3ch\"},\"children\":97}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"                columns = [desc[\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B5CEA8\"},\"children\":\"0\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"] \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"for\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" desc \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"in\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" cur.description]\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":98,\"style\":{\"width\":\"3ch\"},\"children\":98}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":99,\"style\":{\"width\":\"3ch\"},\"children\":99}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6A9955\"},\"children\":\"                # Fetch results and convert to list of dictionaries\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":100,\"style\":{\"width\":\"3ch\"},\"children\":100}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"                results = []\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":101,\"style\":{\"width\":\"3ch\"},\"children\":101}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"                for\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" row \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"in\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" cur.fetchall():\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":102,\"style\":{\"width\":\"3ch\"},\"children\":102}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"                    results.append(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4EC9B0\"},\"children\":\"dict\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCDCAA\"},\"children\":\"zip\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"(columns, row)))\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":103,\"style\":{\"width\":\"3ch\"},\"children\":103}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":104,\"style\":{\"width\":\"3ch\"},\"children\":104}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"                return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" json.dumps({\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":105,\"style\":{\"width\":\"3ch\"},\"children\":105}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"                    \\\"success\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"True\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\",\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":106,\"style\":{\"width\":\"3ch\"},\"children\":106}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"                    \\\"data\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4EC9B0\"},\"children\":\"str\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"(results),\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":107,\"style\":{\"width\":\"3ch\"},\"children\":107}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"                    \\\"row_count\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCDCAA\"},\"children\":\"len\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"(results),\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":108,\"style\":{\"width\":\"3ch\"},\"children\":108}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"                    \\\"columns\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": columns\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":109,\"style\":{\"width\":\"3ch\"},\"children\":109}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"                })\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":110,\"style\":{\"width\":\"3ch\"},\"children\":110}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":111,\"style\":{\"width\":\"3ch\"},\"children\":111}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"    except \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4EC9B0\"},\"children\":\"Exception \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"as\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" e:\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":112,\"style\":{\"width\":\"3ch\"},\"children\":112}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C586C0\"},\"children\":\"        return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" json.dumps({\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":113,\"style\":{\"width\":\"3ch\"},\"children\":113}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"            \\\"error\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4EC9B0\"},\"children\":\"str\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"(e),\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":114,\"style\":{\"width\":\"3ch\"},\"children\":114}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"            \\\"schema\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\": get_database_schema()  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6A9955\"},\"children\":\"# Return schema on error for help\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":115,\"style\":{\"width\":\"3ch\"},\"children\":115}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"        })\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":116,\"style\":{\"width\":\"3ch\"},\"children\":116}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":117,\"style\":{\"width\":\"3ch\"},\"children\":117}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6A9955\"},\"children\":\"# Usage example:\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":118,\"style\":{\"width\":\"3ch\"},\"children\":118}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"agent = Agent()\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":119,\"style\":{\"width\":\"3ch\"},\"children\":119}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":120,\"style\":{\"width\":\"3ch\"},\"children\":120}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6A9955\"},\"children\":\"# The agent now knows about the schema and can write better queries\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":121,\"style\":{\"width\":\"3ch\"},\"children\":121}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"response = agent.process_query(\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":122,\"style\":{\"width\":\"3ch\"},\"children\":122}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CE9178\"},\"children\":\"    \\\"What's the age distribution of users by location and industry?\\\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":123,\"style\":{\"width\":\"3ch\"},\"children\":123}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\")\"}]],[\"$\",\"br\",null,{}]]}]}]]}]}]]}]\n"])</script><script>self.__next_f.push([1,"1e:[\"$\",\"div\",null,{\"data-bright-theme\":\"dark-plus\",\"data-bright-mode\":\"$undefined\",\"className\":\"$undefined\",\"style\":{\"color\":\"#D4D4D4\",\"borderRadius\":\"4px\",\"overflow\":\"hidden\",\"margin\":\"1em 0\",\"--selection-background\":\"#264F78\",\"--line-number-color\":\"#858585\",\"--tab-border\":\"#252526\",\"--tab-background\":\"#1E1E1E\",\"--tab-color\":\"#ffffff\",\"--inactive-tab-background\":\"#2D2D2D\",\"--inactive-tab-color\":\"#ffffff80\",\"--tab-top-border\":\"$undefined\",\"--tab-bottom-border\":\"#1E1E1E\",\"colorScheme\":\"dark\"},\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"\\n  [data-bright-theme] ::selection { background-color: var(--selection-background) }\\n  [data-bright-theme] [data-bright-ln] { \\n    color: var(--line-number-color); \\n    margin-right: 1.5ch; \\n    display: inline-block;\\n    text-align: right;\\n    user-select: none;\\n  }\\n  \"}}],\"$undefined\",[\"$\",\"pre\",null,{\"style\":{\"margin\":0,\"color\":\"#D4D4D4\",\"background\":\"#1E1E1E\",\"padding\":\"1em 0\",\"overflow\":\"auto\"},\"children\":[\"$\",\"code\",null,{\"className\":\"$undefined\",\"style\":{\"display\":\"block\",\"minWidth\":\"fit-content\"},\"children\":[[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":1,\"style\":{\"width\":\"2ch\"},\"children\":1}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"CREATE TABLE \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCDCAA\"},\"children\":\"conversations\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" (\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":2,\"style\":{\"width\":\"2ch\"},\"children\":2}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"    id \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"SERIAL PRIMARY KEY\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\",\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":3,\"style\":{\"width\":\"2ch\"},\"children\":3}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"    session_id UUID,\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":4,\"style\":{\"width\":\"2ch\"},\"children\":4}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"    user_input \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"TEXT\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\",\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":5,\"style\":{\"width\":\"2ch\"},\"children\":5}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"    agent_response \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"TEXT\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\",\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":6,\"style\":{\"width\":\"2ch\"},\"children\":6}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"    tool_calls JSONB,  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6A9955\"},\"children\":\"-- Store tool usage\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":7,\"style\":{\"width\":\"2ch\"},\"children\":7}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"    timestamp TIMESTAMPTZ DEFAULT NOW\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"()\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":8,\"style\":{\"width\":\"2ch\"},\"children\":8}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\");\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":9,\"style\":{\"width\":\"2ch\"},\"children\":9}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":10,\"style\":{\"width\":\"2ch\"},\"children\":10}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"CREATE TABLE \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCDCAA\"},\"children\":\"conversation_summaries\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\" (\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":11,\"style\":{\"width\":\"2ch\"},\"children\":11}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"    id \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"SERIAL PRIMARY KEY\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\",\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":12,\"style\":{\"width\":\"2ch\"},\"children\":12}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"    session_id UUID,\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":13,\"style\":{\"width\":\"2ch\"},\"children\":13}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"    summary \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"TEXT\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\",\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":14,\"style\":{\"width\":\"2ch\"},\"children\":14}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"    start_time \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"TIMESTAMPTZ\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\",\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":15,\"style\":{\"width\":\"2ch\"},\"children\":15}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"    end_time \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"TIMESTAMPTZ\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\",\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":16,\"style\":{\"width\":\"2ch\"},\"children\":16}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\"    message_count \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#569CD6\"},\"children\":\"INTEGER\"}]],[\"$\",\"br\",null,{}]]}]}],[\"$\",\"div\",null,{\"style\":{\"padding\":\"0 1em\"},\"children\":[\"$\",\"span\",null,{\"children\":[[\"$\",\"span\",null,{\"data-bright-ln\":17,\"style\":{\"width\":\"2ch\"},\"children\":17}],[[\"$\",\"span\",null,{\"style\":{\"color\":\"#D4D4D4\"},\"children\":\");\"}]],[\"$\",\"br\",null,{}]]}]}]]}]}]]}]\n"])</script></body></html>