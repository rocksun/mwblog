# Rethinking Identity and Access for Cloud Native
![Featued image for: Rethinking Identity and Access for Cloud Native](https://cdn.thenewstack.io/media/2024/05/06aae5f0-lasers123-1024x576.jpg)
The identity and access management (IAM) market is a behemoth: hundreds of vendors and a projected $19 billion market in 2024, according to
[Gartner](https://www.gartner.com/smarterwithgartner/key-priorities-for-iam-leaders-in-2021).
But off-the-shelf IAM solutions as well as capabilities from cloud service providers are being stretched by the new world of cloud native least privilege scenarios. And like so many other examples in cloud native, some of the most interesting approaches are actually bespoke efforts by platform engineers, born out of necessity inside the walls of their own organizations.
Any vendor helping customers secure their supply chains, or that is providing software like container images which become a major component of their customers’ supply chains, needs to take this approach to security seriously and meticulously. Here are some ways to achieve that.
**New Pressures for Classic IAM Approaches**
Platform engineering teams are being tasked to figure out better “defense in depth” strategies. Taking a page out of the
[site reliability engineering](https://thenewstack.io/a-site-reliability-engineers-advice-on-what-breaks-our-systems/) (SRE) mindset, if we assume that our lines of defense are only 99% reliable, then it stands to reason that over time we will see failures, so how can a platform team build layers of redundant protection that stop threats once they have breached one or more of these layers of protection?
A key part of this is your IAM strategy, and a practice called “least privilege.” The principle of least privilege is a widely accepted security best practice where the aim is to minimize the access (or privilege) granted to identities across a number of dimensions:
[Minimalism](https://www.chainguard.dev/unchained/the-principle-of-minimalism): Level of access (admin > writer > reader > none) [Minimalism](https://www.chainguard.dev/unchained/the-principle-of-minimalism): Scope of access (org > org unit / folder > account / project > resource > none) [Ephemerality](https://www.chainguard.dev/unchained/the-principle-of-ephemerality): Duration ( forever > long-lived > short-lived > none)
Generally, identities within
[cloud platforms are created](https://thenewstack.io/architectural-considerations-for-creating-cloud-native-applications/) with a clean slate: no access to anything. ![](https://cdn.thenewstack.io/media/2024/05/50c9db61-image1.png)
Figure 1
This is a great starting point, and privileges are added via grants of a particular role (set of capabilities) at a particular IAM scope, ideally, the exact resource those capabilities are needed to interact with.
Assuming everyone adheres to these ideals, the least privilege is achieved. A good name for this model is “cooperative least privilege” because it requires everyone participating in the access control model to work together to ensure the least privilege is achieved (similar to
[cooperative multitasking](https://en.wikipedia.org/wiki/Cooperative_multitasking)).
**The Evolution to Audited Least Privilege**
The belief of the platform engineering team should be that any security control is fallible, and thus a defense-in-depth model must be deployed where multiple overlapping controls are used to have checks and balances that the overall system is working properly. For example, Chainguard looks at this belief even more deeply for our security design, asking ourselves how we check the assumptions of a cooperative least privilege model and ensure that there is no untoward access of our resources.
![](https://cdn.thenewstack.io/media/2024/05/0e7e3e90-image3.png)
Figure 2
It is fairly typical to focus on the actor when reasoning about least privilege, as evidenced by the identity-centric visualization above, but what if we were to reorient around the atoms on the other side of the access grant arrows? What might a resource-centric view of least privilege look like?
However, due to the hierarchical nature of IAM models, the grants that allow access could be challenging to discover fully. So how can we ensure that our resources are only accessed in the ways we expect by the identities we expect to interact with them? The answer became pretty plain to see: IAM audit logs.
The cornerstone of cooperative least privilege is very fine IAM access grants. When we flip things around the dual is very fine IAM audit log policies. It’s a model that we call “audited least privilege.”
In the audited least privilege model, we pair each cloud resource that we provision with an IAM audit log alert policy that triggers whenever a resource is accessed outside of the expected minimum. This minimum is typically defined in terms of a set of IAM principles mapped to acceptable interactions (like in our diagram above). My pet name for these IAM alert policies has become the “laser grid” because it evokes the Hollywood heist visual of the priceless artifact surrounded by laser beams.
**Mapping to the 99.9% Expected + Auditing: a Winning Pattern**
Similar to building reliable, distributed systems out of less reliable components, by layering your defense with just two layers with 99% reliability, and assuming the ways they will fail aren’t correlated, you raise the probability that the layered defense will hold to 99.99%.
There are a lot of pitfalls in IAM that are pretty well-known, but still common. IAM grants tend to be overly broad, for example, granting privilege at an account or project level versus a resource level. Sometimes granted capabilities are too broad, possibly due to overly coarse built-in policies. Things like reusing workload identities across multiple services is another no-no because when three different things use the same service and any one of those needs to talk to something new, you end up granting that capability to all three services using that identity.
Think about IAM like a lock (aka a mutex). You want to minimize the amount of work you do while holding these privileges. Microservices let you pull out the functionality that needs certain privileges with a nice constrained interface to just that service.
This is how Chainguard has built out its least privilege implementation around our Chainguard Images product. We believe the principle of least privilege (
[minimalism](https://www.chainguard.dev/unchained/the-principle-of-minimalism)) via short-lived credentials ( [ephemerality](https://www.chainguard.dev/unchained/the-principle-of-ephemerality)) is foundational to the best security posture. When we create service abstractions around resources, we set up laser grids around those resources that codify our auditing so that we get alerts whenever any entity is trying to access data, that’s anomalous to the 99.9% of expected access.
We’re at an interesting moment in platform engineering where the isolation made possible by microservices, the maturity of OpenID Connect and other authentication mechanisms, and the ability for platform teams to create new layers of encapsulation, are all coming together. Like so many prior innovations in cloud native, what begins as bespoke efforts born out of necessity by platform engineering teams, is a peek at the future. And I think we’re going to see much deeper programmability and auditing being driven into IAM as the industry gets smarter about how it encapsulates security across distributed systems.
[
YOUTUBE.COM/THENEWSTACK
Tech moves fast, don't miss an episode. Subscribe to our YouTube
channel to stream all our podcasts, interviews, demos, and more.
](https://youtube.com/thenewstack?sub_confirmation=1)