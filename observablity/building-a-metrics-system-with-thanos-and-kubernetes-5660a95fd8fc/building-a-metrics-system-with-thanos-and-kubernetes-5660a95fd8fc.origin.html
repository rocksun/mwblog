<!doctype html><html lang="en"><head><title data-rh="true">Building a Metrics System with Thanos and Kubernetes | overcast blog</title><meta data-rh="true" charset="utf-8"/><meta data-rh="true" name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1,maximum-scale=1"/><meta data-rh="true" name="theme-color" content="#000000"/><meta data-rh="true" name="twitter:app:name:iphone" content="Medium"/><meta data-rh="true" name="twitter:app:id:iphone" content="828256236"/><meta data-rh="true" property="al:ios:app_name" content="Medium"/><meta data-rh="true" property="al:ios:app_store_id" content="828256236"/><meta data-rh="true" property="al:android:package" content="com.medium.reader"/><meta data-rh="true" property="fb:app_id" content="542599432471018"/><meta data-rh="true" property="og:site_name" content="Medium"/><meta data-rh="true" property="og:type" content="article"/><meta data-rh="true" property="article:published_time" content="2024-09-18T11:01:29.953Z"/><meta data-rh="true" name="title" content="Building a Metrics System with Thanos and Kubernetes | overcast blog"/><meta data-rh="true" property="og:title" content="Building a Metrics System with Thanos and Kubernetes"/><meta data-rh="true" property="al:android:url" content="medium://p/5660a95fd8fc"/><meta data-rh="true" property="al:ios:url" content="medium://p/5660a95fd8fc"/><meta data-rh="true" property="al:android:app_name" content="Medium"/><meta data-rh="true" name="description" content="Metrics are the backbone of observability in any distributed system, and in Kubernetes environments, Prometheus is often the tool of choice. However, scaling Prometheus and retaining long-term…"/><meta data-rh="true" property="og:description" content="Metrics are the backbone of observability in any distributed system, and in Kubernetes environments, Prometheus is often the tool of…"/><meta data-rh="true" property="og:url" content="https://overcast.blog/building-a-metrics-system-with-thanos-and-kubernetes-5660a95fd8fc"/><meta data-rh="true" property="al:web:url" content="https://overcast.blog/building-a-metrics-system-with-thanos-and-kubernetes-5660a95fd8fc"/><meta data-rh="true" property="og:image" content="https://miro.medium.com/v2/resize:fit:985/1*QobsYEWqhoc_8s3tyB1Jlg.png"/><meta data-rh="true" property="article:author" content="https://medium.com/@dskydragon"/><meta data-rh="true" name="author" content="DavidW (skyDragon)"/><meta data-rh="true" name="robots" content="index,noarchive,follow,max-image-preview:large"/><meta data-rh="true" name="referrer" content="unsafe-url"/><meta data-rh="true" property="twitter:title" content="Building a Metrics System with Thanos and Kubernetes"/><meta data-rh="true" name="twitter:site" content="@dailycloudblog"/><meta data-rh="true" name="twitter:app:url:iphone" content="medium://p/5660a95fd8fc"/><meta data-rh="true" property="twitter:description" content="Metrics are the backbone of observability in any distributed system, and in Kubernetes environments, Prometheus is often the tool of…"/><meta data-rh="true" name="twitter:image:src" content="https://miro.medium.com/v2/resize:fit:985/1*QobsYEWqhoc_8s3tyB1Jlg.png"/><meta data-rh="true" name="twitter:card" content="summary_large_image"/><meta data-rh="true" name="twitter:label1" content="Reading time"/><meta data-rh="true" name="twitter:data1" content="11 min read"/><link data-rh="true" rel="icon" href="https://miro.medium.com/v2/resize:fill:256:256/1*hC4pCAXASl2ZiwjKBtISBg.jpeg"/><link data-rh="true" rel="search" type="application/opensearchdescription+xml" title="Medium" href="/osd.xml"/><link data-rh="true" rel="apple-touch-icon" sizes="152x152" href="https://miro.medium.com/v2/resize:fill:304:304/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="120x120" href="https://miro.medium.com/v2/resize:fill:240:240/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="76x76" href="https://miro.medium.com/v2/resize:fill:152:152/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="60x60" href="https://miro.medium.com/v2/resize:fill:120:120/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="mask-icon" href="https://miro.medium.com/v2/resize:fill:1000:1000/7*GAOKVe--MXbEJmV9230oOQ.png" color="#171717"/><link data-rh="true" id="glyph_preload_link" rel="preload" as="style" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" id="glyph_link" rel="stylesheet" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" rel="author" href="https://medium.com/@dskydragon"/><link data-rh="true" rel="canonical" href="https://overcast.blog/building-a-metrics-system-with-thanos-and-kubernetes-5660a95fd8fc"/><link data-rh="true" rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/5660a95fd8fc"/><script data-rh="true" type="application/ld+json">{"@context":"http:\u002F\u002Fschema.org","@type":"NewsArticle","image":["https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:1200\u002F1*QobsYEWqhoc_8s3tyB1Jlg.png"],"url":"https:\u002F\u002Fovercast.blog\u002Fbuilding-a-metrics-system-with-thanos-and-kubernetes-5660a95fd8fc","dateCreated":"2024-09-18T11:01:29.953Z","datePublished":"2024-09-18T11:01:29.953Z","dateModified":"2024-09-19T13:24:47.011Z","headline":"Building a Metrics System with Thanos and Kubernetes | overcast blog","name":"Building a Metrics System with Thanos and Kubernetes | overcast blog","description":"Metrics are the backbone of observability in any distributed system, and in Kubernetes environments, Prometheus is often the tool of choice. However, scaling Prometheus and retaining long-term…","identifier":"5660a95fd8fc","author":{"@type":"Person","name":"DavidW (skyDragon)","url":"https:\u002F\u002Fovercast.blog\u002F@dskydragon"},"creator":["DavidW (skyDragon)"],"publisher":{"@type":"Organization","name":"overcast blog","url":"overcast.blog","logo":{"@type":"ImageObject","width":106,"height":60,"url":"https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:212\u002F1*hC4pCAXASl2ZiwjKBtISBg.jpeg"}},"mainEntityOfPage":"https:\u002F\u002Fovercast.blog\u002Fbuilding-a-metrics-system-with-thanos-and-kubernetes-5660a95fd8fc"}</script><style type="text/css" data-fela-rehydration="545" data-fela-type="STATIC">html{box-sizing:border-box;-webkit-text-size-adjust:100%}*, *:before, *:after{box-sizing:inherit}body{margin:0;padding:0;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;color:rgba(0,0,0,0.8);position:relative;min-height:100vh}h1, h2, h3, h4, h5, h6, dl, dd, ol, ul, menu, figure, blockquote, p, pre, form{margin:0}menu, ol, ul{padding:0;list-style:none;list-style-image:none}main{display:block}a{color:inherit;text-decoration:none}a, button, input{-webkit-tap-highlight-color:transparent}img, svg{vertical-align:middle}button{background:transparent;overflow:visible}button, input, optgroup, select, textarea{margin:0}:root{--reach-tabs:1;--reach-menu-button:1}#speechify-root{font-family:Sohne, sans-serif}div[data-popper-reference-hidden="true"]{visibility:hidden;pointer-events:none}.grecaptcha-badge{visibility:hidden}
/*XCode style (c) Angel Garcia <angelgarcia.mail@gmail.com>*/.hljs {background: #fff;color: black;
}/* Gray DOCTYPE selectors like WebKit */
.xml .hljs-meta {color: #c0c0c0;
}.hljs-comment,
.hljs-quote {color: #007400;
}.hljs-tag,
.hljs-attribute,
.hljs-keyword,
.hljs-selector-tag,
.hljs-literal,
.hljs-name {color: #aa0d91;
}.hljs-variable,
.hljs-template-variable {color: #3F6E74;
}.hljs-code,
.hljs-string,
.hljs-meta .hljs-string {color: #c41a16;
}.hljs-regexp,
.hljs-link {color: #0E0EFF;
}.hljs-title,
.hljs-symbol,
.hljs-bullet,
.hljs-number {color: #1c00cf;
}.hljs-section,
.hljs-meta {color: #643820;
}.hljs-title.class_,
.hljs-class .hljs-title,
.hljs-type,
.hljs-built_in,
.hljs-params {color: #5c2699;
}.hljs-attr {color: #836C28;
}.hljs-subst {color: #000;
}.hljs-formula {background-color: #eee;font-style: italic;
}.hljs-addition {background-color: #baeeba;
}.hljs-deletion {background-color: #ffc8bd;
}.hljs-selector-id,
.hljs-selector-class {color: #9b703f;
}.hljs-doctag,
.hljs-strong {font-weight: bold;
}.hljs-emphasis {font-style: italic;
}
</style><style type="text/css" data-fela-rehydration="545" data-fela-type="KEYFRAME">@-webkit-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@-moz-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}</style><style type="text/css" data-fela-rehydration="545" data-fela-type="RULE">.a{font-family:medium-content-sans-serif-font, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif}.b{font-weight:400}.c{background-color:rgba(255, 255, 255, 1)}.l{display:block}.m{position:sticky}.n{top:0}.o{z-index:500}.p{padding:0 24px}.q{align-items:center}.r{border-bottom:solid 1px #F2F2F2}.y{height:41px}.z{line-height:20px}.ab{display:flex}.ac{height:57px}.ae{flex:1 0 auto}.af{color:inherit}.ag{fill:inherit}.ah{font-size:inherit}.ai{border:inherit}.aj{font-family:inherit}.ak{letter-spacing:inherit}.al{font-weight:inherit}.am{padding:0}.an{margin:0}.ao{cursor:pointer}.ap:disabled{cursor:not-allowed}.aq:disabled{color:#6B6B6B}.ar:disabled{fill:#6B6B6B}.au{width:auto}.av path{fill:#242424}.aw{height:25px}.ax{margin-left:16px}.ay{border:none}.az{border-radius:20px}.ba{width:240px}.bb{background:#F9F9F9}.bc path{fill:#6B6B6B}.be{outline:none}.bf{font-family:sohne, "Helvetica Neue", Helvetica, Arial, sans-serif}.bg{font-size:14px}.bh{width:100%}.bi{padding:10px 20px 10px 0}.bj{background-color:transparent}.bk{color:#242424}.bl::placeholder{color:#6B6B6B}.bm{display:inline-block}.bn{margin-left:12px}.bo{margin-right:12px}.bp{border-radius:4px}.bq{margin-left:24px}.br{height:24px}.bx{background-color:#F9F9F9}.by{border-radius:50%}.bz{height:32px}.ca{width:32px}.cb{justify-content:center}.ch{max-width:680px}.ci{min-width:0}.cj{animation:k1 1.2s ease-in-out infinite}.ck{height:100vh}.cl{margin-bottom:16px}.cm{margin-top:48px}.cn{align-items:flex-start}.co{flex-direction:column}.cp{justify-content:space-between}.cq{margin-bottom:24px}.cw{width:80%}.cx{background-color:#F2F2F2}.dd{height:44px}.de{width:44px}.df{margin:auto 0}.dg{margin-bottom:4px}.dh{height:16px}.di{width:120px}.dj{width:80px}.dp{margin-bottom:8px}.dq{width:96%}.dr{width:98%}.ds{width:81%}.dt{margin-left:8px}.du{color:#6B6B6B}.dv{font-size:13px}.dw{height:100%}.ep{color:#FFFFFF}.eq{fill:#FFFFFF}.er{background:rgba(26, 137, 23, 1)}.es{border-color:rgba(26, 137, 23, 1)}.ew:disabled{cursor:inherit !important}.ex:disabled{opacity:0.3}.ey:disabled:hover{background:rgba(26, 137, 23, 1)}.ez:disabled:hover{border-color:rgba(26, 137, 23, 1)}.fa{border-radius:99em}.fb{border-width:1px}.fc{border-style:solid}.fd{box-sizing:border-box}.fe{text-decoration:none}.ff{text-align:center}.fi{margin-right:32px}.fj{position:relative}.fk{fill:#6B6B6B}.fn{background:transparent}.fo svg{margin-left:4px}.fp svg{fill:#6B6B6B}.fr{box-shadow:inset 0 0 0 1px rgba(0, 0, 0, 0.05)}.fs{position:absolute}.fz{margin:0 24px}.gd{background:rgba(255, 255, 255, 1)}.ge{border:1px solid #F2F2F2}.gf{box-shadow:0 1px 4px #F2F2F2}.gg{max-height:100vh}.gh{overflow-y:auto}.gi{left:0}.gj{top:calc(100vh + 100px)}.gk{bottom:calc(100vh + 100px)}.gl{width:10px}.gm{pointer-events:none}.gn{word-break:break-word}.go{word-wrap:break-word}.gp:after{display:block}.gq:after{content:""}.gr:after{clear:both}.gs{line-height:1.23}.gt{letter-spacing:0}.gu{font-style:normal}.gv{font-weight:700}.ia{align-items:baseline}.ib{width:48px}.ic{height:48px}.id{border:2px solid rgba(255, 255, 255, 1)}.ie{z-index:0}.if{box-shadow:none}.ig{border:1px solid rgba(0, 0, 0, 0.05)}.ih{margin-left:-12px}.ii{width:28px}.ij{height:28px}.ik{z-index:1}.il{width:24px}.im{margin-bottom:2px}.in{flex-wrap:nowrap}.io{font-size:16px}.ip{line-height:24px}.ir{margin:0 8px}.is{display:inline}.it{color:rgba(26, 137, 23, 1)}.iu{fill:rgba(26, 137, 23, 1)}.ix{flex:0 0 auto}.ja{flex-wrap:wrap}.jd{white-space:pre-wrap}.je{margin-right:4px}.jf{overflow:hidden}.jg{max-height:20px}.jh{text-overflow:ellipsis}.ji{display:-webkit-box}.jj{-webkit-line-clamp:1}.jk{-webkit-box-orient:vertical}.jl{word-break:break-all}.jn{padding-left:8px}.jo{padding-right:8px}.kp> *{flex-shrink:0}.kq{overflow-x:scroll}.kr::-webkit-scrollbar{display:none}.ks{scrollbar-width:none}.kt{-ms-overflow-style:none}.ku{width:74px}.kv{flex-direction:row}.kw{z-index:2}.kz{-webkit-user-select:none}.la{border:0}.lb{fill:rgba(117, 117, 117, 1)}.le{outline:0}.lf{user-select:none}.lg> svg{pointer-events:none}.lp{cursor:progress}.lq{opacity:1}.lr{padding:4px 0}.lu{margin-top:0px}.lv{width:16px}.lx{display:inline-flex}.md{max-width:100%}.me{padding:8px 2px}.mf svg{color:#6B6B6B}.mw{margin-left:auto}.mx{margin-right:auto}.my{max-width:985px}.ne{clear:both}.ng{cursor:zoom-in}.nh{z-index:auto}.nj{height:auto}.nk{line-height:1.58}.nl{letter-spacing:-0.004em}.nm{font-family:source-serif-pro, Georgia, Cambria, "Times New Roman", Times, serif}.oh{margin-bottom:-0.46em}.oi{line-height:1.12}.oj{letter-spacing:-0.022em}.ok{font-weight:600}.pf{margin-bottom:-0.28em}.pl{list-style-type:disc}.pm{margin-left:30px}.pn{padding-left:0px}.py{overflow-x:auto}.pz{font-family:source-code-pro, Menlo, Monaco, "Courier New", Courier, monospace}.qa{padding:32px}.qb{border:1px solid #E5E5E5}.qc{line-height:1.4}.qd{margin-top:-0.2em}.qe{margin-bottom:-0.2em}.qf{white-space:pre}.qg{min-width:fit-content}.qh{text-decoration:underline}.qi{padding:2px 4px}.qj{font-size:75%}.qk> strong{font-family:inherit}.qq{box-shadow:inset 0 0 0 1px #F2F2F2}.qr{padding:0px}.qs{padding:16px 20px}.qt{flex:1 1 auto}.qv{max-height:40px}.qw{-webkit-line-clamp:2}.qx{margin-top:8px}.qy{margin-top:12px}.qz{width:160px}.ra{background-image:url(https://miro.medium.com/v2/resize:fit:320/1*G8lxcyeu7A-5zwaBIfvIkw.png)}.rb{background-origin:border-box}.rc{background-size:cover}.rd{height:167px}.re{background-position:50% 50%}.rf{background-image:url(https://miro.medium.com/v2/resize:fit:320/1*fnZC8HU90tNmxnH5UU8yQQ.png)}.rg{background-image:url(https://miro.medium.com/v2/resize:fit:320/1*XSfRm4mUx18FW26PBGB_nw.png)}.rh{background-image:url(https://miro.medium.com/v2/resize:fit:320/1*tRpb0LR1uN0cSwYRilZFFw.png)}.ri{margin-bottom:26px}.rj{margin-top:6px}.rk{margin-right:8px}.rl{padding:8px 16px}.rm{border-radius:100px}.rn{transition:background 300ms ease}.rp{white-space:nowrap}.rq{border-top:none}.rw{height:52px}.rx{max-height:52px}.ry{box-sizing:content-box}.rz{position:static}.sb{max-width:155px}.sh{margin-right:20px}.sn{align-items:flex-end}.so{width:76px}.sp{height:76px}.sq{border:2px solid #F9F9F9}.sr{height:72px}.ss{width:72px}.st{margin-left:-16px}.su{width:36px}.sv{height:36px}.sw{color:rgba(255, 255, 255, 1)}.sx{fill:rgba(255, 255, 255, 1)}.sy{background:rgba(25, 25, 25, 1)}.sz{border-color:rgba(25, 25, 25, 1)}.tc:disabled{opacity:0.1}.td:disabled:hover{background:rgba(25, 25, 25, 1)}.te:disabled:hover{border-color:rgba(25, 25, 25, 1)}.tf{stroke:#F2F2F2}.tg{color:#F2F2F2}.th{fill:#F2F2F2}.ti{background:#F2F2F2}.tj{border-color:#F2F2F2}.tp{font-weight:500}.tq{font-size:24px}.tr{line-height:30px}.ts{letter-spacing:-0.016em}.tt{margin-top:16px}.tu{height:0px}.tv{border-bottom:solid 1px #E5E5E5}.tw{margin-top:72px}.tx{padding:24px 0}.ty{margin-bottom:0px}.tz{margin-right:16px}.as:hover:not(:disabled){color:rgba(25, 25, 25, 1)}.at:hover:not(:disabled){fill:rgba(25, 25, 25, 1)}.et:hover{background:rgba(15, 115, 12, 1)}.eu:hover{border-color:rgba(15, 115, 12, 1)}.ev:hover{cursor:pointer}.fl:hover{color:#242424}.fm:hover{fill:#242424}.fq:hover svg{fill:#242424}.ft:hover{background-color:rgba(0, 0, 0, 0.1)}.iq:hover{text-decoration:underline}.iv:hover:not(:disabled){color:rgba(15, 115, 12, 1)}.iw:hover:not(:disabled){fill:rgba(15, 115, 12, 1)}.ld:hover{fill:rgba(8, 8, 8, 1)}.ls:hover{fill:#000000}.lt:hover p{color:#000000}.lw:hover{color:#000000}.mg:hover svg{color:#000000}.ro:hover{background-color:#F2F2F2}.ta:hover{background:#000000}.tb:hover{border-color:#242424}.tk:hover{background:#F2F2F2}.tl:hover{border-color:#F2F2F2}.tm:hover{cursor:wait}.tn:hover{color:#F2F2F2}.to:hover{fill:#F2F2F2}.bd:focus-within path{fill:#242424}.lc:focus{fill:rgba(8, 8, 8, 1)}.mh:focus svg{color:#000000}.ni:focus{transform:scale(1.01)}.lh:active{border-style:none}</style><style type="text/css" data-fela-rehydration="545" data-fela-type="RULE" media="all and (min-width: 1080px)">.d{display:none}.bw{width:64px}.cg{margin:0 64px}.cv{height:48px}.dc{margin-bottom:52px}.do{margin-bottom:48px}.ef{font-size:14px}.eg{line-height:20px}.em{font-size:13px}.eo{padding:5px 12px}.fh{display:flex}.fy{margin-bottom:68px}.gc{max-width:680px}.hq{font-size:42px}.hr{margin-top:1.19em}.hs{margin-bottom:32px}.ht{line-height:52px}.hu{letter-spacing:-0.011em}.hz{align-items:center}.kb{border-top:solid 1px #F2F2F2}.kc{border-bottom:solid 1px #F2F2F2}.kd{margin:32px 0 0}.ke{padding:3px 8px}.kn> *{margin-right:24px}.ko> :last-child{margin-right:0}.lo{margin-top:0px}.mc{margin:0}.nd{margin-top:40px}.od{font-size:20px}.oe{margin-top:2.14em}.of{line-height:32px}.og{letter-spacing:-0.003em}.pb{font-size:24px}.pc{margin-top:1.95em}.pd{line-height:30px}.pe{letter-spacing:-0.016em}.pk{margin-top:0.94em}.ps{margin-top:1.14em}.px{margin-top:56px}.qp{margin-top:32px}.rv{margin-bottom:88px}.sg{display:inline-block}.sm{padding-top:72px}</style><style type="text/css" data-fela-rehydration="545" data-fela-type="RULE" media="all and (max-width: 1079.98px)">.e{display:none}.ln{margin-top:0px}.sf{display:inline-block}</style><style type="text/css" data-fela-rehydration="545" data-fela-type="RULE" media="all and (max-width: 903.98px)">.f{display:none}.lm{margin-top:0px}.se{display:inline-block}</style><style type="text/css" data-fela-rehydration="545" data-fela-type="RULE" media="all and (max-width: 727.98px)">.g{display:none}.lk{margin-top:0px}.ll{margin-right:0px}.qu{padding:10px 12px 10px}.sd{display:inline-block}</style><style type="text/css" data-fela-rehydration="545" data-fela-type="RULE" media="all and (max-width: 551.98px)">.h{display:none}.s{display:flex}.t{justify-content:space-between}.bs{width:24px}.cc{margin:0 24px}.cr{height:40px}.cy{margin-bottom:44px}.dk{margin-bottom:32px}.dx{font-size:13px}.dy{line-height:20px}.eh{padding:0px 8px 1px}.fu{margin-bottom:4px}.gw{font-size:32px}.gx{margin-top:1.01em}.gy{margin-bottom:24px}.gz{line-height:38px}.ha{letter-spacing:-0.014em}.hv{align-items:flex-start}.iy{flex-direction:column}.jb{margin-bottom:2px}.jp{margin:24px -24px 0}.jq{padding:0}.kf> *{margin-right:8px}.kg> :last-child{margin-right:24px}.kx{margin-left:0px}.li{margin-top:0px}.lj{margin-right:0px}.ly{margin:0}.mi{border:1px solid #F2F2F2}.mj{border-radius:99em}.mk{padding:0px 16px 0px 12px}.ml{height:38px}.mm{align-items:center}.mo svg{margin-right:8px}.mz{margin-top:32px}.nn{font-size:18px}.no{margin-top:1.56em}.np{line-height:28px}.nq{letter-spacing:-0.003em}.ol{font-size:20px}.om{margin-top:1.2em}.on{line-height:24px}.oo{letter-spacing:0}.pg{margin-top:0.67em}.po{margin-top:1.34em}.pt{margin-top:40px}.ql{margin-top:24px}.rr{margin-bottom:80px}.sc{display:inline-block}.si{padding-top:48px}.mn:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="545" data-fela-type="RULE" media="all and (min-width: 904px) and (max-width: 1079.98px)">.i{display:none}.bv{width:64px}.cf{margin:0 64px}.cu{height:48px}.db{margin-bottom:52px}.dn{margin-bottom:48px}.ed{font-size:14px}.ee{line-height:20px}.ek{font-size:13px}.el{padding:5px 12px}.fg{display:flex}.fx{margin-bottom:68px}.gb{max-width:680px}.hl{font-size:42px}.hm{margin-top:1.19em}.hn{margin-bottom:32px}.ho{line-height:52px}.hp{letter-spacing:-0.011em}.hy{align-items:center}.jx{border-top:solid 1px #F2F2F2}.jy{border-bottom:solid 1px #F2F2F2}.jz{margin:32px 0 0}.ka{padding:3px 8px}.kl> *{margin-right:24px}.km> :last-child{margin-right:0}.mb{margin:0}.nc{margin-top:40px}.nz{font-size:20px}.oa{margin-top:2.14em}.ob{line-height:32px}.oc{letter-spacing:-0.003em}.ox{font-size:24px}.oy{margin-top:1.95em}.oz{line-height:30px}.pa{letter-spacing:-0.016em}.pj{margin-top:0.94em}.pr{margin-top:1.14em}.pw{margin-top:56px}.qo{margin-top:32px}.ru{margin-bottom:88px}.sl{padding-top:72px}</style><style type="text/css" data-fela-rehydration="545" data-fela-type="RULE" media="all and (min-width: 728px) and (max-width: 903.98px)">.j{display:none}.w{display:flex}.x{justify-content:space-between}.bu{width:64px}.ce{margin:0 48px}.ct{height:48px}.da{margin-bottom:52px}.dm{margin-bottom:48px}.eb{font-size:13px}.ec{line-height:20px}.ej{padding:0px 8px 1px}.fw{margin-bottom:68px}.ga{max-width:680px}.hg{font-size:42px}.hh{margin-top:1.19em}.hi{margin-bottom:32px}.hj{line-height:52px}.hk{letter-spacing:-0.011em}.hx{align-items:center}.jt{border-top:solid 1px #F2F2F2}.ju{border-bottom:solid 1px #F2F2F2}.jv{margin:32px 0 0}.jw{padding:3px 8px}.kj> *{margin-right:24px}.kk> :last-child{margin-right:0}.ma{margin:0}.nb{margin-top:40px}.nv{font-size:20px}.nw{margin-top:2.14em}.nx{line-height:32px}.ny{letter-spacing:-0.003em}.ot{font-size:24px}.ou{margin-top:1.95em}.ov{line-height:30px}.ow{letter-spacing:-0.016em}.pi{margin-top:0.94em}.pq{margin-top:1.14em}.pv{margin-top:56px}.qn{margin-top:32px}.rt{margin-bottom:88px}.sk{padding-top:72px}</style><style type="text/css" data-fela-rehydration="545" data-fela-type="RULE" media="all and (min-width: 552px) and (max-width: 727.98px)">.k{display:none}.u{display:flex}.v{justify-content:space-between}.bt{width:24px}.cd{margin:0 24px}.cs{height:40px}.cz{margin-bottom:44px}.dl{margin-bottom:32px}.dz{font-size:13px}.ea{line-height:20px}.ei{padding:0px 8px 1px}.fv{margin-bottom:4px}.hb{font-size:32px}.hc{margin-top:1.01em}.hd{margin-bottom:24px}.he{line-height:38px}.hf{letter-spacing:-0.014em}.hw{align-items:flex-start}.iz{flex-direction:column}.jc{margin-bottom:2px}.jr{margin:24px 0 0}.js{padding:0}.kh> *{margin-right:8px}.ki> :last-child{margin-right:8px}.ky{margin-left:0px}.lz{margin:0}.mp{border:1px solid #F2F2F2}.mq{border-radius:99em}.mr{padding:0px 16px 0px 12px}.ms{height:38px}.mt{align-items:center}.mv svg{margin-right:8px}.na{margin-top:32px}.nr{font-size:18px}.ns{margin-top:1.56em}.nt{line-height:28px}.nu{letter-spacing:-0.003em}.op{font-size:20px}.oq{margin-top:1.2em}.or{line-height:24px}.os{letter-spacing:0}.ph{margin-top:0.67em}.pp{margin-top:1.34em}.pu{margin-top:40px}.qm{margin-top:24px}.rs{margin-bottom:80px}.sj{padding-top:48px}.mu:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="545" data-fela-type="RULE" media="print">.sa{display:none}</style><style type="text/css" data-fela-rehydration="545" data-fela-type="RULE" media="(orientation: landscape) and (max-width: 903.98px)">.jm{max-height:none}</style><style type="text/css" data-fela-rehydration="545" data-fela-type="RULE" media="(prefers-reduced-motion: no-preference)">.nf{transition:transform 300ms cubic-bezier(0.2, 0, 0.2, 1)}</style></head><body><div id="root"><div class="a b c"><div class="d e f g h i j k"></div><script>document.domain = document.domain;</script><div class="l c"><div class="l m n o c"><div class="p q r s t u v w x i d y z"><a class="du ag dv bf ak b am an ao ap aq ar as at s u w i d q dw z" href="https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F5660a95fd8fc&amp;%7Efeature=LoOpenInAppButton&amp;%7Echannel=ShowPostUnderCollection&amp;source=---two_column_layout_nav----------------------------------" rel="noopener follow">Open in app<svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" fill="none" viewBox="0 0 10 10" class="dt"><path fill="currentColor" d="M.985 8.485a.375.375 0 1 0 .53.53zM8.75 1.25h.375A.375.375 0 0 0 8.75.875zM8.375 6.5a.375.375 0 1 0 .75 0zM3.5.875a.375.375 0 1 0 0 .75zm-1.985 8.14 7.5-7.5-.53-.53-7.5 7.5zm6.86-7.765V6.5h.75V1.25zM3.5 1.625h5.25v-.75H3.5z"></path></svg></a><div class="ab q"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><a class="bf b dx dy eh dz ea ei eb ec ej ek ee el em eg eo ep eq er es et eu ev ew ex ey ez fa fb fc fd bm fe ff" data-testid="headerSignUpButton" href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fovercast.blog%2Fbuilding-a-metrics-system-with-thanos-and-kubernetes-5660a95fd8fc&amp;source=post_page---two_column_layout_nav-----------------------global_nav-----------" rel="noopener follow">Sign up</a></span></p><div class="ax l"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" href="https://medium.com/m/signin?operation=login&amp;redirect=https%3A%2F%2Fovercast.blog%2Fbuilding-a-metrics-system-with-thanos-and-kubernetes-5660a95fd8fc&amp;source=post_page---two_column_layout_nav-----------------------global_nav-----------" rel="noopener follow">Sign in</a></span></p></div></div></div><div class="p q r ab ac"><div class="ab q ae"><a class="af ag ah ai aj ak al am an ao ap aq ar as at ab" aria-label="Homepage" data-testid="headerMediumLogo" href="https://medium.com/?source=---two_column_layout_nav----------------------------------" rel="noopener follow"><svg xmlns="http://www.w3.org/2000/svg" width="719" height="160" fill="none" viewBox="0 0 719 160" class="au av aw"><path fill="#242424" d="m174.104 9.734.215-.047V8.02H130.39L89.6 103.89 48.81 8.021H1.472v1.666l.212.047c8.018 1.81 12.09 4.509 12.09 14.242V137.93c0 9.734-4.087 12.433-12.106 14.243l-.212.047v1.671h32.118v-1.665l-.213-.048c-8.018-1.809-12.089-4.509-12.089-14.242V30.586l52.399 123.305h2.972l53.925-126.743V140.75c-.687 7.688-4.721 10.062-11.982 11.701l-.215.05v1.652h55.948v-1.652l-.215-.05c-7.269-1.639-11.4-4.013-12.087-11.701l-.037-116.774h.037c0-9.733 4.071-12.432 12.087-14.242m25.555 75.488c.915-20.474 8.268-35.252 20.606-35.507 3.806.063 6.998 1.312 9.479 3.714 5.272 5.118 7.751 15.812 7.368 31.793zm-.553 5.77h65.573v-.275c-.186-15.656-4.721-27.834-13.466-36.196-7.559-7.227-18.751-11.203-30.507-11.203h-.263c-6.101 0-13.584 1.48-18.909 4.16-6.061 2.807-11.407 7.003-15.855 12.511-7.161 8.874-11.499 20.866-12.554 34.343q-.05.606-.092 1.212a50 50 0 0 0-.065 1.151 85.807 85.807 0 0 0-.094 5.689c.71 30.524 17.198 54.917 46.483 54.917 25.705 0 40.675-18.791 44.407-44.013l-1.886-.664c-6.557 13.556-18.334 21.771-31.738 20.769-18.297-1.369-32.314-19.922-31.042-42.395m139.722 41.359c-2.151 5.101-6.639 7.908-12.653 7.908s-11.513-4.129-15.418-11.63c-4.197-8.053-6.405-19.436-6.405-32.92 0-28.067 8.729-46.22 22.24-46.22 5.657 0 10.111 2.807 12.236 7.704zm43.499 20.008c-8.019-1.897-12.089-4.722-12.089-14.951V1.309l-48.716 14.353v1.757l.299-.024c6.72-.543 11.278.386 13.925 2.83 2.072 1.915 3.082 4.853 3.082 8.987v18.66c-4.803-3.067-10.516-4.56-17.448-4.56-14.059 0-26.909 5.92-36.176 16.672-9.66 11.205-14.767 26.518-14.767 44.278-.003 31.72 15.612 53.039 38.851 53.039 13.595 0 24.533-7.449 29.54-20.013v16.865h43.711v-1.746zM424.1 19.819c0-9.904-7.468-17.374-17.375-17.374-9.859 0-17.573 7.632-17.573 17.374s7.721 17.374 17.573 17.374c9.907 0 17.375-7.47 17.375-17.374m11.499 132.546c-8.019-1.897-12.089-4.722-12.089-14.951h-.035V43.635l-43.714 12.551v1.705l.263.024c9.458.842 12.047 4.1 12.047 15.152v81.086h43.751v-1.746zm112.013 0c-8.018-1.897-12.089-4.722-12.089-14.951V43.635l-41.621 12.137v1.71l.246.026c7.733.813 9.967 4.257 9.967 15.36v59.279c-2.578 5.102-7.415 8.131-13.274 8.336-9.503 0-14.736-6.419-14.736-18.073V43.638l-43.714 12.55v1.703l.262.024c9.459.84 12.05 4.097 12.05 15.152v50.17a56.3 56.3 0 0 0 .91 10.444l.787 3.423c3.701 13.262 13.398 20.197 28.59 20.197 12.868 0 24.147-7.966 29.115-20.43v17.311h43.714v-1.747zm169.818 1.788v-1.749l-.213-.05c-8.7-2.006-12.089-5.789-12.089-13.49v-63.79c0-19.89-11.171-31.761-29.883-31.761-13.64 0-25.141 7.882-29.569 20.16-3.517-13.01-13.639-20.16-28.606-20.16-13.146 0-23.449 6.938-27.869 18.657V43.643L545.487 55.68v1.715l.263.024c9.345.829 12.047 4.181 12.047 14.95v81.784h40.787v-1.746l-.215-.053c-6.941-1.631-9.181-4.606-9.181-12.239V66.998c1.836-4.289 5.537-9.37 12.853-9.37 9.086 0 13.692 6.296 13.692 18.697v77.828h40.797v-1.746l-.215-.053c-6.94-1.631-9.18-4.606-9.18-12.239V75.066a42 42 0 0 0-.578-7.26c1.947-4.661 5.86-10.177 13.475-10.177 9.214 0 13.691 6.114 13.691 18.696v77.828z"></path></svg></a><div class="ax h"><div class="ab ay az ba bb q bc bd"><div class="bm" aria-hidden="false" aria-describedby="searchResults" aria-labelledby="searchResults"></div><div class="bn bo ab"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div><input role="combobox" aria-controls="searchResults" aria-expanded="false" aria-label="search" data-testid="headerSearchInput" tabindex="0" class="ay be bf bg z bh bi bj bk bl" placeholder="Search" value=""/></div></div></div><div class="h k w fg fh"><div class="fi ab"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerWriteButton" href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fnew-story&amp;source=---two_column_layout_nav-----------------------new_post_topnav-----------" rel="noopener follow"><div class="bf b bg z du fj fk ab q fl fm"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Write"><path fill="currentColor" d="M14 4a.5.5 0 0 0 0-1zm7 6a.5.5 0 0 0-1 0zm-7-7H4v1h10zM3 4v16h1V4zm1 17h16v-1H4zm17-1V10h-1v10zm-1 1a1 1 0 0 0 1-1h-1zM3 20a1 1 0 0 0 1 1v-1zM4 3a1 1 0 0 0-1 1h1z"></path><path stroke="currentColor" d="m17.5 4.5-8.458 8.458a.25.25 0 0 0-.06.098l-.824 2.47a.25.25 0 0 0 .316.316l2.47-.823a.25.25 0 0 0 .098-.06L19.5 6.5m-2-2 2.323-2.323a.25.25 0 0 1 .354 0l1.646 1.646a.25.25 0 0 1 0 .354L19.5 6.5m-2-2 2 2"></path></svg><div class="dt l">Write</div></div></a></span></div></div><div class="k j i d"><div class="fi ab"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSearchButton" href="https://medium.com/search?source=---two_column_layout_nav----------------------------------" rel="noopener follow"><div class="bf b bg z du fj fk ab q fl fm"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Search"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div></a></div></div><div class="fi h k j"><div class="ab q"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><a class="bf b dx dy eh dz ea ei eb ec ej ek ee el em eg eo ep eq er es et eu ev ew ex ey ez fa fb fc fd bm fe ff" data-testid="headerSignUpButton" href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fovercast.blog%2Fbuilding-a-metrics-system-with-thanos-and-kubernetes-5660a95fd8fc&amp;source=post_page---two_column_layout_nav-----------------------global_nav-----------" rel="noopener follow">Sign up</a></span></p><div class="ax l"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" href="https://medium.com/m/signin?operation=login&amp;redirect=https%3A%2F%2Fovercast.blog%2Fbuilding-a-metrics-system-with-thanos-and-kubernetes-5660a95fd8fc&amp;source=post_page---two_column_layout_nav-----------------------global_nav-----------" rel="noopener follow">Sign in</a></span></p></div></div></div><div class="l" aria-hidden="false"><button class="ay fn am ab q ao fo fp fq" aria-label="user options menu" data-testid="headerUserIcon"><div class="l fj"><img alt="" class="l fd by bz ca cx" src="https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png" width="32" height="32" loading="lazy" role="presentation"/><div class="fr by l bz ca fs n ay ft"></div></div></button></div></div></div><div class="l"><div class="fu fv fw fx fy l"><div class="ab cb"><div class="ci bh fz ga gb gc"></div></div><article><div class="l"><div class="l"><span class="l"></span><section><div><div class="fs gi gj gk gl gm"></div><div class="gn go gp gq gr"><div class="ab cb"><div class="ci bh fz ga gb gc"><div><h1 id="0c09" class="pw-post-title gs gt gu bf gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho hp hq hr hs ht hu bk" data-testid="storyTitle">Building a Metrics System with Thanos and Kubernetes</h1><div><div class="speechify-ignore ab cp"><div class="speechify-ignore bh l"><div class="hv hw hx hy hz ab"><div><div class="ab ia"><a href="https://medium.com/@dskydragon?source=post_page-----5660a95fd8fc--------------------------------" rel="noopener follow"><div><div class="bm" aria-hidden="false"><div class="l ib ic by id ie"><div class="l fj"><img alt="DavidW (skyDragon)" class="l fd by dd de cx" src="https://miro.medium.com/v2/resize:fill:88:88/1*hERaxFU_P3qPjslbAw6bDw.png" width="44" height="44" loading="lazy" data-testid="authorPhoto"/><div class="if by l dd de fs n ig ft"></div></div></div></div></div></a><a href="https://overcast.blog/?source=post_page-----5660a95fd8fc--------------------------------" rel="noopener  ugc nofollow"><div class="ih ab fj"><div><div class="bm" aria-hidden="false"><div class="l ii ij by id ik"><div class="l fj"><img alt="overcast blog" class="l fd by br il cx" src="https://miro.medium.com/v2/resize:fill:48:48/1*hC4pCAXASl2ZiwjKBtISBg.jpeg" width="24" height="24" loading="lazy" data-testid="publicationPhoto"/><div class="if by l br il fs n ig ft"></div></div></div></div></div></div></a></div></div><div class="bn bh l"><div class="ab"><div style="flex:1"><span class="bf b bg z bk"><div class="im ab q"><div class="ab q in"><div class="ab q"><div><div class="bm" aria-hidden="false"><p class="bf b io ip bk"><a class="af ag ah ai aj ak al am an ao ap aq ar iq" data-testid="authorName" href="https://medium.com/@dskydragon?source=post_page-----5660a95fd8fc--------------------------------" rel="noopener follow">DavidW (skyDragon)</a></p></div></div></div><span class="ir is" aria-hidden="true"><span class="bf b bg z du">·</span></span><p class="bf b io ip du"><span><a class="it iu ah ai aj ak al am an ao ap aq ar ex iv iw" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe840bf2eef66&amp;operation=register&amp;redirect=https%3A%2F%2Fovercast.blog%2Fbuilding-a-metrics-system-with-thanos-and-kubernetes-5660a95fd8fc&amp;user=DavidW+%28skyDragon%29&amp;userId=e840bf2eef66&amp;source=post_page-e840bf2eef66----5660a95fd8fc---------------------post_header-----------" rel="noopener follow">Follow</a></span></p></div></div></span></div></div><div class="l ix"><span class="bf b bg z du"><div class="ab cn iy iz ja"><div class="jb jc ab"><div class="bf b bg z du ab jd"><span class="je l ix">Published in</span><div><div class="l" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar iq ab q" data-testid="publicationName" href="https://overcast.blog/?source=post_page-----5660a95fd8fc--------------------------------" rel="noopener  ugc nofollow"><p class="bf b bg z jf jg jh ji jj jk jl jm bk">overcast blog</p></a></div></div></div><div class="h k"><span class="ir is" aria-hidden="true"><span class="bf b bg z du">·</span></span></div></div><span class="bf b bg z du"><div class="ab ae"><span data-testid="storyReadTime">11 min read</span><div class="jn jo l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="bf b bg z du">·</span></span></div>5 days ago</div></span></div></span></div></div></div><div class="ab cp jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke"><div class="h k w fg fh q"><div class="ku l"><div class="ab q kv kw"><div class="pw-multi-vote-icon fj je kx ky kz"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fovercast-blog%2F5660a95fd8fc&amp;operation=register&amp;redirect=https%3A%2F%2Fovercast.blog%2Fbuilding-a-metrics-system-with-thanos-and-kubernetes-5660a95fd8fc&amp;user=DavidW+%28skyDragon%29&amp;userId=e840bf2eef66&amp;source=-----5660a95fd8fc---------------------clap_footer-----------" rel="noopener follow"><div><div class="bm" aria-hidden="false"><div class="la ao lb lc ld le am lf lg lh kz"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l li lj lk ll lm ln lo"><p class="bf b dv z du"><span class="lp">--</span></p></div></div></div><div><div class="bm" aria-hidden="false"><button class="ao la lq lr ab q fk ls lt" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="lu"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg></button></div></div></div><div class="ab q kf kg kh ki kj kk kl km kn ko kp kq kr ks kt"><div class="lv k j i d"></div><div class="h k"><div><div class="bm" aria-hidden="false"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerBookmarkButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5660a95fd8fc&amp;operation=register&amp;redirect=https%3A%2F%2Fovercast.blog%2Fbuilding-a-metrics-system-with-thanos-and-kubernetes-5660a95fd8fc&amp;source=-----5660a95fd8fc---------------------bookmark_footer-----------" rel="noopener follow"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="du lw" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div><div class="fd lx cn"><div class="l ae"><div class="ab cb"><div class="ly lz ma mb mc md ci bh"><div class="ab"><div class="bm bh" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="Listen" data-testid="audioPlayButton" class="af fk ah ai aj ak al me an ao ap ex mf mg lt mh mi mj mk ml s mm mn mo mp mq mr ms u mt mu mv"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"></path></svg><div class="j i d"><p class="bf b bg z du">Listen</p></div></button></div></div></div></div></div></div></div></div><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af fk ah ai aj ak al me an ao ap ex mf mg lt mh mi mj mk ml s mm mn mo mp mq mr ms u mt mu mv"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg><div class="j i d"><p class="bf b bg z du">Share</p></div></button></div></div></div></div></div></div></div></div></div><figure class="mz na nb nc nd ne mw mx paragraph-image"><div role="button" tabindex="0" class="nf ng fj nh bh ni"><div class="mw mx my"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*QobsYEWqhoc_8s3tyB1Jlg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*QobsYEWqhoc_8s3tyB1Jlg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*QobsYEWqhoc_8s3tyB1Jlg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*QobsYEWqhoc_8s3tyB1Jlg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*QobsYEWqhoc_8s3tyB1Jlg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*QobsYEWqhoc_8s3tyB1Jlg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QobsYEWqhoc_8s3tyB1Jlg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*QobsYEWqhoc_8s3tyB1Jlg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*QobsYEWqhoc_8s3tyB1Jlg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*QobsYEWqhoc_8s3tyB1Jlg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*QobsYEWqhoc_8s3tyB1Jlg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*QobsYEWqhoc_8s3tyB1Jlg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*QobsYEWqhoc_8s3tyB1Jlg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*QobsYEWqhoc_8s3tyB1Jlg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md nj c" width="700" height="462" loading="eager" role="presentation"/></picture></div></div></figure><p id="cc98" class="pw-post-body-paragraph nk nl gu nm b nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh gn bk">Metrics are the backbone of observability in any distributed system, and in Kubernetes environments, Prometheus is often the tool of choice.</p><p id="3f76" class="pw-post-body-paragraph nk nl gu nm b nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh gn bk">However, scaling Prometheus and retaining long-term metrics data can be challenging. Thanos is a project that extends Prometheus with additional capabilities, such as scalable storage, global querying across multiple Prometheus instances, and highly available metrics. This article explores how to build a robust, scalable, and resilient metrics system using Thanos on Kubernetes, covering everything from setup to best practices.</p><h1 id="cdf8" class="oi oj gu bf ok ol om on oo op oq or os ot ou ov ow ox oy oz pa pb pc pd pe pf bk">What the H#ck is a Metrics System with Thanos and Kubernetes?</h1><p id="e52f" class="pw-post-body-paragraph nk nl gu nm b nn pg np nq nr ph nt nu nv pi nx ny nz pj ob oc od pk of og oh gn bk">A metrics system built with <strong class="nm gv">Thanos and Kubernetes</strong> is like taking your Prometheus monitoring to the next level. Prometheus is fantastic for scraping and storing metrics from your Kubernetes clusters, but it hits limits when you need to scale, store metrics long-term, or query across multiple clusters. Enter <strong class="nm gv">Thanos</strong>, a tool that layers on top of Prometheus to solve these problems by offering <strong class="nm gv">scalable storage</strong>, <strong class="nm gv">global querying</strong> across clusters, and <strong class="nm gv">high availability</strong> for failover and redundancy.</p><p id="061b" class="pw-post-body-paragraph nk nl gu nm b nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh gn bk">With Thanos, you’re not just collecting metrics; you’re building a resilient system that allows you to store and access metrics across distributed environments without the typical headaches of managing multiple Prometheus instances independently. This makes Thanos a go-to solution for organizations with large-scale Kubernetes deployments or those looking to retain metrics for long-term analysis.</p><h1 id="6a8e" class="oi oj gu bf ok ol om on oo op oq or os ot ou ov ow ox oy oz pa pb pc pd pe pf bk">Why Do I Need One?</h1><p id="1148" class="pw-post-body-paragraph nk nl gu nm b nn pg np nq nr ph nt nu nv pi nx ny nz pj ob oc od pk of og oh gn bk">If you’re just running a small Kubernetes cluster, Prometheus alone might be enough for you. But once your cluster scales, or you have multiple clusters across different regions or environments, <strong class="nm gv">Prometheus on its own starts to show limitations</strong>:</p><ul class=""><li id="74a7" class="nk nl gu nm b nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh pl pm pn bk"><strong class="nm gv">Metrics Retention</strong>: Prometheus wasn’t designed for long-term storage. You might want to store metrics for months or years, but Prometheus will only retain data for a limited period.</li><li id="9c87" class="nk nl gu nm b nn po np nq nr pp nt nu nv pq nx ny nz pr ob oc od ps of og oh pl pm pn bk"><strong class="nm gv">High Availability</strong>: Prometheus doesn’t offer built-in redundancy. If your Prometheus instance goes down, you lose metrics data until it’s back online.</li><li id="6fa9" class="nk nl gu nm b nn po np nq nr pp nt nu nv pq nx ny nz pr ob oc od ps of og oh pl pm pn bk"><strong class="nm gv">Global Queries</strong>: Prometheus is a single-node system, so querying across multiple clusters isn’t supported natively.</li></ul><p id="2f7d" class="pw-post-body-paragraph nk nl gu nm b nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh gn bk">Thanos solves these problems by extending Prometheus with <strong class="nm gv">cloud-native features</strong> that allow you to store metrics in object storage (e.g., Amazon S3), query across multiple clusters in real-time, and ensure metrics availability even when components fail.</p><h1 id="9b7c" class="oi oj gu bf ok ol om on oo op oq or os ot ou ov ow ox oy oz pa pb pc pd pe pf bk">Components of a Metrics System with Thanos and Kubernetes</h1><p id="bfdf" class="pw-post-body-paragraph nk nl gu nm b nn pg np nq nr ph nt nu nv pi nx ny nz pj ob oc od pk of og oh gn bk">Thanos isn’t just one tool — it’s a suite of components that work together to create a full-featured metrics system:</p><ul class=""><li id="2506" class="nk nl gu nm b nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh pl pm pn bk"><strong class="nm gv">Thanos Sidecar</strong>: This runs alongside each Prometheus instance, shipping metrics data to object storage and allowing Prometheus to be part of a larger Thanos architecture.</li><li id="9e7d" class="nk nl gu nm b nn po np nq nr pp nt nu nv pq nx ny nz pr ob oc od ps of og oh pl pm pn bk"><strong class="nm gv">Querier</strong>: This component aggregates data from multiple Prometheus instances and other Thanos components, providing a unified view of your metrics.</li><li id="15ca" class="nk nl gu nm b nn po np nq nr pp nt nu nv pq nx ny nz pr ob oc od ps of og oh pl pm pn bk"><strong class="nm gv">Store Gateway</strong>: It retrieves older metrics from object storage, making it possible to query data beyond what Prometheus retains locally.</li><li id="ee59" class="nk nl gu nm b nn po np nq nr pp nt nu nv pq nx ny nz pr ob oc od ps of og oh pl pm pn bk"><strong class="nm gv">Compactor</strong>: Reduces the footprint of stored metrics by compacting and downsampling them, improving both query performance and storage efficiency.</li><li id="b990" class="nk nl gu nm b nn po np nq nr pp nt nu nv pq nx ny nz pr ob oc od ps of og oh pl pm pn bk"><strong class="nm gv">Ruler</strong>: Evaluates Prometheus-style recording and alerting rules but on historical data, enabling alerts on long-term trends.</li></ul><p id="186c" class="pw-post-body-paragraph nk nl gu nm b nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh gn bk">Each of these components plays a role in ensuring that your metrics system scales as your infrastructure grows, and that you can access long-term data without managing huge Prometheus instances on their own.</p><h1 id="6958" class="oi oj gu bf ok ol om on oo op oq or os ot ou ov ow ox oy oz pa pb pc pd pe pf bk">Before We Start, a Couple of Recommendations…</h1><ul class=""><li id="6aba" class="nk nl gu nm b nn pg np nq nr ph nt nu nv pi nx ny nz pj ob oc od pk of og oh pl pm pn bk"><strong class="nm gv">Plan your storage strategy</strong>: When setting up Thanos, keep in mind that storing large volumes of metrics data in the cloud can get expensive. Choose your storage provider and lifecycle management policies wisely (e.g., move old metrics to cheaper storage tiers).</li><li id="6834" class="nk nl gu nm b nn po np nq nr pp nt nu nv pq nx ny nz pr ob oc od ps of og oh pl pm pn bk"><strong class="nm gv">Automate deployments</strong>: Use Kubernetes tools like Helm to manage your Thanos and Prometheus deployments. This will make scaling and updating the system much easier as your infrastructure grows.</li><li id="bc32" class="nk nl gu nm b nn po np nq nr pp nt nu nv pq nx ny nz pr ob oc od ps of og oh pl pm pn bk"><strong class="nm gv">Monitor Thanos components</strong>: Don’t just monitor your applications — set up alerts for the health of your Thanos components too. If your Querier or Sidecar goes down, you’ll want to know immediately.</li></ul><p id="d524" class="pw-post-body-paragraph nk nl gu nm b nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh gn bk">Now that you know why a metrics system with Thanos and Kubernetes is powerful and what components make it work, let’s dive into the setup and get everything running.</p><h1 id="0259" class="oi oj gu bf ok ol om on oo op oq or os ot ou ov ow ox oy oz pa pb pc pd pe pf bk">Deploying Thanos with Kubernetes: A Real-World Tutorial</h1><p id="b331" class="pw-post-body-paragraph nk nl gu nm b nn pg np nq nr ph nt nu nv pi nx ny nz pj ob oc od pk of og oh gn bk">In this step-by-step guide, we’re going to walk through deploying Thanos with Kubernetes in a real-world scenario. The goal is to set up a scalable, long-term metrics system for Kubernetes clusters using Prometheus as the core metrics collector and Thanos as the layer that extends Prometheus’ capabilities. By the end of this tutorial, you’ll have a robust, distributed system that can handle long-term storage, querying across multiple Prometheus instances, and high availability.</p><h1 id="6e1d" class="oi oj gu bf ok ol om on oo op oq or os ot ou ov ow ox oy oz pa pb pc pd pe pf bk">Step 1: Install Prometheus on Kubernetes</h1><p id="b409" class="pw-post-body-paragraph nk nl gu nm b nn pg np nq nr ph nt nu nv pi nx ny nz pj ob oc od pk of og oh gn bk">The first step in setting up your metrics system is to get Prometheus up and running in your Kubernetes cluster. If Prometheus isn’t installed yet, you can use <strong class="nm gv">Helm</strong> to deploy it quickly.</p><p id="38c5" class="pw-post-body-paragraph nk nl gu nm b nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh gn bk">Begin by adding the Helm repository for Prometheus charts:</p><pre class="pt pu pv pw px py pz qa bp qb bb bk"><span id="b2dd" class="qc oj gu pz b bg qd qe l qf qg">helm repo add prometheus-community https://prometheus-community.github.io/helm-charts<br/>helm repo update</span></pre><p id="4d6a" class="pw-post-body-paragraph nk nl gu nm b nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh gn bk">Once the repository is updated, you can install Prometheus by running:</p><pre class="pt pu pv pw px py pz qa bp qb bb bk"><span id="013a" class="qc oj gu pz b bg qd qe l qf qg">helm install prometheus prometheus-community/prometheus</span></pre><p id="b71b" class="pw-post-body-paragraph nk nl gu nm b nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh gn bk">After running this command, Helm will install the Prometheus server, and you can check its status by listing the running pods:</p><pre class="pt pu pv pw px py pz qa bp qb bb bk"><span id="c6a2" class="qc oj gu pz b bg qd qe l qf qg">kubectl get pods -l &quot;app=prometheus&quot;</span></pre><p id="261d" class="pw-post-body-paragraph nk nl gu nm b nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh gn bk">If Prometheus is up and running, you’ll see one or more pods with names starting with <strong class="nm gv">prometheus</strong>. If the pods are not running or stuck in an error state, you may need to check the logs with:</p><pre class="pt pu pv pw px py pz qa bp qb bb bk"><span id="d556" class="qc oj gu pz b bg qd qe l qf qg">kubectl logs &lt;prometheus-pod-name&gt;</span></pre><h1 id="9af6" class="oi oj gu bf ok ol om on oo op oq or os ot ou ov ow ox oy oz pa pb pc pd pe pf bk">Step 2: Set Up Thanos Sidecar</h1><p id="5f57" class="pw-post-body-paragraph nk nl gu nm b nn pg np nq nr ph nt nu nv pi nx ny nz pj ob oc od pk of og oh gn bk">The Thanos Sidecar is crucial for integrating Prometheus with Thanos. It will run alongside Prometheus, forwarding its data to long-term storage (e.g., Amazon S3).</p><p id="1ce3" class="pw-post-body-paragraph nk nl gu nm b nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh gn bk">Before configuring the sidecar, if you’re using Amazon S3, create a new S3 bucket to store the metrics:</p><pre class="pt pu pv pw px py pz qa bp qb bb bk"><span id="ab9c" class="qc oj gu pz b bg qd qe l qf qg">aws s3api create-bucket --bucket my-thanos-bucket --region us-east-1</span></pre><p id="550f" class="pw-post-body-paragraph nk nl gu nm b nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh gn bk">Now, you need to update the Prometheus deployment to include the Thanos Sidecar. You’ll do this by adding the Thanos container to the existing Prometheus deployment. Here’s an example deployment configuration for <strong class="nm gv">Prometheus with Thanos Sidecar</strong>:</p><pre class="pt pu pv pw px py pz qa bp qb bb bk"><span id="ba2e" class="qc oj gu pz b bg qd qe l qf qg">apiVersion: apps/v1<br/>kind: Deployment<br/>metadata:<br/>  name: prometheus<br/>spec:<br/>  replicas: 1<br/>  template:<br/>    spec:<br/>      containers:<br/>      - name: prometheus<br/>        image: prom/prometheus:v2.43.0<br/>        args:<br/>          - &quot;--config.file=/etc/prometheus/prometheus.yml&quot;<br/>          - &quot;--storage.tsdb.path=/prometheus&quot;<br/>        ports:<br/>          - containerPort: 9090<br/>      - name: thanos-sidecar<br/>        image: quay.io/thanos/thanos:v0.32.1<br/>        args:<br/>          - sidecar<br/>          - --tsdb.path=/prometheus<br/>          - --objstore.config-file=/etc/thanos/s3.yaml<br/>        ports:<br/>          - containerPort: 10902<br/>        volumeMounts:<br/>          - name: prometheus-data<br/>            mountPath: /prometheus<br/>          - name: s3-config<br/>            mountPath: /etc/thanos/s3.yaml<br/>            subPath: s3.yaml<br/>volumes:<br/>  - name: s3-config<br/>    configMap:<br/>      name: s3-config</span></pre><p id="3ac9" class="pw-post-body-paragraph nk nl gu nm b nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh gn bk">Make sure you create the <strong class="nm gv">s3.yaml</strong> file containing the necessary S3 credentials for your bucket:</p><pre class="pt pu pv pw px py pz qa bp qb bb bk"><span id="9d3f" class="qc oj gu pz b bg qd qe l qf qg">type: S3<br/>config:<br/>  bucket: my-thanos-bucket<br/>  endpoint: s3.amazonaws.com<br/>  region: us-east-1<br/>  access_key: YOUR_ACCESS_KEY<br/>  secret_key: YOUR_SECRET_KEY</span></pre><p id="20d8" class="pw-post-body-paragraph nk nl gu nm b nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh gn bk">Once you’ve configured the sidecar, apply the changes to your Kubernetes cluster:</p><pre class="pt pu pv pw px py pz qa bp qb bb bk"><span id="5e92" class="qc oj gu pz b bg qd qe l qf qg">kubectl apply -f prometheus-thanos-deployment.yaml</span></pre><p id="5ffb" class="pw-post-body-paragraph nk nl gu nm b nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh gn bk">This will deploy both Prometheus and the Thanos sidecar, and the sidecar will start sending Prometheus data to the S3 bucket.</p><h1 id="30a8" class="oi oj gu bf ok ol om on oo op oq or os ot ou ov ow ox oy oz pa pb pc pd pe pf bk">Step 3: Deploy the Thanos Querier</h1><p id="2605" class="pw-post-body-paragraph nk nl gu nm b nn pg np nq nr ph nt nu nv pi nx ny nz pj ob oc od pk of og oh gn bk">The <strong class="nm gv">Thanos Querier</strong> allows you to query data across multiple Prometheus instances, providing a global view of your metrics. This is especially useful when you have multiple Kubernetes clusters or regions and want a unified metrics system.</p><p id="6fc4" class="pw-post-body-paragraph nk nl gu nm b nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh gn bk">Here’s an example deployment for the Thanos Querier:</p><pre class="pt pu pv pw px py pz qa bp qb bb bk"><span id="6aee" class="qc oj gu pz b bg qd qe l qf qg">apiVersion: apps/v1<br/>kind: Deployment<br/>metadata:<br/>  name: thanos-querier<br/>spec:<br/>  replicas: 1<br/>  template:<br/>    spec:<br/>      containers:<br/>      - name: thanos-querier<br/>        image: quay.io/thanos/thanos:v0.32.1<br/>        args:<br/>          - query<br/>          - --http-address=0.0.0.0:9090<br/>          - --store=dnssrv+_grpc._tcp.thanos-sidecar.default.svc.cluster.local:10901<br/>          - --store=dnssrv+_grpc._tcp.thanos-store.default.svc.cluster.local:10901<br/>        ports:<br/>          - containerPort: 9090</span></pre><p id="c255" class="pw-post-body-paragraph nk nl gu nm b nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh gn bk">In this configuration, the Querier is set up to pull data from the Thanos Sidecar and Store Gateway via DNS service discovery. The Querier will act as a centralized point for querying metrics.</p><p id="d773" class="pw-post-body-paragraph nk nl gu nm b nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh gn bk">Deploy the Thanos Querier to your cluster by applying the YAML:</p><pre class="pt pu pv pw px py pz qa bp qb bb bk"><span id="f127" class="qc oj gu pz b bg qd qe l qf qg">kubectl apply -f thanos-querier-deployment.yaml</span></pre><p id="49f3" class="pw-post-body-paragraph nk nl gu nm b nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh gn bk">To test the Querier, forward the service port to your local machine:</p><pre class="pt pu pv pw px py pz qa bp qb bb bk"><span id="d095" class="qc oj gu pz b bg qd qe l qf qg">kubectl port-forward svc/thanos-querier 9090:9090</span></pre><p id="ce2a" class="pw-post-body-paragraph nk nl gu nm b nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh gn bk">Now, open your browser and go to <a class="af qh" href="http://localhost:9090" rel="noopener ugc nofollow" target="_blank"><strong class="nm gv">http://localhost:9090</strong></a> to interact with the Thanos Querier UI and start querying data across Prometheus instances.</p><h1 id="aba6" class="oi oj gu bf ok ol om on oo op oq or os ot ou ov ow ox oy oz pa pb pc pd pe pf bk">Step 4: Deploy Thanos Store Gateway</h1><p id="8e20" class="pw-post-body-paragraph nk nl gu nm b nn pg np nq nr ph nt nu nv pi nx ny nz pj ob oc od pk of og oh gn bk">The Thanos <strong class="nm gv">Store Gateway</strong> retrieves historical metrics stored in the S3 bucket. This allows you to query data beyond the retention limits of Prometheus itself.</p><p id="71ad" class="pw-post-body-paragraph nk nl gu nm b nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh gn bk">Here’s an example configuration for the Thanos Store Gateway deployment:</p><pre class="pt pu pv pw px py pz qa bp qb bb bk"><span id="48df" class="qc oj gu pz b bg qd qe l qf qg">apiVersion: apps/v1<br/>kind: Deployment<br/>metadata:<br/>  name: thanos-store<br/>spec:<br/>  replicas: 1<br/>  template:<br/>    spec:<br/>      containers:<br/>      - name: thanos-store<br/>        image: quay.io/thanos/thanos:v0.32.1<br/>        args:<br/>          - store<br/>          - --data-dir=/data<br/>          - --objstore.config-file=/etc/thanos/s3.yaml<br/>        ports:<br/>          - containerPort: 10901<br/>        volumeMounts:<br/>          - name: data<br/>            mountPath: /data<br/>          - name: s3-config<br/>            mountPath: /etc/thanos/s3.yaml<br/>            subPath: s3.yaml<br/>volumes:<br/>  - name: data<br/>    emptyDir: {}<br/>  - name: s3-config<br/>    configMap:<br/>      name: s3-config</span></pre><p id="8ada" class="pw-post-body-paragraph nk nl gu nm b nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh gn bk">Apply this configuration to deploy the Thanos Store Gateway:</p><pre class="pt pu pv pw px py pz qa bp qb bb bk"><span id="a6fa" class="qc oj gu pz b bg qd qe l qf qg">kubectl apply -f thanos-store-deployment.yaml</span></pre><p id="a107" class="pw-post-body-paragraph nk nl gu nm b nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh gn bk">The Store Gateway will start retrieving older metrics from your S3 bucket, making them available for queries through the Thanos Querier.</p><h1 id="6492" class="oi oj gu bf ok ol om on oo op oq or os ot ou ov ow ox oy oz pa pb pc pd pe pf bk">Step 5: Verify and Test Your Setup</h1><p id="c990" class="pw-post-body-paragraph nk nl gu nm b nn pg np nq nr ph nt nu nv pi nx ny nz pj ob oc od pk of og oh gn bk">Once all the Thanos components are running, you should test the entire setup to ensure that metrics are being stored and queried correctly.</p><p id="d1bb" class="pw-post-body-paragraph nk nl gu nm b nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh gn bk">Start by checking that all your Prometheus and Thanos pods are running:</p><pre class="pt pu pv pw px py pz qa bp qb bb bk"><span id="4d0b" class="qc oj gu pz b bg qd qe l qf qg">kubectl get pods</span></pre><p id="4381" class="pw-post-body-paragraph nk nl gu nm b nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh gn bk">If everything is running as expected, use the Thanos Querier UI to execute queries. Verify that you can retrieve both recent and historical data from the S3 bucket.</p><p id="5bad" class="pw-post-body-paragraph nk nl gu nm b nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh gn bk">You can also check the logs of the Thanos components to ensure they are communicating correctly:</p><pre class="pt pu pv pw px py pz qa bp qb bb bk"><span id="0137" class="qc oj gu pz b bg qd qe l qf qg">kubectl logs &lt;thanos-querier-pod-name&gt;<br/>kubectl logs &lt;thanos-store-pod-name&gt;<br/>kubectl logs &lt;thanos-sidecar-pod-name&gt;</span></pre><p id="69ff" class="pw-post-body-paragraph nk nl gu nm b nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh gn bk">If any component isn’t working as expected, these logs will provide clues on what’s going wrong.</p><h1 id="80be" class="oi oj gu bf ok ol om on oo op oq or os ot ou ov ow ox oy oz pa pb pc pd pe pf bk">Best Practices</h1><h1 id="17e8" class="oi oj gu bf ok ol om on oo op oq or os ot ou ov ow ox oy oz pa pb pc pd pe pf bk">Best Practices for a Metrics System with Thanos and Kubernetes</h1><p id="7099" class="pw-post-body-paragraph nk nl gu nm b nn pg np nq nr ph nt nu nv pi nx ny nz pj ob oc od pk of og oh gn bk">Deploying Thanos on Kubernetes is a powerful way to manage metrics at scale, but to ensure that your setup performs efficiently and remains cost-effective, there are several best practices to follow. These will not only improve performance but also reduce overhead and make long-term metric retention more manageable.</p><h1 id="02cd" class="oi oj gu bf ok ol om on oo op oq or os ot ou ov ow ox oy oz pa pb pc pd pe pf bk">Use Downsampling to Reduce Query Load</h1><p id="0b6f" class="pw-post-body-paragraph nk nl gu nm b nn pg np nq nr ph nt nu nv pi nx ny nz pj ob oc od pk of og oh gn bk">As the volume of metrics grows, querying the data can become slow and resource-intensive. This is where <strong class="nm gv">downsampling</strong> comes into play. Downsampling aggregates older metrics, reducing their granularity while preserving essential trends over time. By configuring <strong class="nm gv">Thanos Compactor</strong> to downsample your metrics, you can significantly improve query performance, reduce storage costs, and lighten the load on your object storage.</p><p id="588f" class="pw-post-body-paragraph nk nl gu nm b nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh gn bk">In a typical Thanos setup, the <strong class="nm gv">Compactor</strong> handles two tasks: compacting time series into smaller blocks and downsampling older data. Here’s an example of how to configure the Compactor:</p><pre class="pt pu pv pw px py pz qa bp qb bb bk"><span id="9af7" class="qc oj gu pz b bg qd qe l qf qg">apiVersion: apps/v1<br/>kind: Deployment<br/>metadata:<br/>  name: thanos-compactor<br/>spec:<br/>  replicas: 1<br/>  template:<br/>    spec:<br/>      containers:<br/>      - name: thanos-compactor<br/>        image: quay.io/thanos/thanos:v0.32.1<br/>        args:<br/>          - compact<br/>          - --data-dir=/data<br/>          - --objstore.config-file=/etc/thanos/s3.yaml<br/>          - --retention.resolution-raw=30d<br/>          - --retention.resolution-5m=180d<br/>          - --retention.resolution-1h=1y<br/>        volumeMounts:<br/>          - name: data<br/>            mountPath: /data<br/>          - name: s3-config<br/>            mountPath: /etc/thanos/s3.yaml<br/>            subPath: s3.yaml<br/>volumes:<br/>  - name: data<br/>    emptyDir: {}<br/>  - name: s3-config<br/>    configMap:<br/>      name: s3-config</span></pre><p id="d136" class="pw-post-body-paragraph nk nl gu nm b nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh gn bk">In this configuration, the <strong class="nm gv">Compactor</strong> is set to retain raw, high-resolution data for 30 days, 5-minute downsampled data for 180 days, and 1-hour downsampled data for a year. The Compactor automatically creates these downsampled blocks, making it easier to query historical data without burdening the system.</p><p id="8d24" class="pw-post-body-paragraph nk nl gu nm b nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh gn bk">Make sure to tune the retention periods based on your data needs and storage capacity. Downsampling is ideal when you don’t need fine-grained detail for older metrics but still want to preserve long-term trends for analysis or compliance.</p><h1 id="7036" class="oi oj gu bf ok ol om on oo op oq or os ot ou ov ow ox oy oz pa pb pc pd pe pf bk">Leverage Kubernetes Service Discovery</h1><p id="21a9" class="pw-post-body-paragraph nk nl gu nm b nn pg np nq nr ph nt nu nv pi nx ny nz pj ob oc od pk of og oh gn bk">Thanos Querier can automatically discover Prometheus instances using <strong class="nm gv">Kubernetes service discovery</strong>. This simplifies the process of scaling up or down without having to manually configure new Prometheus instances. Kubernetes’ native DNS-based service discovery allows Thanos to dynamically discover services within the cluster, making the system more flexible and easier to manage.</p><p id="061f" class="pw-post-body-paragraph nk nl gu nm b nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh gn bk">To enable service discovery in Thanos Querier, you can modify the deployment configuration as follows:</p><pre class="pt pu pv pw px py pz qa bp qb bb bk"><span id="5b8e" class="qc oj gu pz b bg qd qe l qf qg">apiVersion: apps/v1<br/>kind: Deployment<br/>metadata:<br/>  name: thanos-querier<br/>spec:<br/>  replicas: 1<br/>  template:<br/>    spec:<br/>      containers:<br/>      - name: thanos-querier<br/>        image: quay.io/thanos/thanos:v0.32.1<br/>        args:<br/>          - query<br/>          - --http-address=0.0.0.0:9090<br/>          - --store=dnssrv+_grpc._tcp.prometheus.default.svc.cluster.local:10901<br/>          - --store=dnssrv+_grpc._tcp.thanos-store.default.svc.cluster.local:10901</span></pre><p id="d69c" class="pw-post-body-paragraph nk nl gu nm b nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh gn bk">In this setup, the <code class="cx qi qj qk pz b">dnssrv</code> address is used to auto-discover any Prometheus instances and Thanos Store Gateways running within the Kubernetes cluster. By leveraging Kubernetes DNS-based service discovery, Thanos can dynamically scale without any manual configuration when new Prometheus instances are added.</p><h1 id="12d8" class="oi oj gu bf ok ol om on oo op oq or os ot ou ov ow ox oy oz pa pb pc pd pe pf bk">Secure Object Storage Access</h1><p id="9ff9" class="pw-post-body-paragraph nk nl gu nm b nn pg np nq nr ph nt nu nv pi nx ny nz pj ob oc od pk of og oh gn bk">When using cloud object storage like <strong class="nm gv">Amazon S3</strong> or <strong class="nm gv">Google Cloud Storage</strong> for storing your metrics, securing the access credentials is critical. Instead of hardcoding the credentials in your YAML files, you should use <strong class="nm gv">Kubernetes Secrets</strong> to manage sensitive information like your object storage access keys.</p><p id="b1f6" class="pw-post-body-paragraph nk nl gu nm b nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh gn bk">Here’s how to securely store your S3 credentials in a Kubernetes Secret:</p><pre class="pt pu pv pw px py pz qa bp qb bb bk"><span id="0206" class="qc oj gu pz b bg qd qe l qf qg">kubectl create secret generic s3-credentials \<br/>  --from-literal=access_key=YOUR_ACCESS_KEY \<br/>  --from-literal=secret_key=YOUR_SECRET_KEY</span></pre><p id="9599" class="pw-post-body-paragraph nk nl gu nm b nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh gn bk">Once the secret is created, reference it in your Thanos sidecar or store configurations:</p><pre class="pt pu pv pw px py pz qa bp qb bb bk"><span id="1c86" class="qc oj gu pz b bg qd qe l qf qg">apiVersion: apps/v1<br/>kind: Deployment<br/>metadata:<br/>  name: thanos-sidecar<br/>spec:<br/>  replicas: 1<br/>  template:<br/>    spec:<br/>      containers:<br/>      - name: thanos-sidecar<br/>        image: quay.io/thanos/thanos:v0.32.1<br/>        args:<br/>          - sidecar<br/>          - --tsdb.path=/prometheus<br/>          - --objstore.config-file=/etc/thanos/s3.yaml<br/>        env:<br/>        - name: S3_ACCESS_KEY<br/>          valueFrom:<br/>            secretKeyRef:<br/>              name: s3-credentials<br/>              key: access_key<br/>        - name: S3_SECRET_KEY<br/>          valueFrom:<br/>            secretKeyRef:<br/>              name: s3-credentials<br/>              key: secret_key<br/>        volumeMounts:<br/>          - name: s3-config<br/>            mountPath: /etc/thanos/s3.yaml<br/>            subPath: s3.yaml</span></pre><p id="eb34" class="pw-post-body-paragraph nk nl gu nm b nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh gn bk">By using <strong class="nm gv">Kubernetes Secrets</strong>, you ensure that your access keys are encrypted and safely stored, reducing the risk of accidental exposure.</p><h1 id="bf34" class="oi oj gu bf ok ol om on oo op oq or os ot ou ov ow ox oy oz pa pb pc pd pe pf bk">Monitor Thanos Components</h1><p id="2cd4" class="pw-post-body-paragraph nk nl gu nm b nn pg np nq nr ph nt nu nv pi nx ny nz pj ob oc od pk of og oh gn bk">Monitoring the health of your Thanos components is just as important as monitoring the health of your applications. If any Thanos component like the Querier, Sidecar, or Store Gateway fails, it could impact your metrics system, leading to missing data or failed queries.</p><p id="0c03" class="pw-post-body-paragraph nk nl gu nm b nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh gn bk">The first step is to set up <strong class="nm gv">Prometheus alerting rules</strong> to track the status of Thanos components. For example, you can monitor the <strong class="nm gv">up</strong> status of Thanos instances with Prometheus using the following alerting rule:</p><pre class="pt pu pv pw px py pz qa bp qb bb bk"><span id="ed3c" class="qc oj gu pz b bg qd qe l qf qg">groups:<br/>- name: thanos-alerts<br/>  rules:<br/>  - alert: ThanosDown<br/>    expr: up{job=&quot;thanos&quot;} == 0<br/>    for: 5m<br/>    labels:<br/>      severity: critical<br/>    annotations:<br/>      summary: &quot;Thanos instance down&quot;<br/>      description: &quot;The Thanos {{ $labels.instance }} instance is down for more than 5 minutes.&quot;</span></pre><p id="3358" class="pw-post-body-paragraph nk nl gu nm b nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh gn bk">This alert will fire if any Thanos instance is down for more than 5 minutes, allowing you to quickly detect and respond to failures in the system.</p><p id="150d" class="pw-post-body-paragraph nk nl gu nm b nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh gn bk">You should also consider using <strong class="nm gv">Grafana</strong> for visualizing the performance of your Thanos components and creating dashboards that track the health and performance of each service in real-time.</p><h1 id="42fa" class="oi oj gu bf ok ol om on oo op oq or os ot ou ov ow ox oy oz pa pb pc pd pe pf bk">Optimize Storage Costs</h1><p id="5919" class="pw-post-body-paragraph nk nl gu nm b nn pg np nq nr ph nt nu nv pi nx ny nz pj ob oc od pk of og oh gn bk">Storing large volumes of metrics can become costly, especially if you’re retaining high-resolution data for long periods. To optimize costs, use <strong class="nm gv">lifecycle policies</strong> in your object storage to automatically move older data to cheaper storage tiers like Amazon S3’s <strong class="nm gv">Glacier</strong> or <strong class="nm gv">Google Cloud Nearline Storage</strong>.</p><p id="bbec" class="pw-post-body-paragraph nk nl gu nm b nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh gn bk">For example, in Amazon S3, you can configure a lifecycle policy that transitions older data to Glacier after 90 days:</p><pre class="pt pu pv pw px py pz qa bp qb bb bk"><span id="5b15" class="qc oj gu pz b bg qd qe l qf qg">{<br/>  &quot;Rules&quot;: [<br/>    {<br/>      &quot;ID&quot;: &quot;MoveOlderDataToGlacier&quot;,<br/>      &quot;Filter&quot;: {<br/>        &quot;Prefix&quot;: &quot;&quot;<br/>      },<br/>      &quot;Status&quot;: &quot;Enabled&quot;,<br/>      &quot;Transitions&quot;: [<br/>        {<br/>          &quot;Days&quot;: 90,<br/>          &quot;StorageClass&quot;: &quot;GLACIER&quot;<br/>        }<br/>      ],<br/>      &quot;NoncurrentVersionTransitions&quot;: [],<br/>      &quot;Expiration&quot;: {<br/>        &quot;Days&quot;: 365<br/>      }<br/>    }<br/>  ]<br/>}</span></pre><p id="b913" class="pw-post-body-paragraph nk nl gu nm b nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh gn bk">Applying this policy ensures that you’re only paying for high-performance storage for recent data, while older data is moved to a cheaper, slower storage class.</p><p id="462e" class="pw-post-body-paragraph nk nl gu nm b nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh gn bk">In Google Cloud Storage, you can configure a similar lifecycle rule to transition objects to <strong class="nm gv">Nearline</strong> or <strong class="nm gv">Coldline</strong> storage after a set number of days. This strategy helps in optimizing your storage costs, especially when retaining large amounts of historical metrics data.</p><h1 id="250d" class="oi oj gu bf ok ol om on oo op oq or os ot ou ov ow ox oy oz pa pb pc pd pe pf bk">Conclusion</h1><p id="80d7" class="pw-post-body-paragraph nk nl gu nm b nn pg np nq nr ph nt nu nv pi nx ny nz pj ob oc od pk of og oh gn bk">Setting up a metrics system with <strong class="nm gv">Thanos</strong> and <strong class="nm gv">Kubernetes</strong> can feel like a big task, especially when you start thinking about long-term storage, high availability, and global querying across multiple clusters. But the good news is that it doesn’t have to be a daunting process. By integrating Thanos with Prometheus, you tackle some of the biggest challenges in observability for Kubernetes environments — scalability, redundancy, and cost management.</p><p id="e077" class="pw-post-body-paragraph nk nl gu nm b nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh gn bk">Throughout this guide, I’ve walked you through deploying Prometheus and Thanos step by step, configuring downsampling, securing object storage access, and using Kubernetes service discovery. Each of these steps helps create a more robust, efficient metrics system that scales with your infrastructure. The important thing here is to keep your setup flexible, monitor the health of your components, and optimize for both performance and cost as your data grows.</p><p id="6b87" class="pw-post-body-paragraph nk nl gu nm b nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh gn bk">Now, I’d love to hear your thoughts! If you’ve got additional tips or encountered any interesting challenges while deploying Thanos, drop your suggestions in the comments below. Let’s make this a collaborative resource where everyone can benefit.</p><h1 id="3ba2" class="oi oj gu bf ok ol om on oo op oq or os ot ou ov ow ox oy oz pa pb pc pd pe pf bk">Learn More</h1><div class="ql qm qn qo qp qq"><a rel="noopener  ugc nofollow" target="_blank" href="/15-best-kubernetes-cost-optimization-tools-for-2024-2e131a7cbe7a?source=post_page-----5660a95fd8fc--------------------------------"><div class="qr ab ix"><div class="qs ab co cb qt qu"><h2 class="bf gv io z jf qv jh ji qw jk jm gt bk">15 Best Kubernetes Cost Optimization Tools for 2024</h2><div class="qx l"><h3 class="bf b io z jf qv jh ji qw jk jm du">Financial times are tough, that’s no secret. Most organizations need to scale their offering to their market and…</h3></div><div class="qy l"><p class="bf b dv z jf qv jh ji qw jk jm du">overcast.blog</p></div></div><div class="qz l"><div class="ra l rb rc rd qz re md qq"></div></div></div></a></div><div class="ql qm qn qo qp qq"><a rel="noopener  ugc nofollow" target="_blank" href="/11-ways-to-optimize-kubernetes-load-balancing-cdbab1bc785e?source=post_page-----5660a95fd8fc--------------------------------"><div class="qr ab ix"><div class="qs ab co cb qt qu"><h2 class="bf gv io z jf qv jh ji qw jk jm gt bk">11 Ways to Optimize Kubernetes Load Balancing</h2><div class="qx l"><h3 class="bf b io z jf qv jh ji qw jk jm du">Optimizing load balancing in Kubernetes is crucial for maintaining the high availability, scalability, and performance…</h3></div><div class="qy l"><p class="bf b dv z jf qv jh ji qw jk jm du">overcast.blog</p></div></div><div class="qz l"><div class="rf l rb rc rd qz re md qq"></div></div></div></a></div><div class="ql qm qn qo qp qq"><a rel="noopener  ugc nofollow" target="_blank" href="/15-cloud-native-devops-tools-you-should-know-36129057a15c?source=post_page-----5660a95fd8fc--------------------------------"><div class="qr ab ix"><div class="qs ab co cb qt qu"><h2 class="bf gv io z jf qv jh ji qw jk jm gt bk">15 Cloud-Native DevOps Tools You Should Know</h2><div class="qx l"><h3 class="bf b io z jf qv jh ji qw jk jm du">Managing dynamic and scalable environments efficiently requires cloud-native DevOps tools. These tools automate…</h3></div><div class="qy l"><p class="bf b dv z jf qv jh ji qw jk jm du">overcast.blog</p></div></div><div class="qz l"><div class="rg l rb rc rd qz re md qq"></div></div></div></a></div><div class="ql qm qn qo qp qq"><a rel="noopener  ugc nofollow" target="_blank" href="/13-kubernetes-automations-you-should-know-5e92028284eb?source=post_page-----5660a95fd8fc--------------------------------"><div class="qr ab ix"><div class="qs ab co cb qt qu"><h2 class="bf gv io z jf qv jh ji qw jk jm gt bk">13 Kubernetes Automations You Should Know</h2><div class="qx l"><h3 class="bf b io z jf qv jh ji qw jk jm du">Managing Kubernetes environments manually can be challenging, especially as your infrastructure scales. Automation is…</h3></div><div class="qy l"><p class="bf b dv z jf qv jh ji qw jk jm du">overcast.blog</p></div></div><div class="qz l"><div class="rh l rb rc rd qz re md qq"></div></div></div></a></div></div></div></div></div></section></div></div></article></div><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="ri rj ab ja"><div class="qx ab"><a class="rk ay am ao" href="https://medium.com/tag/kubernetes?source=post_page-----5660a95fd8fc--------------------------------" rel="noopener follow"><div class="rl fj cx rm ge rn ro bf b bg z bk rp">Kubernetes</div></a></div><div class="qx ab"><a class="rk ay am ao" href="https://medium.com/tag/devops?source=post_page-----5660a95fd8fc--------------------------------" rel="noopener follow"><div class="rl fj cx rm ge rn ro bf b bg z bk rp">DevOps</div></a></div><div class="qx ab"><a class="rk ay am ao" href="https://medium.com/tag/programming?source=post_page-----5660a95fd8fc--------------------------------" rel="noopener follow"><div class="rl fj cx rm ge rn ro bf b bg z bk rp">Programming</div></a></div><div class="qx ab"><a class="rk ay am ao" href="https://medium.com/tag/cloud-computing?source=post_page-----5660a95fd8fc--------------------------------" rel="noopener follow"><div class="rl fj cx rm ge rn ro bf b bg z bk rp">Cloud Computing</div></a></div><div class="qx ab"><a class="rk ay am ao" href="https://medium.com/tag/software-development?source=post_page-----5660a95fd8fc--------------------------------" rel="noopener follow"><div class="rl fj cx rm ge rn ro bf b bg z bk rp">Software Development</div></a></div></div></div></div><div class="l"></div><footer class="rq rr rs rt ru rv rw rx ry ab q rz ik c"><div class="l ae"><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="ab cp sa"><div class="ab q kv"><div class="sb l"><span class="l sc sd se e d"><div class="ab q kv kw"><div class="pw-multi-vote-icon fj je kx ky kz"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fovercast-blog%2F5660a95fd8fc&amp;operation=register&amp;redirect=https%3A%2F%2Fovercast.blog%2Fbuilding-a-metrics-system-with-thanos-and-kubernetes-5660a95fd8fc&amp;user=DavidW+%28skyDragon%29&amp;userId=e840bf2eef66&amp;source=-----5660a95fd8fc---------------------clap_footer-----------" rel="noopener follow"><div><div class="bm" aria-hidden="false"><div class="la ao lb lc ld le am lf lg lh kz"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l li lj lk ll lm ln lo"><p class="bf b dv z du"><span class="lp">--</span></p></div></div></span><span class="l h g f sf sg"><div class="ab q kv kw"><div class="pw-multi-vote-icon fj je kx ky kz"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fovercast-blog%2F5660a95fd8fc&amp;operation=register&amp;redirect=https%3A%2F%2Fovercast.blog%2Fbuilding-a-metrics-system-with-thanos-and-kubernetes-5660a95fd8fc&amp;user=DavidW+%28skyDragon%29&amp;userId=e840bf2eef66&amp;source=-----5660a95fd8fc---------------------clap_footer-----------" rel="noopener follow"><div><div class="bm" aria-hidden="false"><div class="la ao lb lc ld le am lf lg lh kz"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l li lj lk ll lm ln lo"><p class="bf b dv z du"><span class="lp">--</span></p></div></div></span></div><div class="bq ab"><div><div class="bm" aria-hidden="false"><button class="ao la lq lr ab q fk ls lt" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="lu"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg></button></div></div></div></div><div class="ab q"><div class="sh l ix"><div><div class="bm" aria-hidden="false"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerBookmarkButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5660a95fd8fc&amp;operation=register&amp;redirect=https%3A%2F%2Fovercast.blog%2Fbuilding-a-metrics-system-with-thanos-and-kubernetes-5660a95fd8fc&amp;source=--------------------------bookmark_footer-----------" rel="noopener follow"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="du lw" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div><div class="sh l ix"><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="footerSocialShareButton" class="af fk ah ai aj ak al me an ao ap ex mf mg lt mh"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg></button></div></div></div></div></div></div></div></div></div></footer><div class="si sj sk sl sm l bx"><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="cl ab sn cp"><div class="ab ia"><a href="https://medium.com/@dskydragon?source=post_page-----5660a95fd8fc--------------------------------" rel="noopener follow"><div class="l so sp by sq ie"><div class="l fj"><img alt="DavidW (skyDragon)" class="l fd by sr ss cx" src="https://miro.medium.com/v2/resize:fill:144:144/1*hERaxFU_P3qPjslbAw6bDw.png" width="72" height="72" loading="lazy"/><div class="if by l sr ss fs n ig ft"></div></div></div></a><a href="https://overcast.blog/?source=post_page-----5660a95fd8fc--------------------------------" rel="noopener follow"><div class="st ab fj"><div><div class="bm" aria-hidden="false"><div class="l su sv by sq ik"><div class="l fj"><img alt="overcast blog" class="l fd by bz ca cx" src="https://miro.medium.com/v2/resize:fill:64:64/1*hC4pCAXASl2ZiwjKBtISBg.jpeg" width="32" height="32" loading="lazy"/><div class="if by l bz ca fs n ig ft"></div></div></div></div></div></div></a></div><div class="j i d"><div class="ab"><span><a class="bf b bg z sw rl sx sy sz ta tb ev ew tc td te fa au fb fc fd bm fe ff" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe840bf2eef66&amp;operation=register&amp;redirect=https%3A%2F%2Fovercast.blog%2Fbuilding-a-metrics-system-with-thanos-and-kubernetes-5660a95fd8fc&amp;user=DavidW+%28skyDragon%29&amp;userId=e840bf2eef66&amp;source=post_page-e840bf2eef66----5660a95fd8fc---------------------follow_profile-----------" rel="noopener follow">Follow</a></span><div class="dt l"><div><div><div class="bm" aria-hidden="false"><div class="l"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fb4e2c9baad5c&amp;operation=register&amp;redirect=https%3A%2F%2Fovercast.blog%2Fbuilding-a-metrics-system-with-thanos-and-kubernetes-5660a95fd8fc&amp;newsletterV3=e840bf2eef66&amp;newsletterV3Id=b4e2c9baad5c&amp;user=DavidW+%28skyDragon%29&amp;userId=e840bf2eef66&amp;source=-----5660a95fd8fc---------------------subscribe_user-----------" rel="noopener follow"><button class="bf b bg z tg am th ti tj tk tl tm tn to ew tc td te fa fb fc fd bm fe ff" aria-label="Subscribe"><svg xmlns="http://www.w3.org/2000/svg" width="38" height="38" fill="none" viewBox="0 0 38 38" class="tf sv su"><rect width="0.5" height="6.5" x="26.25" y="9.25" rx="0.25"></rect><rect width="0.5" height="6.5" x="29.75" y="12.25" rx="0.25" transform="rotate(90 29.75 12.25)"></rect><path d="M19.5 12.5h-7a1 1 0 0 0-1 1v11a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1v-5"></path><path d="M11.5 14.5 19 20l4-3"></path></svg></button></a></span></div></div></div></div></div></div></div></div><div class="ab cn cp"><div class="l"><div class="ab q"><a class="af ag ah ai aj ak al am an ao ap aq ar as at ab q" href="https://medium.com/@dskydragon?source=post_page-----5660a95fd8fc--------------------------------" rel="noopener follow"><h2 class="pw-author-name bf tp tq tr ts bk"><span class="gn jo">Written by <!-- -->DavidW (skyDragon)</span></h2></a></div><div class="qx ab"><div class="l ix"><span class="pw-follower-count bf b bg z bk"><a class="af ag ah ai aj ak al am an ao ap aq ar iq" href="https://medium.com/@dskydragon/followers?source=post_page-----5660a95fd8fc--------------------------------" rel="noopener follow">12.6K Followers</a></span></div><div class="bf b bg z jf jg jh ab jj jk jl jm du jd"><span class="ir l" aria-hidden="true"><span class="bf b bg z du">·</span></span><span class="l ix">Editor for </span><div><div class="l" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar iq ab q" href="https://overcast.blog/?source=post_page-----5660a95fd8fc--------------------------------" rel="noopener follow"><p class="bf b bg z jf jg jh ji jj jk jl jm bk">overcast blog</p></a></div></div></div></div><div class="tt l"><p class="bf b bg z bk"><span class="gn">Into cloud-native architectures and tools like K8S, Docker, Microservices. I write code to help clouds stay afloat and guides that take people to the clouds.</span></p></div></div><div class="h k"><div class="ab"><span><a class="bf b bg z sw rl sx sy sz ta tb ev ew tc td te fa au fb fc fd bm fe ff" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe840bf2eef66&amp;operation=register&amp;redirect=https%3A%2F%2Fovercast.blog%2Fbuilding-a-metrics-system-with-thanos-and-kubernetes-5660a95fd8fc&amp;user=DavidW+%28skyDragon%29&amp;userId=e840bf2eef66&amp;source=post_page-e840bf2eef66----5660a95fd8fc---------------------follow_profile-----------" rel="noopener follow">Follow</a></span><div class="dt l"><div><div><div class="bm" aria-hidden="false"><div class="l"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fb4e2c9baad5c&amp;operation=register&amp;redirect=https%3A%2F%2Fovercast.blog%2Fbuilding-a-metrics-system-with-thanos-and-kubernetes-5660a95fd8fc&amp;newsletterV3=e840bf2eef66&amp;newsletterV3Id=b4e2c9baad5c&amp;user=DavidW+%28skyDragon%29&amp;userId=e840bf2eef66&amp;source=-----5660a95fd8fc---------------------subscribe_user-----------" rel="noopener follow"><button class="bf b bg z tg am th ti tj tk tl tm tn to ew tc td te fa fb fc fd bm fe ff" aria-label="Subscribe"><svg xmlns="http://www.w3.org/2000/svg" width="38" height="38" fill="none" viewBox="0 0 38 38" class="tf sv su"><rect width="0.5" height="6.5" x="26.25" y="9.25" rx="0.25"></rect><rect width="0.5" height="6.5" x="29.75" y="12.25" rx="0.25" transform="rotate(90 29.75 12.25)"></rect><path d="M19.5 12.5h-7a1 1 0 0 0-1 1v11a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1v-5"></path><path d="M11.5 14.5 19 20l4-3"></path></svg></button></a></span></div></div></div></div></div></div></div></div><div class="tu bh tv mz na nb nc nd"></div></div></div><div class="h k j"><div class="tu bh tv tw"></div><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="tx ab kv ja"><div class="ty tz l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://help.medium.com/hc/en-us?source=post_page-----5660a95fd8fc--------------------------------" rel="noopener follow"><p class="bf b dv z du">Help</p></a></div><div class="ty tz l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.statuspage.io/?source=post_page-----5660a95fd8fc--------------------------------" rel="noopener follow"><p class="bf b dv z du">Status</p></a></div><div class="ty tz l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/about?autoplay=1&amp;source=post_page-----5660a95fd8fc--------------------------------" rel="noopener follow"><p class="bf b dv z du">About</p></a></div><div class="ty tz l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----5660a95fd8fc--------------------------------" rel="noopener follow"><p class="bf b dv z du">Careers</p></a></div><div class="ty tz l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="pressinquiries@medium.com?source=post_page-----5660a95fd8fc--------------------------------" rel="noopener follow"><p class="bf b dv z du">Press</p></a></div><div class="ty tz l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://blog.medium.com/?source=post_page-----5660a95fd8fc--------------------------------" rel="noopener follow"><p class="bf b dv z du">Blog</p></a></div><div class="ty tz l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----5660a95fd8fc--------------------------------" rel="noopener follow"><p class="bf b dv z du">Privacy</p></a></div><div class="ty tz l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----5660a95fd8fc--------------------------------" rel="noopener follow"><p class="bf b dv z du">Terms</p></a></div><div class="ty tz l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://speechify.com/medium?source=post_page-----5660a95fd8fc--------------------------------" rel="noopener follow"><p class="bf b dv z du">Text to speech</p></a></div><div class="ty l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/business?source=post_page-----5660a95fd8fc--------------------------------" rel="noopener follow"><p class="bf b dv z du">Teams</p></a></div></div></div></div></div></div></div></div></div></div><script>window.__BUILD_ID__="main-20240924-010744-6772b423f7"</script><script>window.__GRAPHQL_URI__ = "https://overcast.blog/_/graphql"</script><script>window.__PRELOADED_STATE__ = {"algolia":{"queries":{}},"cache":{"experimentGroupSet":true,"reason":"This request is not using the cache middleware worker","group":"disabled","tags":["group-edgeCachePosts","post-5660a95fd8fc","user-e840bf2eef66","collection-9bad45fbe16d"],"serverVariantState":"","middlewareEnabled":false,"cacheStatus":"DYNAMIC","shouldUseCache":false,"vary":[],"lohpSummerUpsellEnabled":false},"client":{"hydrated":false,"isUs":false,"isNativeMedium":false,"isSafariMobile":false,"isSafari":false,"isFirefox":false,"routingEntity":{"type":"COLLECTION","id":"9bad45fbe16d","explicit":true},"viewerIsBot":false},"debug":{"requestId":"54f72c80-f944-4bc3-964f-29dba7c07a32","hybridDevServices":[],"originalSpanCarrier":{"traceparent":"00-85d093d0dde074e0ff72ea8ce1fa72d0-269aa40f4b531f4b-01"}},"multiVote":{"clapsPerPost":{}},"navigation":{"branch":{"show":null,"hasRendered":null,"blockedByCTA":false},"hideGoogleOneTap":false,"hasRenderedAlternateUserBanner":null,"currentLocation":"https:\u002F\u002Fovercast.blog\u002Fbuilding-a-metrics-system-with-thanos-and-kubernetes-5660a95fd8fc","host":"overcast.blog","hostname":"overcast.blog","referrer":"https:\u002F\u002Fwww.google.com","hasSetReferrer":false,"susiModal":{"step":null,"operation":"register"},"postRead":false,"partnerProgram":{"selectedCountryCode":null}},"config":{"nodeEnv":"production","version":"main-20240924-010744-6772b423f7","target":"production","productName":"Medium","publicUrl":"https:\u002F\u002Fcdn-client.medium.com\u002Flite","authDomain":"medium.com","authGoogleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","favicon":"production","glyphUrl":"https:\u002F\u002Fglyph.medium.com","branchKey":"key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm","algolia":{"appId":"MQ57UUUQZ2","apiKeySearch":"394474ced050e3911ae2249ecc774921","indexPrefix":"medium_","host":"-dsn.algolia.net"},"recaptchaKey":"6Lfc37IUAAAAAKGGtC6rLS13R1Hrw_BqADfS1LRk","recaptcha3Key":"6Lf8R9wUAAAAABMI_85Wb8melS7Zj6ziuf99Yot5","recaptchaEnterpriseKeyId":"6Le-uGgpAAAAAPprRaokM8AKthQ9KNGdoxaGUvVp","datadog":{"applicationId":"6702d87d-a7e0-42fe-bbcb-95b469547ea0","clientToken":"pub853ea8d17ad6821d9f8f11861d23dfed","rumToken":"pubf9cc52896502b9413b68ba36fc0c7162","context":{"deployment":{"target":"production","tag":"main-20240924-010744-6772b423f7","commit":"6772b423f70d35534ffb47df255f09eb9dc9710d"}},"datacenter":"us"},"googleAnalyticsCode":"G-7JY7T788PK","googlePay":{"apiVersion":"2","apiVersionMinor":"0","merchantId":"BCR2DN6TV7EMTGBM","merchantName":"Medium","instanceMerchantId":"13685562959212738550"},"applePay":{"version":3},"signInWallCustomDomainCollectionIds":["3a8144eabfe3","336d898217ee","61061eb0c96b","138adf9c44c","819cc2aaeee0"],"mediumMastodonDomainName":"me.dm","mediumOwnedAndOperatedCollectionIds":["8a9336e5bb4","b7e45b22fec3","193b68bd4fba","8d6b8a439e32","54c98c43354d","3f6ecf56618","d944778ce714","92d2092dc598","ae2a65f35510","1285ba81cada","544c7006046e","fc8964313712","40187e704f1c","88d9857e584e","7b6769f2748b","bcc38c8f6edf","cef6983b292","cb8577c9149e","444d13b52878","713d7dbc99b0","ef8e90590e66","191186aaafa0","55760f21cdc5","9dc80918cc93","bdc4052bbdba","8ccfed20cbb2"],"tierOneDomains":["medium.com","thebolditalic.com","arcdigital.media","towardsdatascience.com","uxdesign.cc","codeburst.io","psiloveyou.xyz","writingcooperative.com","entrepreneurshandbook.co","prototypr.io","betterhumans.coach.me","theascent.pub"],"topicsToFollow":["d61cf867d93f","8a146bc21b28","1eca0103fff3","4d562ee63426","aef1078a3ef5","e15e46793f8d","6158eb913466","55f1c20aba7a","3d18b94f6858","4861fee224fd","63c6f1f93ee","1d98b3a9a871","decb52b64abf","ae5d4995e225","830cded25262"],"topicToTagMappings":{"accessibility":"accessibility","addiction":"addiction","android-development":"android-development","art":"art","artificial-intelligence":"artificial-intelligence","astrology":"astrology","basic-income":"basic-income","beauty":"beauty","biotech":"biotech","blockchain":"blockchain","books":"books","business":"business","cannabis":"cannabis","cities":"cities","climate-change":"climate-change","comics":"comics","coronavirus":"coronavirus","creativity":"creativity","cryptocurrency":"cryptocurrency","culture":"culture","cybersecurity":"cybersecurity","data-science":"data-science","design":"design","digital-life":"digital-life","disability":"disability","economy":"economy","education":"education","equality":"equality","family":"family","feminism":"feminism","fiction":"fiction","film":"film","fitness":"fitness","food":"food","freelancing":"freelancing","future":"future","gadgets":"gadgets","gaming":"gaming","gun-control":"gun-control","health":"health","history":"history","humor":"humor","immigration":"immigration","ios-development":"ios-development","javascript":"javascript","justice":"justice","language":"language","leadership":"leadership","lgbtqia":"lgbtqia","lifestyle":"lifestyle","machine-learning":"machine-learning","makers":"makers","marketing":"marketing","math":"math","media":"media","mental-health":"mental-health","mindfulness":"mindfulness","money":"money","music":"music","neuroscience":"neuroscience","nonfiction":"nonfiction","outdoors":"outdoors","parenting":"parenting","pets":"pets","philosophy":"philosophy","photography":"photography","podcasts":"podcast","poetry":"poetry","politics":"politics","privacy":"privacy","product-management":"product-management","productivity":"productivity","programming":"programming","psychedelics":"psychedelics","psychology":"psychology","race":"race","relationships":"relationships","religion":"religion","remote-work":"remote-work","san-francisco":"san-francisco","science":"science","self":"self","self-driving-cars":"self-driving-cars","sexuality":"sexuality","social-media":"social-media","society":"society","software-engineering":"software-engineering","space":"space","spirituality":"spirituality","sports":"sports","startups":"startup","style":"style","technology":"technology","transportation":"transportation","travel":"travel","true-crime":"true-crime","tv":"tv","ux":"ux","venture-capital":"venture-capital","visual-design":"visual-design","work":"work","world":"world","writing":"writing"},"defaultImages":{"avatar":{"imageId":"1*dmbNkD5D-u45r44go_cf0g.png","height":150,"width":150},"orgLogo":{"imageId":"7*V1_7XP4snlmqrc_0Njontw.png","height":110,"width":500},"postLogo":{"imageId":"bd978bb536350a710e8efb012513429cabdc4c28700604261aeda246d0f980b7","height":810,"width":1440},"postPreviewImage":{"imageId":"1*hn4v1tCaJy7cWMyb0bpNpQ.png","height":386,"width":579}},"collectionStructuredData":{"8d6b8a439e32":{"name":"Elemental","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F980\u002F1*9ygdqoKprhwuTVKUM0DLPA@2x.png","width":980,"height":159}}},"3f6ecf56618":{"name":"Forge","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F596\u002F1*uULpIlImcO5TDuBZ6lm7Lg@2x.png","width":596,"height":183}}},"ae2a65f35510":{"name":"GEN","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F264\u002F1*RdVZMdvfV3YiZTw6mX7yWA.png","width":264,"height":140}}},"88d9857e584e":{"name":"LEVEL","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*JqYMhNX6KNNb2UlqGqO2WQ.png","width":540,"height":108}}},"7b6769f2748b":{"name":"Marker","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F383\u002F1*haCUs0wF6TgOOvfoY-jEoQ@2x.png","width":383,"height":92}}},"444d13b52878":{"name":"OneZero","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*cw32fIqCbRWzwJaoQw6BUg.png","width":540,"height":123}}},"8ccfed20cbb2":{"name":"Zora","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*tZUQqRcCCZDXjjiZ4bDvgQ.png","width":540,"height":106}}}},"embeddedPostIds":{"coronavirus":"cd3010f9d81f"},"sharedCdcMessaging":{"COVID_APPLICABLE_TAG_SLUGS":[],"COVID_APPLICABLE_TOPIC_NAMES":[],"COVID_APPLICABLE_TOPIC_NAMES_FOR_TOPIC_PAGE":[],"COVID_MESSAGES":{"tierA":{"text":"For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":66,"end":73,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"tierB":{"text":"Anyone can publish on Medium per our Policies, but we don’t fact-check every story. For more info about the coronavirus, see cdc.gov.","markups":[{"start":37,"end":45,"href":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Fcategories\u002F201931128-Policies-Safety"},{"start":125,"end":132,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"paywall":{"text":"This article has been made free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":56,"end":70,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":138,"end":145,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"unbound":{"text":"This article is free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":45,"end":59,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":127,"end":134,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]}},"COVID_BANNER_POST_ID_OVERRIDE_WHITELIST":["3b31a67bff4a"]},"sharedVoteMessaging":{"TAGS":["politics","election-2020","government","us-politics","election","2020-presidential-race","trump","donald-trump","democrats","republicans","congress","republican-party","democratic-party","biden","joe-biden","maga"],"TOPICS":["politics","election"],"MESSAGE":{"text":"Find out more about the U.S. election results here.","markups":[{"start":46,"end":50,"href":"https:\u002F\u002Fcookpolitical.com\u002F2020-national-popular-vote-tracker"}]},"EXCLUDE_POSTS":["397ef29e3ca5"]},"embedPostRules":[],"recircOptions":{"v1":{"limit":3},"v2":{"limit":8}},"braintreeClientKey":"production_zjkj96jm_m56f8fqpf7ngnrd4","braintree":{"enabled":true,"merchantId":"m56f8fqpf7ngnrd4","merchantAccountId":{"usd":"AMediumCorporation_instant","eur":"amediumcorporation_EUR","cad":"amediumcorporation_CAD"},"publicKey":"ds2nn34bg2z7j5gd","braintreeEnvironment":"production","dashboardUrl":"https:\u002F\u002Fwww.braintreegateway.com\u002Fmerchants","gracePeriodDurationInDays":14,"mediumMembershipPlanId":{"monthly":"ce105f8c57a3","monthlyV2":"e8a5e126-792b-4ee6-8fba-d574c1b02fc5","monthlyWithTrial":"d5ee3dbe3db8","monthlyPremium":"fa741a9b47a2","yearly":"a40ad4a43185","yearlyV2":"3815d7d6-b8ca-4224-9b8c-182f9047866e","yearlyStaff":"d74fb811198a","yearlyWithTrial":"b3bc7350e5c7","yearlyPremium":"e21bd2c12166","monthlyOneYearFree":"e6c0637a-2bad-4171-ab4f-3c268633d83c","monthly25PercentOffFirstYear":"235ecc62-0cdb-49ae-9378-726cd21c504b","monthly20PercentOffFirstYear":"ba518864-9c13-4a99-91ca-411bf0cac756","monthly15PercentOffFirstYear":"594c029b-9f89-43d5-88f8-8173af4e070e","monthly10PercentOffFirstYear":"c6c7bc9a-40f2-4b51-8126-e28511d5bdb0","monthlyForStudents":"629ebe51-da7d-41fd-8293-34cd2f2030a8","yearlyOneYearFree":"78ba7be9-0d9f-4ece-aa3e-b54b826f2bf1","yearly25PercentOffFirstYear":"2dbb010d-bb8f-4eeb-ad5c-a08509f42d34","yearly20PercentOffFirstYear":"47565488-435b-47f8-bf93-40d5fbe0ebc8","yearly15PercentOffFirstYear":"8259809b-0881-47d9-acf7-6c001c7f720f","yearly10PercentOffFirstYear":"9dd694fb-96e1-472c-8d9e-3c868d5c1506","yearlyForStudents":"e29345ef-ab1c-4234-95c5-70e50fe6bc23","monthlyCad":"p52orjkaceei","yearlyCad":"h4q9g2up9ktt"},"braintreeDiscountId":{"oneMonthFree":"MONTHS_FREE_01","threeMonthsFree":"MONTHS_FREE_03","sixMonthsFree":"MONTHS_FREE_06","fiftyPercentOffOneYear":"FIFTY_PERCENT_OFF_ONE_YEAR"},"3DSecureVersion":"2","defaultCurrency":"usd","providerPlanIdCurrency":{"4ycw":"usd","rz3b":"usd","3kqm":"usd","jzw6":"usd","c2q2":"usd","nnsw":"usd","q8qw":"usd","d9y6":"usd","fx7w":"cad","nwf2":"cad"}},"paypalClientId":"AXj1G4fotC2GE8KzWX9mSxCH1wmPE3nJglf4Z2ig_amnhvlMVX87otaq58niAg9iuLktVNF_1WCMnN7v","paypal":{"host":"https:\u002F\u002Fapi.paypal.com:443","clientMode":"production","serverMode":"live","webhookId":"4G466076A0294510S","monthlyPlan":{"planId":"P-9WR0658853113943TMU5FDQA","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlan":{"planId":"P-7N8963881P8875835MU5JOPQ","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oneYearGift":{"name":"Medium Membership (1 Year, Digital Gift Code)","description":"Unlimited access to the best and brightest stories on Medium. Gift codes can be redeemed at medium.com\u002Fredeem.","price":"50.00","currency":"USD","sku":"membership-gift-1-yr"},"oldMonthlyPlan":{"planId":"P-96U02458LM656772MJZUVH2Y","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlan":{"planId":"P-59P80963JF186412JJZU3SMI","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"monthlyPlanWithTrial":{"planId":"P-66C21969LR178604GJPVKUKY","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlanWithTrial":{"planId":"P-6XW32684EX226940VKCT2MFA","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oldMonthlyPlanNoSetupFee":{"planId":"P-4N046520HR188054PCJC7LJI","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlanNoSetupFee":{"planId":"P-7A4913502Y5181304CJEJMXQ","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"sdkUrl":"https:\u002F\u002Fwww.paypal.com\u002Fsdk\u002Fjs"},"stripePublishableKey":"pk_live_7FReX44VnNIInZwrIIx6ghjl","log":{"json":true,"level":"info"},"imageUploadMaxSizeMb":25,"staffPicks":{"title":"Staff Picks","catalogId":"c7bc6e1ee00f"}},"session":{"xsrf":""}}</script><script>window.__APOLLO_STATE__ = {"ROOT_QUERY":{"__typename":"Query","variantFlags":[{"__typename":"VariantFlag","name":"disable_partner_program_enrollment","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_client","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"limit_post_referrers","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"can_send_tips_v0","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_android_dynamic_aspirational_paywall","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_apple_pay","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_explicit_signals_updated_post_previews","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_simplified_digest_v2_b","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_switch_plan_premium_tier","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_susi_redesign_ios","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"browsable_stream_config_bucket","valueType":{"__typename":"VariantFlagString","value":"curated-topics"}},{"__typename":"VariantFlag","name":"coronavirus_topic_recirc","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_remove_twitter_onboarding_step","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lo_homepage","valueType":{"__typename":"VariantFlagString","value":"control"}},{"__typename":"VariantFlag","name":"ios_enable_friend_links_creation","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_enable_friend_links_creation","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_enable_image_sharer","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_in_app_free_trial","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"reengagement_notification_duration","valueType":{"__typename":"VariantFlagNumber"}},{"__typename":"VariantFlag","name":"enable_creator_welcome_email","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_moc_load_processor_first_story","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"allow_access","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_recommended_publishers_query","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_google_webhook","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"crm_send_contact_to_sendgrid","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_tag_recs","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_android_dynamic_programming_paywall","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_aurora_pub_follower_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_premium_tier","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"rex_generator_max_candidates","valueType":{"__typename":"VariantFlagNumber"}},{"__typename":"VariantFlag","name":"allow_signup","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_enable_topic_portals","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_android_miro_v2","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_social_share_sheet","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"allow_test_auth","valueType":{"__typename":"VariantFlagString","value":"disallow"}},{"__typename":"VariantFlag","name":"enable_lite_homepage","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_speechify_widget","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ios_easy_resubscribe","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_app_flirty_thirty","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_eventstats_event_processing","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"can_receive_tips_v0","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_pre_pp_v4","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_deprecate_legacy_providers_v3","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_integration","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_enable_home_post_menu","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"reader_fair_distribution_non_qp","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_new_manage_membership_flow","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_android_offline_reading","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_import","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_moc_load_processor_c","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"textshots_userid","valueType":{"__typename":"VariantFlagString","value":""}},{"__typename":"VariantFlag","name":"available_annual_premium_plan","valueType":{"__typename":"VariantFlagString","value":"4a442ace1476"}},{"__typename":"VariantFlag","name":"enable_new_stripe_customers","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_rex_reading_history","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_sharer_create_post_share_key","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_pp_country_expansion","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_footer_app_buttons","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_newsletter_lo_flow_custom_domains","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_tribute_landing_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"glyph_font_set","valueType":{"__typename":"VariantFlagString","value":"m2-unbound-source-serif-pro"}},{"__typename":"VariantFlag","name":"available_monthly_plan","valueType":{"__typename":"VariantFlagString","value":"60e220181034"}},{"__typename":"VariantFlag","name":"enable_medium2_kbfd","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"price_smoke_test_monthly","valueType":{"__typename":"VariantFlagString","value":""}},{"__typename":"VariantFlag","name":"enable_author_cards","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_paypal","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"redefined_top_posts","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_apple_sign_in","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_bg_post_post","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_display_paywall_after_onboarding","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"skip_fs_cache_user_vals","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"available_monthly_premium_plan","valueType":{"__typename":"VariantFlagString","value":"12a660186432"}},{"__typename":"VariantFlag","name":"enable_explicit_signals","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ios_dynamic_paywall_programming","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"limit_user_follows","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_enable_lock_responses","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_seamless_social_sharing","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_tick_landing_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_enable_friend_links_postpage_banners","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_premium_tier_badge","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_intrinsic_automatic_actions","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_members_only_audio","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_android_verified_author","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_mastodon_avatar_upload","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_enable_syntax_highlight","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_auto_follow_on_subscribe","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_branch_io","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_starspace","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_conversion_model_v2","valueType":{"__typename":"VariantFlagString","value":"group_2"}},{"__typename":"VariantFlag","name":"enable_iceland_forced_android","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_author_cards_byline","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_pp_v4","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_recirc_model","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_tipping_v0_android","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_marketing_emails","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_rito_upstream_deadlines","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_iceland_nux","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"signup_services","valueType":{"__typename":"VariantFlagString","value":"twitter,facebook,google,email,google-fastidv,google-one-tap,apple"}},{"__typename":"VariantFlag","name":"enable_verifications_service","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_legacy_feed_in_iceland","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_server_upstream_deadlines","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_mastodon_for_members_username_selection","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_cache_less_following_feed","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_continue_this_thread","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_susi_redesign_android","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_tipping_v0_ios","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_enable_lists_v2","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"available_annual_plan","valueType":{"__typename":"VariantFlagString","value":"2c754bcc2995"}},{"__typename":"VariantFlag","name":"enable_configure_pronouns","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ios_offline_reading","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_sharer_validate_post_share_key","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_speechify_ios","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_update_topic_portals_wtf","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_archive_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_enable_friend_links_postpage_banners","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_rating_prompt_stories_read_threshold","valueType":{"__typename":"VariantFlagNumber"}},{"__typename":"VariantFlag","name":"enable_braintree_google_pay","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_automod","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_rex_aggregator_v2","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_update_explore_wtf","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_enable_verified_book_author","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"onboarding_tags_from_top_views","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_two_hour_refresh","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_mastodon_for_members","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_pill_based_home_feed","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_response_markup","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_google_one_tap","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_indexeddb","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_maim_the_meter","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"price_smoke_test_yearly","valueType":{"__typename":"VariantFlagString","value":""}},{"__typename":"VariantFlag","name":"enable_ml_rank_rex_anno","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_see_pronouns","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_updated_pub_recs_ui","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_entities_to_follow_v2","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ios_autorefresh","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_apple_webhook","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_trial_membership","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_enable_editor_new_publishing_flow","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_rex_new_push_notification_endpoint","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_webhook","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_recaptcha_enterprise","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"mobile_custom_app_icon","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"signin_services","valueType":{"__typename":"VariantFlagString","value":"twitter,facebook,google,email,google-fastidv,google-one-tap,apple"}},{"__typename":"VariantFlag","name":"enable_group_gifting","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_moc_load_processor_all_recs_surfaces","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_diversification_rex","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ios_dynamic_paywall_aspiriational","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_sprig","valueType":{"__typename":"VariantFlagBoolean","value":true}}],"viewer":null,"collectionByDomainOrSlug({\"domainOrSlug\":\"overcast.blog\"})":{"__ref":"Collection:9bad45fbe16d"},"postResult({\"id\":\"5660a95fd8fc\"})":{"__ref":"Post:5660a95fd8fc"}},"Collection:9bad45fbe16d":{"__typename":"Collection","id":"9bad45fbe16d","customStyleSheet":null,"colorPalette":{"__typename":"ColorPalette","highlightSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FFFFFFFF","colorPoints":[{"__typename":"ColorPoint","color":"#FFFFFFFF","point":0},{"__typename":"ColorPoint","color":"#FFE8F3E8","point":0.1},{"__typename":"ColorPoint","color":"#FFE8F3E8","point":0.2},{"__typename":"ColorPoint","color":"#FFD1E7D1","point":0.6},{"__typename":"ColorPoint","color":"#FFA3D0A2","point":1}]},"defaultBackgroundSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FFFFFFFF","colorPoints":[{"__typename":"ColorPoint","color":"#FF1A8917","point":0},{"__typename":"ColorPoint","color":"#FF11800E","point":0.1},{"__typename":"ColorPoint","color":"#FF0F730C","point":0.2},{"__typename":"ColorPoint","color":"#FF095407","point":1}]},"tintBackgroundSpectrum":null},"favicon":{"__ref":"ImageMetadata:1*hC4pCAXASl2ZiwjKBtISBg.jpeg"},"googleAnalyticsId":null,"editors":[{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:e840bf2eef66"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:f9295a2addf6"}}],"name":"overcast blog","avatar":{"__ref":"ImageMetadata:1*hC4pCAXASl2ZiwjKBtISBg.jpeg"},"domain":"overcast.blog","slug":"overcast-blog","description":"Cloud-Native Engineering: Kubernetes, Docker, Micro-services, AWS, Azure, GCP & more.","subscriberCount":548,"viewerEdge":{"__ref":"CollectionViewerEdge:collectionId:9bad45fbe16d-viewerId:lo_6c2ed6ac3cac"},"twitterUsername":"dailycloudblog","facebookPageId":null,"logo":{"__ref":"ImageMetadata:1*hC4pCAXASl2ZiwjKBtISBg.jpeg"}},"ImageMetadata:1*hC4pCAXASl2ZiwjKBtISBg.jpeg":{"__typename":"ImageMetadata","id":"1*hC4pCAXASl2ZiwjKBtISBg.jpeg","originalWidth":960,"originalHeight":540},"User:e840bf2eef66":{"__typename":"User","id":"e840bf2eef66","name":"DavidW (skyDragon)","username":"dskydragon","newsletterV3":{"__ref":"NewsletterV3:b4e2c9baad5c"},"linkedAccounts":{"__ref":"LinkedAccounts:e840bf2eef66"},"isSuspended":false,"imageId":"1*hERaxFU_P3qPjslbAw6bDw.png","mediumMemberAt":0,"verifications":{"__typename":"VerifiedInfo","isBookAuthor":false},"socialStats":{"__typename":"SocialStats","followerCount":12644},"customDomainState":null,"hasSubdomain":false,"bio":"Into cloud-native architectures and tools like K8S, Docker, Microservices. I write code to help clouds stay afloat and guides that take people to the clouds.","isPartnerProgramEnrolled":false,"viewerEdge":{"__ref":"UserViewerEdge:userId:e840bf2eef66-viewerId:lo_6c2ed6ac3cac"},"viewerIsUser":false,"postSubscribeMembershipUpsellShownAt":0,"allowNotes":true,"twitterScreenName":"","membership":null},"User:f9295a2addf6":{"__typename":"User","id":"f9295a2addf6"},"LinkedAccounts:e840bf2eef66":{"__typename":"LinkedAccounts","mastodon":null,"id":"e840bf2eef66"},"UserViewerEdge:userId:e840bf2eef66-viewerId:lo_6c2ed6ac3cac":{"__typename":"UserViewerEdge","id":"userId:e840bf2eef66-viewerId:lo_6c2ed6ac3cac","isFollowing":false,"isUser":false,"isMuting":false},"NewsletterV3:b4e2c9baad5c":{"__typename":"NewsletterV3","id":"b4e2c9baad5c","type":"NEWSLETTER_TYPE_AUTHOR","slug":"e840bf2eef66","name":"e840bf2eef66","collection":null,"user":{"__ref":"User:e840bf2eef66"}},"Paragraph:0792ca426880_0":{"__typename":"Paragraph","id":"0792ca426880_0","name":"0c09","type":"H3","href":null,"layout":null,"metadata":null,"text":"Building a Metrics System with Thanos and Kubernetes","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*QobsYEWqhoc_8s3tyB1Jlg.png":{"__typename":"ImageMetadata","id":"1*QobsYEWqhoc_8s3tyB1Jlg.png","originalHeight":650,"originalWidth":985,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:0792ca426880_1":{"__typename":"Paragraph","id":"0792ca426880_1","name":"75e1","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*QobsYEWqhoc_8s3tyB1Jlg.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_2":{"__typename":"Paragraph","id":"0792ca426880_2","name":"cc98","type":"P","href":null,"layout":null,"metadata":null,"text":"Metrics are the backbone of observability in any distributed system, and in Kubernetes environments, Prometheus is often the tool of choice.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_3":{"__typename":"Paragraph","id":"0792ca426880_3","name":"3f76","type":"P","href":null,"layout":null,"metadata":null,"text":"However, scaling Prometheus and retaining long-term metrics data can be challenging. Thanos is a project that extends Prometheus with additional capabilities, such as scalable storage, global querying across multiple Prometheus instances, and highly available metrics. This article explores how to build a robust, scalable, and resilient metrics system using Thanos on Kubernetes, covering everything from setup to best practices.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_4":{"__typename":"Paragraph","id":"0792ca426880_4","name":"cdf8","type":"H3","href":null,"layout":null,"metadata":null,"text":"What the H#ck is a Metrics System with Thanos and Kubernetes?","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_5":{"__typename":"Paragraph","id":"0792ca426880_5","name":"e52f","type":"P","href":null,"layout":null,"metadata":null,"text":"A metrics system built with Thanos and Kubernetes is like taking your Prometheus monitoring to the next level. Prometheus is fantastic for scraping and storing metrics from your Kubernetes clusters, but it hits limits when you need to scale, store metrics long-term, or query across multiple clusters. Enter Thanos, a tool that layers on top of Prometheus to solve these problems by offering scalable storage, global querying across clusters, and high availability for failover and redundancy.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":28,"end":49,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":308,"end":314,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":392,"end":408,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":410,"end":425,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":447,"end":464,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_6":{"__typename":"Paragraph","id":"0792ca426880_6","name":"061b","type":"P","href":null,"layout":null,"metadata":null,"text":"With Thanos, you’re not just collecting metrics; you’re building a resilient system that allows you to store and access metrics across distributed environments without the typical headaches of managing multiple Prometheus instances independently. This makes Thanos a go-to solution for organizations with large-scale Kubernetes deployments or those looking to retain metrics for long-term analysis.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_7":{"__typename":"Paragraph","id":"0792ca426880_7","name":"6a8e","type":"H3","href":null,"layout":null,"metadata":null,"text":"Why Do I Need One?","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_8":{"__typename":"Paragraph","id":"0792ca426880_8","name":"1148","type":"P","href":null,"layout":null,"metadata":null,"text":"If you’re just running a small Kubernetes cluster, Prometheus alone might be enough for you. But once your cluster scales, or you have multiple clusters across different regions or environments, Prometheus on its own starts to show limitations:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":195,"end":243,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_9":{"__typename":"Paragraph","id":"0792ca426880_9","name":"74a7","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Metrics Retention: Prometheus wasn’t designed for long-term storage. You might want to store metrics for months or years, but Prometheus will only retain data for a limited period.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":17,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_10":{"__typename":"Paragraph","id":"0792ca426880_10","name":"9c87","type":"ULI","href":null,"layout":null,"metadata":null,"text":"High Availability: Prometheus doesn’t offer built-in redundancy. If your Prometheus instance goes down, you lose metrics data until it’s back online.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":17,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_11":{"__typename":"Paragraph","id":"0792ca426880_11","name":"6fa9","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Global Queries: Prometheus is a single-node system, so querying across multiple clusters isn’t supported natively.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":14,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_12":{"__typename":"Paragraph","id":"0792ca426880_12","name":"2f7d","type":"P","href":null,"layout":null,"metadata":null,"text":"Thanos solves these problems by extending Prometheus with cloud-native features that allow you to store metrics in object storage (e.g., Amazon S3), query across multiple clusters in real-time, and ensure metrics availability even when components fail.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":58,"end":79,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_13":{"__typename":"Paragraph","id":"0792ca426880_13","name":"9b7c","type":"H3","href":null,"layout":null,"metadata":null,"text":"Components of a Metrics System with Thanos and Kubernetes","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_14":{"__typename":"Paragraph","id":"0792ca426880_14","name":"bfdf","type":"P","href":null,"layout":null,"metadata":null,"text":"Thanos isn’t just one tool — it’s a suite of components that work together to create a full-featured metrics system:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_15":{"__typename":"Paragraph","id":"0792ca426880_15","name":"2506","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Thanos Sidecar: This runs alongside each Prometheus instance, shipping metrics data to object storage and allowing Prometheus to be part of a larger Thanos architecture.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":14,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_16":{"__typename":"Paragraph","id":"0792ca426880_16","name":"9e7d","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Querier: This component aggregates data from multiple Prometheus instances and other Thanos components, providing a unified view of your metrics.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":7,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_17":{"__typename":"Paragraph","id":"0792ca426880_17","name":"15ca","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Store Gateway: It retrieves older metrics from object storage, making it possible to query data beyond what Prometheus retains locally.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":13,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_18":{"__typename":"Paragraph","id":"0792ca426880_18","name":"ee59","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Compactor: Reduces the footprint of stored metrics by compacting and downsampling them, improving both query performance and storage efficiency.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":9,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_19":{"__typename":"Paragraph","id":"0792ca426880_19","name":"b990","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Ruler: Evaluates Prometheus-style recording and alerting rules but on historical data, enabling alerts on long-term trends.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":5,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_20":{"__typename":"Paragraph","id":"0792ca426880_20","name":"186c","type":"P","href":null,"layout":null,"metadata":null,"text":"Each of these components plays a role in ensuring that your metrics system scales as your infrastructure grows, and that you can access long-term data without managing huge Prometheus instances on their own.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_21":{"__typename":"Paragraph","id":"0792ca426880_21","name":"6958","type":"H3","href":null,"layout":null,"metadata":null,"text":"Before We Start, a Couple of Recommendations…","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_22":{"__typename":"Paragraph","id":"0792ca426880_22","name":"6aba","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Plan your storage strategy: When setting up Thanos, keep in mind that storing large volumes of metrics data in the cloud can get expensive. Choose your storage provider and lifecycle management policies wisely (e.g., move old metrics to cheaper storage tiers).","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":26,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_23":{"__typename":"Paragraph","id":"0792ca426880_23","name":"6834","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Automate deployments: Use Kubernetes tools like Helm to manage your Thanos and Prometheus deployments. This will make scaling and updating the system much easier as your infrastructure grows.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":20,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_24":{"__typename":"Paragraph","id":"0792ca426880_24","name":"bc32","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Monitor Thanos components: Don’t just monitor your applications — set up alerts for the health of your Thanos components too. If your Querier or Sidecar goes down, you’ll want to know immediately.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":25,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_25":{"__typename":"Paragraph","id":"0792ca426880_25","name":"d524","type":"P","href":null,"layout":null,"metadata":null,"text":"Now that you know why a metrics system with Thanos and Kubernetes is powerful and what components make it work, let’s dive into the setup and get everything running.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_26":{"__typename":"Paragraph","id":"0792ca426880_26","name":"0259","type":"H3","href":null,"layout":null,"metadata":null,"text":"Deploying Thanos with Kubernetes: A Real-World Tutorial","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_27":{"__typename":"Paragraph","id":"0792ca426880_27","name":"b331","type":"P","href":null,"layout":null,"metadata":null,"text":"In this step-by-step guide, we’re going to walk through deploying Thanos with Kubernetes in a real-world scenario. The goal is to set up a scalable, long-term metrics system for Kubernetes clusters using Prometheus as the core metrics collector and Thanos as the layer that extends Prometheus’ capabilities. By the end of this tutorial, you’ll have a robust, distributed system that can handle long-term storage, querying across multiple Prometheus instances, and high availability.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_28":{"__typename":"Paragraph","id":"0792ca426880_28","name":"6e1d","type":"H3","href":null,"layout":null,"metadata":null,"text":"Step 1: Install Prometheus on Kubernetes","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_29":{"__typename":"Paragraph","id":"0792ca426880_29","name":"b409","type":"P","href":null,"layout":null,"metadata":null,"text":"The first step in setting up your metrics system is to get Prometheus up and running in your Kubernetes cluster. If Prometheus isn’t installed yet, you can use Helm to deploy it quickly.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":160,"end":164,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_30":{"__typename":"Paragraph","id":"0792ca426880_30","name":"38c5","type":"P","href":null,"layout":null,"metadata":null,"text":"Begin by adding the Helm repository for Prometheus charts:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_31":{"__typename":"Paragraph","id":"0792ca426880_31","name":"b2dd","type":"PRE","href":null,"layout":null,"metadata":null,"text":"helm repo add prometheus-community https:\u002F\u002Fprometheus-community.github.io\u002Fhelm-charts\nhelm repo update","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"csharp"},"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_32":{"__typename":"Paragraph","id":"0792ca426880_32","name":"4d6a","type":"P","href":null,"layout":null,"metadata":null,"text":"Once the repository is updated, you can install Prometheus by running:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_33":{"__typename":"Paragraph","id":"0792ca426880_33","name":"013a","type":"PRE","href":null,"layout":null,"metadata":null,"text":"helm install prometheus prometheus-community\u002Fprometheus","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"bash"},"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_34":{"__typename":"Paragraph","id":"0792ca426880_34","name":"b71b","type":"P","href":null,"layout":null,"metadata":null,"text":"After running this command, Helm will install the Prometheus server, and you can check its status by listing the running pods:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_35":{"__typename":"Paragraph","id":"0792ca426880_35","name":"c6a2","type":"PRE","href":null,"layout":null,"metadata":null,"text":"kubectl get pods -l \"app=prometheus\"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"csharp"},"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_36":{"__typename":"Paragraph","id":"0792ca426880_36","name":"261d","type":"P","href":null,"layout":null,"metadata":null,"text":"If Prometheus is up and running, you’ll see one or more pods with names starting with prometheus. If the pods are not running or stuck in an error state, you may need to check the logs with:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":86,"end":96,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_37":{"__typename":"Paragraph","id":"0792ca426880_37","name":"d556","type":"PRE","href":null,"layout":null,"metadata":null,"text":"kubectl logs \u003Cprometheus-pod-name\u003E","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"xml"},"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_38":{"__typename":"Paragraph","id":"0792ca426880_38","name":"9af6","type":"H3","href":null,"layout":null,"metadata":null,"text":"Step 2: Set Up Thanos Sidecar","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_39":{"__typename":"Paragraph","id":"0792ca426880_39","name":"5f57","type":"P","href":null,"layout":null,"metadata":null,"text":"The Thanos Sidecar is crucial for integrating Prometheus with Thanos. It will run alongside Prometheus, forwarding its data to long-term storage (e.g., Amazon S3).","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_40":{"__typename":"Paragraph","id":"0792ca426880_40","name":"1ce3","type":"P","href":null,"layout":null,"metadata":null,"text":"Before configuring the sidecar, if you’re using Amazon S3, create a new S3 bucket to store the metrics:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_41":{"__typename":"Paragraph","id":"0792ca426880_41","name":"ab9c","type":"PRE","href":null,"layout":null,"metadata":null,"text":"aws s3api create-bucket --bucket my-thanos-bucket --region us-east-1","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"css"},"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_42":{"__typename":"Paragraph","id":"0792ca426880_42","name":"550f","type":"P","href":null,"layout":null,"metadata":null,"text":"Now, you need to update the Prometheus deployment to include the Thanos Sidecar. You’ll do this by adding the Thanos container to the existing Prometheus deployment. Here’s an example deployment configuration for Prometheus with Thanos Sidecar:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":213,"end":243,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_43":{"__typename":"Paragraph","id":"0792ca426880_43","name":"ba2e","type":"PRE","href":null,"layout":null,"metadata":null,"text":"apiVersion: apps\u002Fv1\nkind: Deployment\nmetadata:\n  name: prometheus\nspec:\n  replicas: 1\n  template:\n    spec:\n      containers:\n      - name: prometheus\n        image: prom\u002Fprometheus:v2.43.0\n        args:\n          - \"--config.file=\u002Fetc\u002Fprometheus\u002Fprometheus.yml\"\n          - \"--storage.tsdb.path=\u002Fprometheus\"\n        ports:\n          - containerPort: 9090\n      - name: thanos-sidecar\n        image: quay.io\u002Fthanos\u002Fthanos:v0.32.1\n        args:\n          - sidecar\n          - --tsdb.path=\u002Fprometheus\n          - --objstore.config-file=\u002Fetc\u002Fthanos\u002Fs3.yaml\n        ports:\n          - containerPort: 10902\n        volumeMounts:\n          - name: prometheus-data\n            mountPath: \u002Fprometheus\n          - name: s3-config\n            mountPath: \u002Fetc\u002Fthanos\u002Fs3.yaml\n            subPath: s3.yaml\nvolumes:\n  - name: s3-config\n    configMap:\n      name: s3-config","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"yaml"},"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_44":{"__typename":"Paragraph","id":"0792ca426880_44","name":"3ac9","type":"P","href":null,"layout":null,"metadata":null,"text":"Make sure you create the s3.yaml file containing the necessary S3 credentials for your bucket:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":25,"end":32,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_45":{"__typename":"Paragraph","id":"0792ca426880_45","name":"9d3f","type":"PRE","href":null,"layout":null,"metadata":null,"text":"type: S3\nconfig:\n  bucket: my-thanos-bucket\n  endpoint: s3.amazonaws.com\n  region: us-east-1\n  access_key: YOUR_ACCESS_KEY\n  secret_key: YOUR_SECRET_KEY","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"yaml"},"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_46":{"__typename":"Paragraph","id":"0792ca426880_46","name":"20d8","type":"P","href":null,"layout":null,"metadata":null,"text":"Once you’ve configured the sidecar, apply the changes to your Kubernetes cluster:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_47":{"__typename":"Paragraph","id":"0792ca426880_47","name":"5e92","type":"PRE","href":null,"layout":null,"metadata":null,"text":"kubectl apply -f prometheus-thanos-deployment.yaml","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"typescript"},"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_48":{"__typename":"Paragraph","id":"0792ca426880_48","name":"5ffb","type":"P","href":null,"layout":null,"metadata":null,"text":"This will deploy both Prometheus and the Thanos sidecar, and the sidecar will start sending Prometheus data to the S3 bucket.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_49":{"__typename":"Paragraph","id":"0792ca426880_49","name":"30a8","type":"H3","href":null,"layout":null,"metadata":null,"text":"Step 3: Deploy the Thanos Querier","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_50":{"__typename":"Paragraph","id":"0792ca426880_50","name":"2605","type":"P","href":null,"layout":null,"metadata":null,"text":"The Thanos Querier allows you to query data across multiple Prometheus instances, providing a global view of your metrics. This is especially useful when you have multiple Kubernetes clusters or regions and want a unified metrics system.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":4,"end":18,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_51":{"__typename":"Paragraph","id":"0792ca426880_51","name":"6fc4","type":"P","href":null,"layout":null,"metadata":null,"text":"Here’s an example deployment for the Thanos Querier:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_52":{"__typename":"Paragraph","id":"0792ca426880_52","name":"6aee","type":"PRE","href":null,"layout":null,"metadata":null,"text":"apiVersion: apps\u002Fv1\nkind: Deployment\nmetadata:\n  name: thanos-querier\nspec:\n  replicas: 1\n  template:\n    spec:\n      containers:\n      - name: thanos-querier\n        image: quay.io\u002Fthanos\u002Fthanos:v0.32.1\n        args:\n          - query\n          - --http-address=0.0.0.0:9090\n          - --store=dnssrv+_grpc._tcp.thanos-sidecar.default.svc.cluster.local:10901\n          - --store=dnssrv+_grpc._tcp.thanos-store.default.svc.cluster.local:10901\n        ports:\n          - containerPort: 9090","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"yaml"},"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_53":{"__typename":"Paragraph","id":"0792ca426880_53","name":"c255","type":"P","href":null,"layout":null,"metadata":null,"text":"In this configuration, the Querier is set up to pull data from the Thanos Sidecar and Store Gateway via DNS service discovery. The Querier will act as a centralized point for querying metrics.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_54":{"__typename":"Paragraph","id":"0792ca426880_54","name":"d773","type":"P","href":null,"layout":null,"metadata":null,"text":"Deploy the Thanos Querier to your cluster by applying the YAML:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_55":{"__typename":"Paragraph","id":"0792ca426880_55","name":"f127","type":"PRE","href":null,"layout":null,"metadata":null,"text":"kubectl apply -f thanos-querier-deployment.yaml","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"typescript"},"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_56":{"__typename":"Paragraph","id":"0792ca426880_56","name":"49f3","type":"P","href":null,"layout":null,"metadata":null,"text":"To test the Querier, forward the service port to your local machine:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_57":{"__typename":"Paragraph","id":"0792ca426880_57","name":"d095","type":"PRE","href":null,"layout":null,"metadata":null,"text":"kubectl port-forward svc\u002Fthanos-querier 9090:9090","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"bash"},"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_58":{"__typename":"Paragraph","id":"0792ca426880_58","name":"ce2a","type":"P","href":null,"layout":null,"metadata":null,"text":"Now, open your browser and go to http:\u002F\u002Flocalhost:9090 to interact with the Thanos Querier UI and start querying data across Prometheus instances.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":33,"end":54,"href":"http:\u002F\u002Flocalhost:9090","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":33,"end":54,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_59":{"__typename":"Paragraph","id":"0792ca426880_59","name":"aba6","type":"H3","href":null,"layout":null,"metadata":null,"text":"Step 4: Deploy Thanos Store Gateway","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_60":{"__typename":"Paragraph","id":"0792ca426880_60","name":"8e20","type":"P","href":null,"layout":null,"metadata":null,"text":"The Thanos Store Gateway retrieves historical metrics stored in the S3 bucket. This allows you to query data beyond the retention limits of Prometheus itself.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":11,"end":24,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_61":{"__typename":"Paragraph","id":"0792ca426880_61","name":"71ad","type":"P","href":null,"layout":null,"metadata":null,"text":"Here’s an example configuration for the Thanos Store Gateway deployment:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_62":{"__typename":"Paragraph","id":"0792ca426880_62","name":"48df","type":"PRE","href":null,"layout":null,"metadata":null,"text":"apiVersion: apps\u002Fv1\nkind: Deployment\nmetadata:\n  name: thanos-store\nspec:\n  replicas: 1\n  template:\n    spec:\n      containers:\n      - name: thanos-store\n        image: quay.io\u002Fthanos\u002Fthanos:v0.32.1\n        args:\n          - store\n          - --data-dir=\u002Fdata\n          - --objstore.config-file=\u002Fetc\u002Fthanos\u002Fs3.yaml\n        ports:\n          - containerPort: 10901\n        volumeMounts:\n          - name: data\n            mountPath: \u002Fdata\n          - name: s3-config\n            mountPath: \u002Fetc\u002Fthanos\u002Fs3.yaml\n            subPath: s3.yaml\nvolumes:\n  - name: data\n    emptyDir: {}\n  - name: s3-config\n    configMap:\n      name: s3-config","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"yaml"},"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_63":{"__typename":"Paragraph","id":"0792ca426880_63","name":"8ada","type":"P","href":null,"layout":null,"metadata":null,"text":"Apply this configuration to deploy the Thanos Store Gateway:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_64":{"__typename":"Paragraph","id":"0792ca426880_64","name":"a6fa","type":"PRE","href":null,"layout":null,"metadata":null,"text":"kubectl apply -f thanos-store-deployment.yaml","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"typescript"},"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_65":{"__typename":"Paragraph","id":"0792ca426880_65","name":"a107","type":"P","href":null,"layout":null,"metadata":null,"text":"The Store Gateway will start retrieving older metrics from your S3 bucket, making them available for queries through the Thanos Querier.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_66":{"__typename":"Paragraph","id":"0792ca426880_66","name":"6492","type":"H3","href":null,"layout":null,"metadata":null,"text":"Step 5: Verify and Test Your Setup","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_67":{"__typename":"Paragraph","id":"0792ca426880_67","name":"c990","type":"P","href":null,"layout":null,"metadata":null,"text":"Once all the Thanos components are running, you should test the entire setup to ensure that metrics are being stored and queried correctly.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_68":{"__typename":"Paragraph","id":"0792ca426880_68","name":"d1bb","type":"P","href":null,"layout":null,"metadata":null,"text":"Start by checking that all your Prometheus and Thanos pods are running:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_69":{"__typename":"Paragraph","id":"0792ca426880_69","name":"4d0b","type":"PRE","href":null,"layout":null,"metadata":null,"text":"kubectl get pods","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"csharp"},"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_70":{"__typename":"Paragraph","id":"0792ca426880_70","name":"4381","type":"P","href":null,"layout":null,"metadata":null,"text":"If everything is running as expected, use the Thanos Querier UI to execute queries. Verify that you can retrieve both recent and historical data from the S3 bucket.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_71":{"__typename":"Paragraph","id":"0792ca426880_71","name":"5bad","type":"P","href":null,"layout":null,"metadata":null,"text":"You can also check the logs of the Thanos components to ensure they are communicating correctly:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_72":{"__typename":"Paragraph","id":"0792ca426880_72","name":"0137","type":"PRE","href":null,"layout":null,"metadata":null,"text":"kubectl logs \u003Cthanos-querier-pod-name\u003E\nkubectl logs \u003Cthanos-store-pod-name\u003E\nkubectl logs \u003Cthanos-sidecar-pod-name\u003E","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"xml"},"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_73":{"__typename":"Paragraph","id":"0792ca426880_73","name":"69ff","type":"P","href":null,"layout":null,"metadata":null,"text":"If any component isn’t working as expected, these logs will provide clues on what’s going wrong.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_74":{"__typename":"Paragraph","id":"0792ca426880_74","name":"80be","type":"H3","href":null,"layout":null,"metadata":null,"text":"Best Practices","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_75":{"__typename":"Paragraph","id":"0792ca426880_75","name":"17e8","type":"H3","href":null,"layout":null,"metadata":null,"text":"Best Practices for a Metrics System with Thanos and Kubernetes","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_76":{"__typename":"Paragraph","id":"0792ca426880_76","name":"7099","type":"P","href":null,"layout":null,"metadata":null,"text":"Deploying Thanos on Kubernetes is a powerful way to manage metrics at scale, but to ensure that your setup performs efficiently and remains cost-effective, there are several best practices to follow. These will not only improve performance but also reduce overhead and make long-term metric retention more manageable.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_77":{"__typename":"Paragraph","id":"0792ca426880_77","name":"02cd","type":"H3","href":null,"layout":null,"metadata":null,"text":"Use Downsampling to Reduce Query Load","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_78":{"__typename":"Paragraph","id":"0792ca426880_78","name":"0b6f","type":"P","href":null,"layout":null,"metadata":null,"text":"As the volume of metrics grows, querying the data can become slow and resource-intensive. This is where downsampling comes into play. Downsampling aggregates older metrics, reducing their granularity while preserving essential trends over time. By configuring Thanos Compactor to downsample your metrics, you can significantly improve query performance, reduce storage costs, and lighten the load on your object storage.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":104,"end":116,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":260,"end":276,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_79":{"__typename":"Paragraph","id":"0792ca426880_79","name":"588f","type":"P","href":null,"layout":null,"metadata":null,"text":"In a typical Thanos setup, the Compactor handles two tasks: compacting time series into smaller blocks and downsampling older data. Here’s an example of how to configure the Compactor:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":31,"end":40,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_80":{"__typename":"Paragraph","id":"0792ca426880_80","name":"9af7","type":"PRE","href":null,"layout":null,"metadata":null,"text":"apiVersion: apps\u002Fv1\nkind: Deployment\nmetadata:\n  name: thanos-compactor\nspec:\n  replicas: 1\n  template:\n    spec:\n      containers:\n      - name: thanos-compactor\n        image: quay.io\u002Fthanos\u002Fthanos:v0.32.1\n        args:\n          - compact\n          - --data-dir=\u002Fdata\n          - --objstore.config-file=\u002Fetc\u002Fthanos\u002Fs3.yaml\n          - --retention.resolution-raw=30d\n          - --retention.resolution-5m=180d\n          - --retention.resolution-1h=1y\n        volumeMounts:\n          - name: data\n            mountPath: \u002Fdata\n          - name: s3-config\n            mountPath: \u002Fetc\u002Fthanos\u002Fs3.yaml\n            subPath: s3.yaml\nvolumes:\n  - name: data\n    emptyDir: {}\n  - name: s3-config\n    configMap:\n      name: s3-config","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"yaml"},"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_81":{"__typename":"Paragraph","id":"0792ca426880_81","name":"d136","type":"P","href":null,"layout":null,"metadata":null,"text":"In this configuration, the Compactor is set to retain raw, high-resolution data for 30 days, 5-minute downsampled data for 180 days, and 1-hour downsampled data for a year. The Compactor automatically creates these downsampled blocks, making it easier to query historical data without burdening the system.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":27,"end":36,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_82":{"__typename":"Paragraph","id":"0792ca426880_82","name":"8d24","type":"P","href":null,"layout":null,"metadata":null,"text":"Make sure to tune the retention periods based on your data needs and storage capacity. Downsampling is ideal when you don’t need fine-grained detail for older metrics but still want to preserve long-term trends for analysis or compliance.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_83":{"__typename":"Paragraph","id":"0792ca426880_83","name":"7036","type":"H3","href":null,"layout":null,"metadata":null,"text":"Leverage Kubernetes Service Discovery","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_84":{"__typename":"Paragraph","id":"0792ca426880_84","name":"21a9","type":"P","href":null,"layout":null,"metadata":null,"text":"Thanos Querier can automatically discover Prometheus instances using Kubernetes service discovery. This simplifies the process of scaling up or down without having to manually configure new Prometheus instances. Kubernetes’ native DNS-based service discovery allows Thanos to dynamically discover services within the cluster, making the system more flexible and easier to manage.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":69,"end":97,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_85":{"__typename":"Paragraph","id":"0792ca426880_85","name":"061f","type":"P","href":null,"layout":null,"metadata":null,"text":"To enable service discovery in Thanos Querier, you can modify the deployment configuration as follows:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_86":{"__typename":"Paragraph","id":"0792ca426880_86","name":"5b8e","type":"PRE","href":null,"layout":null,"metadata":null,"text":"apiVersion: apps\u002Fv1\nkind: Deployment\nmetadata:\n  name: thanos-querier\nspec:\n  replicas: 1\n  template:\n    spec:\n      containers:\n      - name: thanos-querier\n        image: quay.io\u002Fthanos\u002Fthanos:v0.32.1\n        args:\n          - query\n          - --http-address=0.0.0.0:9090\n          - --store=dnssrv+_grpc._tcp.prometheus.default.svc.cluster.local:10901\n          - --store=dnssrv+_grpc._tcp.thanos-store.default.svc.cluster.local:10901","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"yaml"},"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_87":{"__typename":"Paragraph","id":"0792ca426880_87","name":"d69c","type":"P","href":null,"layout":null,"metadata":null,"text":"In this setup, the dnssrv address is used to auto-discover any Prometheus instances and Thanos Store Gateways running within the Kubernetes cluster. By leveraging Kubernetes DNS-based service discovery, Thanos can dynamically scale without any manual configuration when new Prometheus instances are added.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":19,"end":25,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_88":{"__typename":"Paragraph","id":"0792ca426880_88","name":"12d8","type":"H3","href":null,"layout":null,"metadata":null,"text":"Secure Object Storage Access","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_89":{"__typename":"Paragraph","id":"0792ca426880_89","name":"9ff9","type":"P","href":null,"layout":null,"metadata":null,"text":"When using cloud object storage like Amazon S3 or Google Cloud Storage for storing your metrics, securing the access credentials is critical. Instead of hardcoding the credentials in your YAML files, you should use Kubernetes Secrets to manage sensitive information like your object storage access keys.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":37,"end":46,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":50,"end":70,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":215,"end":233,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_90":{"__typename":"Paragraph","id":"0792ca426880_90","name":"b1f6","type":"P","href":null,"layout":null,"metadata":null,"text":"Here’s how to securely store your S3 credentials in a Kubernetes Secret:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_91":{"__typename":"Paragraph","id":"0792ca426880_91","name":"0206","type":"PRE","href":null,"layout":null,"metadata":null,"text":"kubectl create secret generic s3-credentials \\\n  --from-literal=access_key=YOUR_ACCESS_KEY \\\n  --from-literal=secret_key=YOUR_SECRET_KEY","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"lua"},"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_92":{"__typename":"Paragraph","id":"0792ca426880_92","name":"9599","type":"P","href":null,"layout":null,"metadata":null,"text":"Once the secret is created, reference it in your Thanos sidecar or store configurations:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_93":{"__typename":"Paragraph","id":"0792ca426880_93","name":"1c86","type":"PRE","href":null,"layout":null,"metadata":null,"text":"apiVersion: apps\u002Fv1\nkind: Deployment\nmetadata:\n  name: thanos-sidecar\nspec:\n  replicas: 1\n  template:\n    spec:\n      containers:\n      - name: thanos-sidecar\n        image: quay.io\u002Fthanos\u002Fthanos:v0.32.1\n        args:\n          - sidecar\n          - --tsdb.path=\u002Fprometheus\n          - --objstore.config-file=\u002Fetc\u002Fthanos\u002Fs3.yaml\n        env:\n        - name: S3_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: s3-credentials\n              key: access_key\n        - name: S3_SECRET_KEY\n          valueFrom:\n            secretKeyRef:\n              name: s3-credentials\n              key: secret_key\n        volumeMounts:\n          - name: s3-config\n            mountPath: \u002Fetc\u002Fthanos\u002Fs3.yaml\n            subPath: s3.yaml","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"yaml"},"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_94":{"__typename":"Paragraph","id":"0792ca426880_94","name":"eb34","type":"P","href":null,"layout":null,"metadata":null,"text":"By using Kubernetes Secrets, you ensure that your access keys are encrypted and safely stored, reducing the risk of accidental exposure.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":9,"end":27,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_95":{"__typename":"Paragraph","id":"0792ca426880_95","name":"bf34","type":"H3","href":null,"layout":null,"metadata":null,"text":"Monitor Thanos Components","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_96":{"__typename":"Paragraph","id":"0792ca426880_96","name":"2cd4","type":"P","href":null,"layout":null,"metadata":null,"text":"Monitoring the health of your Thanos components is just as important as monitoring the health of your applications. If any Thanos component like the Querier, Sidecar, or Store Gateway fails, it could impact your metrics system, leading to missing data or failed queries.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_97":{"__typename":"Paragraph","id":"0792ca426880_97","name":"0c03","type":"P","href":null,"layout":null,"metadata":null,"text":"The first step is to set up Prometheus alerting rules to track the status of Thanos components. For example, you can monitor the up status of Thanos instances with Prometheus using the following alerting rule:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":28,"end":53,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":129,"end":131,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_98":{"__typename":"Paragraph","id":"0792ca426880_98","name":"ed3c","type":"PRE","href":null,"layout":null,"metadata":null,"text":"groups:\n- name: thanos-alerts\n  rules:\n  - alert: ThanosDown\n    expr: up{job=\"thanos\"} == 0\n    for: 5m\n    labels:\n      severity: critical\n    annotations:\n      summary: \"Thanos instance down\"\n      description: \"The Thanos {{ $labels.instance }} instance is down for more than 5 minutes.\"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"yaml"},"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_99":{"__typename":"Paragraph","id":"0792ca426880_99","name":"3358","type":"P","href":null,"layout":null,"metadata":null,"text":"This alert will fire if any Thanos instance is down for more than 5 minutes, allowing you to quickly detect and respond to failures in the system.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_100":{"__typename":"Paragraph","id":"0792ca426880_100","name":"150d","type":"P","href":null,"layout":null,"metadata":null,"text":"You should also consider using Grafana for visualizing the performance of your Thanos components and creating dashboards that track the health and performance of each service in real-time.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":31,"end":38,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_101":{"__typename":"Paragraph","id":"0792ca426880_101","name":"42fa","type":"H3","href":null,"layout":null,"metadata":null,"text":"Optimize Storage Costs","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_102":{"__typename":"Paragraph","id":"0792ca426880_102","name":"5919","type":"P","href":null,"layout":null,"metadata":null,"text":"Storing large volumes of metrics can become costly, especially if you’re retaining high-resolution data for long periods. To optimize costs, use lifecycle policies in your object storage to automatically move older data to cheaper storage tiers like Amazon S3’s Glacier or Google Cloud Nearline Storage.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":145,"end":163,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":262,"end":269,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":273,"end":302,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_103":{"__typename":"Paragraph","id":"0792ca426880_103","name":"bbec","type":"P","href":null,"layout":null,"metadata":null,"text":"For example, in Amazon S3, you can configure a lifecycle policy that transitions older data to Glacier after 90 days:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_104":{"__typename":"Paragraph","id":"0792ca426880_104","name":"5b15","type":"PRE","href":null,"layout":null,"metadata":null,"text":"{\n  \"Rules\": [\n    {\n      \"ID\": \"MoveOlderDataToGlacier\",\n      \"Filter\": {\n        \"Prefix\": \"\"\n      },\n      \"Status\": \"Enabled\",\n      \"Transitions\": [\n        {\n          \"Days\": 90,\n          \"StorageClass\": \"GLACIER\"\n        }\n      ],\n      \"NoncurrentVersionTransitions\": [],\n      \"Expiration\": {\n        \"Days\": 365\n      }\n    }\n  ]\n}","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"json"},"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_105":{"__typename":"Paragraph","id":"0792ca426880_105","name":"b913","type":"P","href":null,"layout":null,"metadata":null,"text":"Applying this policy ensures that you’re only paying for high-performance storage for recent data, while older data is moved to a cheaper, slower storage class.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_106":{"__typename":"Paragraph","id":"0792ca426880_106","name":"462e","type":"P","href":null,"layout":null,"metadata":null,"text":"In Google Cloud Storage, you can configure a similar lifecycle rule to transition objects to Nearline or Coldline storage after a set number of days. This strategy helps in optimizing your storage costs, especially when retaining large amounts of historical metrics data.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":93,"end":101,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":105,"end":113,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_107":{"__typename":"Paragraph","id":"0792ca426880_107","name":"250d","type":"H3","href":null,"layout":null,"metadata":null,"text":"Conclusion","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_108":{"__typename":"Paragraph","id":"0792ca426880_108","name":"80d7","type":"P","href":null,"layout":null,"metadata":null,"text":"Setting up a metrics system with Thanos and Kubernetes can feel like a big task, especially when you start thinking about long-term storage, high availability, and global querying across multiple clusters. But the good news is that it doesn’t have to be a daunting process. By integrating Thanos with Prometheus, you tackle some of the biggest challenges in observability for Kubernetes environments — scalability, redundancy, and cost management.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":33,"end":39,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":44,"end":54,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_109":{"__typename":"Paragraph","id":"0792ca426880_109","name":"e077","type":"P","href":null,"layout":null,"metadata":null,"text":"Throughout this guide, I’ve walked you through deploying Prometheus and Thanos step by step, configuring downsampling, securing object storage access, and using Kubernetes service discovery. Each of these steps helps create a more robust, efficient metrics system that scales with your infrastructure. The important thing here is to keep your setup flexible, monitor the health of your components, and optimize for both performance and cost as your data grows.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_110":{"__typename":"Paragraph","id":"0792ca426880_110","name":"6b87","type":"P","href":null,"layout":null,"metadata":null,"text":"Now, I’d love to hear your thoughts! If you’ve got additional tips or encountered any interesting challenges while deploying Thanos, drop your suggestions in the comments below. Let’s make this a collaborative resource where everyone can benefit.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_111":{"__typename":"Paragraph","id":"0792ca426880_111","name":"3ba2","type":"H3","href":null,"layout":null,"metadata":null,"text":"Learn More","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0792ca426880_112":{"__typename":"Paragraph","id":"0792ca426880_112","name":"9e76","type":"MIXTAPE_EMBED","href":null,"layout":null,"metadata":null,"text":"15 Best Kubernetes Cost Optimization Tools for 2024\nFinancial times are tough, that’s no secret. Most organizations need to scale their offering to their market and…overcast.blog","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":178,"href":"https:\u002F\u002Fovercast.blog\u002F15-best-kubernetes-cost-optimization-tools-for-2024-2e131a7cbe7a","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":51,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":52,"end":165,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":{"__typename":"MixtapeMetadata","href":"https:\u002F\u002Fovercast.blog\u002F15-best-kubernetes-cost-optimization-tools-for-2024-2e131a7cbe7a","mediaResource":{"__typename":"MediaResource","mediumCatalog":null},"thumbnailImageId":"1*G8lxcyeu7A-5zwaBIfvIkw.png"}},"Paragraph:0792ca426880_113":{"__typename":"Paragraph","id":"0792ca426880_113","name":"fa3d","type":"MIXTAPE_EMBED","href":null,"layout":null,"metadata":null,"text":"11 Ways to Optimize Kubernetes Load Balancing\nOptimizing load balancing in Kubernetes is crucial for maintaining the high availability, scalability, and performance…overcast.blog","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":178,"href":"https:\u002F\u002Fovercast.blog\u002F11-ways-to-optimize-kubernetes-load-balancing-cdbab1bc785e","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":45,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":46,"end":165,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":{"__typename":"MixtapeMetadata","href":"https:\u002F\u002Fovercast.blog\u002F11-ways-to-optimize-kubernetes-load-balancing-cdbab1bc785e","mediaResource":{"__typename":"MediaResource","mediumCatalog":null},"thumbnailImageId":"1*fnZC8HU90tNmxnH5UU8yQQ.png"}},"Paragraph:0792ca426880_114":{"__typename":"Paragraph","id":"0792ca426880_114","name":"4d65","type":"MIXTAPE_EMBED","href":null,"layout":null,"metadata":null,"text":"15 Cloud-Native DevOps Tools You Should Know\nManaging dynamic and scalable environments efficiently requires cloud-native DevOps tools. These tools automate…overcast.blog","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":170,"href":"https:\u002F\u002Fovercast.blog\u002F15-cloud-native-devops-tools-you-should-know-36129057a15c","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":44,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":45,"end":157,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":{"__typename":"MixtapeMetadata","href":"https:\u002F\u002Fovercast.blog\u002F15-cloud-native-devops-tools-you-should-know-36129057a15c","mediaResource":{"__typename":"MediaResource","mediumCatalog":null},"thumbnailImageId":"1*XSfRm4mUx18FW26PBGB_nw.png"}},"Paragraph:0792ca426880_115":{"__typename":"Paragraph","id":"0792ca426880_115","name":"9586","type":"MIXTAPE_EMBED","href":null,"layout":null,"metadata":null,"text":"13 Kubernetes Automations You Should Know\nManaging Kubernetes environments manually can be challenging, especially as your infrastructure scales. Automation is…overcast.blog","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":173,"href":"https:\u002F\u002Fovercast.blog\u002F13-kubernetes-automations-you-should-know-5e92028284eb","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":41,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":42,"end":160,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":{"__typename":"MixtapeMetadata","href":"https:\u002F\u002Fovercast.blog\u002F13-kubernetes-automations-you-should-know-5e92028284eb","mediaResource":{"__typename":"MediaResource","mediumCatalog":null},"thumbnailImageId":"1*tRpb0LR1uN0cSwYRilZFFw.png"}},"CollectionViewerEdge:collectionId:9bad45fbe16d-viewerId:lo_6c2ed6ac3cac":{"__typename":"CollectionViewerEdge","id":"collectionId:9bad45fbe16d-viewerId:lo_6c2ed6ac3cac","isEditor":false,"isMuting":false},"PostViewerEdge:postId:5660a95fd8fc-viewerId:lo_6c2ed6ac3cac":{"__typename":"PostViewerEdge","shouldIndexPostForExternalSearch":true,"id":"postId:5660a95fd8fc-viewerId:lo_6c2ed6ac3cac"},"Tag:kubernetes":{"__typename":"Tag","id":"kubernetes","displayTitle":"Kubernetes","normalizedTagSlug":"kubernetes"},"Tag:devops":{"__typename":"Tag","id":"devops","displayTitle":"DevOps","normalizedTagSlug":"devops"},"Tag:programming":{"__typename":"Tag","id":"programming","displayTitle":"Programming","normalizedTagSlug":"programming"},"Tag:cloud-computing":{"__typename":"Tag","id":"cloud-computing","displayTitle":"Cloud Computing","normalizedTagSlug":"cloud-computing"},"Tag:software-development":{"__typename":"Tag","id":"software-development","displayTitle":"Software Development","normalizedTagSlug":"software-development"},"Post:5660a95fd8fc":{"__typename":"Post","id":"5660a95fd8fc","collection":{"__ref":"Collection:9bad45fbe16d"},"content({\"postMeteringOptions\":{}})":{"__typename":"PostContent","isLockedPreviewOnly":false,"bodyModel":{"__typename":"RichText","sections":[{"__typename":"Section","name":"6a1d","startIndex":0,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null}],"paragraphs":[{"__ref":"Paragraph:0792ca426880_0"},{"__ref":"Paragraph:0792ca426880_1"},{"__ref":"Paragraph:0792ca426880_2"},{"__ref":"Paragraph:0792ca426880_3"},{"__ref":"Paragraph:0792ca426880_4"},{"__ref":"Paragraph:0792ca426880_5"},{"__ref":"Paragraph:0792ca426880_6"},{"__ref":"Paragraph:0792ca426880_7"},{"__ref":"Paragraph:0792ca426880_8"},{"__ref":"Paragraph:0792ca426880_9"},{"__ref":"Paragraph:0792ca426880_10"},{"__ref":"Paragraph:0792ca426880_11"},{"__ref":"Paragraph:0792ca426880_12"},{"__ref":"Paragraph:0792ca426880_13"},{"__ref":"Paragraph:0792ca426880_14"},{"__ref":"Paragraph:0792ca426880_15"},{"__ref":"Paragraph:0792ca426880_16"},{"__ref":"Paragraph:0792ca426880_17"},{"__ref":"Paragraph:0792ca426880_18"},{"__ref":"Paragraph:0792ca426880_19"},{"__ref":"Paragraph:0792ca426880_20"},{"__ref":"Paragraph:0792ca426880_21"},{"__ref":"Paragraph:0792ca426880_22"},{"__ref":"Paragraph:0792ca426880_23"},{"__ref":"Paragraph:0792ca426880_24"},{"__ref":"Paragraph:0792ca426880_25"},{"__ref":"Paragraph:0792ca426880_26"},{"__ref":"Paragraph:0792ca426880_27"},{"__ref":"Paragraph:0792ca426880_28"},{"__ref":"Paragraph:0792ca426880_29"},{"__ref":"Paragraph:0792ca426880_30"},{"__ref":"Paragraph:0792ca426880_31"},{"__ref":"Paragraph:0792ca426880_32"},{"__ref":"Paragraph:0792ca426880_33"},{"__ref":"Paragraph:0792ca426880_34"},{"__ref":"Paragraph:0792ca426880_35"},{"__ref":"Paragraph:0792ca426880_36"},{"__ref":"Paragraph:0792ca426880_37"},{"__ref":"Paragraph:0792ca426880_38"},{"__ref":"Paragraph:0792ca426880_39"},{"__ref":"Paragraph:0792ca426880_40"},{"__ref":"Paragraph:0792ca426880_41"},{"__ref":"Paragraph:0792ca426880_42"},{"__ref":"Paragraph:0792ca426880_43"},{"__ref":"Paragraph:0792ca426880_44"},{"__ref":"Paragraph:0792ca426880_45"},{"__ref":"Paragraph:0792ca426880_46"},{"__ref":"Paragraph:0792ca426880_47"},{"__ref":"Paragraph:0792ca426880_48"},{"__ref":"Paragraph:0792ca426880_49"},{"__ref":"Paragraph:0792ca426880_50"},{"__ref":"Paragraph:0792ca426880_51"},{"__ref":"Paragraph:0792ca426880_52"},{"__ref":"Paragraph:0792ca426880_53"},{"__ref":"Paragraph:0792ca426880_54"},{"__ref":"Paragraph:0792ca426880_55"},{"__ref":"Paragraph:0792ca426880_56"},{"__ref":"Paragraph:0792ca426880_57"},{"__ref":"Paragraph:0792ca426880_58"},{"__ref":"Paragraph:0792ca426880_59"},{"__ref":"Paragraph:0792ca426880_60"},{"__ref":"Paragraph:0792ca426880_61"},{"__ref":"Paragraph:0792ca426880_62"},{"__ref":"Paragraph:0792ca426880_63"},{"__ref":"Paragraph:0792ca426880_64"},{"__ref":"Paragraph:0792ca426880_65"},{"__ref":"Paragraph:0792ca426880_66"},{"__ref":"Paragraph:0792ca426880_67"},{"__ref":"Paragraph:0792ca426880_68"},{"__ref":"Paragraph:0792ca426880_69"},{"__ref":"Paragraph:0792ca426880_70"},{"__ref":"Paragraph:0792ca426880_71"},{"__ref":"Paragraph:0792ca426880_72"},{"__ref":"Paragraph:0792ca426880_73"},{"__ref":"Paragraph:0792ca426880_74"},{"__ref":"Paragraph:0792ca426880_75"},{"__ref":"Paragraph:0792ca426880_76"},{"__ref":"Paragraph:0792ca426880_77"},{"__ref":"Paragraph:0792ca426880_78"},{"__ref":"Paragraph:0792ca426880_79"},{"__ref":"Paragraph:0792ca426880_80"},{"__ref":"Paragraph:0792ca426880_81"},{"__ref":"Paragraph:0792ca426880_82"},{"__ref":"Paragraph:0792ca426880_83"},{"__ref":"Paragraph:0792ca426880_84"},{"__ref":"Paragraph:0792ca426880_85"},{"__ref":"Paragraph:0792ca426880_86"},{"__ref":"Paragraph:0792ca426880_87"},{"__ref":"Paragraph:0792ca426880_88"},{"__ref":"Paragraph:0792ca426880_89"},{"__ref":"Paragraph:0792ca426880_90"},{"__ref":"Paragraph:0792ca426880_91"},{"__ref":"Paragraph:0792ca426880_92"},{"__ref":"Paragraph:0792ca426880_93"},{"__ref":"Paragraph:0792ca426880_94"},{"__ref":"Paragraph:0792ca426880_95"},{"__ref":"Paragraph:0792ca426880_96"},{"__ref":"Paragraph:0792ca426880_97"},{"__ref":"Paragraph:0792ca426880_98"},{"__ref":"Paragraph:0792ca426880_99"},{"__ref":"Paragraph:0792ca426880_100"},{"__ref":"Paragraph:0792ca426880_101"},{"__ref":"Paragraph:0792ca426880_102"},{"__ref":"Paragraph:0792ca426880_103"},{"__ref":"Paragraph:0792ca426880_104"},{"__ref":"Paragraph:0792ca426880_105"},{"__ref":"Paragraph:0792ca426880_106"},{"__ref":"Paragraph:0792ca426880_107"},{"__ref":"Paragraph:0792ca426880_108"},{"__ref":"Paragraph:0792ca426880_109"},{"__ref":"Paragraph:0792ca426880_110"},{"__ref":"Paragraph:0792ca426880_111"},{"__ref":"Paragraph:0792ca426880_112"},{"__ref":"Paragraph:0792ca426880_113"},{"__ref":"Paragraph:0792ca426880_114"},{"__ref":"Paragraph:0792ca426880_115"}]},"validatedShareKey":"","shareKeyCreator":null},"creator":{"__ref":"User:e840bf2eef66"},"inResponseToEntityType":null,"isLocked":false,"isMarkedPaywallOnly":false,"lockedSource":"LOCKED_POST_SOURCE_NONE","mediumUrl":"https:\u002F\u002Fovercast.blog\u002Fbuilding-a-metrics-system-with-thanos-and-kubernetes-5660a95fd8fc","primaryTopic":null,"topics":[{"__typename":"Topic","slug":"programming"}],"isPublished":true,"latestPublishedVersion":"0792ca426880","visibility":"PUBLIC","postResponses":{"__typename":"PostResponses","count":0},"clapCount":14,"allowResponses":true,"isLimitedState":false,"title":"Building a Metrics System with Thanos and Kubernetes","isSeries":false,"sequence":null,"uniqueSlug":"building-a-metrics-system-with-thanos-and-kubernetes-5660a95fd8fc","socialTitle":"","socialDek":"","canonicalUrl":"","metaDescription":"","latestPublishedAt":1726657289953,"readingTime":10.667924528301887,"previewContent":{"__typename":"PreviewContent","subtitle":"Metrics are the backbone of observability in any distributed system, and in Kubernetes environments, Prometheus is often the tool of…"},"previewImage":{"__ref":"ImageMetadata:1*QobsYEWqhoc_8s3tyB1Jlg.png"},"isShortform":false,"seoTitle":"Building a Metrics System with Thanos and Kubernetes","firstPublishedAt":1726657289953,"updatedAt":1726752287011,"shortformType":"SHORTFORM_TYPE_LINK","seoDescription":"","viewerEdge":{"__ref":"PostViewerEdge:postId:5660a95fd8fc-viewerId:lo_6c2ed6ac3cac"},"isSuspended":false,"license":"ALL_RIGHTS_RESERVED","tags":[{"__ref":"Tag:kubernetes"},{"__ref":"Tag:devops"},{"__ref":"Tag:programming"},{"__ref":"Tag:cloud-computing"},{"__ref":"Tag:software-development"}],"isNewsletter":false,"statusForCollection":"APPROVED","pendingCollection":null,"detectedLanguage":"en","wordCount":2774,"layerCake":0}}</script><script src="https://cdn-client.medium.com/lite/static/js/manifest.d9095704.js"></script><script src="https://cdn-client.medium.com/lite/static/js/9865.1496d74a.js"></script><script src="https://cdn-client.medium.com/lite/static/js/main.92819008.js"></script><script src="https://cdn-client.medium.com/lite/static/js/instrumentation.d9108df7.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/reporting.ff22a7a5.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9120.5df29668.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5049.d1ead72d.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4810.6318add7.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6618.db187378.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/1386.6a7a21a1.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9977.84e4bd5c.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5250.9f9e01d2.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8261.996d0205.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7975.5a872335.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2648.4c6f2eec.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2712.c5e425ad.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2793.ac6e0fc1.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/1530.60750ec6.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3735.8c38ede2.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5642.1bb42b5a.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6546.cd03f950.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6834.381e82cb.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2420.0330d157.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2106.21ff89d3.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6696.d1274e40.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5832.8a87495f.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3366.a8dd0c25.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6040.6ceb7f43.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4391.59acaed3.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/PostPage.MainContent.38709997.chunk.js"></script><script>window.main();</script><script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'8c80d7978870f9e4',t:'MTcyNzE2MDY0Ni4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body></html>