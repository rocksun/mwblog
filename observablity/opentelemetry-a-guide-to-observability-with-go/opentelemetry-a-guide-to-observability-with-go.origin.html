<!DOCTYPE html><html lang="en-us" class="__variable_0aa4ae scroll-smooth"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/_next/static/media/2d141e1a38819612-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="stylesheet" href="/_next/static/css/be280990ef8e1d7c.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/966704dcf8a4851e.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-6a21cf8a7fb177e8.js"/><script src="/_next/static/chunks/4bd1b696-387642ba37ec3ba1.js" async=""></script><script src="/_next/static/chunks/517-8448bcf1716decfe.js" async=""></script><script src="/_next/static/chunks/main-app-e4fc7d62de2180e1.js" async=""></script><script src="/_next/static/chunks/742-b57de7a1e544e103.js" async=""></script><script src="/_next/static/chunks/app/blog/%5B...slug%5D/page-9ea14279cb279a5a.js" async=""></script><script src="/_next/static/chunks/870fdd6f-ce0f76f83efea37d.js" async=""></script><script src="/_next/static/chunks/658-ad59756ae9aed5f1.js" async=""></script><script src="/_next/static/chunks/786-e9f9e114c7d7dc3f.js" async=""></script><script src="/_next/static/chunks/app/layout-543cb7473bb1a7b1.js" async=""></script><link rel="preload" href="/js/script.js" as="script"/><meta name="next-size-adjust" content=""/><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#101620"/><meta name="msapplication-TileColor" content="#101620"/><meta name="theme-color" content="#101620"/><link rel="alternate" type="application/rss+xml" href="/feed.xml"/><title>OpenTelemetry: A Guide to Observability with Go | Blog | Luca Cavallin</title><meta name="description" content="Modern applications are often complex, distributed systems. Debugging them is not fun: you have to follow requests across services, logs get lost, and metrics are often hard to correlate. It&#x27;s like looking for a needle in a haystack - except the haystack is on fire, and the needle keeps moving. This is where OpenTelemetry (OTel) can help."/><link rel="author" href="https://www.lucavall.in"/><meta name="author" content="Luca Cavallin"/><link rel="manifest" href="/manifest.webmanifest"/><meta name="creator" content="Luca Cavallin"/><meta name="publisher" content="Luca Cavallin"/><meta name="robots" content="index, follow"/><meta name="googlebot" content="index, follow, max-video-preview:-1, max-image-preview:large, max-snippet:-1"/><link rel="canonical" href="https://www.lucavall.in/blog/opentelemetry-a-guide-to-observability-with-go"/><link rel="alternate" type="application/rss+xml" href="https://www.lucavall.in/feed.xml"/><meta property="og:title" content="OpenTelemetry: A Guide to Observability with Go | Blog"/><meta property="og:description" content="Modern applications are often complex, distributed systems. Debugging them is not fun: you have to follow requests across services, logs get lost, and metrics are often hard to correlate. It&#x27;s like looking for a needle in a haystack - except the haystack is on fire, and the needle keeps moving. This is where OpenTelemetry (OTel) can help."/><meta property="og:url" content="https://www.lucavall.in/blog/opentelemetry-a-guide-to-observability-with-go"/><meta property="og:site_name" content="Luca Cavallin"/><meta property="og:locale" content="en_US"/><meta property="og:image" content="https://www.lucavall.in/images/blog/opentelemetry-a-guide-to-observability-with-go/cover.webp"/><meta property="og:type" content="article"/><meta property="article:published_time" content="2025-02-06T00:00:00.000Z"/><meta property="article:modified_time" content="2025-02-06T00:00:00.000Z"/><meta property="article:author" content="Luca Cavallin"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="OpenTelemetry: A Guide to Observability with Go | Blog"/><meta name="twitter:description" content="Modern applications are often complex, distributed systems. Debugging them is not fun: you have to follow requests across services, logs get lost, and metrics are often hard to correlate. It&#x27;s like looking for a needle in a haystack - except the haystack is on fire, and the needle keeps moving. This is where OpenTelemetry (OTel) can help."/><meta name="twitter:image" content="https://www.lucavall.in/images/blog/opentelemetry-a-guide-to-observability-with-go/cover.webp"/><link rel="icon" href="/favicon.ico" type="image/x-icon" sizes="48x48"/><link rel="apple-touch-icon" href="/apple-icon.png?0c30cc317c29bf5e" type="image/png" sizes="180x180"/><script src="/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="bg-black-400 px-1 text-white antialiased"><div class="mx-auto max-w-3xl px-4 sm:px-6 xl:max-w-5xl xl:px-0"><div class="flex h-screen flex-col justify-between font-sans"><header class="flex items-center justify-between py-10"><div><a title="lucavallin" aria-label="lucavallin" href="/"><div class="flex items-center justify-between"><div class="mr-3"><img alt="lucavallin" loading="lazy" width="220" height="55" decoding="async" data-nimg="1" style="color:transparent" srcSet="/_next/image?url=%2Fimages%2Flogo.webp&amp;w=256&amp;q=75 1x, /_next/image?url=%2Fimages%2Flogo.webp&amp;w=640&amp;q=75 2x" src="/_next/image?url=%2Fimages%2Flogo.webp&amp;w=640&amp;q=75"/></div><div class="hidden h-6 text-2xl font-semibold">lucavallin</div></div></a></div><div class="flex items-center space-x-4 leading-5 sm:space-x-6"><a class="hidden sm:block font-medium text-gray-900" title="Home" aria-label="Home" href="/">Home</a><a class="hidden sm:block font-semibold text-pink" title="Blog" aria-label="Blog" href="/blog">Blog</a><a class="hidden sm:block font-medium text-gray-900" title="Mentoring" aria-label="Mentoring" href="/mentoring">Mentoring</a><a class="hidden sm:block font-medium text-gray-900" title="Photography" aria-label="Photography" href="/photography">Photography</a><a class="hidden sm:block font-medium text-gray-900" title="About" aria-label="About" href="/about">About</a><button aria-label="Search" class="pr-2"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="magnifying-glass" class="svg-inline--fa fa-magnifying-glass fa-xl text-gray-900" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352a144 144 0 1 0 0-288 144 144 0 1 0 0 288z"></path></svg></button><button aria-label="Toggle Menu" class="sm:hidden"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="bars" class="svg-inline--fa fa-bars fa-xl text-gray-900" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M0 96C0 78.3 14.3 64 32 64l384 0c17.7 0 32 14.3 32 32s-14.3 32-32 32L32 128C14.3 128 0 113.7 0 96zM0 256c0-17.7 14.3-32 32-32l384 0c17.7 0 32 14.3 32 32s-14.3 32-32 32L32 288c-17.7 0-32-14.3-32-32zM448 416c0 17.7-14.3 32-32 32L32 448c-17.7 0-32-14.3-32-32s14.3-32 32-32l384 0c17.7 0 32 14.3 32 32z"></path></svg></button><div class="fixed left-0 top-0 z-10 size-full bg-gray-950 opacity-[0.98] duration-300 ease-in-out translate-x-full"><div class="flex justify-end"><button class="mr-8 mt-11 size-8" aria-label="Toggle Menu"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="xmark" class="svg-inline--fa fa-xmark fa-2xl text-gray-900" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><path fill="currentColor" d="M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z"></path></svg></button></div><nav class="fixed mt-8 h-full"><div class="px-12 py-4"><a title="Home" aria-label="Home" class="text-2xl tracking-widest font-medium text-gray-900" href="/">Home</a></div><div class="px-12 py-4"><a title="Blog" aria-label="Blog" class="text-2xl tracking-widest font-semibold text-pink" href="/blog">Blog</a></div><div class="px-12 py-4"><a title="Mentoring" aria-label="Mentoring" class="text-2xl tracking-widest font-medium text-gray-900" href="/mentoring">Mentoring</a></div><div class="px-12 py-4"><a title="Photography" aria-label="Photography" class="text-2xl tracking-widest font-medium text-gray-900" href="/photography">Photography</a></div><div class="px-12 py-4"><a title="About" aria-label="About" class="text-2xl tracking-widest font-medium text-gray-900" href="/about">About</a></div></nav></div></div></header><main class="mb-auto"><div class="mx-auto max-w-3xl px-4 sm:px-6 xl:max-w-5xl xl:px-0"><article><div class="divide-y divide-dashed divide-silver-200"><header class="p-6"><div class="space-y-1 text-center"><div class="space-y-10"><div><dl><dt class="sr-only">Published on</dt><dd class="text-base font-medium leading-6 text-gray-700"><time dateTime="2025-02-06T00:00:00.000Z">Thursday, February 6, 2025</time></dd></dl></div></div><div class="pb-2"><h1 class="text-4xl font-extrabold leading-9 tracking-tight text-gray-900 sm:text-4xl sm:leading-10 md:text-5xl md:leading-14">OpenTelemetry: A Guide to Observability with Go</h1></div><div class="pb-2"><div class="flex flex-wrap items-center justify-center"><h2 class="mr-2 text-xs uppercase tracking-wide text-gray-700">Tags</h2><a title="golang" aria-label="golang" class="mr-3 text-lg font-medium uppercase text-pink-500 hover:text-pink-400" href="/blog/tags/golang">golang</a><a title="opentelemetry" aria-label="opentelemetry" class="mr-3 text-lg font-medium uppercase text-pink-500 hover:text-pink-400" href="/blog/tags/opentelemetry">opentelemetry</a><a title="observability" aria-label="observability" class="mr-3 text-lg font-medium uppercase text-pink-500 hover:text-pink-400" href="/blog/tags/observability">observability</a></div></div><div class="flex flex-wrap justify-center"><div class="flex justify-center"><img alt="avatar" loading="lazy" width="38" height="38" decoding="async" data-nimg="1" class="size-5 rounded-full" style="color:transparent" srcSet="/_next/image?url=%2Fimages%2Fluca_cavallin.webp&amp;w=48&amp;q=75 1x, /_next/image?url=%2Fimages%2Fluca_cavallin.webp&amp;w=96&amp;q=75 2x" src="/_next/image?url=%2Fimages%2Fluca_cavallin.webp&amp;w=96&amp;q=75"/><dl class="whitespace-nowrap pl-3 text-base font-medium leading-5"><dt class="sr-only">Name</dt><dd class="text-gray-900">Luca Cavallin</dd></dl></div></div></div></header><div class="divide-y divide-dashed divide-silver-100 pb-8 xl:gap-x-6 xl:divide-y-0"><div class="xl:pb-0"><div class="prose max-w-none pb-2 pt-10"><p>Modern applications are often complex, distributed systems. Debugging them is not fun: you have to follow requests across services, logs get lost, and metrics are often hard to correlate. It&#x27;s like looking for a needle in a haystack - except the haystack is on fire, and the needle keeps moving. This is where <a target="_blank" rel="noopener noreferrer" href="https://opentelemetry.io">OpenTelemetry</a> (OTel) can help.</p><p>OpenTelemetry is an open-source observability framework that helps collect and export <strong>traces</strong>, <strong>metrics</strong>, and <strong>logs</strong> from applications. It standardizes how telemetry data is gathered and makes it easy to integrate with tools like <strong>Grafana</strong>. With OpenTelemetry, we can finally get clear insights into our application&#x27;s performance, allowing us to answer questions like &quot;Why is this request slow?&quot;, &quot;How many requests are active right now?&quot;, and &quot;What errors are happening, and where?&quot;.</p><p>In this post, I&#x27;ll walk through how to integrate OpenTelemetry in a Go application. By the end, you&#x27;ll have a reusable telemetry package that sets up logging, metrics, and tracing - all without cluttering your application code! I&#x27;ve published the package, complete with tests and examples, on GitHub: <a target="_blank" rel="noopener noreferrer" href="https://github.com/lucavallin/gotel">gotel</a>. Feel free to use it as a starting point for your own projects.</p><h2 id="a-few-important-concepts-first"><a aria-hidden="true" tabindex="-1" href="#a-few-important-concepts-first"><span class="icon icon-link"></span></a>A Few Important Concepts First</h2><p>Before we dive into code, let&#x27;s break down the major components of OpenTelemetry: logs, metrics, and traces. These are the building blocks of observability, and they help us understand what&#x27;s happening in our applications.</p><p><strong>Providers</strong>, <strong>resources</strong>, <strong>exporters</strong>, and <strong>collectors</strong> are the components that work together to gather, process, and send telemetry data to an external system.</p><h3 id="logs-metrics-and-traces"><a aria-hidden="true" tabindex="-1" href="#logs-metrics-and-traces"><span class="icon icon-link"></span></a>Logs, Metrics, and Traces</h3><p>Logs, metrics, and traces are all types of telemetry data, but they serve different purposes. Here&#x27;s a quick overview of each:</p><ul><li><strong>Logs</strong> are records of discrete events. Think of them as diary entries for your application. When something goes wrong, logs are the first place you look.</li><li><strong>Metrics</strong> track numerical data over time, like request duration, CPU usage, or active connections. They help monitor trends and spot performance issues.</li><li><strong>Traces</strong> track a request as it flows through multiple services. A trace is made up of spans, each representing an individual operation.</li></ul><p>Basically: logs tell us what happened, metrics show us how often it happens, and traces reveal how different parts of the system interact.</p><h3 id="providers-resources-exporters-and-collectors"><a aria-hidden="true" tabindex="-1" href="#providers-resources-exporters-and-collectors"><span class="icon icon-link"></span></a>Providers, Resources, Exporters, and Collectors</h3><p>In OpenTelemetry, providers, resources, exporters, and collectors work together to gather, process, and send telemetry data to an external system. Providers are responsible for generating telemetry data and they rely on resources, which <strong>define metadata about the application</strong>, such as the service name, version, and host. Once telemetry data is collected, it needs to be sent somewhere, which is what exporters do. Exporters <strong>forward data</strong> to an observability backend like Grafana. To manage this process more efficiently, OpenTelemetry uses collectors, which <strong>act as intermediaries, aggregating, processing, and routing telemetry data</strong> before sending it to one or multiple backends. Collectors help reduce application overhead and provide flexibility in telemetry storage and analysis.</p><h2 id="setting-up-telemetry-in-go"><a aria-hidden="true" tabindex="-1" href="#setting-up-telemetry-in-go"><span class="icon icon-link"></span></a>Setting Up Telemetry in Go</h2><p>Now, let&#x27;s build a Go package that handles logs, metrics, and traces using OpenTelemetry. The package is called <code>gotel</code> and it&#x27;s available on GitHub: <a target="_blank" rel="noopener noreferrer" href="https://github.com/lucavallin/gotel">gotel</a>. This package wraps OpenTelemetry&#x27;s SDK into a simple interface, making it easier to use.</p><h3 id="configuration"><a aria-hidden="true" tabindex="-1" href="#configuration"><span class="icon icon-link"></span></a>Configuration</h3><p>First, we need a way to configure our telemetry system. The <code>config.go</code> file handles this by loading settings from environment variables. This makes it easy to tweak the configuration without modifying the code.</p><div class="relative"><pre><code class="language-go code-highlight"><span class="code-line"><span class="token keyword">package</span> gotel
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">import</span> <span class="token punctuation">(</span>
</span><span class="code-line">	<span class="token string">&quot;fmt&quot;</span>
</span><span class="code-line">
</span><span class="code-line">	<span class="token string">&quot;github.com/caarlos0/env&quot;</span>
</span><span class="code-line"><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// Config holds the configuration for the telemetry.</span>
</span><span class="code-line"><span class="token keyword">type</span> Config <span class="token keyword">struct</span> <span class="token punctuation">{</span>
</span><span class="code-line">	ServiceName    <span class="token builtin">string</span> <span class="token string">`env:&quot;SERVICE_NAME&quot;      envDefault:&quot;gotel&quot;`</span>
</span><span class="code-line">	ServiceVersion <span class="token builtin">string</span> <span class="token string">`env:&quot;SERVICE_VERSION&quot;   envDefault:&quot;0.0.1&quot;`</span>
</span><span class="code-line">	Enabled        <span class="token builtin">bool</span>   <span class="token string">`env:&quot;TELEMETRY_ENABLED&quot; envDefault:&quot;true&quot;`</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// NewConfigFromEnv creates a new telemetry config from the environment.</span>
</span><span class="code-line"><span class="token keyword">func</span> <span class="token function">NewConfigFromEnv</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>Config<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">	telem <span class="token operator">:=</span> Config<span class="token punctuation">{</span><span class="token punctuation">}</span>
</span><span class="code-line">	<span class="token keyword">if</span> err <span class="token operator">:=</span> env<span class="token punctuation">.</span><span class="token function">Parse</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>telem<span class="token punctuation">)</span><span class="token punctuation">;</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
</span><span class="code-line">		<span class="token keyword">return</span> Config<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> fmt<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;failed to parse telemetry config: %w&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">	<span class="token keyword">return</span> telem<span class="token punctuation">,</span> <span class="token boolean">nil</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><p>This file defines a <code>Config</code> struct that stores the <strong>service name</strong>, <strong>version</strong>, and a flag to enable or disable telemetry. The <code>NewConfigFromEnv</code> function loads these values from environment variables, allowing us to tweak settings without modifying the code. If an environment variable is not set, a default value is used instead.</p><h3 id="providers--exporters"><a aria-hidden="true" tabindex="-1" href="#providers--exporters"><span class="icon icon-link"></span></a>Providers &amp; Exporters</h3><p>Now that we have configuration in place, we need to set up <strong>providers</strong>-components responsible for handling logs, metrics, and traces.</p><p>The <code>providers.go</code> file contains functions to create logger, meter, and tracer providers. These functions are used to initialize the telemetry system in <code>NewTelemetry</code>. The <code>newResource</code> function is also defined in this file to attach metadata to all telemetry data, making it easier to track where the data is coming from.</p><div class="relative"><pre><code class="language-go code-highlight"><span class="code-line"><span class="token keyword">package</span> gotel
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">import</span> <span class="token punctuation">(</span>
</span><span class="code-line">	<span class="token string">&quot;context&quot;</span>
</span><span class="code-line">	<span class="token string">&quot;fmt&quot;</span>
</span><span class="code-line">	<span class="token string">&quot;os&quot;</span>
</span><span class="code-line">
</span><span class="code-line">	<span class="token string">&quot;go.opentelemetry.io/otel&quot;</span>
</span><span class="code-line">	<span class="token string">&quot;go.opentelemetry.io/otel/exporters/otlp/otlplog/otlploggrpc&quot;</span>
</span><span class="code-line">	<span class="token string">&quot;go.opentelemetry.io/otel/exporters/otlp/otlpmetric/otlpmetricgrpc&quot;</span>
</span><span class="code-line">	<span class="token string">&quot;go.opentelemetry.io/otel/exporters/otlp/otlptrace/otlptracegrpc&quot;</span>
</span><span class="code-line">	<span class="token string">&quot;go.opentelemetry.io/otel/sdk/log&quot;</span>
</span><span class="code-line">	<span class="token string">&quot;go.opentelemetry.io/otel/sdk/metric&quot;</span>
</span><span class="code-line">	<span class="token string">&quot;go.opentelemetry.io/otel/sdk/resource&quot;</span>
</span><span class="code-line">	<span class="token string">&quot;go.opentelemetry.io/otel/sdk/trace&quot;</span>
</span><span class="code-line">	semconv <span class="token string">&quot;go.opentelemetry.io/otel/semconv/v1.17.0&quot;</span>
</span><span class="code-line"><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// newLoggerProvider creates a new logger provider with the OTLP gRPC exporter.</span>
</span><span class="code-line"><span class="token keyword">func</span> <span class="token function">newLoggerProvider</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> res <span class="token operator">*</span>resource<span class="token punctuation">.</span>Resource<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token operator">*</span>log<span class="token punctuation">.</span>LoggerProvider<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">	exporter<span class="token punctuation">,</span> err <span class="token operator">:=</span> otlploggrpc<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
</span><span class="code-line">		<span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> fmt<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;failed to create OTLP log exporter: %w&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">	processor <span class="token operator">:=</span> log<span class="token punctuation">.</span><span class="token function">NewBatchProcessor</span><span class="token punctuation">(</span>exporter<span class="token punctuation">)</span>
</span><span class="code-line">	lp <span class="token operator">:=</span> log<span class="token punctuation">.</span><span class="token function">NewLoggerProvider</span><span class="token punctuation">(</span>
</span><span class="code-line">		log<span class="token punctuation">.</span><span class="token function">WithProcessor</span><span class="token punctuation">(</span>processor<span class="token punctuation">)</span><span class="token punctuation">,</span>
</span><span class="code-line">		log<span class="token punctuation">.</span><span class="token function">WithResource</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">,</span>
</span><span class="code-line">	<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">	<span class="token keyword">return</span> lp<span class="token punctuation">,</span> <span class="token boolean">nil</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// newMeterProvider creates a new meter provider with the OTLP gRPC exporter.</span>
</span><span class="code-line"><span class="token keyword">func</span> <span class="token function">newMeterProvider</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> res <span class="token operator">*</span>resource<span class="token punctuation">.</span>Resource<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token operator">*</span>metric<span class="token punctuation">.</span>MeterProvider<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">	exporter<span class="token punctuation">,</span> err <span class="token operator">:=</span> otlpmetricgrpc<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
</span><span class="code-line">		<span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> fmt<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;failed to create OTLP metric exporter: %w&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">	mp <span class="token operator">:=</span> metric<span class="token punctuation">.</span><span class="token function">NewMeterProvider</span><span class="token punctuation">(</span>
</span><span class="code-line">		metric<span class="token punctuation">.</span><span class="token function">WithReader</span><span class="token punctuation">(</span>metric<span class="token punctuation">.</span><span class="token function">NewPeriodicReader</span><span class="token punctuation">(</span>exporter<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
</span><span class="code-line">		metric<span class="token punctuation">.</span><span class="token function">WithResource</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">,</span>
</span><span class="code-line">	<span class="token punctuation">)</span>
</span><span class="code-line">	otel<span class="token punctuation">.</span><span class="token function">SetMeterProvider</span><span class="token punctuation">(</span>mp<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">	<span class="token keyword">return</span> mp<span class="token punctuation">,</span> <span class="token boolean">nil</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// newTracerProvider creates a new tracer provider with the OTLP gRPC exporter.</span>
</span><span class="code-line"><span class="token keyword">func</span> <span class="token function">newTracerProvider</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> res <span class="token operator">*</span>resource<span class="token punctuation">.</span>Resource<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token operator">*</span>trace<span class="token punctuation">.</span>TracerProvider<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">	exporter<span class="token punctuation">,</span> err <span class="token operator">:=</span> otlptracegrpc<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
</span><span class="code-line">		<span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> fmt<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;failed to create OTLP trace exporter: %w&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">	<span class="token comment">// Create Resource</span>
</span><span class="code-line">	tp <span class="token operator">:=</span> trace<span class="token punctuation">.</span><span class="token function">NewTracerProvider</span><span class="token punctuation">(</span>
</span><span class="code-line">		trace<span class="token punctuation">.</span><span class="token function">WithBatcher</span><span class="token punctuation">(</span>exporter<span class="token punctuation">)</span><span class="token punctuation">,</span>
</span><span class="code-line">		trace<span class="token punctuation">.</span><span class="token function">WithResource</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">,</span>
</span><span class="code-line">	<span class="token punctuation">)</span>
</span><span class="code-line">	otel<span class="token punctuation">.</span><span class="token function">SetTracerProvider</span><span class="token punctuation">(</span>tp<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">	<span class="token keyword">return</span> tp<span class="token punctuation">,</span> <span class="token boolean">nil</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// newResource creates a new OTEL resource with the service name and version.</span>
</span><span class="code-line"><span class="token keyword">func</span> <span class="token function">newResource</span><span class="token punctuation">(</span>serviceName <span class="token builtin">string</span><span class="token punctuation">,</span> serviceVersion <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">*</span>resource<span class="token punctuation">.</span>Resource <span class="token punctuation">{</span>
</span><span class="code-line">	hostName<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> os<span class="token punctuation">.</span><span class="token function">Hostname</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">	<span class="token keyword">return</span> resource<span class="token punctuation">.</span><span class="token function">NewWithAttributes</span><span class="token punctuation">(</span>
</span><span class="code-line">		semconv<span class="token punctuation">.</span>SchemaURL<span class="token punctuation">,</span>
</span><span class="code-line">		semconv<span class="token punctuation">.</span><span class="token function">ServiceName</span><span class="token punctuation">(</span>serviceName<span class="token punctuation">)</span><span class="token punctuation">,</span>
</span><span class="code-line">		semconv<span class="token punctuation">.</span><span class="token function">ServiceVersion</span><span class="token punctuation">(</span>serviceVersion<span class="token punctuation">)</span><span class="token punctuation">,</span>
</span><span class="code-line">		semconv<span class="token punctuation">.</span><span class="token function">HostName</span><span class="token punctuation">(</span>hostName<span class="token punctuation">)</span><span class="token punctuation">,</span>
</span><span class="code-line">	<span class="token punctuation">)</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><p>We start by importing OpenTelemetry&#x27;s SDK and exporters for logs, metrics, and traces. These exporters <strong>send data to an external system</strong> like Grafana or another OTLP-compatible backend.</p><p>The <code>providers.go</code> file contains functions for the following:</p><ul><li><code>newLoggerProvider</code>: creates a <strong>logger provider</strong>, which collects and exports logs. The OTLP gRPC exporter sends logs over the network via gRPC, and the <code>BatchProcessor</code> efficiently batches log entries before exporting them.</li><li><code>newMeterProvider</code>: creates a <strong>metrics provider</strong>, which is responsible for collecting <strong>metrics</strong>. It periodically exports metrics to a backend.</li><li><code>newTracerProvider</code>: creates a <strong>tracing provider</strong> to track request flows and exports them to an external backend.</li><li><code>newResource</code>: creates a <strong>resource</strong> with metadata about the application, such as the service name, version, and hostname. This information is attached to all telemetry data.</li></ul><p>For all telemetry, I am using the <strong>OTLP gRPC exporter</strong>, which is the default and most commonly used exporter in OpenTelemetry. OTLP (OpenTelemetry Protocol) is a standardized format for transmitting logs, metrics, and traces between applications and observability backends. It supports both gRPC and HTTP transport, allowing data to be sent efficiently in high-throughput environments. I chose OTLP gRPC because it provides low-latency, high-performance communication with strong streaming support, making it ideal for production workloads. However, OpenTelemetry supports many other exporters, depending on your use case.</p><h3 id="bringing-it-all-together"><a aria-hidden="true" tabindex="-1" href="#bringing-it-all-together"><span class="icon icon-link"></span></a>Bringing It All Together</h3><p>The <code>Telemetry</code> struct wraps all the components together. This is handy when we want to pass the telemetry system to other parts of the application. For example, we can use the <code>Telemetry</code> struct in middleware to log requests and measure request duration. The <code>telemetry.go</code> file contains the <code>Telemetry</code> struct and the <code>TelemetryProvider</code> interface, which defines the methods that the <code>Telemetry</code> struct implements. The <code>Telemetry</code> struct is a wrapper around the OpenTelemetry logger, meter, and tracer.</p><div class="relative"><pre><code class="language-go code-highlight"><span class="code-line"><span class="token keyword">package</span> gotel
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">import</span> <span class="token punctuation">(</span>
</span><span class="code-line">	<span class="token string">&quot;context&quot;</span>
</span><span class="code-line">	<span class="token string">&quot;fmt&quot;</span>
</span><span class="code-line">	<span class="token string">&quot;os&quot;</span>
</span><span class="code-line">
</span><span class="code-line">	<span class="token string">&quot;github.com/gin-gonic/gin&quot;</span>
</span><span class="code-line">	<span class="token string">&quot;go.opentelemetry.io/contrib/bridges/otelzap&quot;</span>
</span><span class="code-line">	otelmetric <span class="token string">&quot;go.opentelemetry.io/otel/metric&quot;</span>
</span><span class="code-line">	<span class="token string">&quot;go.opentelemetry.io/otel/sdk/log&quot;</span>
</span><span class="code-line">	<span class="token string">&quot;go.opentelemetry.io/otel/sdk/metric&quot;</span>
</span><span class="code-line">	<span class="token string">&quot;go.opentelemetry.io/otel/sdk/trace&quot;</span>
</span><span class="code-line">	oteltrace <span class="token string">&quot;go.opentelemetry.io/otel/trace&quot;</span>
</span><span class="code-line">	<span class="token string">&quot;go.uber.org/zap&quot;</span>
</span><span class="code-line">	<span class="token string">&quot;go.uber.org/zap/zapcore&quot;</span>
</span><span class="code-line"><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// TelemetryProvider is an interface for the telemetry provider.</span>
</span><span class="code-line"><span class="token keyword">type</span> TelemetryProvider <span class="token keyword">interface</span> <span class="token punctuation">{</span>
</span><span class="code-line">	<span class="token function">GetServiceName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">string</span>
</span><span class="code-line">	<span class="token function">LogInfo</span><span class="token punctuation">(</span>args <span class="token operator">...</span><span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token function">LogErrorln</span><span class="token punctuation">(</span>args <span class="token operator">...</span><span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token function">LogFatalln</span><span class="token punctuation">(</span>args <span class="token operator">...</span><span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token function">MeterInt64Histogram</span><span class="token punctuation">(</span>metric Metric<span class="token punctuation">)</span> <span class="token punctuation">(</span>otelmetric<span class="token punctuation">.</span>Int64Histogram<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token function">MeterInt64UpDownCounter</span><span class="token punctuation">(</span>metric Metric<span class="token punctuation">)</span> <span class="token punctuation">(</span>otelmetric<span class="token punctuation">.</span>Int64UpDownCounter<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token function">TraceStart</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> name <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> oteltrace<span class="token punctuation">.</span>Span<span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token function">LogRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span> gin<span class="token punctuation">.</span>HandlerFunc
</span><span class="code-line">	<span class="token function">MeterRequestDuration</span><span class="token punctuation">(</span><span class="token punctuation">)</span> gin<span class="token punctuation">.</span>HandlerFunc
</span><span class="code-line">	<span class="token function">MeterRequestsInFlight</span><span class="token punctuation">(</span><span class="token punctuation">)</span> gin<span class="token punctuation">.</span>HandlerFunc
</span><span class="code-line">	<span class="token function">Shutdown</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">)</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// Telemetry is a wrapper around the OpenTelemetry logger, meter, and tracer.</span>
</span><span class="code-line"><span class="token keyword">type</span> Telemetry <span class="token keyword">struct</span> <span class="token punctuation">{</span>
</span><span class="code-line">	lp     <span class="token operator">*</span>log<span class="token punctuation">.</span>LoggerProvider
</span><span class="code-line">	mp     <span class="token operator">*</span>metric<span class="token punctuation">.</span>MeterProvider
</span><span class="code-line">	tp     <span class="token operator">*</span>trace<span class="token punctuation">.</span>TracerProvider
</span><span class="code-line">	log    <span class="token operator">*</span>zap<span class="token punctuation">.</span>SugaredLogger
</span><span class="code-line">	meter  otelmetric<span class="token punctuation">.</span>Meter
</span><span class="code-line">	tracer oteltrace<span class="token punctuation">.</span>Tracer
</span><span class="code-line">	cfg    Config
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// NewTelemetry creates a new telemetry instance.</span>
</span><span class="code-line"><span class="token keyword">func</span> <span class="token function">NewTelemetry</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> cfg Config<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token operator">*</span>Telemetry<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">	rp <span class="token operator">:=</span> <span class="token function">newResource</span><span class="token punctuation">(</span>cfg<span class="token punctuation">.</span>ServiceName<span class="token punctuation">,</span> cfg<span class="token punctuation">.</span>ServiceVersion<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">	lp<span class="token punctuation">,</span> err <span class="token operator">:=</span> <span class="token function">newLoggerProvider</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> rp<span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
</span><span class="code-line">		<span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> fmt<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;failed to create logger: %w&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">	logger <span class="token operator">:=</span> zap<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span>
</span><span class="code-line">		zapcore<span class="token punctuation">.</span><span class="token function">NewTee</span><span class="token punctuation">(</span>
</span><span class="code-line">			zapcore<span class="token punctuation">.</span><span class="token function">NewCore</span><span class="token punctuation">(</span>zapcore<span class="token punctuation">.</span><span class="token function">NewJSONEncoder</span><span class="token punctuation">(</span>zap<span class="token punctuation">.</span><span class="token function">NewProductionEncoderConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> zapcore<span class="token punctuation">.</span><span class="token function">AddSync</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>Stdout<span class="token punctuation">)</span><span class="token punctuation">,</span> zapcore<span class="token punctuation">.</span>InfoLevel<span class="token punctuation">)</span><span class="token punctuation">,</span>
</span><span class="code-line">			otelzap<span class="token punctuation">.</span><span class="token function">NewCore</span><span class="token punctuation">(</span>cfg<span class="token punctuation">.</span>ServiceName<span class="token punctuation">,</span> otelzap<span class="token punctuation">.</span><span class="token function">WithLoggerProvider</span><span class="token punctuation">(</span>lp<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
</span><span class="code-line">		<span class="token punctuation">)</span><span class="token punctuation">,</span>
</span><span class="code-line">	<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">	mp<span class="token punctuation">,</span> err <span class="token operator">:=</span> <span class="token function">newMeterProvider</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> rp<span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
</span><span class="code-line">		<span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> fmt<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;failed to create meter: %w&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token punctuation">}</span>
</span><span class="code-line">	meter <span class="token operator">:=</span> mp<span class="token punctuation">.</span><span class="token function">Meter</span><span class="token punctuation">(</span>cfg<span class="token punctuation">.</span>ServiceName<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">	tp<span class="token punctuation">,</span> err <span class="token operator">:=</span> <span class="token function">newTracerProvider</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> rp<span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
</span><span class="code-line">		<span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> fmt<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;failed to create tracer: %w&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token punctuation">}</span>
</span><span class="code-line">	tracer <span class="token operator">:=</span> tp<span class="token punctuation">.</span><span class="token function">Tracer</span><span class="token punctuation">(</span>cfg<span class="token punctuation">.</span>ServiceName<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">	<span class="token keyword">return</span> <span class="token operator">&amp;</span>Telemetry<span class="token punctuation">{</span>
</span><span class="code-line">		lp<span class="token punctuation">:</span>     lp<span class="token punctuation">,</span>
</span><span class="code-line">		mp<span class="token punctuation">:</span>     mp<span class="token punctuation">,</span>
</span><span class="code-line">		tp<span class="token punctuation">:</span>     tp<span class="token punctuation">,</span>
</span><span class="code-line">		log<span class="token punctuation">:</span>    logger<span class="token punctuation">.</span><span class="token function">Sugar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
</span><span class="code-line">		meter<span class="token punctuation">:</span>  meter<span class="token punctuation">,</span>
</span><span class="code-line">		tracer<span class="token punctuation">:</span> tracer<span class="token punctuation">,</span>
</span><span class="code-line">		cfg<span class="token punctuation">:</span>    cfg<span class="token punctuation">,</span>
</span><span class="code-line">	<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">nil</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// GetServiceName returns the name of the service.</span>
</span><span class="code-line"><span class="token keyword">func</span> <span class="token punctuation">(</span>t <span class="token operator">*</span>Telemetry<span class="token punctuation">)</span> <span class="token function">GetServiceName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
</span><span class="code-line">	<span class="token keyword">return</span> t<span class="token punctuation">.</span>cfg<span class="token punctuation">.</span>ServiceName
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// LogInfo logs a message at the info level.</span>
</span><span class="code-line"><span class="token keyword">func</span> <span class="token punctuation">(</span>t <span class="token operator">*</span>Telemetry<span class="token punctuation">)</span> <span class="token function">LogInfo</span><span class="token punctuation">(</span>args <span class="token operator">...</span><span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">	t<span class="token punctuation">.</span>log<span class="token punctuation">.</span><span class="token function">Info</span><span class="token punctuation">(</span>args<span class="token operator">...</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// LogErrorln logs a message and then calls os.Exit(1).</span>
</span><span class="code-line"><span class="token keyword">func</span> <span class="token punctuation">(</span>t <span class="token operator">*</span>Telemetry<span class="token punctuation">)</span> <span class="token function">LogErrorln</span><span class="token punctuation">(</span>args <span class="token operator">...</span><span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">	t<span class="token punctuation">.</span>log<span class="token punctuation">.</span><span class="token function">Errorln</span><span class="token punctuation">(</span>args<span class="token operator">...</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// LogFatalln logs a message and then calls os.Exit(1).</span>
</span><span class="code-line"><span class="token keyword">func</span> <span class="token punctuation">(</span>t <span class="token operator">*</span>Telemetry<span class="token punctuation">)</span> <span class="token function">LogFatalln</span><span class="token punctuation">(</span>args <span class="token operator">...</span><span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">	t<span class="token punctuation">.</span>log<span class="token punctuation">.</span><span class="token function">Fatalln</span><span class="token punctuation">(</span>args<span class="token operator">...</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// MeterInt64Histogram creates a new int64 histogram metric.</span>
</span><span class="code-line"><span class="token keyword">func</span> <span class="token punctuation">(</span>t <span class="token operator">*</span>Telemetry<span class="token punctuation">)</span> <span class="token function">MeterInt64Histogram</span><span class="token punctuation">(</span>metric Metric<span class="token punctuation">)</span> <span class="token punctuation">(</span>otelmetric<span class="token punctuation">.</span>Int64Histogram<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">//nolint:ireturn</span>
</span><span class="code-line">	histogram<span class="token punctuation">,</span> err <span class="token operator">:=</span> t<span class="token punctuation">.</span>meter<span class="token punctuation">.</span><span class="token function">Int64Histogram</span><span class="token punctuation">(</span>
</span><span class="code-line">		metric<span class="token punctuation">.</span>Name<span class="token punctuation">,</span>
</span><span class="code-line">		otelmetric<span class="token punctuation">.</span><span class="token function">WithDescription</span><span class="token punctuation">(</span>metric<span class="token punctuation">.</span>Description<span class="token punctuation">)</span><span class="token punctuation">,</span>
</span><span class="code-line">		otelmetric<span class="token punctuation">.</span><span class="token function">WithUnit</span><span class="token punctuation">(</span>metric<span class="token punctuation">.</span>Unit<span class="token punctuation">)</span><span class="token punctuation">,</span>
</span><span class="code-line">	<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
</span><span class="code-line">		<span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> fmt<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;failed to create histogram: %w&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">	<span class="token keyword">return</span> histogram<span class="token punctuation">,</span> <span class="token boolean">nil</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// MeterInt64UpDownCounter creates a new int64 up down counter metric.</span>
</span><span class="code-line"><span class="token keyword">func</span> <span class="token punctuation">(</span>t <span class="token operator">*</span>Telemetry<span class="token punctuation">)</span> <span class="token function">MeterInt64UpDownCounter</span><span class="token punctuation">(</span>metric Metric<span class="token punctuation">)</span> <span class="token punctuation">(</span>otelmetric<span class="token punctuation">.</span>Int64UpDownCounter<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">//nolint:ireturn</span>
</span><span class="code-line">	counter<span class="token punctuation">,</span> err <span class="token operator">:=</span> t<span class="token punctuation">.</span>meter<span class="token punctuation">.</span><span class="token function">Int64UpDownCounter</span><span class="token punctuation">(</span>
</span><span class="code-line">		metric<span class="token punctuation">.</span>Name<span class="token punctuation">,</span>
</span><span class="code-line">		otelmetric<span class="token punctuation">.</span><span class="token function">WithDescription</span><span class="token punctuation">(</span>metric<span class="token punctuation">.</span>Description<span class="token punctuation">)</span><span class="token punctuation">,</span>
</span><span class="code-line">		otelmetric<span class="token punctuation">.</span><span class="token function">WithUnit</span><span class="token punctuation">(</span>metric<span class="token punctuation">.</span>Unit<span class="token punctuation">)</span><span class="token punctuation">,</span>
</span><span class="code-line">	<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
</span><span class="code-line">		<span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> fmt<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;failed to create counter: %w&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">	<span class="token keyword">return</span> counter<span class="token punctuation">,</span> <span class="token boolean">nil</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// TraceStart starts a new span with the given name. The span must be ended by calling End.</span>
</span><span class="code-line"><span class="token keyword">func</span> <span class="token punctuation">(</span>t <span class="token operator">*</span>Telemetry<span class="token punctuation">)</span> <span class="token function">TraceStart</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> name <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> oteltrace<span class="token punctuation">.</span>Span<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">//nolint:ireturn</span>
</span><span class="code-line">	<span class="token comment">//nolint: spancheck</span>
</span><span class="code-line">	<span class="token keyword">return</span> t<span class="token punctuation">.</span>tracer<span class="token punctuation">.</span><span class="token function">Start</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> name<span class="token punctuation">)</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// Shutdown shuts down the logger, meter, and tracer.</span>
</span><span class="code-line"><span class="token keyword">func</span> <span class="token punctuation">(</span>t <span class="token operator">*</span>Telemetry<span class="token punctuation">)</span> <span class="token function">Shutdown</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">	t<span class="token punctuation">.</span>lp<span class="token punctuation">.</span><span class="token function">Shutdown</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span>
</span><span class="code-line">	t<span class="token punctuation">.</span>mp<span class="token punctuation">.</span><span class="token function">Shutdown</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span>
</span><span class="code-line">	t<span class="token punctuation">.</span>tp<span class="token punctuation">.</span><span class="token function">Shutdown</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><p>In this file, a <code>TelemetryProvider</code> interface is defined to make it easier to mock the telemetry package in tests, but also to make it easier to swap out the underlying telemetry system in the future.</p><p>The <code>NewTelemetry</code> function initializes logging, metrics, and tracing and returns an instance of the <code>Telemetry</code> struct. I am using the <a target="_blank" rel="noopener noreferrer" href="https://github.com/uber-go/zap">zap</a> logger for simplicity, but you can use any other logger that integrates with OpenTelemetry. Keep in mind, the <code>zap</code> logger requires a so-called <strong>&quot;bridge&quot;</strong> (<code>otelzap</code>) to work with OpenTelemetry.</p><p>An advantage of defining the <code>TelemetryProvider</code> interface is that we can easily swap out the underlying telemetry system, for example in tests. Here&#x27;s an example of a no-op telemetry provider that can be used in tests:</p><div class="relative"><pre><code class="language-go code-highlight"><span class="code-line"><span class="token keyword">package</span> gotel
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">import</span> <span class="token punctuation">(</span>
</span><span class="code-line">	<span class="token string">&quot;context&quot;</span>
</span><span class="code-line">	<span class="token string">&quot;os&quot;</span>
</span><span class="code-line">
</span><span class="code-line">	<span class="token string">&quot;github.com/gin-gonic/gin&quot;</span>
</span><span class="code-line">	<span class="token string">&quot;go.opentelemetry.io/otel/metric&quot;</span>
</span><span class="code-line">	<span class="token string">&quot;go.opentelemetry.io/otel/trace&quot;</span>
</span><span class="code-line"><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// NoopTelemetry is a no-op implementation of the TelemetryProvider interface.</span>
</span><span class="code-line"><span class="token keyword">type</span> NoopTelemetry <span class="token keyword">struct</span> <span class="token punctuation">{</span>
</span><span class="code-line">	serviceName <span class="token builtin">string</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// NewNoopTelemetry creates a new NoopTelemetry instance.</span>
</span><span class="code-line"><span class="token keyword">func</span> <span class="token function">NewNoopTelemetry</span><span class="token punctuation">(</span>cfg Config<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token operator">*</span>NoopTelemetry<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">	<span class="token keyword">return</span> <span class="token operator">&amp;</span>NoopTelemetry<span class="token punctuation">{</span>serviceName<span class="token punctuation">:</span> cfg<span class="token punctuation">.</span>ServiceName<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">nil</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// GetServiceName returns the service name.</span>
</span><span class="code-line"><span class="token keyword">func</span> <span class="token punctuation">(</span>t <span class="token operator">*</span>NoopTelemetry<span class="token punctuation">)</span> <span class="token function">GetServiceName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">string</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> t<span class="token punctuation">.</span>serviceName <span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// LogInfo logs nothing.</span>
</span><span class="code-line"><span class="token keyword">func</span> <span class="token punctuation">(</span>t <span class="token operator">*</span>NoopTelemetry<span class="token punctuation">)</span> <span class="token function">LogInfo</span><span class="token punctuation">(</span>args <span class="token operator">...</span><span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// LogErrorln logs nothing.</span>
</span><span class="code-line"><span class="token keyword">func</span> <span class="token punctuation">(</span>t <span class="token operator">*</span>NoopTelemetry<span class="token punctuation">)</span> <span class="token function">LogErrorln</span><span class="token punctuation">(</span>args <span class="token operator">...</span><span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// LogFatalln logs nothing, then exits.</span>
</span><span class="code-line"><span class="token keyword">func</span> <span class="token punctuation">(</span>t <span class="token operator">*</span>NoopTelemetry<span class="token punctuation">)</span> <span class="token function">LogFatalln</span><span class="token punctuation">(</span>args <span class="token operator">...</span><span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">	os<span class="token punctuation">.</span><span class="token function">Exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// LogRequest is a no-op middleware.</span>
</span><span class="code-line"><span class="token keyword">func</span> <span class="token punctuation">(</span>t <span class="token operator">*</span>NoopTelemetry<span class="token punctuation">)</span> <span class="token function">LogRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span> gin<span class="token punctuation">.</span>HandlerFunc <span class="token punctuation">{</span>
</span><span class="code-line">	<span class="token keyword">return</span> <span class="token keyword">func</span><span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{</span> c<span class="token punctuation">.</span><span class="token function">Next</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// MeterRequestDuration is a no-op middleware.</span>
</span><span class="code-line"><span class="token keyword">func</span> <span class="token punctuation">(</span>t <span class="token operator">*</span>NoopTelemetry<span class="token punctuation">)</span> <span class="token function">MeterRequestDuration</span><span class="token punctuation">(</span><span class="token punctuation">)</span> gin<span class="token punctuation">.</span>HandlerFunc <span class="token punctuation">{</span>
</span><span class="code-line">	<span class="token keyword">return</span> <span class="token keyword">func</span><span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{</span> c<span class="token punctuation">.</span><span class="token function">Next</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// MeterRequestsInFlight is a no-op middleware.</span>
</span><span class="code-line"><span class="token keyword">func</span> <span class="token punctuation">(</span>t <span class="token operator">*</span>NoopTelemetry<span class="token punctuation">)</span> <span class="token function">MeterRequestsInFlight</span><span class="token punctuation">(</span><span class="token punctuation">)</span> gin<span class="token punctuation">.</span>HandlerFunc <span class="token punctuation">{</span>
</span><span class="code-line">	<span class="token keyword">return</span> <span class="token keyword">func</span><span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{</span> c<span class="token punctuation">.</span><span class="token function">Next</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// TraceStart returns the context and span unchanged.</span>
</span><span class="code-line"><span class="token keyword">func</span> <span class="token punctuation">(</span>t <span class="token operator">*</span>NoopTelemetry<span class="token punctuation">)</span> <span class="token function">TraceStart</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> name <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> trace<span class="token punctuation">.</span>Span<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">	<span class="token keyword">return</span> ctx<span class="token punctuation">,</span> trace<span class="token punctuation">.</span><span class="token function">SpanFromContext</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// MeterInt64Histogram returns nil.</span>
</span><span class="code-line"><span class="token keyword">func</span> <span class="token punctuation">(</span>t <span class="token operator">*</span>NoopTelemetry<span class="token punctuation">)</span> <span class="token function">MeterInt64Histogram</span><span class="token punctuation">(</span>metric Metric<span class="token punctuation">)</span> <span class="token punctuation">(</span>metric<span class="token punctuation">.</span>Int64Histogram<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">	<span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> <span class="token boolean">nil</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// MeterInt64UpDownCounter returns nil.</span>
</span><span class="code-line"><span class="token keyword">func</span> <span class="token punctuation">(</span>t <span class="token operator">*</span>NoopTelemetry<span class="token punctuation">)</span> <span class="token function">MeterInt64UpDownCounter</span><span class="token punctuation">(</span>metric Metric<span class="token punctuation">)</span> <span class="token punctuation">(</span>metric<span class="token punctuation">.</span>Int64UpDownCounter<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">	<span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> <span class="token boolean">nil</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// Shutdown does nothing.</span>
</span><span class="code-line"><span class="token keyword">func</span> <span class="token punctuation">(</span>t <span class="token operator">*</span>NoopTelemetry<span class="token punctuation">)</span> <span class="token function">Shutdown</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</span></code></pre></div><p>The <code>NoopTelemetry</code> struct implements the <code>TelemetryProvider</code> interface, but does nothing. This is useful for tests, where we don&#x27;t want to send telemetry data to an external system.</p><h2 id="using-the-telemetry-package"><a aria-hidden="true" tabindex="-1" href="#using-the-telemetry-package"><span class="icon icon-link"></span></a>Using the Telemetry Package</h2><p>In <code>main.go</code>, we can now initialize and use our telemetry system. Here&#x27;s an example of how to use the <code>gotel</code> package to create a new telemetry system. In this example, if the initialization fails, the <code>NewTelemetry</code> function falls back to a no-op telemetry system. This is useful for graceful degradation, where we want to continue running the application even if the telemetry system is down.</p><div class="relative"><pre><code class="language-go code-highlight"><span class="code-line"><span class="token keyword">package</span> main
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">import</span> <span class="token punctuation">(</span>
</span><span class="code-line">	<span class="token string">&quot;context&quot;</span>
</span><span class="code-line">	<span class="token string">&quot;fmt&quot;</span>
</span><span class="code-line">	<span class="token string">&quot;os&quot;</span>
</span><span class="code-line">
</span><span class="code-line">	<span class="token string">&quot;github.com/lucavallin/gotel&quot;</span>
</span><span class="code-line"><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">	ctx <span class="token operator">:=</span> context<span class="token punctuation">.</span><span class="token function">Background</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">	telemConfig<span class="token punctuation">,</span> err <span class="token operator">:=</span> gotel<span class="token punctuation">.</span><span class="token function">NewConfigFromEnv</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
</span><span class="code-line">		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;failed to load telemetry config&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line">		os<span class="token punctuation">.</span><span class="token function">Exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">	<span class="token comment">// Initialize telemetry. If the exporter fails, fallback to nop.</span>
</span><span class="code-line">	<span class="token keyword">var</span> telem gotel<span class="token punctuation">.</span>TelemetryProvider
</span><span class="code-line">	telem<span class="token punctuation">,</span> err <span class="token operator">=</span> gotel<span class="token punctuation">.</span><span class="token function">NewTelemetry</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> telemConfig<span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
</span><span class="code-line">		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;failed to create telemetry, falling back to no-op telemetry&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line">		telem<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">=</span> gotel<span class="token punctuation">.</span><span class="token function">NewNoopTelemetry</span><span class="token punctuation">(</span>telemConfig<span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token punctuation">}</span>
</span><span class="code-line">	<span class="token keyword">defer</span> telem<span class="token punctuation">.</span><span class="token function">Shutdown</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">	telem<span class="token punctuation">.</span><span class="token function">LogInfo</span><span class="token punctuation">(</span><span class="token string">&quot;telemetry initialized&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><p>The <code>telem</code> variable is an instance of the <code>Telemetry</code> struct, which implements the <code>TelemetryProvider</code> interface. It can be used to write info-level logs with <code>telem.LogInfo()</code>, for example. The <code>telem</code> variable can also be passed to other parts of the application, like services, middleware, etc.</p><h3 id="what-about-traces"><a aria-hidden="true" tabindex="-1" href="#what-about-traces"><span class="icon icon-link"></span></a>What About Traces?</h3><p>Traces track a request as it flows through multiple services. A trace is made up of <strong>spans</strong>, each representing an individual operation. The <code>TraceStart</code> function that the <code>gotel</code> package provides is a convenient way to start a new span and attach it to the current context. This is useful for instrumenting HTTP requests, for example.</p><p>Let&#x27;s take this example of a fictional API:</p><div class="relative"><pre><code class="language-go code-highlight"><span class="code-line"><span class="token keyword">type</span> API <span class="token keyword">struct</span> <span class="token punctuation">{</span>
</span><span class="code-line">	telem   gotel<span class="token punctuation">.</span>TelemetryProvider
</span><span class="code-line">	httpSrv <span class="token operator">*</span>http<span class="token punctuation">.</span>Server
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><p>This API has a <code>telem</code> field that holds a reference to the telemetry system. I like to structure my APIs this way because it makes it easy to use dependencies in the HTTP handlers.</p><div class="relative"><pre><code class="language-go code-highlight"><span class="code-line"><span class="token keyword">func</span> <span class="token punctuation">(</span>a <span class="token operator">*</span>API<span class="token punctuation">)</span> <span class="token function">GetSomething</span><span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">	<span class="token boolean">_</span><span class="token punctuation">,</span> span <span class="token operator">:=</span> a<span class="token punctuation">.</span>telem<span class="token punctuation">.</span><span class="token function">TraceStart</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span>Request<span class="token punctuation">.</span><span class="token function">Context</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;get_something&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token keyword">defer</span> span<span class="token punctuation">.</span><span class="token function">End</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">	something <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span><span class="token string">&quot;foo&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;bar&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;baz&quot;</span><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">	c<span class="token punctuation">.</span><span class="token function">JSON</span><span class="token punctuation">(</span>http<span class="token punctuation">.</span>StatusOK<span class="token punctuation">,</span> something<span class="token punctuation">)</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><p>In this example, the <code>GetSomething</code> handler starts a new span with the name <code>get_something</code> and attaches it to the current context. The <code>defer span.End()</code> statement ends the span when the function returns.</p><h3 id="middlewares--metrics"><a aria-hidden="true" tabindex="-1" href="#middlewares--metrics"><span class="icon icon-link"></span></a>Middlewares &amp; Metrics</h3><p>A common pattern is to use <strong>middlewares</strong> to instrument HTTP requests. Here&#x27;s an example of a <code>telemetry</code> middleware that logs request duration and counts requests in flight. This is useful for monitoring the health of the application.</p><p>In a <code>metrics.go</code> file, we define a <code>Metrics</code> struct that holds references to the metrics we want to collect. This makes it easy to pass the metrics to middleware and other parts of the application. The <code>Metric</code> struct defines the name, unit, and description of a metric. This is useful for defining metrics in a reusable way.</p><div class="relative"><pre><code class="language-go code-highlight"><span class="code-line"><span class="token keyword">package</span> gotel
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// Metric represents a metric that can be collected by the server.</span>
</span><span class="code-line"><span class="token keyword">type</span> Metric <span class="token keyword">struct</span> <span class="token punctuation">{</span>
</span><span class="code-line">	Name        <span class="token builtin">string</span>
</span><span class="code-line">	Unit        <span class="token builtin">string</span>
</span><span class="code-line">	Description <span class="token builtin">string</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// MetricRequestDurationMillis is a metric that measures the latency of HTTP requests processed by the server, in milliseconds.</span>
</span><span class="code-line"><span class="token keyword">var</span> MetricRequestDurationMillis <span class="token operator">=</span> Metric<span class="token punctuation">{</span>
</span><span class="code-line">	Name<span class="token punctuation">:</span>        <span class="token string">&quot;request_duration_millis&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">	Unit<span class="token punctuation">:</span>        <span class="token string">&quot;ms&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">	Description<span class="token punctuation">:</span> <span class="token string">&quot;Measures the latency of HTTP requests processed by the server, in milliseconds.&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// MetricRequestsInFlight is a metric that measures the number of requests currently being processed by the server.</span>
</span><span class="code-line"><span class="token keyword">var</span> MetricRequestsInFlight <span class="token operator">=</span> Metric<span class="token punctuation">{</span>
</span><span class="code-line">	Name<span class="token punctuation">:</span>        <span class="token string">&quot;requests_inflight&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">	Unit<span class="token punctuation">:</span>        <span class="token string">&quot;{count}&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">	Description<span class="token punctuation">:</span> <span class="token string">&quot;Measures the number of requests currently being processed by the server.&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><p>A <code>middleware.go</code> file instead contains the <code>telemetry</code> middleware, for use with the <a target="_blank" rel="noopener noreferrer" href="https://gin-gonic.com">gin</a> web framework. The middleware functions defined can be used to log requests, measure request duration, and count requests in flight.</p><div class="relative"><pre><code class="language-go code-highlight"><span class="code-line"><span class="token keyword">package</span> gotel
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">import</span> <span class="token punctuation">(</span>
</span><span class="code-line">	<span class="token string">&quot;fmt&quot;</span>
</span><span class="code-line">	<span class="token string">&quot;time&quot;</span>
</span><span class="code-line">
</span><span class="code-line">	<span class="token string">&quot;github.com/gin-gonic/gin&quot;</span>
</span><span class="code-line">
</span><span class="code-line">	<span class="token string">&quot;go.opentelemetry.io/otel/metric&quot;</span>
</span><span class="code-line">	<span class="token string">&quot;go.opentelemetry.io/otel/semconv/v1.20.0/httpconv&quot;</span>
</span><span class="code-line"><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// LogRequest is a gin middleware that logs the request path.</span>
</span><span class="code-line"><span class="token keyword">func</span> <span class="token punctuation">(</span>t <span class="token operator">*</span>Telemetry<span class="token punctuation">)</span> <span class="token function">LogRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span> gin<span class="token punctuation">.</span>HandlerFunc <span class="token punctuation">{</span>
</span><span class="code-line">	<span class="token keyword">return</span> <span class="token keyword">func</span><span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">		t<span class="token punctuation">.</span><span class="token function">LogInfo</span><span class="token punctuation">(</span><span class="token string">&quot;request to &quot;</span><span class="token punctuation">,</span> c<span class="token punctuation">.</span>Request<span class="token punctuation">.</span>URL<span class="token punctuation">.</span>Path<span class="token punctuation">)</span>
</span><span class="code-line">		c<span class="token punctuation">.</span><span class="token function">Next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">		t<span class="token punctuation">.</span><span class="token function">LogInfo</span><span class="token punctuation">(</span><span class="token string">&quot;end of request to &quot;</span><span class="token punctuation">,</span> c<span class="token punctuation">.</span>Request<span class="token punctuation">.</span>URL<span class="token punctuation">.</span>Path<span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token punctuation">}</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// MeterRequestDuration is a gin middleware that captures the duration of the request.</span>
</span><span class="code-line"><span class="token keyword">func</span> <span class="token punctuation">(</span>t <span class="token operator">*</span>Telemetry<span class="token punctuation">)</span> <span class="token function">MeterRequestDuration</span><span class="token punctuation">(</span><span class="token punctuation">)</span> gin<span class="token punctuation">.</span>HandlerFunc <span class="token punctuation">{</span>
</span><span class="code-line">	<span class="token comment">// init metric, here we are using histogram for capturing request duration</span>
</span><span class="code-line">	histogram<span class="token punctuation">,</span> err <span class="token operator">:=</span> t<span class="token punctuation">.</span><span class="token function">MeterInt64Histogram</span><span class="token punctuation">(</span>MetricRequestDurationMillis<span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
</span><span class="code-line">		t<span class="token punctuation">.</span><span class="token function">LogFatalln</span><span class="token punctuation">(</span>fmt<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;failed to create histogram: %w&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">	<span class="token keyword">return</span> <span class="token keyword">func</span><span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">		<span class="token comment">// capture the start time of the request</span>
</span><span class="code-line">		startTime <span class="token operator">:=</span> time<span class="token punctuation">.</span><span class="token function">Now</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">		<span class="token comment">// execute next http handler</span>
</span><span class="code-line">		c<span class="token punctuation">.</span><span class="token function">Next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">		<span class="token comment">// record the request duration</span>
</span><span class="code-line">		duration <span class="token operator">:=</span> time<span class="token punctuation">.</span><span class="token function">Since</span><span class="token punctuation">(</span>startTime<span class="token punctuation">)</span>
</span><span class="code-line">		histogram<span class="token punctuation">.</span><span class="token function">Record</span><span class="token punctuation">(</span>
</span><span class="code-line">			c<span class="token punctuation">.</span>Request<span class="token punctuation">.</span><span class="token function">Context</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
</span><span class="code-line">			duration<span class="token punctuation">.</span><span class="token function">Milliseconds</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
</span><span class="code-line">			metric<span class="token punctuation">.</span><span class="token function">WithAttributes</span><span class="token punctuation">(</span>
</span><span class="code-line">				httpconv<span class="token punctuation">.</span><span class="token function">ServerRequest</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span><span class="token function">GetServiceName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> c<span class="token punctuation">.</span>Request<span class="token punctuation">)</span><span class="token operator">...</span><span class="token punctuation">,</span>
</span><span class="code-line">			<span class="token punctuation">)</span><span class="token punctuation">,</span>
</span><span class="code-line">		<span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token punctuation">}</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// MeterRequestsInFlight is a gin middleware that captures the number of requests in flight.</span>
</span><span class="code-line"><span class="token keyword">func</span> <span class="token punctuation">(</span>t <span class="token operator">*</span>Telemetry<span class="token punctuation">)</span> <span class="token function">MeterRequestsInFlight</span><span class="token punctuation">(</span><span class="token punctuation">)</span> gin<span class="token punctuation">.</span>HandlerFunc <span class="token punctuation">{</span>
</span><span class="code-line">	<span class="token comment">// init metric, here we are using counter for capturing request in flight</span>
</span><span class="code-line">	counter<span class="token punctuation">,</span> err <span class="token operator">:=</span> t<span class="token punctuation">.</span><span class="token function">MeterInt64UpDownCounter</span><span class="token punctuation">(</span>MetricRequestsInFlight<span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
</span><span class="code-line">		t<span class="token punctuation">.</span><span class="token function">LogFatalln</span><span class="token punctuation">(</span>fmt<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;failed to create counter: %w&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">	<span class="token keyword">return</span> <span class="token keyword">func</span><span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">		<span class="token comment">// define metric attributes</span>
</span><span class="code-line">		attrs <span class="token operator">:=</span> metric<span class="token punctuation">.</span><span class="token function">WithAttributes</span><span class="token punctuation">(</span>httpconv<span class="token punctuation">.</span><span class="token function">ServerRequest</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span><span class="token function">GetServiceName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> c<span class="token punctuation">.</span>Request<span class="token punctuation">)</span><span class="token operator">...</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">		<span class="token comment">// increase the number of requests in flight</span>
</span><span class="code-line">		counter<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span>Request<span class="token punctuation">.</span><span class="token function">Context</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> attrs<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">		<span class="token comment">// execute next http handler</span>
</span><span class="code-line">		c<span class="token punctuation">.</span><span class="token function">Next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">		<span class="token comment">// decrease the number of requests in flight</span>
</span><span class="code-line">		counter<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span>Request<span class="token punctuation">.</span><span class="token function">Context</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> attrs<span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token punctuation">}</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><p>You can then use the middleware in your application to get observability data transparently. For example, with <a target="_blank" rel="noopener noreferrer" href="https://github.com/gin-gonic/gin">gin-gonic/gin</a>:</p><div class="relative"><pre><code class="language-go code-highlight"><span class="code-line">r <span class="token operator">:=</span> gin<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">r<span class="token punctuation">.</span><span class="token function">Use</span><span class="token punctuation">(</span>telem<span class="token punctuation">.</span><span class="token function">LogRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">r<span class="token punctuation">.</span><span class="token function">Use</span><span class="token punctuation">(</span>telem<span class="token punctuation">.</span><span class="token function">MeterRequestDuration</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">r<span class="token punctuation">.</span><span class="token function">Use</span><span class="token punctuation">(</span>telem<span class="token punctuation">.</span><span class="token function">MeterRequestsInFlight</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span></code></pre></div><p>See gin&#x27;s <a target="_blank" rel="noopener noreferrer" href="https://gin-gonic.com/docs/examples/custom-middleware/">Custom Middleware</a> docs for more information.</p><h2 id="so-where-does-the-telemetry-go"><a aria-hidden="true" tabindex="-1" href="#so-where-does-the-telemetry-go"><span class="icon icon-link"></span></a>So Where Does the Telemetry Go?</h2><p>The telemetry data is sent to an observability backend, and Grafana&#x27;s <code>grafana/docker-otel-lgtm</code> is an all-in-one OpenTelemetry backend that makes it easy to get started.</p><div><img alt="Grafana&#x27;s docker-otel-lgtm" loading="lazy" width="1577" height="658" decoding="async" data-nimg="1" style="color:transparent" srcSet="/_next/image?url=%2Fimages%2Fblog%2Fopentelemetry-a-guide-to-observability-with-go%2Fgrafana-docker-otel-lgtm.webp&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fimages%2Fblog%2Fopentelemetry-a-guide-to-observability-with-go%2Fgrafana-docker-otel-lgtm.webp&amp;w=3840&amp;q=75 2x" src="/_next/image?url=%2Fimages%2Fblog%2Fopentelemetry-a-guide-to-observability-with-go%2Fgrafana-docker-otel-lgtm.webp&amp;w=3840&amp;q=75"/></div><p>Grafana&#x27;s <code>grafana/docker-otel-lgtm</code> is a Docker image that offers a ready-to-use OpenTelemetry backend. It integrates the OpenTelemetry Collector with Grafana&#x27;s LGTM stack (Loki for logs, Grafana for visualization, Tempo for traces, and Mimir for metrics).</p><p>By running this container, you can receive OpenTelemetry signals on default ports (4317 for gRPC and 4318 for HTTP). These signals are then automatically forwarded: logs go to <strong>Loki</strong>, traces go to <strong>Tempo</strong>, and metrics go to <strong>Mimir</strong>.</p><p>Grafana is pre-configured to visualize all these data sources and is accessible via port 3000. This makes it a great solution for development, demos, and testing environments, providing a quick way to analyze telemetry data without needing extensive configuration.</p><h2 id="summary"><a aria-hidden="true" tabindex="-1" href="#summary"><span class="icon icon-link"></span></a>Summary</h2><p>Observability isn&#x27;t just a nice-to-have, it&#x27;s what keeps you from flying blind when things go wrong in your application. OpenTelemetry makes it easy to <strong>collect, process, and export logs, metrics, and traces</strong> in a way that&#x27;s standardized and vendor-neutral. In this post, we broke down the key concepts of observability, explored how OpenTelemetry works, and built a reusable telemetry package in Go to keep logging, metrics, and tracing clean and consistent across an application.</p><p>By structuring everything into a single, easy-to-use package, we&#x27;ve made it simple to instrument your code without cluttering it. Whether you need to debug a slow request, track system performance, or figure out why your service is on fire at 2 AM, OpenTelemetry has you covered. And with Grafana&#x27;s <code>docker-otel-lgtm</code>, you can spin up a fully functional OpenTelemetry backend in seconds to visualize all your telemetry data.</p><p>If you want to give it a try, check out <a target="_blank" rel="noopener noreferrer" href="https://github.com/lucavallin/gotel">gotel</a> on GitHub. It&#x27;s built to be plug-and-play, so you can start collecting logs, metrics, and traces right away. Happy coding, and may your traces always connect, your metrics make sense, and your logs tell you what actually happened! 🚀</p></div><div></div></div></div></div></article></div></main><footer class="mt-12 border-t-2 border-dashed border-pink/20"><div class="mt-3 flex flex-col items-center"><div class="mb-4 flex flex-row flex-wrap items-end justify-center space-x-4 space-y-4 px-6"><a target="_blank" rel="noopener noreferrer" title="GitHub" aria-label="GitHub" href="https://github.com/lucavallin"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="github" class="svg-inline--fa fa-github fa-xl " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg></a><a target="_blank" rel="noopener noreferrer" title="LinkedIn" aria-label="LinkedIn" href="https://www.linkedin.com/in/lucavallin"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="linkedin" class="svg-inline--fa fa-linkedin fa-xl " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"></path></svg></a><a target="_blank" rel="noopener noreferrer" title="Unsplash" aria-label="Unsplash" href="https://unsplash.com/@lucavallin"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="unsplash" class="svg-inline--fa fa-unsplash fa-xl " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M448,230.17V480H0V230.17H141.13V355.09H306.87V230.17ZM306.87,32H141.13V156.91H306.87Z"></path></svg></a><a target="_blank" rel="noopener noreferrer" title="Instagram" aria-label="Instagram" href="https://instagram.com/lucavallincom"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="instagram" class="svg-inline--fa fa-instagram fa-xl " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M224.1 141c-63.6 0-114.9 51.3-114.9 114.9s51.3 114.9 114.9 114.9S339 319.5 339 255.9 287.7 141 224.1 141zm0 189.6c-41.1 0-74.7-33.5-74.7-74.7s33.5-74.7 74.7-74.7 74.7 33.5 74.7 74.7-33.6 74.7-74.7 74.7zm146.4-194.3c0 14.9-12 26.8-26.8 26.8-14.9 0-26.8-12-26.8-26.8s12-26.8 26.8-26.8 26.8 12 26.8 26.8zm76.1 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9 0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8 0-184.8zM398.8 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1z"></path></svg></a><a title="RSS" aria-label="RSS" href="/feed.xml"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="rss" class="svg-inline--fa fa-rss fa-xl " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M0 64C0 46.3 14.3 32 32 32c229.8 0 416 186.2 416 416c0 17.7-14.3 32-32 32s-32-14.3-32-32C384 253.6 226.4 96 32 96C14.3 96 0 81.7 0 64zM0 416a64 64 0 1 1 128 0A64 64 0 1 1 0 416zM32 160c159.1 0 288 128.9 288 288c0 17.7-14.3 32-32 32s-32-14.3-32-32c0-123.7-100.3-224-224-224c-17.7 0-32-14.3-32-32s14.3-32 32-32z"></path></svg></a></div><div class="mb-8 flex flex-col text-center text-sm text-gray-800"><div>Luca Cavallin<!-- --> © <!-- -->2025<!-- --> • <a title="Sitemap" aria-label="Sitemap" href="/sitemap.xml">Sitemap</a></div></div></div></footer></div></div><!--$!--><template data-dgst="BAILOUT_TO_CLIENT_SIDE_RENDERING"></template><!--/$--><script src="/_next/static/chunks/webpack-6a21cf8a7fb177e8.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[3704,[\"742\",\"static/chunks/742-b57de7a1e544e103.js\",\"909\",\"static/chunks/app/blog/%5B...slug%5D/page-9ea14279cb279a5a.js\"],\"\"]\n3:I[7969,[\"266\",\"static/chunks/870fdd6f-ce0f76f83efea37d.js\",\"742\",\"static/chunks/742-b57de7a1e544e103.js\",\"658\",\"static/chunks/658-ad59756ae9aed5f1.js\",\"786\",\"static/chunks/786-e9f9e114c7d7dc3f.js\",\"177\",\"static/chunks/app/layout-543cb7473bb1a7b1.js\"],\"KBarSearchProvider\"]\n4:I[3768,[\"266\",\"static/chunks/870fdd6f-ce0f76f83efea37d.js\",\"742\",\"static/chunks/742-b57de7a1e544e103.js\",\"658\",\"static/chunks/658-ad59756ae9aed5f1.js\",\"786\",\"static/chunks/786-e9f9e114c7d7dc3f.js\",\"177\",\"static/chunks/app/layout-543cb7473bb1a7b1.js\"],\"default\"]\n5:I[5244,[],\"\"]\n6:I[3866,[],\"\"]\n7:I[8173,[\"742\",\"static/chunks/742-b57de7a1e544e103.js\",\"909\",\"static/chunks/app/blog/%5B...slug%5D/page-9ea14279cb279a5a.js\"],\"\"]\n9:I[8686,[\"266\",\"static/chunks/870fdd6f-ce0f76f83efea37d.js\",\"742\",\"static/chunks/742-b57de7a1e544e103.js\",\"658\",\"static/chunks/658-ad59756ae9aed5f1.js\",\"786\",\"static/chunks/786-e9f9e114c7d7dc3f.js\",\"177\",\"static/chunks/app/layout-543cb7473bb1a7b1.js\"],\"SpeedInsights\"]\nb:I[6213,[],\"OutletBoundary\"]\nd:I[6213,[],\"MetadataBoundary\"]\nf:I[6213,[],\"ViewportBoundary\"]\n11:I[4835,[],\"\"]\n:HL[\"/_next/static/media/2d141e1a38819612-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/css/be280990ef8e1d7c.css\",\"style\"]\n:HL[\"/_next/static/css/966704dcf8a4851e.css\",\"style\"]\n8:T518,M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6"])</script><script>self.__next_f.push([1,"-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"-_xncSkW0Zz1nn7LgpTYI\",\"p\":\"\",\"c\":[\"\",\"blog\",\"opentelemetry-a-guide-to-observability-with-go\"],\"i\":false,\"f\":[[[\"\",{\"children\":[\"blog\",{\"children\":[[\"slug\",\"opentelemetry-a-guide-to-observability-with-go\",\"c\"],{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[\"\",[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/be280990ef8e1d7c.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en-us\",\"className\":\"__variable_0aa4ae scroll-smooth\",\"suppressHydrationWarning\":true,\"children\":[[\"$\",\"head\",null,{\"children\":[[\"$\",\"link\",null,{\"rel\":\"mask-icon\",\"href\":\"/safari-pinned-tab.svg\",\"color\":\"#101620\"}],[\"$\",\"meta\",null,{\"name\":\"msapplication-TileColor\",\"content\":\"#101620\"}],[\"$\",\"meta\",null,{\"name\":\"theme-color\",\"content\":\"#101620\"}],[\"$\",\"link\",null,{\"rel\":\"alternate\",\"type\":\"application/rss+xml\",\"href\":\"/feed.xml\"}],[\"$\",\"$L2\",null,{\"defer\":true,\"data-domain\":\"lucavall.in\",\"src\":\"/js/script.js\"}]]}],[\"$\",\"body\",null,{\"className\":\"bg-black-400 px-1 text-white antialiased\",\"children\":[[\"$\",\"div\",null,{\"className\":\"mx-auto max-w-3xl px-4 sm:px-6 xl:max-w-5xl xl:px-0\",\"children\":[\"$\",\"div\",null,{\"className\":\"flex h-screen flex-col justify-between font-sans\",\"children\":[[\"$\",\"$L3\",null,{\"kbarConfig\":{\"searchDocumentsPath\":\"search.json\"},\"children\":[[\"$\",\"$L4\",null,{}],[\"$\",\"main\",null,{\"className\":\"mb-auto\",\"children\":[\"$\",\"$L5\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L6\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[],[\"$\",\"div\",null,{\"className\":\"flex flex-col items-start justify-start md:mt-24 md:flex-row md:items-center md:justify-center md:space-x-6\",\"children\":[[\"$\",\"div\",null,{\"className\":\"space-x-2 pb-8 pt-6 md:space-y-5\",\"children\":[\"$\",\"h1\",null,{\"className\":\"text-6xl font-extrabold leading-9 tracking-tight text-gray-900 md:border-r-2 md:px-6 md:text-8xl md:leading-14\",\"children\":\"404\"}]}],[\"$\",\"div\",null,{\"className\":\"max-w-md\",\"children\":[\"$\",\"p\",null,{\"className\":\"mb-4 text-xl font-bold leading-normal md:text-2xl\",\"children\":\"Sorry, the page imploded.\"}]}]]}]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]]}],[\"$\",\"footer\",null,{\"className\":\"mt-12 border-t-2 border-dashed border-pink/20\",\"children\":[\"$\",\"div\",null,{\"className\":\"mt-3 flex flex-col items-center\",\"children\":[[\"$\",\"div\",null,{\"className\":\"mb-4 flex flex-row flex-wrap items-end justify-center space-x-4 space-y-4 px-6\",\"children\":[[\"$\",\"$L7\",null,{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://github.com/lucavallin\",\"title\":\"GitHub\",\"aria-label\":\"GitHub\",\"children\":[\"$\",\"svg\",null,{\"aria-hidden\":\"true\",\"focusable\":\"false\",\"data-prefix\":\"fab\",\"data-icon\":\"github\",\"className\":\"svg-inline--fa fa-github fa-xl \",\"role\":\"img\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"viewBox\":\"0 0 496 512\",\"style\":{},\"ref\":\"$undefined\",\"children\":[\"$\",\"path\",null,{\"fill\":\"currentColor\",\"d\":\"$8\",\"style\":{}}]}]}],[\"$\",\"$L7\",null,{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://www.linkedin.com/in/lucavallin\",\"title\":\"LinkedIn\",\"aria-label\":\"LinkedIn\",\"children\":[\"$\",\"svg\",null,{\"aria-hidden\":\"true\",\"focusable\":\"false\",\"data-prefix\":\"fab\",\"data-icon\":\"linkedin\",\"className\":\"svg-inline--fa fa-linkedin fa-xl \",\"role\":\"img\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"viewBox\":\"0 0 448 512\",\"style\":{},\"ref\":\"$undefined\",\"children\":[\"$\",\"path\",null,{\"fill\":\"currentColor\",\"d\":\"M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z\",\"style\":{}}]}]}],[\"$\",\"$L7\",null,{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://unsplash.com/@lucavallin\",\"title\":\"Unsplash\",\"aria-label\":\"Unsplash\",\"children\":[\"$\",\"svg\",null,{\"aria-hidden\":\"true\",\"focusable\":\"false\",\"data-prefix\":\"fab\",\"data-icon\":\"unsplash\",\"className\":\"svg-inline--fa fa-unsplash fa-xl \",\"role\":\"img\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"viewBox\":\"0 0 448 512\",\"style\":{},\"ref\":\"$undefined\",\"children\":[\"$\",\"path\",null,{\"fill\":\"currentColor\",\"d\":\"M448,230.17V480H0V230.17H141.13V355.09H306.87V230.17ZM306.87,32H141.13V156.91H306.87Z\",\"style\":{}}]}]}],[\"$\",\"$L7\",null,{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://instagram.com/lucavallincom\",\"title\":\"Instagram\",\"aria-label\":\"Instagram\",\"children\":[\"$\",\"svg\",null,{\"aria-hidden\":\"true\",\"focusable\":\"false\",\"data-prefix\":\"fab\",\"data-icon\":\"instagram\",\"className\":\"svg-inline--fa fa-instagram fa-xl \",\"role\":\"img\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"viewBox\":\"0 0 448 512\",\"style\":{},\"ref\":\"$undefined\",\"children\":[\"$\",\"path\",null,{\"fill\":\"currentColor\",\"d\":\"M224.1 141c-63.6 0-114.9 51.3-114.9 114.9s51.3 114.9 114.9 114.9S339 319.5 339 255.9 287.7 141 224.1 141zm0 189.6c-41.1 0-74.7-33.5-74.7-74.7s33.5-74.7 74.7-74.7 74.7 33.5 74.7 74.7-33.6 74.7-74.7 74.7zm146.4-194.3c0 14.9-12 26.8-26.8 26.8-14.9 0-26.8-12-26.8-26.8s12-26.8 26.8-26.8 26.8 12 26.8 26.8zm76.1 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9 0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8 0-184.8zM398.8 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1z\",\"style\":{}}]}]}],[\"$\",\"$L7\",null,{\"href\":\"/feed.xml\",\"title\":\"RSS\",\"aria-label\":\"RSS\",\"children\":[\"$\",\"svg\",null,{\"aria-hidden\":\"true\",\"focusable\":\"false\",\"data-prefix\":\"fas\",\"data-icon\":\"rss\",\"className\":\"svg-inline--fa fa-rss fa-xl \",\"role\":\"img\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"viewBox\":\"0 0 448 512\",\"style\":{},\"ref\":\"$undefined\",\"children\":[\"$\",\"path\",null,{\"fill\":\"currentColor\",\"d\":\"M0 64C0 46.3 14.3 32 32 32c229.8 0 416 186.2 416 416c0 17.7-14.3 32-32 32s-32-14.3-32-32C384 253.6 226.4 96 32 96C14.3 96 0 81.7 0 64zM0 416a64 64 0 1 1 128 0A64 64 0 1 1 0 416zM32 160c159.1 0 288 128.9 288 288c0 17.7-14.3 32-32 32s-32-14.3-32-32c0-123.7-100.3-224-224-224c-17.7 0-32-14.3-32-32s14.3-32 32-32z\",\"style\":{}}]}]}]]}],[\"$\",\"div\",null,{\"className\":\"mb-8 flex flex-col text-center text-sm text-gray-800\",\"children\":[\"$\",\"div\",null,{\"children\":[\"Luca Cavallin\",\" © \",2025,\" • \",[\"$\",\"$L7\",null,{\"href\":\"/sitemap.xml\",\"title\":\"Sitemap\",\"aria-label\":\"Sitemap\",\"children\":\"Sitemap\"}]]}]}]]}]}]]}]}],[\"$\",\"$L9\",null,{}]]}]]}]]}],{\"children\":[\"blog\",[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L5\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"blog\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L6\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"slug\",\"opentelemetry-a-guide-to-observability-with-go\",\"c\"],[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L5\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"blog\",\"children\",\"$0:f:0:1:2:children:2:children:0\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L6\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[\"__PAGE__\",[\"$\",\"$1\",\"c\",{\"children\":[\"$La\",[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/966704dcf8a4851e.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"$Lb\",null,{\"children\":\"$Lc\"}]]}],{},null,false]},null,false]},null,false]},null,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[\"$\",\"$1\",\"x2uSiT8z6i1I2iUrdxeS1\",{\"children\":[[\"$\",\"$Ld\",null,{\"children\":\"$Le\"}],[\"$\",\"$Lf\",null,{\"children\":\"$L10\"}],[\"$\",\"meta\",null,{\"name\":\"next-size-adjust\",\"content\":\"\"}]]}]]}],false]],\"m\":\"$undefined\",\"G\":[\"$11\",\"$undefined\"],\"s\":false,\"S\":true}\n"])</script><script>self.__next_f.push([1,"12:I[7970,[\"742\",\"static/chunks/742-b57de7a1e544e103.js\",\"909\",\"static/chunks/app/blog/%5B...slug%5D/page-9ea14279cb279a5a.js\"],\"Image\"]\n13:I[8801,[\"742\",\"static/chunks/742-b57de7a1e544e103.js\",\"909\",\"static/chunks/app/blog/%5B...slug%5D/page-9ea14279cb279a5a.js\"],\"default\"]\n"])</script><script>self.__next_f.push([1,"a:[[\"$\",\"$L2\",null,{\"id\":\"json-ld\",\"type\":\"application/ld+json\",\"dangerouslySetInnerHTML\":{\"__html\":\"{\\\"@context\\\":\\\"https://schema.org\\\",\\\"@graph\\\":[{\\\"@context\\\":\\\"https://schema.org\\\",\\\"@type\\\":\\\"BlogPosting\\\",\\\"headline\\\":\\\"OpenTelemetry: A Guide to Observability with Go\\\",\\\"datePublished\\\":\\\"2025-02-06T00:00:00.000Z\\\",\\\"dateModified\\\":\\\"2025-02-06T00:00:00.000Z\\\",\\\"description\\\":\\\"Modern applications are often complex, distributed systems. Debugging them is not fun: you have to follow requests across services, logs get lost, and metrics are often hard to correlate. It's like looking for a needle in a haystack - except the haystack is on fire, and the needle keeps moving. This is where OpenTelemetry (OTel) can help.\\\",\\\"image\\\":\\\"/images/blog/opentelemetry-a-guide-to-observability-with-go/cover.webp\\\",\\\"url\\\":\\\"https://www.lucavall.in/blog/opentelemetry-a-guide-to-observability-with-go\\\",\\\"author\\\":{\\\"@type\\\":\\\"Person\\\",\\\"name\\\":\\\"Luca Cavallin\\\",\\\"url\\\":\\\"https://www.lucavall.in\\\"}}]}\"}}],[\"$\",\"div\",null,{\"className\":\"mx-auto max-w-3xl px-4 sm:px-6 xl:max-w-5xl xl:px-0\",\"children\":[\"$\",\"article\",null,{\"children\":[\"$\",\"div\",null,{\"className\":\"divide-y divide-dashed divide-silver-200\",\"children\":[[\"$\",\"header\",null,{\"className\":\"p-6\",\"children\":[\"$\",\"div\",null,{\"className\":\"space-y-1 text-center\",\"children\":[[\"$\",\"div\",null,{\"className\":\"space-y-10\",\"children\":[\"$\",\"div\",null,{\"children\":[\"$\",\"dl\",null,{\"children\":[[\"$\",\"dt\",null,{\"className\":\"sr-only\",\"children\":\"Published on\"}],[\"$\",\"dd\",null,{\"className\":\"text-base font-medium leading-6 text-gray-700\",\"children\":[\"$\",\"time\",null,{\"dateTime\":\"2025-02-06T00:00:00.000Z\",\"children\":\"Thursday, February 6, 2025\"}]}]]}]}]}],[\"$\",\"div\",null,{\"className\":\"pb-2\",\"children\":[\"$\",\"h1\",null,{\"className\":\"text-4xl font-extrabold leading-9 tracking-tight text-gray-900 sm:text-4xl sm:leading-10 md:text-5xl md:leading-14\",\"children\":\"OpenTelemetry: A Guide to Observability with Go\"}]}],[\"$\",\"div\",null,{\"className\":\"pb-2\",\"children\":[\"$\",\"div\",null,{\"className\":\"flex flex-wrap items-center justify-center\",\"children\":[[\"$\",\"h2\",null,{\"className\":\"mr-2 text-xs uppercase tracking-wide text-gray-700\",\"children\":\"Tags\"}],[[\"$\",\"$L7\",\"golang\",{\"href\":\"/blog/tags/golang\",\"title\":\"golang\",\"aria-label\":\"golang\",\"className\":\"mr-3 text-lg font-medium uppercase text-pink-500 hover:text-pink-400\",\"children\":\"golang\"}],[\"$\",\"$L7\",\"opentelemetry\",{\"href\":\"/blog/tags/opentelemetry\",\"title\":\"opentelemetry\",\"aria-label\":\"opentelemetry\",\"className\":\"mr-3 text-lg font-medium uppercase text-pink-500 hover:text-pink-400\",\"children\":\"opentelemetry\"}],[\"$\",\"$L7\",\"observability\",{\"href\":\"/blog/tags/observability\",\"title\":\"observability\",\"aria-label\":\"observability\",\"className\":\"mr-3 text-lg font-medium uppercase text-pink-500 hover:text-pink-400\",\"children\":\"observability\"}]]]}]}],[\"$\",\"div\",null,{\"className\":\"flex flex-wrap justify-center\",\"children\":[\"$\",\"div\",null,{\"className\":\"flex justify-center\",\"children\":[[\"$\",\"$L12\",null,{\"src\":\"/images/luca_cavallin.webp\",\"width\":38,\"height\":38,\"alt\":\"avatar\",\"className\":\"size-5 rounded-full\"}],[\"$\",\"dl\",null,{\"className\":\"whitespace-nowrap pl-3 text-base font-medium leading-5\",\"children\":[[\"$\",\"dt\",null,{\"className\":\"sr-only\",\"children\":\"Name\"}],[\"$\",\"dd\",null,{\"className\":\"text-gray-900\",\"children\":\"Luca Cavallin\"}]]}]]}]}]]}]}],[\"$\",\"div\",null,{\"className\":\"divide-y divide-dashed divide-silver-100 pb-8 xl:gap-x-6 xl:divide-y-0\",\"children\":[\"$\",\"div\",null,{\"className\":\"xl:pb-0\",\"children\":[[\"$\",\"div\",null,{\"className\":\"prose max-w-none pb-2 pt-10\",\"children\":[[\"$\",\"p\",null,{\"children\":[\"Modern applications are often complex, distributed systems. Debugging them is not fun: you have to follow requests across services, logs get lost, and metrics are often hard to correlate. It's like looking for a needle in a haystack - except the haystack is on fire, and the needle keeps moving. This is where \",[\"$\",\"$L7\",null,{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://opentelemetry.io\",\"children\":\"OpenTelemetry\"}],\" (OTel) can help.\"]}],[\"$\",\"p\",null,{\"children\":[\"OpenTelemetry is an open-source observability framework that helps collect and export \",[\"$\",\"strong\",null,{\"children\":\"traces\"}],\", \",[\"$\",\"strong\",null,{\"children\":\"metrics\"}],\", and \",[\"$\",\"strong\",null,{\"children\":\"logs\"}],\" from applications. It standardizes how telemetry data is gathered and makes it easy to integrate with tools like \",[\"$\",\"strong\",null,{\"children\":\"Grafana\"}],\". With OpenTelemetry, we can finally get clear insights into our application's performance, allowing us to answer questions like \\\"Why is this request slow?\\\", \\\"How many requests are active right now?\\\", and \\\"What errors are happening, and where?\\\".\"]}],[\"$\",\"p\",null,{\"children\":[\"In this post, I'll walk through how to integrate OpenTelemetry in a Go application. By the end, you'll have a reusable telemetry package that sets up logging, metrics, and tracing - all without cluttering your application code! I've published the package, complete with tests and examples, on GitHub: \",[\"$\",\"$L7\",null,{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://github.com/lucavallin/gotel\",\"children\":\"gotel\"}],\". Feel free to use it as a starting point for your own projects.\"]}],[\"$\",\"h2\",null,{\"id\":\"a-few-important-concepts-first\",\"children\":[[\"$\",\"$L7\",null,{\"href\":\"#a-few-important-concepts-first\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"icon icon-link\"}]}],\"A Few Important Concepts First\"]}],[\"$\",\"p\",null,{\"children\":\"Before we dive into code, let's break down the major components of OpenTelemetry: logs, metrics, and traces. These are the building blocks of observability, and they help us understand what's happening in our applications.\"}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"Providers\"}],\", \",[\"$\",\"strong\",null,{\"children\":\"resources\"}],\", \",[\"$\",\"strong\",null,{\"children\":\"exporters\"}],\", and \",[\"$\",\"strong\",null,{\"children\":\"collectors\"}],\" are the components that work together to gather, process, and send telemetry data to an external system.\"]}],[\"$\",\"h3\",null,{\"id\":\"logs-metrics-and-traces\",\"children\":[[\"$\",\"$L7\",null,{\"href\":\"#logs-metrics-and-traces\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"icon icon-link\"}]}],\"Logs, Metrics, and Traces\"]}],[\"$\",\"p\",null,{\"children\":\"Logs, metrics, and traces are all types of telemetry data, but they serve different purposes. Here's a quick overview of each:\"}],[\"$\",\"ul\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"Logs\"}],\" are records of discrete events. Think of them as diary entries for your application. When something goes wrong, logs are the first place you look.\"]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"Metrics\"}],\" track numerical data over time, like request duration, CPU usage, or active connections. They help monitor trends and spot performance issues.\"]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"Traces\"}],\" track a request as it flows through multiple services. A trace is made up of spans, each representing an individual operation.\"]}]]}],[\"$\",\"p\",null,{\"children\":\"Basically: logs tell us what happened, metrics show us how often it happens, and traces reveal how different parts of the system interact.\"}],[\"$\",\"h3\",null,{\"id\":\"providers-resources-exporters-and-collectors\",\"children\":[[\"$\",\"$L7\",null,{\"href\":\"#providers-resources-exporters-and-collectors\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"icon icon-link\"}]}],\"Providers, Resources, Exporters, and Collectors\"]}],[\"$\",\"p\",null,{\"children\":[\"In OpenTelemetry, providers, resources, exporters, and collectors work together to gather, process, and send telemetry data to an external system. Providers are responsible for generating telemetry data and they rely on resources, which \",[\"$\",\"strong\",null,{\"children\":\"define metadata about the application\"}],\", such as the service name, version, and host. Once telemetry data is collected, it needs to be sent somewhere, which is what exporters do. Exporters \",[\"$\",\"strong\",null,{\"children\":\"forward data\"}],\" to an observability backend like Grafana. To manage this process more efficiently, OpenTelemetry uses collectors, which \",[\"$\",\"strong\",null,{\"children\":\"act as intermediaries, aggregating, processing, and routing telemetry data\"}],\" before sending it to one or multiple backends. Collectors help reduce application overhead and provide flexibility in telemetry storage and analysis.\"]}],[\"$\",\"h2\",null,{\"id\":\"setting-up-telemetry-in-go\",\"children\":[[\"$\",\"$L7\",null,{\"href\":\"#setting-up-telemetry-in-go\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"icon icon-link\"}]}],\"Setting Up Telemetry in Go\"]}],[\"$\",\"p\",null,{\"children\":[\"Now, let's build a Go package that handles logs, metrics, and traces using OpenTelemetry. The package is called \",[\"$\",\"code\",null,{\"children\":\"gotel\"}],\" and it's available on GitHub: \",[\"$\",\"$L7\",null,{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://github.com/lucavallin/gotel\",\"children\":\"gotel\"}],\". This package wraps OpenTelemetry's SDK into a simple interface, making it easier to use.\"]}],[\"$\",\"h3\",null,{\"id\":\"configuration\",\"children\":[[\"$\",\"$L7\",null,{\"href\":\"#configuration\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"icon icon-link\"}]}],\"Configuration\"]}],[\"$\",\"p\",null,{\"children\":[\"First, we need a way to configure our telemetry system. The \",[\"$\",\"code\",null,{\"children\":\"config.go\"}],\" file handles this by loading settings from environment variables. This makes it easy to tweak the configuration without modifying the code.\"]}],[\"$\",\"$L13\",null,{\"className\":\"language-go\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-go code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"package\"}],\" gotel\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"import\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"fmt\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"github.com/caarlos0/env\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// Config holds the configuration for the telemetry.\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"type\"}],\" Config \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"struct\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\tServiceName    \",[\"$\",\"span\",null,{\"className\":\"token builtin\",\"children\":\"string\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"`env:\\\"SERVICE_NAME\\\"      envDefault:\\\"gotel\\\"`\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\tServiceVersion \",[\"$\",\"span\",null,{\"className\":\"token builtin\",\"children\":\"string\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"`env:\\\"SERVICE_VERSION\\\"   envDefault:\\\"0.0.1\\\"`\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\tEnabled        \",[\"$\",\"span\",null,{\"className\":\"token builtin\",\"children\":\"bool\"}],\"   \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"`env:\\\"TELEMETRY_ENABLED\\\" envDefault:\\\"true\\\"`\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// NewConfigFromEnv creates a new telemetry config from the environment.\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"func\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"NewConfigFromEnv\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"Config\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token builtin\",\"children\":\"error\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\ttelem \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":=\"}],\" Config\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" err \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":=\"}],\" env\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"Parse\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u0026\"}],\"telem\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\" err \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"!=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token boolean\",\"children\":\"nil\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\\t\",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" Config\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" fmt\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"Errorf\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"failed to parse telemetry config: %w\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" err\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" telem\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token boolean\",\"children\":\"nil\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}]]}]}],[\"$\",\"p\",null,{\"children\":[\"This file defines a \",[\"$\",\"code\",null,{\"children\":\"Config\"}],\" struct that stores the \",[\"$\",\"strong\",null,{\"children\":\"service name\"}],\", \",[\"$\",\"strong\",null,{\"children\":\"version\"}],\", and a flag to enable or disable telemetry. The \",[\"$\",\"code\",null,{\"children\":\"NewConfigFromEnv\"}],\" function loads these values from environment variables, allowing us to tweak settings without modifying the code. If an environment variable is not set, a default value is used instead.\"]}],[\"$\",\"h3\",null,{\"id\":\"providers--exporters\",\"children\":[[\"$\",\"$L7\",null,{\"href\":\"#providers--exporters\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"icon icon-link\"}]}],\"Providers \u0026 Exporters\"]}],[\"$\",\"p\",null,{\"children\":[\"Now that we have configuration in place, we need to set up \",[\"$\",\"strong\",null,{\"children\":\"providers\"}],\"-components responsible for handling logs, metrics, and traces.\"]}],[\"$\",\"p\",null,{\"children\":[\"The \",[\"$\",\"code\",null,{\"children\":\"providers.go\"}],\" file contains functions to create logger, meter, and tracer providers. These functions are used to initialize the telemetry system in \",[\"$\",\"code\",null,{\"children\":\"NewTelemetry\"}],\". The \",[\"$\",\"code\",null,{\"children\":\"newResource\"}],\" function is also defined in this file to attach metadata to all telemetry data, making it easier to track where the data is coming from.\"]}],[\"$\",\"$L13\",null,{\"className\":\"language-go\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-go code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"package\"}],\" gotel\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"import\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"context\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"fmt\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"os\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"go.opentelemetry.io/otel\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"go.opentelemetry.io/otel/exporters/otlp/otlplog/otlploggrpc\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"go.opentelemetry.io/otel/exporters/otlp/otlpmetric/otlpmetricgrpc\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"go.opentelemetry.io/otel/exporters/otlp/otlptrace/otlptracegrpc\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"go.opentelemetry.io/otel/sdk/log\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"go.opentelemetry.io/otel/sdk/metric\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"go.opentelemetry.io/otel/sdk/resource\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"go.opentelemetry.io/otel/sdk/trace\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\tsemconv \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"go.opentelemetry.io/otel/semconv/v1.17.0\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// newLoggerProvider creates a new logger provider with the OTLP gRPC exporter.\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"func\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"newLoggerProvider\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"ctx context\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"Context\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" res \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"resource\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"Resource\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"log\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"LoggerProvider\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token builtin\",\"children\":\"error\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\texporter\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" err \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":=\"}],\" otlploggrpc\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"New\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"ctx\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" err \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"!=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token boolean\",\"children\":\"nil\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\\t\",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token boolean\",\"children\":\"nil\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" fmt\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"Errorf\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"failed to create OTLP log exporter: %w\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" err\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\tprocessor \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":=\"}],\" log\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"NewBatchProcessor\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"exporter\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\tlp \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":=\"}],\" log\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"NewLoggerProvider\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\\tlog\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"WithProcessor\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"processor\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\\tlog\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"WithResource\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"res\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" lp\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token boolean\",\"children\":\"nil\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// newMeterProvider creates a new meter provider with the OTLP gRPC exporter.\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"func\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"newMeterProvider\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"ctx context\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"Context\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" res \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"resource\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"Resource\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"metric\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"MeterProvider\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token builtin\",\"children\":\"error\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\texporter\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" err \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":=\"}],\" otlpmetricgrpc\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"New\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"ctx\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" err \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"!=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token boolean\",\"children\":\"nil\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\\t\",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token boolean\",\"children\":\"nil\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" fmt\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"Errorf\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"failed to create OTLP metric exporter: %w\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" err\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\tmp \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":=\"}],\" metric\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"NewMeterProvider\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\\tmetric\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"WithReader\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"metric\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"NewPeriodicReader\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"exporter\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\\tmetric\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"WithResource\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"res\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\totel\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"SetMeterProvider\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"mp\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" mp\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token boolean\",\"children\":\"nil\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// newTracerProvider creates a new tracer provider with the OTLP gRPC exporter.\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"func\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"newTracerProvider\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"ctx context\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"Context\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" res \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"resource\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"Resource\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"trace\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"TracerProvider\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token builtin\",\"children\":\"error\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\texporter\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" err \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":=\"}],\" otlptracegrpc\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"New\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"ctx\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" err \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"!=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token boolean\",\"children\":\"nil\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\\t\",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token boolean\",\"children\":\"nil\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" fmt\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"Errorf\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"failed to create OTLP trace exporter: %w\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" err\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// Create Resource\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\ttp \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":=\"}],\" trace\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"NewTracerProvider\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\\ttrace\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"WithBatcher\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"exporter\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\\ttrace\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"WithResource\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"res\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\totel\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"SetTracerProvider\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"tp\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" tp\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token boolean\",\"children\":\"nil\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// newResource creates a new OTEL resource with the service name and version.\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"func\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"newResource\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"serviceName \",[\"$\",\"span\",null,{\"className\":\"token builtin\",\"children\":\"string\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" serviceVersion \",[\"$\",\"span\",null,{\"className\":\"token builtin\",\"children\":\"string\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"resource\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"Resource \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\thostName\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token boolean\",\"children\":\"_\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":=\"}],\" os\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"Hostname\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" resource\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"NewWithAttributes\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\\tsemconv\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"SchemaURL\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\\tsemconv\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"ServiceName\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"serviceName\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\\tsemconv\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"ServiceVersion\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"serviceVersion\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\\tsemconv\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"HostName\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"hostName\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}]]}]}],[\"$\",\"p\",null,{\"children\":[\"We start by importing OpenTelemetry's SDK and exporters for logs, metrics, and traces. These exporters \",[\"$\",\"strong\",null,{\"children\":\"send data to an external system\"}],\" like Grafana or another OTLP-compatible backend.\"]}],[\"$\",\"p\",null,{\"children\":[\"The \",[\"$\",\"code\",null,{\"children\":\"providers.go\"}],\" file contains functions for the following:\"]}],[\"$\",\"ul\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":[[\"$\",\"code\",null,{\"children\":\"newLoggerProvider\"}],\": creates a \",[\"$\",\"strong\",null,{\"children\":\"logger provider\"}],\", which collects and exports logs. The OTLP gRPC exporter sends logs over the network via gRPC, and the \",[\"$\",\"code\",null,{\"children\":\"BatchProcessor\"}],\" efficiently batches log entries before exporting them.\"]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"code\",null,{\"children\":\"newMeterProvider\"}],\": creates a \",[\"$\",\"strong\",null,{\"children\":\"metrics provider\"}],\", which is responsible for collecting \",[\"$\",\"strong\",null,{\"children\":\"metrics\"}],\". It periodically exports metrics to a backend.\"]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"code\",null,{\"children\":\"newTracerProvider\"}],\": creates a \",[\"$\",\"strong\",null,{\"children\":\"tracing provider\"}],\" to track request flows and exports them to an external backend.\"]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"code\",null,{\"children\":\"newResource\"}],\": creates a \",[\"$\",\"strong\",null,{\"children\":\"resource\"}],\" with metadata about the application, such as the service name, version, and hostname. This information is attached to all telemetry data.\"]}]]}],[\"$\",\"p\",null,{\"children\":[\"For all telemetry, I am using the \",[\"$\",\"strong\",null,{\"children\":\"OTLP gRPC exporter\"}],\", which is the default and most commonly used exporter in OpenTelemetry. OTLP (OpenTelemetry Protocol) is a standardized format for transmitting logs, metrics, and traces between applications and observability backends. It supports both gRPC and HTTP transport, allowing data to be sent efficiently in high-throughput environments. I chose OTLP gRPC because it provides low-latency, high-performance communication with strong streaming support, making it ideal for production workloads. However, OpenTelemetry supports many other exporters, depending on your use case.\"]}],[\"$\",\"h3\",null,{\"id\":\"bringing-it-all-together\",\"children\":[[\"$\",\"$L7\",null,{\"href\":\"#bringing-it-all-together\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"icon icon-link\"}]}],\"Bringing It All Together\"]}],[\"$\",\"p\",null,{\"children\":[\"The \",[\"$\",\"code\",null,{\"children\":\"Telemetry\"}],\" struct wraps all the components together. This is handy when we want to pass the telemetry system to other parts of the application. For example, we can use the \",[\"$\",\"code\",null,{\"children\":\"Telemetry\"}],\" struct in middleware to log requests and measure request duration. The \",[\"$\",\"code\",null,{\"children\":\"telemetry.go\"}],\" file contains the \",[\"$\",\"code\",null,{\"children\":\"Telemetry\"}],\" struct and the \",[\"$\",\"code\",null,{\"children\":\"TelemetryProvider\"}],\" interface, which defines the methods that the \",[\"$\",\"code\",null,{\"children\":\"Telemetry\"}],\" struct implements. The \",[\"$\",\"code\",null,{\"children\":\"Telemetry\"}],\" struct is a wrapper around the OpenTelemetry logger, meter, and tracer.\"]}],[\"$\",\"$L13\",null,{\"className\":\"language-go\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-go code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"package\"}],\" gotel\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"import\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"context\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"fmt\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"os\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"github.com/gin-gonic/gin\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"go.opentelemetry.io/contrib/bridges/otelzap\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\totelmetric \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"go.opentelemetry.io/otel/metric\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"go.opentelemetry.io/otel/sdk/log\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"go.opentelemetry.io/otel/sdk/metric\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"go.opentelemetry.io/otel/sdk/trace\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\toteltrace \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"go.opentelemetry.io/otel/trace\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"go.uber.org/zap\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"go.uber.org/zap/zapcore\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// TelemetryProvider is an interface for the telemetry provider.\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"type\"}],\" TelemetryProvider \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"interface\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"GetServiceName\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token builtin\",\"children\":\"string\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"LogInfo\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"args \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"...\"}],[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"interface\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"LogErrorln\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"args \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"...\"}],[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"interface\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"LogFatalln\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"args \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"...\"}],[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"interface\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"MeterInt64Histogram\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"metric Metric\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"otelmetric\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"Int64Histogram\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token builtin\",\"children\":\"error\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"MeterInt64UpDownCounter\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"metric Metric\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"otelmetric\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"Int64UpDownCounter\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token builtin\",\"children\":\"error\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"TraceStart\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"ctx context\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"Context\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" name \",[\"$\",\"span\",null,{\"className\":\"token builtin\",\"children\":\"string\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"context\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"Context\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" oteltrace\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"Span\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"LogRequest\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" gin\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"HandlerFunc\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"MeterRequestDuration\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" gin\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"HandlerFunc\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"MeterRequestsInFlight\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" gin\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"HandlerFunc\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"Shutdown\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"ctx context\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"Context\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// Telemetry is a wrapper around the OpenTelemetry logger, meter, and tracer.\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"type\"}],\" Telemetry \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"struct\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\tlp     \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"log\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"LoggerProvider\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\tmp     \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"metric\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"MeterProvider\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\ttp     \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"trace\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"TracerProvider\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\tlog    \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"zap\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"SugaredLogger\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\tmeter  otelmetric\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"Meter\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\ttracer oteltrace\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"Tracer\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\tcfg    Config\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// NewTelemetry creates a new telemetry instance.\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"func\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"NewTelemetry\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"ctx context\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"Context\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" cfg Config\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"Telemetry\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token builtin\",\"children\":\"error\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\trp \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"newResource\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"cfg\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"ServiceName\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" cfg\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"ServiceVersion\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\tlp\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" err \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"newLoggerProvider\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"ctx\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" rp\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" err \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"!=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token boolean\",\"children\":\"nil\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\\t\",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token boolean\",\"children\":\"nil\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" fmt\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"Errorf\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"failed to create logger: %w\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" err\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\tlogger \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":=\"}],\" zap\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"New\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\\tzapcore\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"NewTee\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\\t\\tzapcore\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"NewCore\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"zapcore\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"NewJSONEncoder\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"zap\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"NewProductionEncoderConfig\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" zapcore\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"AddSync\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"os\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"Stdout\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" zapcore\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"InfoLevel\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\\t\\totelzap\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"NewCore\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"cfg\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"ServiceName\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" otelzap\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"WithLoggerProvider\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"lp\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\\t\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\tmp\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" err \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"newMeterProvider\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"ctx\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" rp\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" err \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"!=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token boolean\",\"children\":\"nil\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\\t\",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token boolean\",\"children\":\"nil\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" fmt\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"Errorf\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"failed to create meter: %w\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" err\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\tmeter \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":=\"}],\" mp\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"Meter\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"cfg\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"ServiceName\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\ttp\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" err \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"newTracerProvider\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"ctx\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" rp\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" err \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"!=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token boolean\",\"children\":\"nil\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\\t\",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token boolean\",\"children\":\"nil\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" fmt\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"Errorf\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"failed to create tracer: %w\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" err\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\ttracer \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":=\"}],\" tp\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"Tracer\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"cfg\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"ServiceName\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u0026\"}],\"Telemetry\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\\tlp\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"     lp\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\\tmp\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"     mp\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\\ttp\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"     tp\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\\tlog\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"    logger\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"Sugar\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\\tmeter\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"  meter\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\\ttracer\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\" tracer\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\\tcfg\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"    cfg\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token boolean\",\"children\":\"nil\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// GetServiceName returns the name of the service.\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"func\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"t \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"Telemetry\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"GetServiceName\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token builtin\",\"children\":\"string\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" t\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"cfg\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"ServiceName\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// LogInfo logs a message at the info level.\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"func\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"t \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"Telemetry\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"LogInfo\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"args \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"...\"}],[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"interface\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\tt\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"log\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"Info\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"args\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"...\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// LogErrorln logs a message and then calls os.Exit(1).\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"func\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"t \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"Telemetry\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"LogErrorln\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"args \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"...\"}],[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"interface\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\tt\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"log\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"Errorln\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"args\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"...\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// LogFatalln logs a message and then calls os.Exit(1).\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"func\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"t \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"Telemetry\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"LogFatalln\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"args \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"...\"}],[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"interface\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\tt\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"log\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"Fatalln\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"args\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"...\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// MeterInt64Histogram creates a new int64 histogram metric.\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"func\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"t \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"Telemetry\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"MeterInt64Histogram\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"metric Metric\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"otelmetric\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"Int64Histogram\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token builtin\",\"children\":\"error\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"//nolint:ireturn\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\thistogram\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" err \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":=\"}],\" t\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"meter\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"Int64Histogram\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\\tmetric\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"Name\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\\totelmetric\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"WithDescription\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"metric\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"Description\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\\totelmetric\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"WithUnit\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"metric\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"Unit\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" err \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"!=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token boolean\",\"children\":\"nil\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\\t\",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token boolean\",\"children\":\"nil\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" fmt\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"Errorf\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"failed to create histogram: %w\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" err\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" histogram\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token boolean\",\"children\":\"nil\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// MeterInt64UpDownCounter creates a new int64 up down counter metric.\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"func\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"t \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"Telemetry\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"MeterInt64UpDownCounter\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"metric Metric\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"otelmetric\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"Int64UpDownCounter\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token builtin\",\"children\":\"error\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"//nolint:ireturn\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\tcounter\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" err \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":=\"}],\" t\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"meter\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"Int64UpDownCounter\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\\tmetric\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"Name\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\\totelmetric\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"WithDescription\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"metric\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"Description\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\\totelmetric\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"WithUnit\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"metric\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"Unit\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" err \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"!=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token boolean\",\"children\":\"nil\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\\t\",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token boolean\",\"children\":\"nil\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" fmt\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"Errorf\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"failed to create counter: %w\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" err\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" counter\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token boolean\",\"children\":\"nil\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// TraceStart starts a new span with the given name. The span must be ended by calling End.\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"func\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"t \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"Telemetry\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"TraceStart\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"ctx context\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"Context\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" name \",[\"$\",\"span\",null,{\"className\":\"token builtin\",\"children\":\"string\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"context\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"Context\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" oteltrace\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"Span\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"//nolint:ireturn\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"//nolint: spancheck\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" t\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"tracer\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"Start\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"ctx\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" name\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// Shutdown shuts down the logger, meter, and tracer.\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"func\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"t \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"Telemetry\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"Shutdown\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"ctx context\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"Context\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\tt\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"lp\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"Shutdown\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"ctx\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\tt\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"mp\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"Shutdown\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"ctx\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\tt\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"tp\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"Shutdown\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"ctx\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}]]}]}],[\"$\",\"p\",null,{\"children\":[\"In this file, a \",[\"$\",\"code\",null,{\"children\":\"TelemetryProvider\"}],\" interface is defined to make it easier to mock the telemetry package in tests, but also to make it easier to swap out the underlying telemetry system in the future.\"]}],[\"$\",\"p\",null,{\"children\":[\"The \",[\"$\",\"code\",null,{\"children\":\"NewTelemetry\"}],\" function initializes logging, metrics, and tracing and returns an instance of the \",[\"$\",\"code\",null,{\"children\":\"Telemetry\"}],\" struct. I am using the \",[\"$\",\"$L7\",null,{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://github.com/uber-go/zap\",\"children\":\"zap\"}],\" logger for simplicity, but you can use any other logger that integrates with OpenTelemetry. Keep in mind, the \",[\"$\",\"code\",null,{\"children\":\"zap\"}],\" logger requires a so-called \",[\"$\",\"strong\",null,{\"children\":\"\\\"bridge\\\"\"}],\" (\",[\"$\",\"code\",null,{\"children\":\"otelzap\"}],\") to work with OpenTelemetry.\"]}],[\"$\",\"p\",null,{\"children\":[\"An advantage of defining the \",[\"$\",\"code\",null,{\"children\":\"TelemetryProvider\"}],\" interface is that we can easily swap out the underlying telemetry system, for example in tests. Here's an example of a no-op telemetry provider that can be used in tests:\"]}],[\"$\",\"$L13\",null,{\"className\":\"language-go\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-go code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"package\"}],\" gotel\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"import\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"context\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"os\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"github.com/gin-gonic/gin\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"go.opentelemetry.io/otel/metric\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"go.opentelemetry.io/otel/trace\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// NoopTelemetry is a no-op implementation of the TelemetryProvider interface.\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"type\"}],\" NoopTelemetry \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"struct\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\tserviceName \",[\"$\",\"span\",null,{\"className\":\"token builtin\",\"children\":\"string\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// NewNoopTelemetry creates a new NoopTelemetry instance.\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"func\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"NewNoopTelemetry\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"cfg Config\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"NoopTelemetry\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token builtin\",\"children\":\"error\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u0026\"}],\"NoopTelemetry\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"serviceName\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\" cfg\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"ServiceName\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token boolean\",\"children\":\"nil\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// GetServiceName returns the service name.\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"func\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"t \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"NoopTelemetry\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"GetServiceName\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token builtin\",\"children\":\"string\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" t\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"serviceName \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// LogInfo logs nothing.\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"func\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"t \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"NoopTelemetry\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"LogInfo\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"args \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"...\"}],[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"interface\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// LogErrorln logs nothing.\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"func\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"t \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"NoopTelemetry\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"LogErrorln\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"args \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"...\"}],[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"interface\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// LogFatalln logs nothing, then exits.\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"func\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"t \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"NoopTelemetry\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"LogFatalln\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"args \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"...\"}],[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"interface\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\tos\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"Exit\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"1\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// LogRequest is a no-op middleware.\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"func\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"t \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"NoopTelemetry\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"LogRequest\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" gin\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"HandlerFunc \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"func\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"c \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"gin\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"Context\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\" c\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"Next\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// MeterRequestDuration is a no-op middleware.\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"func\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"t \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"NoopTelemetry\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"MeterRequestDuration\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" gin\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"HandlerFunc \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"func\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"c \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"gin\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"Context\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\" c\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"Next\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// MeterRequestsInFlight is a no-op middleware.\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"func\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"t \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"NoopTelemetry\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"MeterRequestsInFlight\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" gin\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"HandlerFunc \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"func\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"c \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"gin\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"Context\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\" c\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"Next\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// TraceStart returns the context and span unchanged.\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"func\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"t \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"NoopTelemetry\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"TraceStart\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"ctx context\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"Context\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" name \",[\"$\",\"span\",null,{\"className\":\"token builtin\",\"children\":\"string\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"context\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"Context\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" trace\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"Span\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" ctx\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" trace\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"SpanFromContext\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"ctx\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// MeterInt64Histogram returns nil.\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"func\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"t \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"NoopTelemetry\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"MeterInt64Histogram\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"metric Metric\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"metric\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"Int64Histogram\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token builtin\",\"children\":\"error\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token boolean\",\"children\":\"nil\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token boolean\",\"children\":\"nil\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// MeterInt64UpDownCounter returns nil.\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"func\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"t \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"NoopTelemetry\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"MeterInt64UpDownCounter\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"metric Metric\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"metric\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"Int64UpDownCounter\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token builtin\",\"children\":\"error\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token boolean\",\"children\":\"nil\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token boolean\",\"children\":\"nil\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// Shutdown does nothing.\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"func\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"t \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"NoopTelemetry\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"Shutdown\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"ctx context\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"Context\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}]]}]}],[\"$\",\"p\",null,{\"children\":[\"The \",[\"$\",\"code\",null,{\"children\":\"NoopTelemetry\"}],\" struct implements the \",[\"$\",\"code\",null,{\"children\":\"TelemetryProvider\"}],\" interface, but does nothing. This is useful for tests, where we don't want to send telemetry data to an external system.\"]}],[\"$\",\"h2\",null,{\"id\":\"using-the-telemetry-package\",\"children\":[[\"$\",\"$L7\",null,{\"href\":\"#using-the-telemetry-package\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"icon icon-link\"}]}],\"Using the Telemetry Package\"]}],[\"$\",\"p\",null,{\"children\":[\"In \",[\"$\",\"code\",null,{\"children\":\"main.go\"}],\", we can now initialize and use our telemetry system. Here's an example of how to use the \",[\"$\",\"code\",null,{\"children\":\"gotel\"}],\" package to create a new telemetry system. In this example, if the initialization fails, the \",[\"$\",\"code\",null,{\"children\":\"NewTelemetry\"}],\" function falls back to a no-op telemetry system. This is useful for graceful degradation, where we want to continue running the application even if the telemetry system is down.\"]}],[\"$\",\"$L13\",null,{\"className\":\"language-go\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-go code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"package\"}],\" main\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"import\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"context\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"fmt\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"os\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"github.com/lucavallin/gotel\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"func\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"main\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\tctx \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":=\"}],\" context\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"Background\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\ttelemConfig\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" err \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":=\"}],\" gotel\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"NewConfigFromEnv\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" err \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"!=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token boolean\",\"children\":\"nil\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\\tfmt\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"Println\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"failed to load telemetry config\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\\tos\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"Exit\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"1\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// Initialize telemetry. If the exporter fails, fallback to nop.\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"var\"}],\" telem gotel\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"TelemetryProvider\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\ttelem\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" err \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" gotel\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"NewTelemetry\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"ctx\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" telemConfig\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" err \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"!=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token boolean\",\"children\":\"nil\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\\tfmt\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"Println\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"failed to create telemetry, falling back to no-op telemetry\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\\ttelem\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token boolean\",\"children\":\"_\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" gotel\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"NewNoopTelemetry\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"telemConfig\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"defer\"}],\" telem\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"Shutdown\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"ctx\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\ttelem\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"LogInfo\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"telemetry initialized\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}]]}]}],[\"$\",\"p\",null,{\"children\":[\"The \",[\"$\",\"code\",null,{\"children\":\"telem\"}],\" variable is an instance of the \",[\"$\",\"code\",null,{\"children\":\"Telemetry\"}],\" struct, which implements the \",[\"$\",\"code\",null,{\"children\":\"TelemetryProvider\"}],\" interface. It can be used to write info-level logs with \",[\"$\",\"code\",null,{\"children\":\"telem.LogInfo()\"}],\", for example. The \",[\"$\",\"code\",null,{\"children\":\"telem\"}],\" variable can also be passed to other parts of the application, like services, middleware, etc.\"]}],[\"$\",\"h3\",null,{\"id\":\"what-about-traces\",\"children\":[[\"$\",\"$L7\",null,{\"href\":\"#what-about-traces\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"icon icon-link\"}]}],\"What About Traces?\"]}],[\"$\",\"p\",null,{\"children\":[\"Traces track a request as it flows through multiple services. A trace is made up of \",[\"$\",\"strong\",null,{\"children\":\"spans\"}],\", each representing an individual operation. The \",[\"$\",\"code\",null,{\"children\":\"TraceStart\"}],\" function that the \",[\"$\",\"code\",null,{\"children\":\"gotel\"}],\" package provides is a convenient way to start a new span and attach it to the current context. This is useful for instrumenting HTTP requests, for example.\"]}],[\"$\",\"p\",null,{\"children\":\"Let's take this example of a fictional API:\"}],[\"$\",\"$L13\",null,{\"className\":\"language-go\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-go code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"type\"}],\" API \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"struct\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\ttelem   gotel\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"TelemetryProvider\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\thttpSrv \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"http\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"Server\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}]]}]}],[\"$\",\"p\",null,{\"children\":[\"This API has a \",[\"$\",\"code\",null,{\"children\":\"telem\"}],\" field that holds a reference to the telemetry system. I like to structure my APIs this way because it makes it easy to use dependencies in the HTTP handlers.\"]}],[\"$\",\"$L13\",null,{\"className\":\"language-go\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-go code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"func\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"a \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"API\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"GetSomething\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"c \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"gin\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"Context\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token boolean\",\"children\":\"_\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" span \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":=\"}],\" a\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"telem\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"TraceStart\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"c\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"Request\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"Context\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"get_something\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"defer\"}],\" span\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"End\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\tsomething \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],[\"$\",\"span\",null,{\"className\":\"token builtin\",\"children\":\"string\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"foo\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"bar\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"baz\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\tc\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"JSON\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"http\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"StatusOK\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" something\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}]]}]}],[\"$\",\"p\",null,{\"children\":[\"In this example, the \",[\"$\",\"code\",null,{\"children\":\"GetSomething\"}],\" handler starts a new span with the name \",[\"$\",\"code\",null,{\"children\":\"get_something\"}],\" and attaches it to the current context. The \",[\"$\",\"code\",null,{\"children\":\"defer span.End()\"}],\" statement ends the span when the function returns.\"]}],[\"$\",\"h3\",null,{\"id\":\"middlewares--metrics\",\"children\":[[\"$\",\"$L7\",null,{\"href\":\"#middlewares--metrics\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"icon icon-link\"}]}],\"Middlewares \u0026 Metrics\"]}],[\"$\",\"p\",null,{\"children\":[\"A common pattern is to use \",[\"$\",\"strong\",null,{\"children\":\"middlewares\"}],\" to instrument HTTP requests. Here's an example of a \",[\"$\",\"code\",null,{\"children\":\"telemetry\"}],\" middleware that logs request duration and counts requests in flight. This is useful for monitoring the health of the application.\"]}],[\"$\",\"p\",null,{\"children\":[\"In a \",[\"$\",\"code\",null,{\"children\":\"metrics.go\"}],\" file, we define a \",[\"$\",\"code\",null,{\"children\":\"Metrics\"}],\" struct that holds references to the metrics we want to collect. This makes it easy to pass the metrics to middleware and other parts of the application. The \",[\"$\",\"code\",null,{\"children\":\"Metric\"}],\" struct defines the name, unit, and description of a metric. This is useful for defining metrics in a reusable way.\"]}],[\"$\",\"$L13\",null,{\"className\":\"language-go\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-go code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"package\"}],\" gotel\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// Metric represents a metric that can be collected by the server.\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"type\"}],\" Metric \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"struct\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\tName        \",[\"$\",\"span\",null,{\"className\":\"token builtin\",\"children\":\"string\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\tUnit        \",[\"$\",\"span\",null,{\"className\":\"token builtin\",\"children\":\"string\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\tDescription \",[\"$\",\"span\",null,{\"className\":\"token builtin\",\"children\":\"string\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// MetricRequestDurationMillis is a metric that measures the latency of HTTP requests processed by the server, in milliseconds.\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"var\"}],\" MetricRequestDurationMillis \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" Metric\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\tName\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"        \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"request_duration_millis\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\tUnit\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"        \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"ms\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\tDescription\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"Measures the latency of HTTP requests processed by the server, in milliseconds.\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// MetricRequestsInFlight is a metric that measures the number of requests currently being processed by the server.\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"var\"}],\" MetricRequestsInFlight \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" Metric\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\tName\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"        \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"requests_inflight\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\tUnit\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"        \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"{count}\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\tDescription\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"Measures the number of requests currently being processed by the server.\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}]]}]}],[\"$\",\"p\",null,{\"children\":[\"A \",[\"$\",\"code\",null,{\"children\":\"middleware.go\"}],\" file instead contains the \",[\"$\",\"code\",null,{\"children\":\"telemetry\"}],\" middleware, for use with the \",[\"$\",\"$L7\",null,{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://gin-gonic.com\",\"children\":\"gin\"}],\" web framework. The middleware functions defined can be used to log requests, measure request duration, and count requests in flight.\"]}],[\"$\",\"$L13\",null,{\"className\":\"language-go\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-go code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"package\"}],\" gotel\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"import\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"fmt\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"time\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"github.com/gin-gonic/gin\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"go.opentelemetry.io/otel/metric\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"go.opentelemetry.io/otel/semconv/v1.20.0/httpconv\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// LogRequest is a gin middleware that logs the request path.\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"func\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"t \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"Telemetry\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"LogRequest\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" gin\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"HandlerFunc \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"func\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"c \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"gin\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"Context\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\\tt\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"LogInfo\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"request to \\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" c\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"Request\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"URL\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"Path\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\\tc\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"Next\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\\tt\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"LogInfo\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"end of request to \\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" c\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"Request\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"URL\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"Path\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// MeterRequestDuration is a gin middleware that captures the duration of the request.\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"func\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"t \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"Telemetry\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"MeterRequestDuration\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" gin\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"HandlerFunc \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// init metric, here we are using histogram for capturing request duration\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\thistogram\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" err \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":=\"}],\" t\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"MeterInt64Histogram\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"MetricRequestDurationMillis\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" err \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"!=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token boolean\",\"children\":\"nil\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\\tt\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"LogFatalln\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"fmt\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"Errorf\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"failed to create histogram: %w\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" err\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"func\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"c \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"gin\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"Context\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\\t\",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// capture the start time of the request\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\\tstartTime \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":=\"}],\" time\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"Now\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\\t\",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// execute next http handler\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\\tc\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"Next\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\\t\",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// record the request duration\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\\tduration \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":=\"}],\" time\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"Since\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"startTime\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\\thistogram\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"Record\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\\t\\tc\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"Request\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"Context\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\\t\\tduration\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"Milliseconds\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\\t\\tmetric\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"WithAttributes\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\\t\\t\\thttpconv\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"ServerRequest\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"t\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"GetServiceName\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" c\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"Request\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"...\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\\t\\t\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\\t\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// MeterRequestsInFlight is a gin middleware that captures the number of requests in flight.\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"func\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"t \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"Telemetry\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"MeterRequestsInFlight\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" gin\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"HandlerFunc \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// init metric, here we are using counter for capturing request in flight\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\tcounter\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" err \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":=\"}],\" t\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"MeterInt64UpDownCounter\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"MetricRequestsInFlight\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" err \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"!=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token boolean\",\"children\":\"nil\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\\tt\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"LogFatalln\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"fmt\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"Errorf\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"failed to create counter: %w\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" err\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"func\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"c \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"gin\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"Context\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\\t\",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// define metric attributes\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\\tattrs \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":=\"}],\" metric\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"WithAttributes\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"httpconv\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"ServerRequest\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"t\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"GetServiceName\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" c\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"Request\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"...\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\\t\",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// increase the number of requests in flight\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\\tcounter\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"Add\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"c\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"Request\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"Context\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"1\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" attrs\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\\t\",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// execute next http handler\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\\tc\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"Next\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\\t\",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// decrease the number of requests in flight\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\\tcounter\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"Add\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"c\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"Request\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"Context\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"-\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"1\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" attrs\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}]]}]}],[\"$\",\"p\",null,{\"children\":[\"You can then use the middleware in your application to get observability data transparently. For example, with \",[\"$\",\"$L7\",null,{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://github.com/gin-gonic/gin\",\"children\":\"gin-gonic/gin\"}],\":\"]}],[\"$\",\"$L13\",null,{\"className\":\"language-go\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-go code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"r \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":=\"}],\" gin\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"New\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"r\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"Use\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"telem\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"LogRequest\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"r\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"Use\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"telem\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"MeterRequestDuration\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"r\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"Use\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"telem\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"MeterRequestsInFlight\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}]]}]}],[\"$\",\"p\",null,{\"children\":[\"See gin's \",[\"$\",\"$L7\",null,{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://gin-gonic.com/docs/examples/custom-middleware/\",\"children\":\"Custom Middleware\"}],\" docs for more information.\"]}],[\"$\",\"h2\",null,{\"id\":\"so-where-does-the-telemetry-go\",\"children\":[[\"$\",\"$L7\",null,{\"href\":\"#so-where-does-the-telemetry-go\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"icon icon-link\"}]}],\"So Where Does the Telemetry Go?\"]}],[\"$\",\"p\",null,{\"children\":[\"The telemetry data is sent to an observability backend, and Grafana's \",[\"$\",\"code\",null,{\"children\":\"grafana/docker-otel-lgtm\"}],\" is an all-in-one OpenTelemetry backend that makes it easy to get started.\"]}],[\"$\",\"div\",null,{\"children\":[\"$\",\"$L12\",null,{\"alt\":\"Grafana's docker-otel-lgtm\",\"src\":\"/images/blog/opentelemetry-a-guide-to-observability-with-go/grafana-docker-otel-lgtm.webp\",\"width\":\"1577\",\"height\":\"658\"}]}],[\"$\",\"p\",null,{\"children\":[\"Grafana's \",[\"$\",\"code\",null,{\"children\":\"grafana/docker-otel-lgtm\"}],\" is a Docker image that offers a ready-to-use OpenTelemetry backend. It integrates the OpenTelemetry Collector with Grafana's LGTM stack (Loki for logs, Grafana for visualization, Tempo for traces, and Mimir for metrics).\"]}],[\"$\",\"p\",null,{\"children\":[\"By running this container, you can receive OpenTelemetry signals on default ports (4317 for gRPC and 4318 for HTTP). These signals are then automatically forwarded: logs go to \",[\"$\",\"strong\",null,{\"children\":\"Loki\"}],\", traces go to \",[\"$\",\"strong\",null,{\"children\":\"Tempo\"}],\", and metrics go to \",[\"$\",\"strong\",null,{\"children\":\"Mimir\"}],\".\"]}],[\"$\",\"p\",null,{\"children\":\"Grafana is pre-configured to visualize all these data sources and is accessible via port 3000. This makes it a great solution for development, demos, and testing environments, providing a quick way to analyze telemetry data without needing extensive configuration.\"}],[\"$\",\"h2\",null,{\"id\":\"summary\",\"children\":[[\"$\",\"$L7\",null,{\"href\":\"#summary\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"icon icon-link\"}]}],\"Summary\"]}],[\"$\",\"p\",null,{\"children\":[\"Observability isn't just a nice-to-have, it's what keeps you from flying blind when things go wrong in your application. OpenTelemetry makes it easy to \",[\"$\",\"strong\",null,{\"children\":\"collect, process, and export logs, metrics, and traces\"}],\" in a way that's standardized and vendor-neutral. In this post, we broke down the key concepts of observability, explored how OpenTelemetry works, and built a reusable telemetry package in Go to keep logging, metrics, and tracing clean and consistent across an application.\"]}],[\"$\",\"p\",null,{\"children\":[\"By structuring everything into a single, easy-to-use package, we've made it simple to instrument your code without cluttering it. Whether you need to debug a slow request, track system performance, or figure out why your service is on fire at 2 AM, OpenTelemetry has you covered. And with Grafana's \",[\"$\",\"code\",null,{\"children\":\"docker-otel-lgtm\"}],\", you can spin up a fully functional OpenTelemetry backend in seconds to visualize all your telemetry data.\"]}],[\"$\",\"p\",null,{\"children\":[\"If you want to give it a try, check out \",[\"$\",\"$L7\",null,{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://github.com/lucavallin/gotel\",\"children\":\"gotel\"}],\" on GitHub. It's built to be plug-and-play, so you can start collecting logs, metrics, and traces right away. Happy coding, and may your traces always connect, your metrics make sense, and your logs tell you what actually happened! 🚀\"]}]]}],[\"$\",\"div\",null,{}]]}]}]]}]}]}]]\n"])</script><script>self.__next_f.push([1,"10:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n"])</script><script>self.__next_f.push([1,"e:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"1\",{\"children\":\"OpenTelemetry: A Guide to Observability with Go | Blog | Luca Cavallin\"}],[\"$\",\"meta\",\"2\",{\"name\":\"description\",\"content\":\"Modern applications are often complex, distributed systems. Debugging them is not fun: you have to follow requests across services, logs get lost, and metrics are often hard to correlate. It's like looking for a needle in a haystack - except the haystack is on fire, and the needle keeps moving. This is where OpenTelemetry (OTel) can help.\"}],[\"$\",\"link\",\"3\",{\"rel\":\"author\",\"href\":\"https://www.lucavall.in\"}],[\"$\",\"meta\",\"4\",{\"name\":\"author\",\"content\":\"Luca Cavallin\"}],[\"$\",\"link\",\"5\",{\"rel\":\"manifest\",\"href\":\"/manifest.webmanifest\",\"crossOrigin\":\"$undefined\"}],[\"$\",\"meta\",\"6\",{\"name\":\"creator\",\"content\":\"Luca Cavallin\"}],[\"$\",\"meta\",\"7\",{\"name\":\"publisher\",\"content\":\"Luca Cavallin\"}],[\"$\",\"meta\",\"8\",{\"name\":\"robots\",\"content\":\"index, follow\"}],[\"$\",\"meta\",\"9\",{\"name\":\"googlebot\",\"content\":\"index, follow, max-video-preview:-1, max-image-preview:large, max-snippet:-1\"}],[\"$\",\"link\",\"10\",{\"rel\":\"canonical\",\"href\":\"https://www.lucavall.in/blog/opentelemetry-a-guide-to-observability-with-go\"}],[\"$\",\"link\",\"11\",{\"rel\":\"alternate\",\"type\":\"application/rss+xml\",\"href\":\"https://www.lucavall.in/feed.xml\"}],[\"$\",\"meta\",\"12\",{\"property\":\"og:title\",\"content\":\"OpenTelemetry: A Guide to Observability with Go | Blog\"}],[\"$\",\"meta\",\"13\",{\"property\":\"og:description\",\"content\":\"Modern applications are often complex, distributed systems. Debugging them is not fun: you have to follow requests across services, logs get lost, and metrics are often hard to correlate. It's like looking for a needle in a haystack - except the haystack is on fire, and the needle keeps moving. This is where OpenTelemetry (OTel) can help.\"}],[\"$\",\"meta\",\"14\",{\"property\":\"og:url\",\"content\":\"https://www.lucavall.in/blog/opentelemetry-a-guide-to-observability-with-go\"}],[\"$\",\"meta\",\"15\",{\"property\":\"og:site_name\",\"content\":\"Luca Cavallin\"}],[\"$\",\"meta\",\"16\",{\"property\":\"og:locale\",\"content\":\"en_US\"}],[\"$\",\"meta\",\"17\",{\"property\":\"og:image\",\"content\":\"https://www.lucavall.in/images/blog/opentelemetry-a-guide-to-observability-with-go/cover.webp\"}],[\"$\",\"meta\",\"18\",{\"property\":\"og:type\",\"content\":\"article\"}],[\"$\",\"meta\",\"19\",{\"property\":\"article:published_time\",\"content\":\"2025-02-06T00:00:00.000Z\"}],[\"$\",\"meta\",\"20\",{\"property\":\"article:modified_time\",\"content\":\"2025-02-06T00:00:00.000Z\"}],[\"$\",\"meta\",\"21\",{\"property\":\"article:author\",\"content\":\"Luca Cavallin\"}],[\"$\",\"meta\",\"22\",{\"name\":\"twitter:card\",\"content\":\"summary_large_image\"}],[\"$\",\"meta\",\"23\",{\"name\":\"twitter:title\",\"content\":\"OpenTelemetry: A Guide to Observability with Go | Blog\"}],[\"$\",\"meta\",\"24\",{\"name\":\"twitter:description\",\"content\":\"Modern applications are often complex, distributed systems. Debugging them is not fun: you have to follow requests across services, logs get lost, and metrics are often hard to correlate. It's like looking for a needle in a haystack - except the haystack is on fire, and the needle keeps moving. This is where OpenTelemetry (OTel) can help.\"}],[\"$\",\"meta\",\"25\",{\"name\":\"twitter:image\",\"content\":\"https://www.lucavall.in/images/blog/opentelemetry-a-guide-to-observability-with-go/cover.webp\"}],[\"$\",\"link\",\"26\",{\"rel\":\"icon\",\"href\":\"/favicon.ico\",\"type\":\"image/x-icon\",\"sizes\":\"48x48\"}],[\"$\",\"link\",\"27\",{\"rel\":\"apple-touch-icon\",\"href\":\"/apple-icon.png?0c30cc317c29bf5e\",\"type\":\"image/png\",\"sizes\":\"180x180\"}]]\n"])</script><script>self.__next_f.push([1,"c:null\n"])</script></body></html>